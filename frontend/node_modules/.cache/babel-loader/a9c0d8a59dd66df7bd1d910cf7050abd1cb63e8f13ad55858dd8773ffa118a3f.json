{"ast":null,"code":"import { remove, resetBlazorTemplate, blazorTemplates, getValue } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { DataManager, Query, Deferred, Predicate, DataUtil } from '@syncfusion/ej2-data';\nimport { ValueFormatter } from '../services/value-formatter';\nimport { RenderType, CellType } from '../base/enum';\nimport { Data } from '../actions/data';\nimport { Column } from '../models/column';\nimport { Row } from '../models/row';\nimport { Cell } from '../models/cell';\nimport * as events from '../base/constant';\nimport { prepareColumns, setFormatter, isGroupAdaptive, getDatePredicate, getObject, clearReactVueTemplates } from '../base/util';\nimport { ContentRender } from '../renderer/content-renderer';\nimport { HeaderRender } from '../renderer/header-renderer';\nimport { CellRenderer } from '../renderer/cell-renderer';\nimport { HeaderCellRenderer } from '../renderer/header-cell-renderer';\nimport { StackedHeaderCellRenderer } from '../renderer/stacked-cell-renderer';\nimport { IndentCellRenderer } from '../renderer/indent-cell-renderer';\nimport { GroupCaptionCellRenderer, GroupCaptionEmptyCellRenderer } from '../renderer/caption-cell-renderer';\nimport { ExpandCellRenderer } from '../renderer/expand-cell-renderer';\nimport { HeaderIndentCellRenderer } from '../renderer/header-indent-renderer';\nimport { DetailHeaderIndentCellRenderer } from '../renderer/detail-header-indent-renderer';\nimport { DetailExpandCellRenderer } from '../renderer/detail-expand-cell-renderer';\nimport { RowDragDropRenderer } from './row-drag-drop-renderer';\nimport { RowDragDropHeaderRenderer } from '../renderer/row-drag-header-indent-render';\nimport * as literals from '../base/string-literals';\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar Render = /** @class */function () {\n  /**\n   * Constructor for render module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {ServiceLocator} locator - specifies the serviceLocator\n   */\n  function Render(parent, locator) {\n    this.emptyGrid = false;\n    this.counter = 0;\n    this.parent = parent;\n    this.locator = locator;\n    this.data = new Data(parent, locator);\n    this.l10n = locator.getService('localization');\n    this.ariaService = this.locator.getService('ariaService');\n    this.renderer = this.locator.getService('rendererFactory');\n    this.addEventListener();\n  }\n  /**\n   * To initialize grid header, content and footer rendering\n   *\n   * @returns {void}\n   */\n  Render.prototype.render = function () {\n    var gObj = this.parent;\n    this.headerRenderer = this.renderer.getRenderer(RenderType.Header);\n    this.contentRenderer = this.renderer.getRenderer(RenderType.Content);\n    this.headerRenderer.renderPanel();\n    this.contentRenderer.renderPanel();\n    if (gObj.getColumns().length) {\n      this.isLayoutRendered = true;\n      this.headerRenderer.renderTable();\n      this.contentRenderer.renderTable();\n      this.emptyRow(false);\n    }\n    this.parent.scrollModule.setWidth();\n    this.parent.scrollModule.setHeight();\n    if (this.parent.height !== 'auto') {\n      this.parent.scrollModule.setPadding();\n    }\n    this.refreshDataManager();\n  };\n  /**\n   * Refresh the entire Grid.\n   *\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   */\n  Render.prototype.refresh = function (e) {\n    var _this = this;\n    if (e === void 0) {\n      e = {\n        requestType: 'refresh'\n      };\n    }\n    var gObj = this.parent;\n    gObj.notify(e.requestType + \"-begin\", e);\n    gObj.trigger(events.actionBegin, e, function (args) {\n      if (args === void 0) {\n        args = {\n          requestType: 'refresh'\n        };\n      }\n      if (args.cancel) {\n        gObj.notify(events.cancelBegin, args);\n        if (args.action === 'clearFilter' && _this.parent.filterSettings.type === 'Menu') {\n          _this.parent.filterSettings.columns[_this.parent.filterModule.filterObjIndex] = _this.parent.filterModule.prevFilterObject;\n          var iconClass = _this.parent.showColumnMenu && _this.parent.filterModule['column'].showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n          var col = _this.parent.element.querySelector('[e-mappinguid=\"' + _this.parent.filterModule['column'].uid + '\"]').parentElement;\n          var flIcon = col.querySelector(iconClass);\n          if (!isNullOrUndefined(_this.parent.filterModule.prevFilterObject)) {\n            flIcon.classList.add('e-filtered');\n          }\n        }\n        if (args.action === 'clear-filter' && (_this.parent.filterSettings.type === 'CheckBox' || _this.parent.filterSettings.type === 'Excel')) {\n          _this.parent.filterSettings.columns = _this.parent.filterModule.checkboxPrevFilterObject;\n        }\n        if (args.requestType === 'grouping') {\n          // Remove the dropped column name from groupsettings.columns if args.cancel is true\n          var index = gObj.groupSettings.columns.indexOf(args.columnName);\n          if (index !== -1) {\n            gObj.setProperties({\n              groupSettings: {\n                Columns: gObj.groupSettings.columns.splice(index, 1)\n              }\n            }, true);\n            gObj.setProperties({\n              sortSettings: {\n                Columns: gObj.sortSettings.columns.splice(index, 1)\n              }\n            }, true);\n            var column = gObj.getColumnByField(args.columnName);\n            var headerCell = gObj.getColumnHeaderByField(column.field);\n            column.visible = !isNullOrUndefined(headerCell) && !headerCell.classList.contains('e-hide');\n          }\n        }\n        return;\n      }\n      _this.parent.notify(events.destroyEditForm, args);\n      if (args.requestType === 'virtualscroll' && (_this.parent.getDataModule().isRemote() || 'result' in _this.parent.dataSource) && args.virtualInfo && args.virtualInfo.direction === 'down') {\n        _this.parent.contentModule.prevInfo = args.virtualInfo;\n      }\n      if (_this.parent.groupModule && args.preventFocusOnGroup) {\n        _this.parent.groupModule.preventFocusOnGroup = args.preventFocusOnGroup;\n      }\n      if (gObj.allowSelection && (args.action === 'clearFilter' || args.action === 'clear-filter' || args.requestType === 'searching' && args.searchString === '' || args.action === 'add')) {\n        gObj.selectionModule['rmtHdrChkbxClicked'] = false;\n        if (gObj.selectionModule.isPartialSelection) {\n          gObj.selectionModule['isHdrSelectAllClicked'] = false;\n        }\n      }\n      if (gObj.allowPaging && gObj.pageSettings.pageSizes && gObj.pagerModule.pagerObj.isAllPage && args.action === 'add' && args.requestType === 'save' && gObj.pagerModule.pagerObj.checkAll) {\n        gObj.setProperties({\n          pageSettings: {\n            pageSize: gObj.pageSettings.pageSize + 1\n          }\n        }, true);\n      }\n      if (args.requestType === 'delete' && gObj.allowPaging) {\n        var dataLength = args.data.length;\n        var count = gObj.pageSettings.totalRecordsCount - dataLength;\n        var currentViewData = gObj.getCurrentViewRecords().length;\n        // eslint-disable-next-line max-len\n        if (!(currentViewData - dataLength) && count && (gObj.pageSettings.currentPage - 1) * gObj.pageSettings.pageSize === count || count && count <= dataLength) {\n          gObj.prevPageMoving = true;\n          gObj.setProperties({\n            pageSettings: {\n              totalRecordsCount: count,\n              currentPage: Math.ceil(count / gObj.pageSettings.pageSize)\n            }\n          }, true);\n          gObj.pagerModule.pagerObj.totalRecordsCount = count;\n        }\n      }\n      if (args.requestType === 'reorder' && _this.parent.dataSource && 'result' in _this.parent.dataSource) {\n        _this.contentRenderer.refreshContentRows(args);\n      } else if ((args.requestType === 'paging' || args.requestType === 'columnstate' || args.requestType === 'reorder') && _this.parent.groupSettings.enableLazyLoading && _this.parent.groupSettings.columns.length && (_this.parent.enableVirtualization ? _this.parent.lazyLoadRender : _this.parent.contentModule).getGroupCache()[_this.parent.pageSettings.currentPage]) {\n        _this.contentRenderer.refreshContentRows(args);\n      } else {\n        _this.refreshDataManager(args);\n      }\n    });\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Render.prototype.resetTemplates = function () {\n    var gObj = this.parent;\n    var gridColumns = gObj.getColumns();\n    if (gObj.detailTemplate) {\n      var detailTemplateID = gObj.element.id + 'detailTemplate';\n      blazorTemplates[\"\" + detailTemplateID] = [];\n      resetBlazorTemplate(detailTemplateID, 'DetailTemplate');\n    }\n    if (gObj.groupSettings.captionTemplate) {\n      resetBlazorTemplate(gObj.element.id + 'captionTemplate', 'CaptionTemplate');\n    }\n    if (gObj.rowTemplate) {\n      resetBlazorTemplate(gObj.element.id + 'rowTemplate', 'RowTemplate');\n    }\n    if (gObj.toolbarTemplate) {\n      resetBlazorTemplate(gObj.element.id + 'toolbarTemplate', 'ToolbarTemplate');\n    }\n    if (gObj.pageSettings.template) {\n      resetBlazorTemplate(gObj.element.id + '_template', 'pageSettings');\n    }\n    for (var i = 0; i < gridColumns.length; i++) {\n      if (gridColumns[parseInt(i.toString(), 10)].template) {\n        blazorTemplates[gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid] = [];\n        resetBlazorTemplate(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid, 'Template');\n      }\n      if (gridColumns[parseInt(i.toString(), 10)].headerTemplate) {\n        resetBlazorTemplate(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid + 'headerTemplate', 'HeaderTemplate');\n      }\n      if (gridColumns[parseInt(i.toString(), 10)].filterTemplate) {\n        resetBlazorTemplate(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid + 'filterTemplate', 'FilterTemplate');\n      }\n    }\n    var guid = 'guid';\n    for (var k = 0; k < gObj.aggregates.length; k++) {\n      for (var j = 0; j < gObj.aggregates[parseInt(k.toString(), 10)].columns.length; j++) {\n        if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].footerTemplate) {\n          var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'footerTemplate';\n          resetBlazorTemplate(tempID, 'FooterTemplate');\n        }\n        if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].groupFooterTemplate) {\n          var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'groupFooterTemplate';\n          resetBlazorTemplate(tempID, 'GroupFooterTemplate');\n        }\n        if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].groupCaptionTemplate) {\n          var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'groupCaptionTemplate';\n          resetBlazorTemplate(tempID, 'GroupCaptionTemplate');\n        }\n      }\n    }\n  };\n  Render.prototype.refreshComplete = function (e) {\n    this.parent.trigger(events.actionComplete, e);\n  };\n  /**\n   * The function is used to refresh the dataManager\n   *\n   * @param {NotifyArgs} args - specifies the args\n   * @returns {void}\n   */\n  Render.prototype.refreshDataManager = function (args) {\n    var _this = this;\n    if (args === void 0) {\n      args = {};\n    }\n    var gObj = this.parent;\n    var maskRow = gObj.loadingIndicator.indicatorType === 'Shimmer' && args.requestType !== 'virtualscroll' && args.requestType !== 'infiniteScroll' || (args.requestType === 'virtualscroll' || args.requestType === 'infiniteScroll') && gObj.enableVirtualMaskRow;\n    if (args.requestType !== 'virtualscroll' && !args.isCaptionCollapse && !maskRow) {\n      this.parent.showSpinner();\n    }\n    if (maskRow) {\n      gObj.showMaskRow(args.requestType === 'virtualscroll' ? args.virtualInfo.sentinelInfo.axis : args.requestType === 'infiniteScroll' ? args.direction : undefined);\n    }\n    this.parent.notify(events.resetInfiniteBlocks, args);\n    this.emptyGrid = false;\n    var dataManager;\n    var isFActon = this.isNeedForeignAction();\n    this.ariaService.setBusy(this.parent.getContent().querySelector('.' + literals.content), true);\n    if (isFActon) {\n      var deffered = new Deferred();\n      dataManager = this.getFData(deffered, args);\n    }\n    if (!dataManager) {\n      if (gObj.allowPaging && !gObj.getDataModule().dataManager.dataSource.offline && gObj.pageSettings && gObj.pageSettings.pageSizes && gObj.pagerModule && gObj.pagerModule.pagerObj && gObj.pagerModule.pagerObj.isAllPage) {\n        gObj.pagerModule.pagerObj.isAllPage = undefined;\n      }\n      dataManager = this.data.getData(args, this.data.generateQuery().requiresCount());\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      dataManager = dataManager.then(function (e) {\n        var query = _this.data.generateQuery().requiresCount();\n        if (_this.emptyGrid) {\n          var def = new Deferred();\n          def.resolve({\n            result: [],\n            count: 0\n          });\n          return def.promise;\n        }\n        return _this.data.getData(args, query);\n      });\n    }\n    var foreignKeyColumns = this.parent.getForeignKeyColumns();\n    var foreignKeyLength = foreignKeyColumns.length;\n    if (this.parent.columnQueryMode === 'ExcludeHidden' && foreignKeyLength) {\n      foreignKeyLength = foreignKeyColumns.filter(function (col) {\n        return col.visible !== false;\n      }).length;\n    }\n    if (foreignKeyLength && (!isFActon || this.parent.searchSettings.key.length)) {\n      var deffered_1 = new Deferred();\n      dataManager = dataManager.then(function (e) {\n        _this.parent.notify(events.getForeignKeyData, {\n          dataManager: dataManager,\n          result: e,\n          promise: deffered_1,\n          action: args\n        });\n        return deffered_1.promise;\n      });\n    }\n    if (this.parent.groupSettings.disablePageWiseAggregates && this.parent.groupSettings.columns.length) {\n      dataManager = dataManager.then(function (e) {\n        return _this.validateGroupRecords(e);\n      });\n    }\n    dataManager.then(function (e) {\n      return _this.dataManagerSuccess(e, args);\n    }).catch(function (e) {\n      return _this.dataManagerFailure(e, args);\n    });\n  };\n  Render.prototype.getFData = function (deferred, args) {\n    this.parent.notify(events.getForeignKeyData, {\n      isComplex: true,\n      promise: deferred,\n      action: args\n    });\n    return deferred.promise;\n  };\n  Render.prototype.isNeedForeignAction = function () {\n    var gObj = this.parent;\n    return !!(gObj.allowFiltering && gObj.filterSettings.columns.length || !isNullOrUndefined(gObj.searchSettings.key) && gObj.searchSettings.key.length) && this.foreignKey(this.parent.getForeignKeyColumns());\n  };\n  Render.prototype.foreignKey = function (columns) {\n    var _this = this;\n    return columns.some(function (col) {\n      var fbool = false;\n      fbool = _this.parent.filterSettings.columns.some(function (value) {\n        return col.uid === value.uid;\n      });\n      return !!(fbool || _this.parent.searchSettings.key.length);\n    });\n  };\n  Render.prototype.sendBulkRequest = function (args) {\n    var _this = this;\n    args.requestType = 'batchsave';\n    var gObj = this.parent;\n    if (gObj.allowPaging && gObj.pageSettings.pageSizes && gObj.pagerModule.pagerObj.isAllPage && gObj.pagerModule.pagerObj.checkAll) {\n      var dataLength = args['changes'].addedRecords.length;\n      if (dataLength) {\n        gObj.setProperties({\n          pageSettings: {\n            pageSize: gObj.pageSettings.pageSize + dataLength\n          }\n        }, true);\n      }\n    }\n    if (gObj.allowPaging && (args.changes.addedRecords.length || args.changes.deletedRecords.length || args.changes.changedRecords.length) && gObj.pageSettings && gObj.pageSettings.pageSizes && gObj.pagerModule && gObj.pagerModule.pagerObj && !gObj.getDataModule().dataManager.dataSource.offline && gObj.pagerModule.pagerObj.isAllPage) {\n      gObj.pagerModule.pagerObj.isAllPage = undefined;\n    }\n    var promise = this.data.saveChanges(args.changes, this.parent.getPrimaryKeyFieldNames()[0], args.original);\n    var query = this.data.generateQuery().requiresCount();\n    if (this.data.dataManager.dataSource.offline) {\n      this.refreshDataManager({\n        requestType: 'batchsave'\n      });\n      return;\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      promise.then(function (e) {\n        _this.data.getData(args, query).then(function (e) {\n          return _this.dmSuccess(e, args);\n        }).catch(function (e) {\n          return _this.dmFailure(e, args);\n        });\n      }).catch(function (e) {\n        return _this.dmFailure(e, args);\n      });\n    }\n  };\n  Render.prototype.dmSuccess = function (e, args) {\n    this.dataManagerSuccess(e, args);\n  };\n  Render.prototype.dmFailure = function (e, args) {\n    this.dataManagerFailure(e, args);\n  };\n  /**\n   * Render empty row to Grid which is used at the time to represent to no records.\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Render.prototype.renderEmptyRow = function () {\n    this.emptyRow(true);\n  };\n  Render.prototype.emptyRow = function (isTrigger) {\n    var gObj = this.parent;\n    var tbody = this.contentRenderer.getTable().querySelector(literals.tbody);\n    if (!isNullOrUndefined(tbody)) {\n      remove(tbody);\n    }\n    tbody = this.parent.createElement(literals.tbody, {\n      attrs: {\n        role: 'rowgroup'\n      }\n    });\n    var spanCount = gObj.allowRowDragAndDrop && isNullOrUndefined(gObj.rowDropSettings.targetID) ? 1 : 0;\n    if (gObj.detailTemplate || gObj.childGrid) {\n      ++spanCount;\n    }\n    var className = gObj.editSettings.showAddNewRow && gObj.editSettings.newRowPosition === 'Bottom' ? 'e-emptyrow e-show-added-row' : 'e-emptyrow';\n    var tr = this.parent.createElement('tr', {\n      className: className,\n      attrs: {\n        role: 'row'\n      }\n    });\n    var td;\n    if (gObj.emptyRecordTemplate) {\n      var emptyRecordTemplateID = gObj.element.id + 'emptyRecordTemplate';\n      td = this.parent.createElement('td', {\n        attrs: {\n          colspan: (gObj.getVisibleColumns().length + spanCount + gObj.groupSettings.columns.length).toString()\n        }\n      });\n      if (gObj.isVue || gObj.parentDetails && gObj.parentDetails.parentInstObj && gObj.parentDetails.parentInstObj.isVue) {\n        td.appendChild(gObj.getEmptyRecordTemplate()(gObj.dataSource, gObj, 'emptyRecordTemplate', emptyRecordTemplateID, undefined, undefined, undefined, this.parent['root'])[1]);\n      } else {\n        td.appendChild(gObj.getEmptyRecordTemplate()(gObj.dataSource, gObj, 'emptyRecordTemplate', emptyRecordTemplateID, undefined, undefined, undefined, this.parent['root'])[0]);\n      }\n      if (gObj.isReact) {\n        this.parent.renderTemplates();\n      }\n    } else {\n      td = this.parent.createElement('td', {\n        innerHTML: this.l10n.getConstant('EmptyRecord'),\n        attrs: {\n          colspan: (gObj.getVisibleColumns().length + spanCount + (!isNullOrUndefined(gObj.groupSettings.columns) ? gObj.groupSettings.columns.length : 0)).toString()\n        }\n      });\n    }\n    if (gObj.isFrozenGrid()) {\n      td.classList.add('e-leftfreeze');\n      td.style.left = 0 + 'px';\n    }\n    if (gObj.frozenRows && gObj.element.querySelector('.e-frozenrow-border')) {\n      this.parent.element.querySelector('.e-frozenrow-border').classList.add('e-frozenrow-empty');\n    }\n    tr.appendChild(td);\n    tbody.appendChild(tr);\n    this.contentRenderer.renderEmpty(tbody);\n    if (isTrigger) {\n      if (!this.parent.isInitialLoad) {\n        this.parent.focusModule.setFirstFocusableTabIndex();\n      }\n      this.parent.trigger(events.dataBound, {});\n      this.parent.notify(events.onEmpty, {\n        rows: [new Row({\n          isDataRow: true,\n          cells: [new Cell({\n            isDataCell: true,\n            visible: true\n          })]\n        })]\n      });\n      if (gObj.editSettings.showAddNewRow) {\n        gObj.addRecord();\n        this.parent.notify(events.showAddNewRowFocus, {});\n      }\n    }\n  };\n  Render.prototype.dynamicColumnChange = function () {\n    if (this.parent.getCurrentViewRecords().length) {\n      this.updateColumnType(this.parent.getCurrentViewRecords()[0]);\n    }\n  };\n  Render.prototype.updateColumnType = function (record) {\n    var columns = this.parent.getColumns();\n    var value;\n    var cFormat = 'customFormat';\n    var equalTo = 'equalTo';\n    var data = record && record.items ? record.items[0] : record;\n    var fmtr = this.locator.getService('valueFormatter');\n    for (var i = 0, len = columns.length; i < len; i++) {\n      value = getObject(columns[parseInt(i.toString(), 10)].field || '', data);\n      if (!isNullOrUndefined(columns[parseInt(i.toString(), 10)][\"\" + cFormat])) {\n        columns[parseInt(i.toString(), 10)].format = columns[parseInt(i.toString(), 10)][\"\" + cFormat];\n      }\n      if (!isNullOrUndefined(columns[parseInt(i.toString(), 10)].validationRules) && !isNullOrUndefined(columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo])) {\n        columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo][0] = this.parent.element.id + columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo][0];\n      }\n      if (columns[parseInt(i.toString(), 10)].isForeignColumn() && columns[parseInt(i.toString(), 10)].columnData) {\n        value = getObject(columns[parseInt(i.toString(), 10)].foreignKeyValue || '', columns[parseInt(i.toString(), 10)].columnData[0]);\n      }\n      if (!isNullOrUndefined(value)) {\n        this.isColTypeDef = true;\n        if (!columns[parseInt(i.toString(), 10)].type) {\n          columns[parseInt(i.toString(), 10)].type = value.getDay ? value.getHours() > 0 || value.getMinutes() > 0 || value.getSeconds() > 0 || value.getMilliseconds() > 0 ? 'datetime' : 'date' : typeof value;\n        }\n      } else {\n        columns[parseInt(i.toString(), 10)].type = columns[parseInt(i.toString(), 10)].type || null;\n      }\n      var valueFormatter = new ValueFormatter();\n      if (columns[parseInt(i.toString(), 10)].format && (columns[parseInt(i.toString(), 10)].format.skeleton || columns[parseInt(i.toString(), 10)].format.format && typeof columns[parseInt(i.toString(), 10)].format.format === 'string')) {\n        columns[parseInt(i.toString(), 10)].setFormatter(valueFormatter.getFormatFunction(extend({}, columns[parseInt(i.toString(), 10)].format)));\n        columns[parseInt(i.toString(), 10)].setParser(valueFormatter.getParserFunction(columns[parseInt(i.toString(), 10)].format));\n      }\n      if (typeof columns[parseInt(i.toString(), 10)].format === 'string') {\n        setFormatter(this.locator, columns[parseInt(i.toString(), 10)]);\n      } else if (!columns[parseInt(i.toString(), 10)].format && columns[parseInt(i.toString(), 10)].type === 'number') {\n        columns[parseInt(i.toString(), 10)].setParser(fmtr.getParserFunction({\n          format: 'n2'\n        }));\n      }\n      if (columns[parseInt(i.toString(), 10)].type === 'dateonly' && !columns[parseInt(i.toString(), 10)].format) {\n        columns[parseInt(i.toString(), 10)].format = 'yMd';\n        setFormatter(this.locator, columns[parseInt(i.toString(), 10)]);\n      }\n    }\n  };\n  /**\n   * @param {ReturnType} e - specifies the return type\n   * @param {NotifyArgs} args - specifies the Notifyargs\n   * @returns {void}\n   * @hidden\n   */\n  // tslint:disable-next-line:max-func-body-length\n  Render.prototype.dataManagerSuccess = function (e, args) {\n    var _this = this;\n    var gObj = this.parent;\n    this.contentRenderer = this.renderer.getRenderer(RenderType.Content);\n    this.headerRenderer = this.renderer.getRenderer(RenderType.Header);\n    e.actionArgs = args;\n    var detailGrid = gObj.childGrid || gObj.detailTemplate ? true : false;\n    var isInfiniteDelete = this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache && !gObj.groupSettings.enableLazyLoading && (args.requestType === 'delete' && !detailGrid || args.requestType === 'save' && this.parent.infiniteScrollModule.requestType === 'add' && !(gObj.sortSettings.columns.length || gObj.filterSettings.columns.length || this.parent.groupSettings.columns.length || gObj.searchSettings.key || detailGrid));\n    // tslint:disable-next-line:max-func-body-length\n    gObj.trigger(events.beforeDataBound, e, function (dataArgs) {\n      if (dataArgs.cancel) {\n        return;\n      }\n      dataArgs.result = isNullOrUndefined(dataArgs.result) ? [] : dataArgs.result;\n      var len = Object.keys(dataArgs.result).length;\n      if (_this.parent.isDestroyed) {\n        return;\n      }\n      if (!gObj.getColumns().length && !len && !(gObj.columns.length && gObj.columns[0] instanceof Column)) {\n        gObj.hideSpinner();\n        return;\n      }\n      if (_this.isInfiniteEnd(args) && !len) {\n        _this.parent.notify(events.infiniteEditHandler, {\n          e: args,\n          result: e.result,\n          count: e.count,\n          agg: e.aggregates\n        });\n        return;\n      }\n      _this.parent.isEdit = false;\n      _this.parent.notify(events.editReset, {});\n      _this.parent.notify(events.tooltipDestroy, {});\n      if (args && !((args.requestType === 'infiniteScroll' || args.requestType === 'delete' || args.action === 'add') && gObj.enableInfiniteScrolling)) {\n        _this.parent.notify(events.commandColumnDestroy, {\n          type: 'refreshCommandColumn'\n        });\n      }\n      _this.contentRenderer.prevCurrentView = !isNullOrUndefined(_this.parent.currentViewData) && _this.parent.currentViewData.slice();\n      gObj.currentViewData = dataArgs.result;\n      gObj.notify(events.refreshInfiniteCurrentViewData, {\n        args: args,\n        data: dataArgs.result\n      });\n      if (dataArgs.count && !gObj.allowPaging && (gObj.enableVirtualization || gObj.enableInfiniteScrolling)) {\n        gObj.totalDataRecordsCount = dataArgs.count;\n      }\n      if (!len && dataArgs.count && gObj.allowPaging && args && args.requestType !== 'delete') {\n        if (_this.parent.groupSettings.enableLazyLoading && (args.requestType === 'grouping' || args.requestType === 'ungrouping')) {\n          _this.parent.notify(events.groupComplete, args);\n        }\n        gObj.prevPageMoving = true;\n        gObj.pageSettings.totalRecordsCount = dataArgs.count;\n        if (args.requestType !== 'paging') {\n          gObj.pageSettings.currentPage = Math.ceil(dataArgs.count / gObj.pageSettings.pageSize);\n        }\n        gObj.dataBind();\n        return;\n      }\n      if ((!gObj.getColumns().length && len || !_this.isLayoutRendered) && !isGroupAdaptive(gObj)) {\n        gObj.removeMaskRow();\n        _this.updatesOnInitialRender(dataArgs);\n      }\n      if (!_this.isColTypeDef && gObj.getCurrentViewRecords()) {\n        if (_this.data.dataManager.dataSource.offline && gObj.dataSource && gObj.dataSource.length) {\n          _this.updateColumnType(gObj.dataSource[0]);\n        } else {\n          _this.updateColumnType(gObj.getCurrentViewRecords()[0]);\n        }\n      }\n      if (!_this.parent.isInitialLoad && _this.parent.groupSettings.disablePageWiseAggregates && !_this.parent.groupSettings.columns.length) {\n        dataArgs.result = _this.parent.dataSource instanceof Array ? _this.parent.dataSource : _this.parent.currentViewData;\n      }\n      if ((_this.parent.isReact || _this.parent.isVue) && !isNullOrUndefined(args) && args.requestType !== 'infiniteScroll' && !args.isFrozen) {\n        clearReactVueTemplates(_this.parent, ['footerTemplate']);\n      }\n      if (_this.parent.isAngular && _this.parent.allowGrouping && _this.parent.groupSettings.captionTemplate && !(!isNullOrUndefined(args) && args.requestType === 'infiniteScroll')) {\n        _this.parent.destroyTemplate(['groupSettings_captionTemplate']);\n      }\n      _this.parent.notify(events.dataReady, extend({\n        count: dataArgs.count,\n        result: dataArgs.result,\n        aggregates: dataArgs.aggregates,\n        loadSummaryOnEmpty: false\n      }, args));\n      if ((gObj.groupSettings.columns.length || args && args.requestType === 'ungrouping') && args && args.requestType !== 'filtering') {\n        _this.headerRenderer.refreshUI();\n      }\n      if (len) {\n        if (isGroupAdaptive(gObj)) {\n          var content = 'content';\n          args.scrollTop = {\n            top: _this.contentRenderer[\"\" + content].scrollTop\n          };\n        }\n        if (!isInfiniteDelete) {\n          if (_this.parent.enableImmutableMode) {\n            _this.contentRenderer.immutableModeRendering(args);\n          } else {\n            _this.contentRenderer.refreshContentRows(args);\n          }\n        } else {\n          _this.parent.notify(events.infiniteEditHandler, {\n            e: args,\n            result: e.result,\n            count: e.count,\n            agg: e.aggregates\n          });\n        }\n      } else {\n        if (args && args.isCaptionCollapse) {\n          return;\n        }\n        if (!gObj.getColumns().length) {\n          gObj.element.innerHTML = '';\n          alert(_this.l10n.getConstant('EmptyDataSourceError')); //ToDO: change this alert as dialog\n          return;\n        }\n        _this.contentRenderer.setRowElements([]);\n        _this.contentRenderer.setRowObjects([]);\n        _this.ariaService.setBusy(_this.parent.getContent().querySelector('.' + literals.content), false);\n        gObj.removeMaskRow();\n        _this.renderEmptyRow();\n        if (gObj.enableColumnVirtualization && !len) {\n          _this.parent.notify(events.contentReady, {\n            rows: gObj.getRowsObject(),\n            args: {}\n          });\n        }\n        if (args) {\n          var action = (args.requestType || '').toLowerCase() + '-complete';\n          _this.parent.notify(action, args);\n          if (args.requestType === 'batchsave') {\n            args.cancel = false;\n            args.rows = [];\n            args.isFrozen = !args.isFrozen;\n            _this.parent.trigger(events.actionComplete, args);\n          }\n        }\n        if (_this.parent.autoFit) {\n          _this.parent.preventAdjustColumns();\n        }\n        _this.parent.hideSpinner();\n      }\n      _this.parent.notify(events.toolbarRefresh, {});\n      _this.setRowCount(_this.parent.getCurrentViewRecords().length);\n      if ('query' in e) {\n        _this.parent.getDataModule().isQueryInvokedFromData = false;\n      }\n    });\n  };\n  /**\n   * @param {object} e - specifies the object\n   * @param {Object[]} e.result - specifies the result\n   * @param {NotifyArgs} args - specifies the args\n   * @returns {void}\n   * @hidden\n   */\n  Render.prototype.dataManagerFailure = function (e, args) {\n    if (!isNullOrUndefined(this.parent.contentModule)) {\n      this.ariaService.setOptions(this.parent.getContent().querySelector('.' + literals.content), {\n        busy: false,\n        invalid: true\n      });\n      this.setRowCount(1);\n    }\n    this.parent.trigger(events.actionFailure, e && e.error ? e : {\n      error: e\n    });\n    this.parent.hideSpinner();\n    this.parent.removeMaskRow();\n    if (args.requestType === 'save' || args.requestType === 'delete' || args.name === 'bulk-save') {\n      return;\n    }\n    this.parent.currentViewData = [];\n    this.renderEmptyRow();\n    if (!this.parent.isInitialLoad) {\n      this.parent.focusModule.setFirstFocusableTabIndex();\n    }\n    this.parent.log('actionfailure', {\n      error: e\n    });\n  };\n  Render.prototype.setRowCount = function (dataRowCount) {\n    this.ariaService.setOptions(this.parent.element, {\n      rowcount: dataRowCount ? dataRowCount.toString() : '1'\n    });\n  };\n  Render.prototype.isInfiniteEnd = function (args) {\n    return this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache && args.requestType === 'delete';\n  };\n  Render.prototype.updatesOnInitialRender = function (e) {\n    this.isLayoutRendered = true;\n    var isEmptyCol = false;\n    if (this.parent.columns.length < 1) {\n      this.buildColumns(e.result[0]);\n      isEmptyCol = true;\n    }\n    prepareColumns(this.parent.columns, null, this.parent);\n    if (isEmptyCol) {\n      this.parent.notify(events.refreshSplitFrozenColumn, {});\n    }\n    this.headerRenderer.renderTable();\n    this.contentRenderer.renderTable();\n    this.parent.isAutoGen = true;\n    this.parent.notify(events.autoCol, {});\n  };\n  Render.prototype.iterateComplexColumns = function (obj, field, split) {\n    var keys = Object.keys(obj);\n    for (var i = 0; i < keys.length; i++) {\n      var childKeys = typeof obj[keys[parseInt(i.toString(), 10)]] === 'object' && obj[keys[parseInt(i.toString(), 10)]] && !(obj[keys[parseInt(i.toString(), 10)]] instanceof Date) ? Object.keys(obj[keys[parseInt(i.toString(), 10)]]) : [];\n      if (childKeys.length) {\n        this.iterateComplexColumns(obj[keys[parseInt(i.toString(), 10)]], field + (keys[parseInt(i.toString(), 10)] + '.'), split);\n      } else {\n        split[this.counter] = field + keys[parseInt(i.toString(), 10)];\n        this.counter++;\n      }\n    }\n  };\n  Render.prototype.buildColumns = function (record) {\n    var cols = [];\n    var complexCols = {};\n    this.iterateComplexColumns(record, '', complexCols);\n    var columns = Object.keys(complexCols).filter(function (e) {\n      return complexCols[\"\" + e] !== 'BlazId';\n    }).map(function (field) {\n      return complexCols[\"\" + field];\n    });\n    for (var i = 0, len = columns.length; i < len; i++) {\n      cols[parseInt(i.toString(), 10)] = {\n        'field': columns[parseInt(i.toString(), 10)]\n      };\n      if (this.parent.enableColumnVirtualization) {\n        cols[parseInt(i.toString(), 10)].width = !isNullOrUndefined(cols[parseInt(i.toString(), 10)].width) ? cols[parseInt(i.toString(), 10)].width : 200;\n      }\n    }\n    this.parent.setProperties({\n      'columns': cols\n    }, true);\n  };\n  Render.prototype.instantiateRenderer = function () {\n    this.renderer.addRenderer(RenderType.Header, new HeaderRender(this.parent, this.locator));\n    this.renderer.addRenderer(RenderType.Content, new ContentRender(this.parent, this.locator));\n    var cellrender = this.locator.getService('cellRendererFactory');\n    cellrender.addCellRenderer(CellType.Header, new HeaderCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.Data, new CellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.StackedHeader, new StackedHeaderCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.Indent, new IndentCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.GroupCaption, new GroupCaptionCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.GroupCaptionEmpty, new GroupCaptionEmptyCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.Expand, new ExpandCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.HeaderIndent, new HeaderIndentCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.StackedHeader, new StackedHeaderCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.DetailHeader, new DetailHeaderIndentCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.RowDragHIcon, new RowDragDropHeaderRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.DetailExpand, new DetailExpandCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.DetailFooterIntent, new IndentCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.RowDragIcon, new RowDragDropRenderer(this.parent, this.locator));\n  };\n  Render.prototype.addEventListener = function () {\n    var _this = this;\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.initialLoad, this.instantiateRenderer, this);\n    this.parent.on('refreshdataSource', this.dataManagerSuccess, this);\n    this.parent.on(events.modelChanged, this.refresh, this);\n    this.parent.on(events.refreshComplete, this.refreshComplete, this);\n    this.parent.on(events.bulkSave, this.sendBulkRequest, this);\n    this.parent.on(events.showEmptyGrid, function () {\n      _this.emptyGrid = true;\n    }, this);\n    this.parent.on(events.autoCol, this.dynamicColumnChange, this);\n  };\n  /**\n   * @param {ReturnType} e - specifies the Return type\n   * @returns {Promise<Object>} returns the object\n   * @hidden\n   */\n  Render.prototype.validateGroupRecords = function (e) {\n    var _this = this;\n    var index = e.result.length - 1;\n    if (index < 0) {\n      return Promise.resolve(e);\n    }\n    var group0 = e.result[0];\n    var groupN = e.result[parseInt(index.toString(), 10)];\n    var predicate = [];\n    var addWhere = function (input) {\n      var groups = [group0, groupN];\n      for (var i = 0; i < groups.length; i++) {\n        predicate.push(new Predicate('field', '==', groups[parseInt(i.toString(), 10)].field).and(_this.getPredicate('key', 'equal', groups[parseInt(i.toString(), 10)].key)));\n      }\n      input.where(Predicate.or(predicate));\n    };\n    var query = new Query();\n    addWhere(query);\n    var curDm = new DataManager(e.result);\n    var curFilter = curDm.executeLocal(query);\n    var newQuery = this.data.generateQuery(true);\n    var rPredicate = [];\n    if (this.data.isRemote()) {\n      var groups = [group0, groupN];\n      for (var i = 0; i < groups.length; i++) {\n        rPredicate.push(this.getPredicate(groups[parseInt(i.toString(), 10)].field, 'equal', groups[parseInt(i.toString(), 10)].key));\n      }\n      newQuery.where(Predicate.or(rPredicate));\n    } else {\n      addWhere(newQuery);\n    }\n    var deferred = new Deferred();\n    this.data.getData({}, newQuery).then(function (r) {\n      _this.updateGroupInfo(curFilter, r.result);\n      deferred.resolve(e);\n    }).catch(function (e) {\n      return deferred.reject(e);\n    });\n    return deferred.promise;\n  };\n  /**\n   * @param {string} key - Defines the key\n   * @param {string} operator - Defines the operator\n   * @param {string | number | Date} value - Defines the value\n   * @returns {Predicate} - Returns the predicate\n   * @hidden */\n  Render.prototype.getPredicate = function (key, operator, value) {\n    if (value instanceof Date) {\n      return getDatePredicate({\n        field: key,\n        operator: operator,\n        value: value\n      });\n    }\n    return new Predicate(key, operator, value);\n  };\n  /**\n   * @param {Object[]} current - Defines the current object\n   * @param {Object[]} untouched - Defines the object needs to merge\n   * @returns {Object[]} - Returns the updated group information\n   * @hidden */\n  Render.prototype.updateGroupInfo = function (current, untouched) {\n    var dm = new DataManager(untouched);\n    var elements = current;\n    for (var i = 0; i < elements.length; i++) {\n      var updatedGroup = dm.executeLocal(new Query().where(new Predicate('field', '==', elements[parseInt(i.toString(), 10)].field).and(this.getPredicate('key', 'equal', elements[parseInt(i.toString(), 10)].key))))[0];\n      if (!isNullOrUndefined(updatedGroup)) {\n        elements[parseInt(i.toString(), 10)].count = updatedGroup.count;\n        var itemGroup = elements[parseInt(i.toString(), 10)].items;\n        var updatedGroupItem = updatedGroup.items;\n        if (itemGroup.GroupGuid) {\n          elements[parseInt(i.toString(), 10)].items = this.updateGroupInfo(elements[parseInt(i.toString(), 10)].items, updatedGroup.items);\n        }\n        var rows = this.parent.aggregates;\n        for (var j = 0; j < rows.length; j++) {\n          var row = rows[parseInt(j.toString(), 10)];\n          for (var k = 0; k < row.columns.length; k++) {\n            var column = row.columns[parseInt(k.toString(), 10)];\n            var types = column.type instanceof Array ? column.type : [column.type];\n            for (var l = 0; l < types.length; l++) {\n              var key = column.field + ' - ' + types[parseInt(l.toString(), 10)].toLowerCase();\n              var data = itemGroup.level ? updatedGroupItem.records : updatedGroup.items;\n              var context = this.parent;\n              if (types[parseInt(l.toString(), 10)] === 'Custom') {\n                var data_1 = itemGroup.level ? updatedGroupItem : updatedGroup;\n                var temp = column.customAggregate;\n                if (typeof temp === 'string') {\n                  temp = getValue(temp, window);\n                }\n                elements[parseInt(i.toString(), 10)].aggregates[\"\" + key] = temp ? temp.call(context, data_1, row.columns[parseInt(k.toString(), 10)]) : '';\n              } else {\n                elements[parseInt(i.toString(), 10)].aggregates[\"\" + key] = DataUtil.aggregates[types[parseInt(l.toString(), 10)].toLowerCase()](data, row.columns[parseInt(k.toString(), 10)].field);\n              }\n            }\n          }\n        }\n      }\n    }\n    return current;\n  };\n  return Render;\n}();\nexport { Render };","map":{"version":3,"names":["remove","resetBlazorTemplate","blazorTemplates","getValue","isNullOrUndefined","extend","DataManager","Query","Deferred","Predicate","DataUtil","ValueFormatter","RenderType","CellType","Data","Column","Row","Cell","events","prepareColumns","setFormatter","isGroupAdaptive","getDatePredicate","getObject","clearReactVueTemplates","ContentRender","HeaderRender","CellRenderer","HeaderCellRenderer","StackedHeaderCellRenderer","IndentCellRenderer","GroupCaptionCellRenderer","GroupCaptionEmptyCellRenderer","ExpandCellRenderer","HeaderIndentCellRenderer","DetailHeaderIndentCellRenderer","DetailExpandCellRenderer","RowDragDropRenderer","RowDragDropHeaderRenderer","literals","Render","parent","locator","emptyGrid","counter","data","l10n","getService","ariaService","renderer","addEventListener","prototype","render","gObj","headerRenderer","getRenderer","Header","contentRenderer","Content","renderPanel","getColumns","length","isLayoutRendered","renderTable","emptyRow","scrollModule","setWidth","setHeight","height","setPadding","refreshDataManager","refresh","e","_this","requestType","notify","trigger","actionBegin","args","cancel","cancelBegin","action","filterSettings","type","columns","filterModule","filterObjIndex","prevFilterObject","iconClass","showColumnMenu","col","element","querySelector","uid","parentElement","flIcon","classList","add","checkboxPrevFilterObject","index","groupSettings","indexOf","columnName","setProperties","Columns","splice","sortSettings","column","getColumnByField","headerCell","getColumnHeaderByField","field","visible","contains","destroyEditForm","getDataModule","isRemote","dataSource","virtualInfo","direction","contentModule","prevInfo","groupModule","preventFocusOnGroup","allowSelection","searchString","selectionModule","isPartialSelection","allowPaging","pageSettings","pageSizes","pagerModule","pagerObj","isAllPage","checkAll","pageSize","dataLength","count","totalRecordsCount","currentViewData","getCurrentViewRecords","currentPage","prevPageMoving","Math","ceil","refreshContentRows","enableLazyLoading","enableVirtualization","lazyLoadRender","getGroupCache","resetTemplates","gridColumns","detailTemplate","detailTemplateID","id","captionTemplate","rowTemplate","toolbarTemplate","template","i","parseInt","toString","headerTemplate","filterTemplate","guid","k","aggregates","j","footerTemplate","tempID","groupFooterTemplate","groupCaptionTemplate","refreshComplete","actionComplete","maskRow","loadingIndicator","indicatorType","enableVirtualMaskRow","isCaptionCollapse","showSpinner","showMaskRow","sentinelInfo","axis","undefined","resetInfiniteBlocks","dataManager","isFActon","isNeedForeignAction","setBusy","getContent","content","deffered","getFData","offline","getData","generateQuery","requiresCount","then","query","def","resolve","result","promise","foreignKeyColumns","getForeignKeyColumns","foreignKeyLength","columnQueryMode","filter","searchSettings","key","deffered_1","getForeignKeyData","disablePageWiseAggregates","validateGroupRecords","dataManagerSuccess","catch","dataManagerFailure","deferred","isComplex","allowFiltering","foreignKey","some","fbool","value","sendBulkRequest","addedRecords","changes","deletedRecords","changedRecords","saveChanges","getPrimaryKeyFieldNames","original","dmSuccess","dmFailure","renderEmptyRow","isTrigger","tbody","getTable","createElement","attrs","role","spanCount","allowRowDragAndDrop","rowDropSettings","targetID","childGrid","className","editSettings","showAddNewRow","newRowPosition","tr","td","emptyRecordTemplate","emptyRecordTemplateID","colspan","getVisibleColumns","isVue","parentDetails","parentInstObj","appendChild","getEmptyRecordTemplate","isReact","renderTemplates","innerHTML","getConstant","isFrozenGrid","style","left","frozenRows","renderEmpty","isInitialLoad","focusModule","setFirstFocusableTabIndex","dataBound","onEmpty","rows","isDataRow","cells","isDataCell","addRecord","showAddNewRowFocus","dynamicColumnChange","updateColumnType","record","cFormat","equalTo","items","fmtr","len","format","validationRules","isForeignColumn","columnData","foreignKeyValue","isColTypeDef","getDay","getHours","getMinutes","getSeconds","getMilliseconds","valueFormatter","skeleton","getFormatFunction","setParser","getParserFunction","actionArgs","detailGrid","isInfiniteDelete","enableInfiniteScrolling","infiniteScrollSettings","enableCache","infiniteScrollModule","beforeDataBound","dataArgs","Object","keys","isDestroyed","hideSpinner","isInfiniteEnd","infiniteEditHandler","agg","isEdit","editReset","tooltipDestroy","commandColumnDestroy","prevCurrentView","slice","refreshInfiniteCurrentViewData","totalDataRecordsCount","groupComplete","dataBind","removeMaskRow","updatesOnInitialRender","Array","isFrozen","isAngular","allowGrouping","destroyTemplate","dataReady","loadSummaryOnEmpty","refreshUI","scrollTop","top","enableImmutableMode","immutableModeRendering","alert","setRowElements","setRowObjects","enableColumnVirtualization","contentReady","getRowsObject","toLowerCase","autoFit","preventAdjustColumns","toolbarRefresh","setRowCount","isQueryInvokedFromData","setOptions","busy","invalid","actionFailure","error","name","log","dataRowCount","rowcount","isEmptyCol","buildColumns","refreshSplitFrozenColumn","isAutoGen","autoCol","iterateComplexColumns","obj","split","childKeys","Date","cols","complexCols","map","width","instantiateRenderer","addRenderer","cellrender","addCellRenderer","StackedHeader","Indent","GroupCaption","GroupCaptionEmpty","Expand","HeaderIndent","DetailHeader","RowDragHIcon","DetailExpand","DetailFooterIntent","RowDragIcon","on","initialLoad","modelChanged","bulkSave","showEmptyGrid","Promise","group0","groupN","predicate","addWhere","input","groups","push","and","getPredicate","where","or","curDm","curFilter","executeLocal","newQuery","rPredicate","r","updateGroupInfo","reject","operator","current","untouched","dm","elements","updatedGroup","itemGroup","updatedGroupItem","GroupGuid","row","types","l","level","records","context","data_1","temp","customAggregate","window","call"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-grids/src/grid/renderer/render.js"],"sourcesContent":["import { remove, resetBlazorTemplate, blazorTemplates, getValue } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { DataManager, Query, Deferred, Predicate, DataUtil } from '@syncfusion/ej2-data';\nimport { ValueFormatter } from '../services/value-formatter';\nimport { RenderType, CellType } from '../base/enum';\nimport { Data } from '../actions/data';\nimport { Column } from '../models/column';\nimport { Row } from '../models/row';\nimport { Cell } from '../models/cell';\nimport * as events from '../base/constant';\nimport { prepareColumns, setFormatter, isGroupAdaptive, getDatePredicate, getObject, clearReactVueTemplates } from '../base/util';\nimport { ContentRender } from '../renderer/content-renderer';\nimport { HeaderRender } from '../renderer/header-renderer';\nimport { CellRenderer } from '../renderer/cell-renderer';\nimport { HeaderCellRenderer } from '../renderer/header-cell-renderer';\nimport { StackedHeaderCellRenderer } from '../renderer/stacked-cell-renderer';\nimport { IndentCellRenderer } from '../renderer/indent-cell-renderer';\nimport { GroupCaptionCellRenderer, GroupCaptionEmptyCellRenderer } from '../renderer/caption-cell-renderer';\nimport { ExpandCellRenderer } from '../renderer/expand-cell-renderer';\nimport { HeaderIndentCellRenderer } from '../renderer/header-indent-renderer';\nimport { DetailHeaderIndentCellRenderer } from '../renderer/detail-header-indent-renderer';\nimport { DetailExpandCellRenderer } from '../renderer/detail-expand-cell-renderer';\nimport { RowDragDropRenderer } from './row-drag-drop-renderer';\nimport { RowDragDropHeaderRenderer } from '../renderer/row-drag-header-indent-render';\nimport * as literals from '../base/string-literals';\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    /**\n     * Constructor for render module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} locator - specifies the serviceLocator\n     */\n    function Render(parent, locator) {\n        this.emptyGrid = false;\n        this.counter = 0;\n        this.parent = parent;\n        this.locator = locator;\n        this.data = new Data(parent, locator);\n        this.l10n = locator.getService('localization');\n        this.ariaService = this.locator.getService('ariaService');\n        this.renderer = this.locator.getService('rendererFactory');\n        this.addEventListener();\n    }\n    /**\n     * To initialize grid header, content and footer rendering\n     *\n     * @returns {void}\n     */\n    Render.prototype.render = function () {\n        var gObj = this.parent;\n        this.headerRenderer = this.renderer.getRenderer(RenderType.Header);\n        this.contentRenderer = this.renderer.getRenderer(RenderType.Content);\n        this.headerRenderer.renderPanel();\n        this.contentRenderer.renderPanel();\n        if (gObj.getColumns().length) {\n            this.isLayoutRendered = true;\n            this.headerRenderer.renderTable();\n            this.contentRenderer.renderTable();\n            this.emptyRow(false);\n        }\n        this.parent.scrollModule.setWidth();\n        this.parent.scrollModule.setHeight();\n        if (this.parent.height !== 'auto') {\n            this.parent.scrollModule.setPadding();\n        }\n        this.refreshDataManager();\n    };\n    /**\n     * Refresh the entire Grid.\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     */\n    Render.prototype.refresh = function (e) {\n        var _this = this;\n        if (e === void 0) { e = { requestType: 'refresh' }; }\n        var gObj = this.parent;\n        gObj.notify(e.requestType + \"-begin\", e);\n        gObj.trigger(events.actionBegin, e, function (args) {\n            if (args === void 0) { args = { requestType: 'refresh' }; }\n            if (args.cancel) {\n                gObj.notify(events.cancelBegin, args);\n                if (args.action === 'clearFilter' && _this.parent.filterSettings.type === 'Menu') {\n                    _this.parent.filterSettings.columns[_this.parent.filterModule.filterObjIndex] = _this.parent.filterModule.prevFilterObject;\n                    var iconClass = _this.parent.showColumnMenu && _this.parent.filterModule['column'].showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n                    var col = _this.parent.element.querySelector('[e-mappinguid=\"' + _this.parent.filterModule['column'].uid + '\"]').parentElement;\n                    var flIcon = col.querySelector(iconClass);\n                    if (!isNullOrUndefined(_this.parent.filterModule.prevFilterObject)) {\n                        flIcon.classList.add('e-filtered');\n                    }\n                }\n                if (args.action === 'clear-filter' && (_this.parent.filterSettings.type === 'CheckBox' || _this.parent.filterSettings.type === 'Excel')) {\n                    _this.parent.filterSettings.columns = _this.parent.filterModule.checkboxPrevFilterObject;\n                }\n                if (args.requestType === 'grouping') {\n                    // Remove the dropped column name from groupsettings.columns if args.cancel is true\n                    var index = gObj.groupSettings.columns.indexOf(args.columnName);\n                    if (index !== -1) {\n                        gObj.setProperties({ groupSettings: { Columns: gObj.groupSettings.columns.splice(index, 1) } }, true);\n                        gObj.setProperties({ sortSettings: { Columns: gObj.sortSettings.columns.splice(index, 1) } }, true);\n                        var column = gObj.getColumnByField(args.columnName);\n                        var headerCell = gObj.getColumnHeaderByField(column.field);\n                        column.visible = (!isNullOrUndefined(headerCell) && !headerCell.classList.contains('e-hide'));\n                    }\n                }\n                return;\n            }\n            _this.parent.notify(events.destroyEditForm, args);\n            if (args.requestType === 'virtualscroll' && (_this.parent.getDataModule().isRemote() || 'result' in _this.parent.dataSource)\n                && args.virtualInfo && args.virtualInfo.direction === 'down') {\n                _this.parent.contentModule.prevInfo = args.virtualInfo;\n            }\n            if (_this.parent.groupModule && args.preventFocusOnGroup) {\n                _this.parent.groupModule.preventFocusOnGroup = args.preventFocusOnGroup;\n            }\n            if (gObj.allowSelection && (args.action === 'clearFilter' || args.action === 'clear-filter' ||\n                (args.requestType === 'searching' && args.searchString === '') || args.action === 'add')) {\n                gObj.selectionModule['rmtHdrChkbxClicked'] = false;\n                if (gObj.selectionModule.isPartialSelection) {\n                    gObj.selectionModule['isHdrSelectAllClicked'] = false;\n                }\n            }\n            if (gObj.allowPaging && gObj.pageSettings.pageSizes && gObj.pagerModule.pagerObj.isAllPage &&\n                (args.action === 'add' && args.requestType === 'save') && gObj.pagerModule.pagerObj.checkAll) {\n                gObj.setProperties({ pageSettings: { pageSize: gObj.pageSettings.pageSize + 1 } }, true);\n            }\n            if (args.requestType === 'delete' && gObj.allowPaging) {\n                var dataLength = args.data.length;\n                var count = gObj.pageSettings.totalRecordsCount - dataLength;\n                var currentViewData = gObj.getCurrentViewRecords().length;\n                // eslint-disable-next-line max-len\n                if ((!(currentViewData - dataLength) && count && ((gObj.pageSettings.currentPage - 1) * gObj.pageSettings.pageSize) === count) || (count && count <= dataLength)) {\n                    gObj.prevPageMoving = true;\n                    gObj.setProperties({\n                        pageSettings: {\n                            totalRecordsCount: count, currentPage: Math.ceil(count / gObj.pageSettings.pageSize)\n                        }\n                    }, true);\n                    gObj.pagerModule.pagerObj.totalRecordsCount = count;\n                }\n            }\n            if (args.requestType === 'reorder' && _this.parent.dataSource && 'result' in _this.parent.dataSource) {\n                _this.contentRenderer.refreshContentRows(args);\n            }\n            else if ((args.requestType === 'paging' || args.requestType === 'columnstate' || args.requestType === 'reorder')\n                && _this.parent.groupSettings.enableLazyLoading && _this.parent.groupSettings.columns.length\n                && (_this.parent.enableVirtualization ? _this.parent.lazyLoadRender :\n                    _this.parent.contentModule).getGroupCache()[_this.parent.pageSettings.currentPage]) {\n                _this.contentRenderer.refreshContentRows(args);\n            }\n            else {\n                _this.refreshDataManager(args);\n            }\n        });\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.resetTemplates = function () {\n        var gObj = this.parent;\n        var gridColumns = gObj.getColumns();\n        if (gObj.detailTemplate) {\n            var detailTemplateID = gObj.element.id + 'detailTemplate';\n            blazorTemplates[\"\" + detailTemplateID] = [];\n            resetBlazorTemplate(detailTemplateID, 'DetailTemplate');\n        }\n        if (gObj.groupSettings.captionTemplate) {\n            resetBlazorTemplate(gObj.element.id + 'captionTemplate', 'CaptionTemplate');\n        }\n        if (gObj.rowTemplate) {\n            resetBlazorTemplate(gObj.element.id + 'rowTemplate', 'RowTemplate');\n        }\n        if (gObj.toolbarTemplate) {\n            resetBlazorTemplate(gObj.element.id + 'toolbarTemplate', 'ToolbarTemplate');\n        }\n        if (gObj.pageSettings.template) {\n            resetBlazorTemplate(gObj.element.id + '_template', 'pageSettings');\n        }\n        for (var i = 0; i < gridColumns.length; i++) {\n            if (gridColumns[parseInt(i.toString(), 10)].template) {\n                blazorTemplates[gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid] = [];\n                resetBlazorTemplate(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid, 'Template');\n            }\n            if (gridColumns[parseInt(i.toString(), 10)].headerTemplate) {\n                resetBlazorTemplate(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid + 'headerTemplate', 'HeaderTemplate');\n            }\n            if (gridColumns[parseInt(i.toString(), 10)].filterTemplate) {\n                resetBlazorTemplate(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid + 'filterTemplate', 'FilterTemplate');\n            }\n        }\n        var guid = 'guid';\n        for (var k = 0; k < gObj.aggregates.length; k++) {\n            for (var j = 0; j < gObj.aggregates[parseInt(k.toString(), 10)].columns.length; j++) {\n                if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].footerTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'footerTemplate';\n                    resetBlazorTemplate(tempID, 'FooterTemplate');\n                }\n                if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].groupFooterTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'groupFooterTemplate';\n                    resetBlazorTemplate(tempID, 'GroupFooterTemplate');\n                }\n                if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].groupCaptionTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'groupCaptionTemplate';\n                    resetBlazorTemplate(tempID, 'GroupCaptionTemplate');\n                }\n            }\n        }\n    };\n    Render.prototype.refreshComplete = function (e) {\n        this.parent.trigger(events.actionComplete, e);\n    };\n    /**\n     * The function is used to refresh the dataManager\n     *\n     * @param {NotifyArgs} args - specifies the args\n     * @returns {void}\n     */\n    Render.prototype.refreshDataManager = function (args) {\n        var _this = this;\n        if (args === void 0) { args = {}; }\n        var gObj = this.parent;\n        var maskRow = (gObj.loadingIndicator.indicatorType === 'Shimmer' && args.requestType !== 'virtualscroll'\n            && args.requestType !== 'infiniteScroll') || ((args.requestType === 'virtualscroll' || args.requestType === 'infiniteScroll')\n            && gObj.enableVirtualMaskRow);\n        if (args.requestType !== 'virtualscroll' && !args.isCaptionCollapse && !maskRow) {\n            this.parent.showSpinner();\n        }\n        if (maskRow) {\n            gObj.showMaskRow(args.requestType === 'virtualscroll' ? args.virtualInfo.sentinelInfo.axis\n                : args.requestType === 'infiniteScroll' ? args.direction : undefined);\n        }\n        this.parent.notify(events.resetInfiniteBlocks, args);\n        this.emptyGrid = false;\n        var dataManager;\n        var isFActon = this.isNeedForeignAction();\n        this.ariaService.setBusy(this.parent.getContent().querySelector('.' + literals.content), true);\n        if (isFActon) {\n            var deffered = new Deferred();\n            dataManager = this.getFData(deffered, args);\n        }\n        if (!dataManager) {\n            if (gObj.allowPaging && !gObj.getDataModule().dataManager.dataSource.offline && gObj.pageSettings\n                && gObj.pageSettings.pageSizes && gObj.pagerModule && gObj.pagerModule.pagerObj && gObj.pagerModule.pagerObj.isAllPage) {\n                gObj.pagerModule.pagerObj.isAllPage = undefined;\n            }\n            dataManager = this.data.getData(args, this.data.generateQuery().requiresCount());\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            dataManager = dataManager.then(function (e) {\n                var query = _this.data.generateQuery().requiresCount();\n                if (_this.emptyGrid) {\n                    var def = new Deferred();\n                    def.resolve({ result: [], count: 0 });\n                    return def.promise;\n                }\n                return _this.data.getData(args, query);\n            });\n        }\n        var foreignKeyColumns = this.parent.getForeignKeyColumns();\n        var foreignKeyLength = foreignKeyColumns.length;\n        if (this.parent.columnQueryMode === 'ExcludeHidden' && foreignKeyLength) {\n            foreignKeyLength = foreignKeyColumns.filter(function (col) { return col.visible !== false; }).length;\n        }\n        if (foreignKeyLength && (!isFActon || this.parent.searchSettings.key.length)) {\n            var deffered_1 = new Deferred();\n            dataManager = dataManager.then(function (e) {\n                _this.parent.notify(events.getForeignKeyData, { dataManager: dataManager, result: e, promise: deffered_1, action: args });\n                return deffered_1.promise;\n            });\n        }\n        if (this.parent.groupSettings.disablePageWiseAggregates && this.parent.groupSettings.columns.length) {\n            dataManager = dataManager.then(function (e) { return _this.validateGroupRecords(e); });\n        }\n        dataManager.then(function (e) { return _this.dataManagerSuccess(e, args); })\n            .catch(function (e) { return _this.dataManagerFailure(e, args); });\n    };\n    Render.prototype.getFData = function (deferred, args) {\n        this.parent.notify(events.getForeignKeyData, { isComplex: true, promise: deferred, action: args });\n        return deferred.promise;\n    };\n    Render.prototype.isNeedForeignAction = function () {\n        var gObj = this.parent;\n        return !!((gObj.allowFiltering && gObj.filterSettings.columns.length) ||\n            (!isNullOrUndefined(gObj.searchSettings.key) && gObj.searchSettings.key.length))\n            && this.foreignKey(this.parent.getForeignKeyColumns());\n    };\n    Render.prototype.foreignKey = function (columns) {\n        var _this = this;\n        return columns.some(function (col) {\n            var fbool = false;\n            fbool = _this.parent.filterSettings.columns.some(function (value) {\n                return col.uid === value.uid;\n            });\n            return !!(fbool || _this.parent.searchSettings.key.length);\n        });\n    };\n    Render.prototype.sendBulkRequest = function (args) {\n        var _this = this;\n        args.requestType = 'batchsave';\n        var gObj = this.parent;\n        if (gObj.allowPaging && gObj.pageSettings.pageSizes && gObj.pagerModule.pagerObj.isAllPage && gObj.pagerModule.pagerObj.checkAll) {\n            var dataLength = args['changes'].addedRecords.length;\n            if (dataLength) {\n                gObj.setProperties({ pageSettings: { pageSize: gObj.pageSettings.pageSize + dataLength } }, true);\n            }\n        }\n        if (gObj.allowPaging && (args.changes.addedRecords.length ||\n            args.changes.deletedRecords.length ||\n            args.changes.changedRecords.length) && gObj.pageSettings\n            && gObj.pageSettings.pageSizes && gObj.pagerModule && gObj.pagerModule.pagerObj\n            && !gObj.getDataModule().dataManager.dataSource.offline && gObj.pagerModule.pagerObj.isAllPage) {\n            gObj.pagerModule.pagerObj.isAllPage = undefined;\n        }\n        var promise = this.data.saveChanges(args.changes, this.parent.getPrimaryKeyFieldNames()[0], args.original);\n        var query = this.data.generateQuery().requiresCount();\n        if (this.data.dataManager.dataSource.offline) {\n            this.refreshDataManager({ requestType: 'batchsave' });\n            return;\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            promise.then(function (e) {\n                _this.data.getData(args, query)\n                    .then(function (e) { return _this.dmSuccess(e, args); })\n                    .catch(function (e) { return _this.dmFailure(e, args); });\n            })\n                .catch(function (e) { return _this.dmFailure(e, args); });\n        }\n    };\n    Render.prototype.dmSuccess = function (e, args) {\n        this.dataManagerSuccess(e, args);\n    };\n    Render.prototype.dmFailure = function (e, args) {\n        this.dataManagerFailure(e, args);\n    };\n    /**\n     * Render empty row to Grid which is used at the time to represent to no records.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.renderEmptyRow = function () {\n        this.emptyRow(true);\n    };\n    Render.prototype.emptyRow = function (isTrigger) {\n        var gObj = this.parent;\n        var tbody = this.contentRenderer.getTable().querySelector(literals.tbody);\n        if (!isNullOrUndefined(tbody)) {\n            remove(tbody);\n        }\n        tbody = this.parent.createElement(literals.tbody, { attrs: { role: 'rowgroup' } });\n        var spanCount = gObj.allowRowDragAndDrop && isNullOrUndefined(gObj.rowDropSettings.targetID) ? 1 : 0;\n        if (gObj.detailTemplate || gObj.childGrid) {\n            ++spanCount;\n        }\n        var className = gObj.editSettings.showAddNewRow && gObj.editSettings.newRowPosition === 'Bottom' ?\n            'e-emptyrow e-show-added-row' : 'e-emptyrow';\n        var tr = this.parent.createElement('tr', { className: className, attrs: { role: 'row' } });\n        var td;\n        if (gObj.emptyRecordTemplate) {\n            var emptyRecordTemplateID = gObj.element.id + 'emptyRecordTemplate';\n            td = this.parent.createElement('td', { attrs: { colspan: (gObj.getVisibleColumns().length +\n                        spanCount + gObj.groupSettings.columns.length).toString() } });\n            if (gObj.isVue || (gObj.parentDetails && gObj.parentDetails.parentInstObj && gObj.parentDetails.parentInstObj.isVue)) {\n                td.appendChild(gObj.getEmptyRecordTemplate()(gObj.dataSource, gObj, 'emptyRecordTemplate', emptyRecordTemplateID, undefined, undefined, undefined, this.parent['root'])[1]);\n            }\n            else {\n                td.appendChild(gObj.getEmptyRecordTemplate()(gObj.dataSource, gObj, 'emptyRecordTemplate', emptyRecordTemplateID, undefined, undefined, undefined, this.parent['root'])[0]);\n            }\n            if (gObj.isReact) {\n                this.parent.renderTemplates();\n            }\n        }\n        else {\n            td = this.parent.createElement('td', {\n                innerHTML: this.l10n.getConstant('EmptyRecord'),\n                attrs: { colspan: (gObj.getVisibleColumns().length + spanCount + (!isNullOrUndefined(gObj.groupSettings.columns) ?\n                        gObj.groupSettings.columns.length : 0)).toString() }\n            });\n        }\n        if (gObj.isFrozenGrid()) {\n            td.classList.add('e-leftfreeze');\n            td.style.left = 0 + 'px';\n        }\n        if (gObj.frozenRows && gObj.element.querySelector('.e-frozenrow-border')) {\n            this.parent.element.querySelector('.e-frozenrow-border').classList.add('e-frozenrow-empty');\n        }\n        tr.appendChild(td);\n        tbody.appendChild(tr);\n        this.contentRenderer.renderEmpty(tbody);\n        if (isTrigger) {\n            if (!this.parent.isInitialLoad) {\n                this.parent.focusModule.setFirstFocusableTabIndex();\n            }\n            this.parent.trigger(events.dataBound, {});\n            this.parent.notify(events.onEmpty, { rows: [new Row({ isDataRow: true, cells: [new Cell({ isDataCell: true, visible: true })] })] });\n            if (gObj.editSettings.showAddNewRow) {\n                gObj.addRecord();\n                this.parent.notify(events.showAddNewRowFocus, {});\n            }\n        }\n    };\n    Render.prototype.dynamicColumnChange = function () {\n        if (this.parent.getCurrentViewRecords().length) {\n            this.updateColumnType(this.parent.getCurrentViewRecords()[0]);\n        }\n    };\n    Render.prototype.updateColumnType = function (record) {\n        var columns = this.parent.getColumns();\n        var value;\n        var cFormat = 'customFormat';\n        var equalTo = 'equalTo';\n        var data = record && record.items ? record.items[0] : record;\n        var fmtr = this.locator.getService('valueFormatter');\n        for (var i = 0, len = columns.length; i < len; i++) {\n            value = getObject(columns[parseInt(i.toString(), 10)].field || '', data);\n            if (!isNullOrUndefined(columns[parseInt(i.toString(), 10)][\"\" + cFormat])) {\n                columns[parseInt(i.toString(), 10)].format = columns[parseInt(i.toString(), 10)][\"\" + cFormat];\n            }\n            if (!isNullOrUndefined(columns[parseInt(i.toString(), 10)].validationRules)\n                && !isNullOrUndefined(columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo])) {\n                columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo][0] = this.parent.element.id + columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo][0];\n            }\n            if (columns[parseInt(i.toString(), 10)].isForeignColumn() && columns[parseInt(i.toString(), 10)].columnData) {\n                value = getObject(columns[parseInt(i.toString(), 10)].foreignKeyValue || '', columns[parseInt(i.toString(), 10)].columnData[0]);\n            }\n            if (!isNullOrUndefined(value)) {\n                this.isColTypeDef = true;\n                if (!columns[parseInt(i.toString(), 10)].type) {\n                    columns[parseInt(i.toString(), 10)].type = value.getDay ? (value.getHours() > 0 || value.getMinutes() > 0 ||\n                        value.getSeconds() > 0 || value.getMilliseconds() > 0 ? 'datetime' : 'date') : typeof (value);\n                }\n            }\n            else {\n                columns[parseInt(i.toString(), 10)].type = columns[parseInt(i.toString(), 10)].type || null;\n            }\n            var valueFormatter = new ValueFormatter();\n            if (columns[parseInt(i.toString(), 10)].format && (columns[parseInt(i.toString(), 10)].format.skeleton\n                || (columns[parseInt(i.toString(), 10)].format.format &&\n                    typeof columns[parseInt(i.toString(), 10)].format.format === 'string'))) {\n                columns[parseInt(i.toString(), 10)].setFormatter(valueFormatter.getFormatFunction(extend({}, columns[parseInt(i.toString(), 10)].format)));\n                columns[parseInt(i.toString(), 10)].setParser(valueFormatter.getParserFunction(columns[parseInt(i.toString(), 10)].format));\n            }\n            if (typeof (columns[parseInt(i.toString(), 10)].format) === 'string') {\n                setFormatter(this.locator, columns[parseInt(i.toString(), 10)]);\n            }\n            else if (!columns[parseInt(i.toString(), 10)].format && columns[parseInt(i.toString(), 10)].type === 'number') {\n                columns[parseInt(i.toString(), 10)].setParser(fmtr.getParserFunction({ format: 'n2' }));\n            }\n            if (columns[parseInt(i.toString(), 10)].type === 'dateonly' && !columns[parseInt(i.toString(), 10)].format) {\n                columns[parseInt(i.toString(), 10)].format = 'yMd';\n                setFormatter(this.locator, columns[parseInt(i.toString(), 10)]);\n            }\n        }\n    };\n    /**\n     * @param {ReturnType} e - specifies the return type\n     * @param {NotifyArgs} args - specifies the Notifyargs\n     * @returns {void}\n     * @hidden\n     */\n    // tslint:disable-next-line:max-func-body-length\n    Render.prototype.dataManagerSuccess = function (e, args) {\n        var _this = this;\n        var gObj = this.parent;\n        this.contentRenderer = this.renderer.getRenderer(RenderType.Content);\n        this.headerRenderer = this.renderer.getRenderer(RenderType.Header);\n        e.actionArgs = args;\n        var detailGrid = gObj.childGrid || gObj.detailTemplate ? true : false;\n        var isInfiniteDelete = this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache &&\n            !gObj.groupSettings.enableLazyLoading && ((args.requestType === 'delete' && !detailGrid) || (args.requestType === 'save' &&\n            this.parent.infiniteScrollModule.requestType === 'add' && !(gObj.sortSettings.columns.length ||\n            gObj.filterSettings.columns.length || this.parent.groupSettings.columns.length || gObj.searchSettings.key || detailGrid)));\n        // tslint:disable-next-line:max-func-body-length\n        gObj.trigger(events.beforeDataBound, e, function (dataArgs) {\n            if (dataArgs.cancel) {\n                return;\n            }\n            dataArgs.result = isNullOrUndefined(dataArgs.result) ? [] : dataArgs.result;\n            var len = Object.keys(dataArgs.result).length;\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n            if ((!gObj.getColumns().length && !len) && !(gObj.columns.length && gObj.columns[0] instanceof Column)) {\n                gObj.hideSpinner();\n                return;\n            }\n            if (_this.isInfiniteEnd(args) && !len) {\n                _this.parent.notify(events.infiniteEditHandler, { e: args, result: e.result, count: e.count, agg: e.aggregates });\n                return;\n            }\n            _this.parent.isEdit = false;\n            _this.parent.notify(events.editReset, {});\n            _this.parent.notify(events.tooltipDestroy, {});\n            if (args && !((args.requestType === 'infiniteScroll' || args.requestType === 'delete' || args.action === 'add') &&\n                gObj.enableInfiniteScrolling)) {\n                _this.parent.notify(events.commandColumnDestroy, { type: 'refreshCommandColumn' });\n            }\n            _this.contentRenderer.prevCurrentView = !isNullOrUndefined(_this.parent.currentViewData) && _this.parent.currentViewData.slice();\n            gObj.currentViewData = dataArgs.result;\n            gObj.notify(events.refreshInfiniteCurrentViewData, { args: args, data: dataArgs.result });\n            if (dataArgs.count && !gObj.allowPaging && (gObj.enableVirtualization || gObj.enableInfiniteScrolling)) {\n                gObj.totalDataRecordsCount = dataArgs.count;\n            }\n            if (!len && dataArgs.count && gObj.allowPaging && args && args.requestType !== 'delete') {\n                if (_this.parent.groupSettings.enableLazyLoading\n                    && (args.requestType === 'grouping' || args.requestType === 'ungrouping')) {\n                    _this.parent.notify(events.groupComplete, args);\n                }\n                gObj.prevPageMoving = true;\n                gObj.pageSettings.totalRecordsCount = dataArgs.count;\n                if (args.requestType !== 'paging') {\n                    gObj.pageSettings.currentPage = Math.ceil(dataArgs.count / gObj.pageSettings.pageSize);\n                }\n                gObj.dataBind();\n                return;\n            }\n            if ((!gObj.getColumns().length && len || !_this.isLayoutRendered) && !isGroupAdaptive(gObj)) {\n                gObj.removeMaskRow();\n                _this.updatesOnInitialRender(dataArgs);\n            }\n            if (!_this.isColTypeDef && gObj.getCurrentViewRecords()) {\n                if (_this.data.dataManager.dataSource.offline && gObj.dataSource && gObj.dataSource.length) {\n                    _this.updateColumnType(gObj.dataSource[0]);\n                }\n                else {\n                    _this.updateColumnType(gObj.getCurrentViewRecords()[0]);\n                }\n            }\n            if (!_this.parent.isInitialLoad && _this.parent.groupSettings.disablePageWiseAggregates &&\n                !_this.parent.groupSettings.columns.length) {\n                dataArgs.result = _this.parent.dataSource instanceof Array ? _this.parent.dataSource : _this.parent.currentViewData;\n            }\n            if ((_this.parent.isReact || _this.parent.isVue) && !isNullOrUndefined(args) && args.requestType !== 'infiniteScroll' && !args.isFrozen) {\n                clearReactVueTemplates(_this.parent, ['footerTemplate']);\n            }\n            if (_this.parent.isAngular && _this.parent.allowGrouping && _this.parent.groupSettings.captionTemplate\n                && !(!isNullOrUndefined(args) && args.requestType === 'infiniteScroll')) {\n                _this.parent.destroyTemplate(['groupSettings_captionTemplate']);\n            }\n            _this.parent.notify(events.dataReady, extend({ count: dataArgs.count, result: dataArgs.result, aggregates: dataArgs.aggregates, loadSummaryOnEmpty: false }, args));\n            if ((gObj.groupSettings.columns.length || (args && args.requestType === 'ungrouping'))\n                && (args && args.requestType !== 'filtering')) {\n                _this.headerRenderer.refreshUI();\n            }\n            if (len) {\n                if (isGroupAdaptive(gObj)) {\n                    var content = 'content';\n                    args.scrollTop = { top: _this.contentRenderer[\"\" + content].scrollTop };\n                }\n                if (!isInfiniteDelete) {\n                    if (_this.parent.enableImmutableMode) {\n                        _this.contentRenderer.immutableModeRendering(args);\n                    }\n                    else {\n                        _this.contentRenderer.refreshContentRows(args);\n                    }\n                }\n                else {\n                    _this.parent.notify(events.infiniteEditHandler, { e: args, result: e.result, count: e.count, agg: e.aggregates });\n                }\n            }\n            else {\n                if (args && args.isCaptionCollapse) {\n                    return;\n                }\n                if (!gObj.getColumns().length) {\n                    gObj.element.innerHTML = '';\n                    alert(_this.l10n.getConstant('EmptyDataSourceError')); //ToDO: change this alert as dialog\n                    return;\n                }\n                _this.contentRenderer.setRowElements([]);\n                _this.contentRenderer.setRowObjects([]);\n                _this.ariaService.setBusy(_this.parent.getContent().querySelector('.' + literals.content), false);\n                gObj.removeMaskRow();\n                _this.renderEmptyRow();\n                if (gObj.enableColumnVirtualization && !len) {\n                    _this.parent.notify(events.contentReady, { rows: gObj.getRowsObject(), args: {} });\n                }\n                if (args) {\n                    var action = (args.requestType || '').toLowerCase() + '-complete';\n                    _this.parent.notify(action, args);\n                    if (args.requestType === 'batchsave') {\n                        args.cancel = false;\n                        args.rows = [];\n                        args.isFrozen = !args.isFrozen;\n                        _this.parent.trigger(events.actionComplete, args);\n                    }\n                }\n                if (_this.parent.autoFit) {\n                    _this.parent.preventAdjustColumns();\n                }\n                _this.parent.hideSpinner();\n            }\n            _this.parent.notify(events.toolbarRefresh, {});\n            _this.setRowCount(_this.parent.getCurrentViewRecords().length);\n            if ('query' in e) {\n                _this.parent.getDataModule().isQueryInvokedFromData = false;\n            }\n        });\n    };\n    /**\n     * @param {object} e - specifies the object\n     * @param {Object[]} e.result - specifies the result\n     * @param {NotifyArgs} args - specifies the args\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.dataManagerFailure = function (e, args) {\n        if (!isNullOrUndefined(this.parent.contentModule)) {\n            this.ariaService.setOptions(this.parent.getContent().querySelector('.' + literals.content), { busy: false, invalid: true });\n            this.setRowCount(1);\n        }\n        this.parent.trigger(events.actionFailure, e && e.error ? e : { error: e });\n        this.parent.hideSpinner();\n        this.parent.removeMaskRow();\n        if (args.requestType === 'save' || args.requestType === 'delete'\n            || args.name === 'bulk-save') {\n            return;\n        }\n        this.parent.currentViewData = [];\n        this.renderEmptyRow();\n        if (!this.parent.isInitialLoad) {\n            this.parent.focusModule.setFirstFocusableTabIndex();\n        }\n        this.parent.log('actionfailure', { error: e });\n    };\n    Render.prototype.setRowCount = function (dataRowCount) {\n        this.ariaService.setOptions(this.parent.element, {\n            rowcount: dataRowCount ? dataRowCount.toString() : '1'\n        });\n    };\n    Render.prototype.isInfiniteEnd = function (args) {\n        return this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache && args.requestType === 'delete';\n    };\n    Render.prototype.updatesOnInitialRender = function (e) {\n        this.isLayoutRendered = true;\n        var isEmptyCol = false;\n        if (this.parent.columns.length < 1) {\n            this.buildColumns(e.result[0]);\n            isEmptyCol = true;\n        }\n        prepareColumns(this.parent.columns, null, this.parent);\n        if (isEmptyCol) {\n            this.parent.notify(events.refreshSplitFrozenColumn, {});\n        }\n        this.headerRenderer.renderTable();\n        this.contentRenderer.renderTable();\n        this.parent.isAutoGen = true;\n        this.parent.notify(events.autoCol, {});\n    };\n    Render.prototype.iterateComplexColumns = function (obj, field, split) {\n        var keys = Object.keys(obj);\n        for (var i = 0; i < keys.length; i++) {\n            var childKeys = typeof obj[keys[parseInt(i.toString(), 10)]] === 'object'\n                && obj[keys[parseInt(i.toString(), 10)]] && !(obj[keys[parseInt(i.toString(), 10)]] instanceof Date) ?\n                Object.keys(obj[keys[parseInt(i.toString(), 10)]]) : [];\n            if (childKeys.length) {\n                this.iterateComplexColumns(obj[keys[parseInt(i.toString(), 10)]], field + (keys[parseInt(i.toString(), 10)] + '.'), split);\n            }\n            else {\n                split[this.counter] = field + keys[parseInt(i.toString(), 10)];\n                this.counter++;\n            }\n        }\n    };\n    Render.prototype.buildColumns = function (record) {\n        var cols = [];\n        var complexCols = {};\n        this.iterateComplexColumns(record, '', complexCols);\n        var columns = Object.keys(complexCols).filter(function (e) { return complexCols[\"\" + e] !== 'BlazId'; }).\n            map(function (field) { return complexCols[\"\" + field]; });\n        for (var i = 0, len = columns.length; i < len; i++) {\n            cols[parseInt(i.toString(), 10)] = { 'field': columns[parseInt(i.toString(), 10)] };\n            if (this.parent.enableColumnVirtualization) {\n                cols[parseInt(i.toString(), 10)].width = !isNullOrUndefined(cols[parseInt(i.toString(), 10)].width) ?\n                    cols[parseInt(i.toString(), 10)].width : 200;\n            }\n        }\n        this.parent.setProperties({ 'columns': cols }, true);\n    };\n    Render.prototype.instantiateRenderer = function () {\n        this.renderer.addRenderer(RenderType.Header, new HeaderRender(this.parent, this.locator));\n        this.renderer.addRenderer(RenderType.Content, new ContentRender(this.parent, this.locator));\n        var cellrender = this.locator.getService('cellRendererFactory');\n        cellrender.addCellRenderer(CellType.Header, new HeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.Data, new CellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.StackedHeader, new StackedHeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.Indent, new IndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.GroupCaption, new GroupCaptionCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.GroupCaptionEmpty, new GroupCaptionEmptyCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.Expand, new ExpandCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.HeaderIndent, new HeaderIndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.StackedHeader, new StackedHeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.DetailHeader, new DetailHeaderIndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.RowDragHIcon, new RowDragDropHeaderRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.DetailExpand, new DetailExpandCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.DetailFooterIntent, new IndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.RowDragIcon, new RowDragDropRenderer(this.parent, this.locator));\n    };\n    Render.prototype.addEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.initialLoad, this.instantiateRenderer, this);\n        this.parent.on('refreshdataSource', this.dataManagerSuccess, this);\n        this.parent.on(events.modelChanged, this.refresh, this);\n        this.parent.on(events.refreshComplete, this.refreshComplete, this);\n        this.parent.on(events.bulkSave, this.sendBulkRequest, this);\n        this.parent.on(events.showEmptyGrid, function () { _this.emptyGrid = true; }, this);\n        this.parent.on(events.autoCol, this.dynamicColumnChange, this);\n    };\n    /**\n     * @param {ReturnType} e - specifies the Return type\n     * @returns {Promise<Object>} returns the object\n     * @hidden\n     */\n    Render.prototype.validateGroupRecords = function (e) {\n        var _this = this;\n        var index = e.result.length - 1;\n        if (index < 0) {\n            return Promise.resolve(e);\n        }\n        var group0 = e.result[0];\n        var groupN = e.result[parseInt(index.toString(), 10)];\n        var predicate = [];\n        var addWhere = function (input) {\n            var groups = [group0, groupN];\n            for (var i = 0; i < groups.length; i++) {\n                predicate.push(new Predicate('field', '==', groups[parseInt(i.toString(), 10)].field).and(_this.getPredicate('key', 'equal', groups[parseInt(i.toString(), 10)].key)));\n            }\n            input.where(Predicate.or(predicate));\n        };\n        var query = new Query();\n        addWhere(query);\n        var curDm = new DataManager(e.result);\n        var curFilter = curDm.executeLocal(query);\n        var newQuery = this.data.generateQuery(true);\n        var rPredicate = [];\n        if (this.data.isRemote()) {\n            var groups = [group0, groupN];\n            for (var i = 0; i < groups.length; i++) {\n                rPredicate.push(this.getPredicate(groups[parseInt(i.toString(), 10)].field, 'equal', groups[parseInt(i.toString(), 10)].key));\n            }\n            newQuery.where(Predicate.or(rPredicate));\n        }\n        else {\n            addWhere(newQuery);\n        }\n        var deferred = new Deferred();\n        this.data.getData({}, newQuery).then(function (r) {\n            _this.updateGroupInfo(curFilter, r.result);\n            deferred.resolve(e);\n        }).catch(function (e) { return deferred.reject(e); });\n        return deferred.promise;\n    };\n    /**\n     * @param {string} key - Defines the key\n     * @param {string} operator - Defines the operator\n     * @param {string | number | Date} value - Defines the value\n     * @returns {Predicate} - Returns the predicate\n     * @hidden */\n    Render.prototype.getPredicate = function (key, operator, value) {\n        if (value instanceof Date) {\n            return getDatePredicate({ field: key, operator: operator, value: value });\n        }\n        return new Predicate(key, operator, value);\n    };\n    /**\n     * @param {Object[]} current - Defines the current object\n     * @param {Object[]} untouched - Defines the object needs to merge\n     * @returns {Object[]} - Returns the updated group information\n     * @hidden */\n    Render.prototype.updateGroupInfo = function (current, untouched) {\n        var dm = new DataManager(untouched);\n        var elements = current;\n        for (var i = 0; i < elements.length; i++) {\n            var updatedGroup = dm.executeLocal(new Query()\n                .where(new Predicate('field', '==', elements[parseInt(i.toString(), 10)].field).and(this.getPredicate('key', 'equal', elements[parseInt(i.toString(), 10)].key))))[0];\n            if (!isNullOrUndefined(updatedGroup)) {\n                elements[parseInt(i.toString(), 10)].count = updatedGroup.count;\n                var itemGroup = elements[parseInt(i.toString(), 10)].items;\n                var updatedGroupItem = updatedGroup.items;\n                if (itemGroup.GroupGuid) {\n                    elements[parseInt(i.toString(), 10)].items =\n                        this.updateGroupInfo(elements[parseInt(i.toString(), 10)].items, updatedGroup.items);\n                }\n                var rows = this.parent.aggregates;\n                for (var j = 0; j < rows.length; j++) {\n                    var row = rows[parseInt(j.toString(), 10)];\n                    for (var k = 0; k < row.columns.length; k++) {\n                        var column = row.columns[parseInt(k.toString(), 10)];\n                        var types = column.type instanceof Array ? (column.type) : [(column.type)];\n                        for (var l = 0; l < types.length; l++) {\n                            var key = column.field + ' - ' + types[parseInt(l.toString(), 10)].toLowerCase();\n                            var data = itemGroup.level ? updatedGroupItem.records : updatedGroup.items;\n                            var context = this.parent;\n                            if (types[parseInt(l.toString(), 10)] === 'Custom') {\n                                var data_1 = itemGroup.level ? updatedGroupItem : updatedGroup;\n                                var temp = column\n                                    .customAggregate;\n                                if (typeof temp === 'string') {\n                                    temp = getValue(temp, window);\n                                }\n                                elements[parseInt(i.toString(), 10)].aggregates[\"\" + key] = temp ? temp.call(context, data_1, row.columns[parseInt(k.toString(), 10)]) : '';\n                            }\n                            else {\n                                elements[parseInt(i.toString(), 10)].aggregates[\"\" + key] = DataUtil.aggregates[types[parseInt(l.toString(), 10)].toLowerCase()](data, row.columns[parseInt(k.toString(), 10)].field);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return current;\n    };\n    return Render;\n}());\nexport { Render };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}