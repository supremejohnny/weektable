{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n/* eslint-disable valid-jsdoc */\n/* eslint-disable security/detect-object-injection */\nimport { Fetch } from '@syncfusion/ej2-base';\nimport { extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DataUtil } from './util';\nimport { Predicate, Query } from './query';\nimport { ODataAdaptor, JsonAdaptor, CacheAdaptor, RemoteSaveAdaptor, CustomDataAdaptor } from './adaptors';\n/**\n * DataManager is used to manage and manipulate relational data.\n */\nvar DataManager = /** @class */function () {\n  /**\n   * Constructor for DataManager class\n   *\n   * @param {DataOptions|JSON[]} dataSource?\n   * @param {Query} query?\n   * @param {AdaptorOptions|string} adaptor?\n   * @param dataSource\n   * @param query\n   * @param adaptor\n   * @hidden\n   */\n  function DataManager(dataSource, query, adaptor) {\n    var _this = this;\n    /** @hidden */\n    this.dateParse = true;\n    /** @hidden */\n    this.timeZoneHandling = true;\n    this.persistQuery = {};\n    this.isInitialLoad = false;\n    this.requests = [];\n    this.isEnableCache = false;\n    this.isInitialLoad = true;\n    this.isEnableCache = false;\n    if (!dataSource && !this.dataSource) {\n      dataSource = [];\n    }\n    adaptor = adaptor || dataSource.adaptor;\n    if (dataSource && dataSource.timeZoneHandling === false) {\n      this.timeZoneHandling = dataSource.timeZoneHandling;\n    }\n    var data;\n    if (dataSource instanceof Array) {\n      data = {\n        json: dataSource,\n        offline: true\n      };\n    } else if (typeof dataSource === 'object') {\n      if (!dataSource.json) {\n        dataSource.json = [];\n      }\n      if (!dataSource.enablePersistence) {\n        dataSource.enablePersistence = false;\n      }\n      if (!dataSource.id) {\n        dataSource.id = '';\n      }\n      if (!dataSource.ignoreOnPersist) {\n        dataSource.ignoreOnPersist = [];\n      }\n      data = {\n        url: dataSource.url,\n        insertUrl: dataSource.insertUrl,\n        removeUrl: dataSource.removeUrl,\n        updateUrl: dataSource.updateUrl,\n        crudUrl: dataSource.crudUrl,\n        batchUrl: dataSource.batchUrl,\n        json: dataSource.json,\n        headers: dataSource.headers,\n        accept: dataSource.accept,\n        data: dataSource.data,\n        enableCache: dataSource.enableCache,\n        timeTillExpiration: dataSource.timeTillExpiration,\n        cachingPageSize: dataSource.cachingPageSize,\n        enableCaching: dataSource.enableCaching,\n        requestType: dataSource.requestType,\n        key: dataSource.key,\n        crossDomain: dataSource.crossDomain,\n        jsonp: dataSource.jsonp,\n        dataType: dataSource.dataType,\n        offline: dataSource.offline !== undefined ? dataSource.offline : dataSource.adaptor instanceof RemoteSaveAdaptor || dataSource.adaptor instanceof CustomDataAdaptor ? false : dataSource.url ? false : true,\n        requiresFormat: dataSource.requiresFormat,\n        enablePersistence: dataSource.enablePersistence,\n        id: dataSource.id,\n        ignoreOnPersist: dataSource.ignoreOnPersist\n      };\n    } else {\n      DataUtil.throwError('DataManager: Invalid arguments');\n    }\n    if (data.requiresFormat === undefined && !DataUtil.isCors()) {\n      data.requiresFormat = isNullOrUndefined(data.crossDomain) ? true : data.crossDomain;\n    }\n    if (data.dataType === undefined) {\n      data.dataType = 'json';\n    }\n    this.isEnableCache = data.enableCache;\n    this.dataSource = data;\n    this.defaultQuery = query;\n    if (this.dataSource.enablePersistence && this.dataSource.id) {\n      window.addEventListener('unload', this.setPersistData.bind(this));\n    }\n    if (data.url && data.offline && !data.json.length) {\n      this.isDataAvailable = false;\n      this.adaptor = adaptor || new ODataAdaptor();\n      this.dataSource.offline = false;\n      this.ready = this.executeQuery(query || new Query());\n      this.ready.then(function (e) {\n        _this.dataSource.offline = true;\n        _this.isDataAvailable = true;\n        data.json = e.result;\n        _this.adaptor = new JsonAdaptor();\n      });\n    } else {\n      this.adaptor = data.offline ? new JsonAdaptor() : new ODataAdaptor();\n    }\n    if (!data.jsonp && this.adaptor instanceof ODataAdaptor) {\n      data.jsonp = 'callback';\n    }\n    this.adaptor = adaptor || this.adaptor;\n    if (this.isEnableCache) {\n      this.guidId = DataUtil.getGuid('cacheAdaptor');\n      var obj = {\n        keys: [],\n        results: []\n      };\n      window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n    }\n    if (data.enableCaching) {\n      this.adaptor = new CacheAdaptor(this.adaptor, data.timeTillExpiration, data.cachingPageSize);\n    }\n    return this;\n  }\n  Object.defineProperty(DataManager.prototype, \"moduleName\", {\n    /** @hidden */\n    get: function () {\n      return 'datamanager';\n    },\n    enumerable: true,\n    configurable: true\n  });\n  ;\n  /**\n   * Get the queries maintained in the persisted state.\n   * @param {string} id - The identifier of the persisted query to retrieve.\n   * @returns {object} The persisted data object.\n   */\n  DataManager.prototype.getPersistedData = function (id) {\n    var persistedData = localStorage.getItem(id || this.dataSource.id);\n    return JSON.parse(persistedData);\n  };\n  /**\n  * Set the queries to be maintained in the persisted state.\n  * @param {Event} e - The event parameter that triggers the setPersistData method.\n  * @param {string} id - The identifier of the persisted query to set.\n  * @param {object} persistData - The data to be persisted.\n  * @returns {void} .\n  */\n  DataManager.prototype.setPersistData = function (e, id, persistData) {\n    localStorage.setItem(id || this.dataSource.id, JSON.stringify(persistData || this.persistQuery));\n  };\n  DataManager.prototype.setPersistQuery = function (query) {\n    var _this = this;\n    var persistedQuery = this.getPersistedData();\n    if (this.isInitialLoad && persistedQuery && Object.keys(persistedQuery).length) {\n      this.persistQuery = persistedQuery;\n      this.persistQuery.queries = this.persistQuery.queries.filter(function (query) {\n        if (_this.dataSource.ignoreOnPersist && _this.dataSource.ignoreOnPersist.length) {\n          if (query.fn && _this.dataSource.ignoreOnPersist.some(function (keyword) {\n            return query.fn === keyword;\n          })) {\n            return false; // Exclude the matching query\n          }\n        }\n        if (query.fn === 'onWhere') {\n          var e = query.e;\n          if (e && e.isComplex && e.predicates instanceof Array) {\n            var allPredicates = e.predicates.map(function (predicateObj) {\n              if (predicateObj.predicates && predicateObj.predicates instanceof Array) {\n                // Process nested predicate array\n                var nestedPredicates = predicateObj.predicates.map(function (nestedPredicate) {\n                  var field = nestedPredicate.field,\n                    operator = nestedPredicate.operator,\n                    value = nestedPredicate.value,\n                    ignoreCase = nestedPredicate.ignoreCase,\n                    ignoreAccent = nestedPredicate.ignoreAccent,\n                    matchCase = nestedPredicate.matchCase;\n                  return new Predicate(field, operator, value, ignoreCase, ignoreAccent, matchCase);\n                });\n                return predicateObj.condition === 'and' ? Predicate.and(nestedPredicates) : Predicate.or(nestedPredicates);\n              } else {\n                // Process individual predicate\n                var field = predicateObj.field,\n                  operator = predicateObj.operator,\n                  value = predicateObj.value,\n                  ignoreCase = predicateObj.ignoreCase,\n                  ignoreAccent = predicateObj.ignoreAccent,\n                  matchCase = predicateObj.matchCase;\n                return new Predicate(field, operator, value, ignoreCase, ignoreAccent, matchCase);\n              }\n            });\n            query.e = new Predicate(allPredicates[0], e.condition, allPredicates.slice(1));\n          }\n        }\n        return true; // Keep all other queries\n      });\n      var newQuery = extend(new Query(), this.persistQuery);\n      this.isInitialLoad = false;\n      return newQuery;\n    } else {\n      this.persistQuery = query;\n      this.isInitialLoad = false;\n      return query;\n    }\n  };\n  /**\n   * Overrides DataManager's default query with given query.\n   *\n   * @param  {Query} query - Defines the new default query.\n   */\n  DataManager.prototype.setDefaultQuery = function (query) {\n    this.defaultQuery = query;\n    return this;\n  };\n  /**\n   * Executes the given query with local data source.\n   *\n   * @param  {Query} query - Defines the query to retrieve data.\n   */\n  DataManager.prototype.executeLocal = function (query) {\n    if (!this.defaultQuery && !(query instanceof Query)) {\n      DataUtil.throwError('DataManager - executeLocal() : A query is required to execute');\n    }\n    if (!this.dataSource.json) {\n      DataUtil.throwError('DataManager - executeLocal() : Json data is required to execute');\n    }\n    if (this.dataSource.enablePersistence && this.dataSource.id) {\n      query = this.setPersistQuery(query);\n    }\n    query = query || this.defaultQuery;\n    var result = this.adaptor.processQuery(this, query);\n    if (query.subQuery) {\n      var from = query.subQuery.fromTable;\n      var lookup = query.subQuery.lookups;\n      var res = query.isCountRequired ? result.result : result;\n      if (lookup && lookup instanceof Array) {\n        DataUtil.buildHierarchy(query.subQuery.fKey, from, res, lookup, query.subQuery.key);\n      }\n      for (var j = 0; j < res.length; j++) {\n        if (res[j][from] instanceof Array) {\n          res[j] = extend({}, {}, res[j]);\n          res[j][from] = this.adaptor.processResponse(query.subQuery.using(new DataManager(res[j][from].slice(0))).executeLocal(), this, query);\n        }\n      }\n    }\n    return this.adaptor.processResponse(result, this, query);\n  };\n  /**\n   * Executes the given query with either local or remote data source.\n   * It will be executed as asynchronously and returns Promise object which will be resolved or rejected after action completed.\n   *\n   * @param  {Query|Function} query - Defines the query to retrieve data.\n   * @param  {Function} done - Defines the callback function and triggers when the Promise is resolved.\n   * @param  {Function} fail - Defines the callback function and triggers when the Promise is rejected.\n   * @param  {Function} always - Defines the callback function and triggers when the Promise is resolved or rejected.\n   */\n  DataManager.prototype.executeQuery = function (query, done, fail, always) {\n    var _this = this;\n    var makeRequest = 'makeRequest';\n    if (this.dataSource.enablePersistence && this.dataSource.id) {\n      query = this.setPersistQuery(query);\n    }\n    if (typeof query === 'function') {\n      always = fail;\n      fail = done;\n      done = query;\n      query = null;\n    }\n    if (!query) {\n      query = this.defaultQuery;\n    }\n    if (!(query instanceof Query)) {\n      DataUtil.throwError('DataManager - executeQuery() : A query is required to execute');\n    }\n    var deffered = new Deferred();\n    var args = {\n      query: query\n    };\n    if (!this.dataSource.offline && this.dataSource.url !== undefined && this.dataSource.url !== '' || !isNullOrUndefined(this.adaptor[makeRequest]) || this.isCustomDataAdaptor(this.adaptor)) {\n      var result = this.isEnableCache ? this.processQuery(query) : this.adaptor.processQuery(this, query);\n      if (!isNullOrUndefined(this.adaptor[makeRequest])) {\n        this.adaptor[makeRequest](result, deffered, args, query);\n      } else if (!isNullOrUndefined(result.url) || this.isCustomDataAdaptor(this.adaptor)) {\n        this.requests = [];\n        this.makeRequest(result, deffered, args, query);\n      } else {\n        args = DataManager.getDeferedArgs(query, result, args);\n        deffered.resolve(args);\n      }\n    } else {\n      DataManager.nextTick(function () {\n        var res = _this.executeLocal(query);\n        args = DataManager.getDeferedArgs(query, res, args);\n        deffered.resolve(args);\n      });\n    }\n    if (done || fail) {\n      deffered.promise.then(done, fail);\n    }\n    if (always) {\n      deffered.promise.then(always, always);\n    }\n    return deffered.promise;\n  };\n  DataManager.prototype.getQueryRequest = function (query) {\n    var req = {\n      sorts: [],\n      groups: [],\n      filters: [],\n      searches: [],\n      aggregates: []\n    };\n    req.sorts = Query.filterQueries(query.queries, 'onSortBy');\n    req.groups = Query.filterQueries(query.queries, 'onGroup');\n    req.filters = Query.filterQueries(query.queries, 'onWhere');\n    req.searches = Query.filterQueries(query.queries, 'onSearch');\n    req.aggregates = Query.filterQueries(query.queries, 'onAggregates');\n    return req;\n  };\n  DataManager.prototype.generateKey = function (url, query) {\n    var queries = this.getQueryRequest(query);\n    var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n    var key = url;\n    var page = 'onPage';\n    queries.sorts.forEach(function (obj) {\n      key += obj.e.direction + obj.e.fieldName;\n    });\n    queries.groups.forEach(function (obj) {\n      key += obj.e.fieldName;\n    });\n    queries.searches.forEach(function (obj) {\n      key += obj.e.searchKey;\n    });\n    for (var filter = 0; filter < queries.filters.length; filter++) {\n      var currentFilter = queries.filters[filter];\n      if (currentFilter.e.isComplex) {\n        var newQuery = query.clone();\n        newQuery.queries = [];\n        for (var i = 0; i < currentFilter.e.predicates.length; i++) {\n          newQuery.queries.push({\n            fn: 'onWhere',\n            e: currentFilter.e.predicates[i],\n            filter: query.queries.filter\n          });\n        }\n        key += currentFilter.e.condition + this.generateKey(url, newQuery);\n      } else {\n        key += currentFilter.e.field + currentFilter.e.operator + currentFilter.e.value;\n      }\n    }\n    if (!isNullOrUndefined(this.previousCacheQuery) && this.previousCacheQuery !== key) {\n      var obj = {\n        keys: [],\n        results: []\n      };\n      window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n    }\n    this.previousCacheQuery = key;\n    if (page in singles) {\n      key += singles[page].pageIndex;\n    }\n    return key;\n  };\n  DataManager.prototype.processQuery = function (query) {\n    var key = this.generateKey(this.dataSource.url, query);\n    var cachedItems = JSON.parse(window.localStorage.getItem(this.guidId));\n    var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(key)] : null;\n    if (data != null) {\n      return DataUtil.parse.parseJson(data);\n    }\n    return this.adaptor.processQuery(this, query);\n  };\n  DataManager.getDeferedArgs = function (query, result, args) {\n    if (query.isCountRequired) {\n      args.result = result.result;\n      args.count = result.count;\n      args.aggregates = result.aggregates;\n    } else {\n      args.result = result;\n    }\n    return args;\n  };\n  DataManager.nextTick = function (fn) {\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    // tslint:disable-next-line:no-any\n    (window.setImmediate || window.setTimeout)(fn, 0);\n    /* eslint-enable @typescript-eslint/no-explicit-any */\n  };\n  DataManager.prototype.extendRequest = function (url, fnSuccess, fnFail) {\n    return extend({}, {\n      type: 'GET',\n      dataType: this.dataSource.dataType,\n      crossDomain: this.dataSource.crossDomain,\n      jsonp: this.dataSource.jsonp,\n      cache: true,\n      processData: false,\n      onSuccess: fnSuccess,\n      onFailure: fnFail\n    }, url);\n  };\n  // tslint:disable-next-line:max-func-body-length\n  DataManager.prototype.makeRequest = function (url, deffered, args, query) {\n    var _this = this;\n    var isSelector = !!query.subQuerySelector;\n    var fnFail = function (e) {\n      args.error = e;\n      deffered.reject(args);\n    };\n    var process = function (data, count, xhr, request, actual, aggregates, virtualSelectRecords) {\n      args.xhr = xhr;\n      args.count = count ? parseInt(count.toString(), 10) : 0;\n      args.result = data;\n      args.request = request;\n      args.aggregates = aggregates;\n      args.actual = actual;\n      args.virtualSelectRecords = virtualSelectRecords;\n      deffered.resolve(args);\n    };\n    var fnQueryChild = function (data, selector) {\n      var subDeffer = new Deferred();\n      var childArgs = {\n        parent: args\n      };\n      query.subQuery.isChild = true;\n      var subUrl = _this.adaptor.processQuery(_this, query.subQuery, data ? _this.adaptor.processResponse(data) : selector);\n      var childReq = _this.makeRequest(subUrl, subDeffer, childArgs, query.subQuery);\n      if (!isSelector) {\n        subDeffer.then(function (subData) {\n          if (data) {\n            DataUtil.buildHierarchy(query.subQuery.fKey, query.subQuery.fromTable, data, subData, query.subQuery.key);\n            process(data, subData.count, subData.xhr);\n          }\n        }, fnFail);\n      }\n      return childReq;\n    };\n    var fnSuccess = function (data, request) {\n      if (_this.isGraphQLAdaptor(_this.adaptor)) {\n        // tslint:disable-next-line:no-string-literal\n        if (!isNullOrUndefined(data['errors'])) {\n          // tslint:disable-next-line:no-string-literal\n          return fnFail(data['errors'], request);\n        }\n      }\n      if (_this.isCustomDataAdaptor(_this.adaptor)) {\n        request = extend({}, _this.fetchReqOption, request);\n      }\n      if (request.contentType.indexOf('xml') === -1 && _this.dateParse && !_this.isEnableCache) {\n        data = DataUtil.parse.parseJson(data);\n      }\n      var result;\n      var promise = _this.afterReponseRequest(data);\n      promise.then(function (data) {\n        result = _this.adaptor.processResponse(data, _this, query, request.fetchRequest, request);\n        if (_this.isEnableCache) {\n          /* eslint-enable prefer-spread */\n          var key = query ? _this.generateKey(_this.dataSource.url, query) : _this.dataSource.url;\n          var obj = {};\n          obj = JSON.parse(window.localStorage.getItem(_this.guidId));\n          var index = obj.keys.indexOf(key);\n          if (index !== -1) {\n            obj.results.splice(index, 1);\n            obj.keys.splice(index, 1);\n          }\n          obj.results[obj.keys.push(key) - 1] = {\n            keys: key,\n            result: result.result,\n            timeStamp: new Date(),\n            count: result.count\n          };\n          window.localStorage.setItem(_this.guidId, JSON.stringify(obj));\n        }\n        if (request.contentType.indexOf('xml') === -1 && _this.dateParse && _this.isEnableCache) {\n          result = DataUtil.parse.parseJson(result);\n        }\n        var count = 0;\n        var aggregates = null;\n        var virtualSelectRecords = 'virtualSelectRecords';\n        var virtualRecords = data[virtualSelectRecords];\n        if (query.isCountRequired) {\n          count = result.count;\n          aggregates = result.aggregates;\n          result = result.result;\n        }\n        if (!query.subQuery) {\n          process(result, count, request.fetchRequest, request.type, data, aggregates, virtualRecords);\n          return;\n        }\n        if (!isSelector) {\n          fnQueryChild(result, request);\n        }\n        ;\n      }).catch(function (e) {\n        return _this.dataManagerFailure(e, deffered, args);\n      });\n    };\n    var req = this.extendRequest(url, fnSuccess, fnFail);\n    if (!this.isCustomDataAdaptor(this.adaptor)) {\n      var promise = this.useMiddleware(req);\n      var fetch_1;\n      promise.then(function (response) {\n        fetch_1 = new Fetch(req);\n        fetch_1.beforeSend = function () {\n          _this.beforeSend(fetch_1.fetchRequest, fetch_1, response);\n        };\n        req = fetch_1.send();\n        req.catch(function (e) {\n          return true;\n        });\n        _this.requests.push(fetch_1);\n      }).catch(function (e) {\n        return _this.dataManagerFailure(e, deffered, args);\n      });\n    } else {\n      this.fetchReqOption = req;\n      var request = req;\n      this.adaptor.options.getData({\n        data: request.data,\n        onSuccess: request.onSuccess,\n        onFailure: request.onFailure\n      });\n    }\n    if (isSelector) {\n      var promise = void 0;\n      var res = query.subQuerySelector.call(this, {\n        query: query.subQuery,\n        parent: query\n      });\n      if (res && res.length) {\n        promise = Promise.all([req, fnQueryChild(null, res)]);\n        promise.then(function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var result = args[0];\n          var pResult = _this.adaptor.processResponse(result[0], _this, query, _this.requests[0].fetchRequest, _this.requests[0]);\n          var count = 0;\n          if (query.isCountRequired) {\n            count = pResult.count;\n            pResult = pResult.result;\n          }\n          var cResult = _this.adaptor.processResponse(result[1], _this, query.subQuery, _this.requests[1].fetchRequest, _this.requests[1]);\n          count = 0;\n          if (query.subQuery.isCountRequired) {\n            count = cResult.count;\n            cResult = cResult.result;\n          }\n          DataUtil.buildHierarchy(query.subQuery.fKey, query.subQuery.fromTable, pResult, cResult, query.subQuery.key);\n          isSelector = false;\n          process(pResult, count, _this.requests[0].fetchRequest);\n        });\n      } else {\n        isSelector = false;\n      }\n    }\n    return req;\n  };\n  /**\n   * @param {Error} e - specifies the string\n   * @param {Deferred} deffered - specifies the deffered\n   * @param {RequestOptions} args - specifies the RequestOptions\n   * @hidden\n   */\n  DataManager.prototype.dataManagerFailure = function (e, deffered, args) {\n    args.error = e;\n    deffered.reject(args);\n  };\n  DataManager.prototype.afterReponseRequest = function (data) {\n    return __awaiter(this, void 0, void 0, function () {\n      var reponse, deffered;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.applyPostRequestMiddlewares(data)];\n          case 1:\n            reponse = _a.sent();\n            deffered = new Deferred();\n            deffered.resolve(reponse);\n            return [2 /*return*/, deffered.promise];\n        }\n      });\n    });\n  };\n  /**\n   * Processes the middleware stack after receiving the response.\n   * @param {Response} response - The response object.\n   * @returns {Response} - The potentially modified response.\n   */\n  DataManager.prototype.applyPostRequestMiddlewares = function (response) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2 /*return*/, response];\n      });\n    });\n  };\n  /**\n   * Registers a new middleware in the DataManager.\n   * @param {Middleware} middleware - The middleware instance to register.\n   * @returns {void}\n   */\n  DataManager.prototype.useMiddleware = function (request) {\n    return __awaiter(this, void 0, void 0, function () {\n      var reponse, deffered;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.applyPreRequestMiddlewares(request)];\n          case 1:\n            reponse = _a.sent();\n            deffered = new Deferred();\n            deffered.resolve(reponse);\n            return [2 /*return*/, deffered.promise];\n        }\n      });\n    });\n  };\n  /**\n   * Processes the middleware stack before sending the request.\n   * @param {Request} request - The request object.\n   * @returns {Request} - The potentially modified request.\n   */\n  DataManager.prototype.applyPreRequestMiddlewares = function (request) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2 /*return*/, request];\n      });\n    });\n  };\n  DataManager.prototype.beforeSend = function (request, settings, response) {\n    this.adaptor.beforeSend(this, request, settings);\n    var headers = [];\n    if (this.dataSource.headers) {\n      headers = headers.concat(this.dataSource.headers);\n    }\n    var props;\n    if (response && response.headers) {\n      headers = headers.concat(response.headers);\n    }\n    for (var i = 0; headers && i < headers.length; i++) {\n      props = [];\n      var keys = Object.keys(headers[i]);\n      for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var prop = keys_1[_i];\n        props.push(prop);\n        request.headers.set(prop, headers[i][prop]);\n      }\n    }\n  };\n  /**\n   * Save bulk changes to the given table name.\n   * User can add a new record, edit an existing record, and delete a record at the same time.\n   * If the datasource from remote, then updated in a single post.\n   *\n   * @param {Object} changes - Defines the CrudOptions.\n   * @param {string} key - Defines the column field.\n   * @param {string|Query} tableName - Defines the table name.\n   * @param {Query} query - Sets default query for the DataManager.\n   * @param original\n   */\n  DataManager.prototype.saveChanges = function (changes, key, tableName, query, original) {\n    var _this = this;\n    if (tableName instanceof Query) {\n      query = tableName;\n      tableName = null;\n    }\n    var args = {\n      url: tableName,\n      key: key || this.dataSource.key\n    };\n    var req = this.adaptor.batchRequest(this, changes, args, query || new Query(), original);\n    var dofetchRequest = 'dofetchRequest';\n    if (this.dataSource.offline) {\n      return req;\n    }\n    if (!isNullOrUndefined(this.adaptor[dofetchRequest])) {\n      return this.adaptor[dofetchRequest](req);\n    } else if (!this.isCustomDataAdaptor(this.adaptor)) {\n      var deff_1 = new Deferred();\n      var fetch_2 = new Fetch(req);\n      fetch_2.beforeSend = function () {\n        _this.beforeSend(fetch_2.fetchRequest, fetch_2);\n      };\n      fetch_2.onSuccess = function (data, request) {\n        if (_this.isGraphQLAdaptor(_this.adaptor)) {\n          // tslint:disable-next-line:no-string-literal\n          if (!isNullOrUndefined(data['errors'])) {\n            // tslint:disable-next-line:no-string-literal\n            fetch_2.onFailure(JSON.stringify(data['errors']));\n          }\n        }\n        deff_1.resolve(_this.adaptor.processResponse(data, _this, null, request.fetchRequest, request, changes, args));\n      };\n      fetch_2.onFailure = function (e) {\n        deff_1.reject([{\n          error: e\n        }]);\n      };\n      fetch_2.send().catch(function (e) {\n        return true;\n      }); // to handle the failure requests.\n      return deff_1.promise;\n    } else {\n      return this.dofetchRequest(req, this.adaptor.options.batchUpdate, changes);\n    }\n  };\n  /**\n   * Inserts new record in the given table.\n   *\n   * @param {Object} data - Defines the data to insert.\n   * @param {string|Query} tableName - Defines the table name.\n   * @param {Query} query - Sets default query for the DataManager.\n   * @param position\n   */\n  DataManager.prototype.insert = function (data, tableName, query, position) {\n    if (tableName instanceof Query) {\n      query = tableName;\n      tableName = null;\n    }\n    var req = this.adaptor.insert(this, data, tableName, query, position);\n    var dofetchRequest = 'dofetchRequest';\n    if (this.dataSource.offline) {\n      return req;\n    }\n    if (!isNullOrUndefined(this.adaptor[dofetchRequest])) {\n      return this.adaptor[dofetchRequest](req);\n    } else {\n      return this.dofetchRequest(req, this.adaptor.options.addRecord);\n    }\n  };\n  /**\n   * Removes data from the table with the given key.\n   *\n   * @param  {string} keyField - Defines the column field.\n   * @param  {Object} value - Defines the value to find the data in the specified column.\n   * @param  {string|Query} tableName - Defines the table name\n   * @param  {Query} query - Sets default query for the DataManager.\n   */\n  DataManager.prototype.remove = function (keyField, value, tableName, query) {\n    if (typeof value === 'object') {\n      value = DataUtil.getObject(keyField, value);\n    }\n    if (tableName instanceof Query) {\n      query = tableName;\n      tableName = null;\n    }\n    var res = this.adaptor.remove(this, keyField, value, tableName, query);\n    var dofetchRequest = 'dofetchRequest';\n    if (this.dataSource.offline) {\n      return res;\n    }\n    if (!isNullOrUndefined(this.adaptor[dofetchRequest])) {\n      return this.adaptor[dofetchRequest](res);\n    } else {\n      var remove = this.adaptor.options.deleteRecord;\n      return this.dofetchRequest(res, remove);\n    }\n  };\n  /**\n   * Updates existing record in the given table.\n   *\n   * @param {string} keyField - Defines the column field.\n   * @param {Object} value - Defines the value to find the data in the specified column.\n   * @param {string|Query} tableName - Defines the table name\n   * @param {Query} query - Sets default query for the DataManager.\n   * @param original\n   */\n  DataManager.prototype.update = function (keyField, value, tableName, query, original) {\n    if (tableName instanceof Query) {\n      query = tableName;\n      tableName = null;\n    }\n    if (this.isEnableCache) {\n      this.cacheQuery = this.generateKey(this.dataSource.url, query);\n    }\n    var res = this.adaptor.update(this, keyField, value, tableName, query, original);\n    var dofetchRequest = 'dofetchRequest';\n    if (this.dataSource.offline) {\n      return res;\n    }\n    if (!isNullOrUndefined(this.adaptor[dofetchRequest])) {\n      return this.adaptor[dofetchRequest](res);\n    } else {\n      var update = this.adaptor.options.updateRecord;\n      return this.dofetchRequest(res, update);\n    }\n  };\n  DataManager.prototype.isCustomDataAdaptor = function (dataSource) {\n    return this.adaptor.getModuleName && this.adaptor.getModuleName() === 'CustomDataAdaptor';\n  };\n  DataManager.prototype.isGraphQLAdaptor = function (dataSource) {\n    return this.adaptor.getModuleName && this.adaptor.getModuleName() === 'GraphQLAdaptor';\n  };\n  DataManager.prototype.successFunc = function (record, request, changes) {\n    if (this.isGraphQLAdaptor(this.adaptor)) {\n      var data = typeof record === 'object' ? record : JSON.parse(record);\n      // tslint:disable-next-line:no-string-literal\n      if (!isNullOrUndefined(data['errors'])) {\n        // tslint:disable-next-line:no-string-literal\n        this.failureFunc(JSON.stringify(data['errors']));\n      }\n    }\n    if (this.isCustomDataAdaptor(this.adaptor)) {\n      request = extend({}, this.fetchReqOption, request);\n    }\n    try {\n      DataUtil.parse.parseJson(record);\n    } catch (e) {\n      record = [];\n    }\n    if (this.isEnableCache) {\n      var requests = JSON.parse(request.data);\n      if (requests.action === 'insert' || requests.action === 'remove') {\n        var obj = {\n          keys: [],\n          results: []\n        };\n        window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n      } else if (requests.action === 'update') {\n        var cachedItems = JSON.parse(window.localStorage.getItem(this.guidId));\n        var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(this.cacheQuery)] : null;\n        if (data && data.result) {\n          var cacheData = data.result;\n          for (var i = 0; i < cacheData.length; i++) {\n            if (cacheData[i][requests.keyColumn] === requests.key) {\n              cacheData[i] = requests.value;\n              window.localStorage.setItem(this.guidId, JSON.stringify(cachedItems));\n              break;\n            }\n          }\n        }\n      }\n    }\n    record = this.adaptor.processResponse(DataUtil.parse.parseJson(record), this, null, request.fetchRequest, request, changes);\n    this.fetchDeffered.resolve(record);\n  };\n  DataManager.prototype.failureFunc = function (e) {\n    if (this.isEnableCache) {\n      this.cacheQuery = '';\n    }\n    this.fetchDeffered.reject([{\n      error: e\n    }]);\n  };\n  DataManager.prototype.dofetchRequest = function (res, fetchFunc, changes) {\n    var _this = this;\n    res = extend({}, {\n      type: 'POST',\n      contentType: 'application/json; charset=utf-8',\n      processData: false\n    }, res);\n    this.fetchDeffered = new Deferred();\n    if (!this.isCustomDataAdaptor(this.adaptor)) {\n      var fetch_3 = new Fetch(res);\n      fetch_3.beforeSend = function () {\n        _this.beforeSend(fetch_3.fetchRequest, fetch_3);\n      };\n      fetch_3.onSuccess = this.successFunc.bind(this);\n      fetch_3.onFailure = this.failureFunc.bind(this);\n      fetch_3.send().catch(function (e) {\n        return true;\n      }); // to handle the failure requests.\n    } else {\n      this.fetchReqOption = res;\n      fetchFunc.call(this, {\n        data: res.data,\n        onSuccess: this.successFunc.bind(this),\n        onFailure: this.failureFunc.bind(this),\n        changes: changes\n      });\n    }\n    return this.fetchDeffered.promise;\n  };\n  DataManager.prototype.clearPersistence = function () {\n    window.removeEventListener('unload', this.setPersistData.bind(this));\n    this.dataSource.enablePersistence = false;\n    this.persistQuery = {};\n    window.localStorage.setItem(this.dataSource.id, '[]');\n  };\n  return DataManager;\n}();\nexport { DataManager };\n/**\n * Deferred is used to handle asynchronous operation.\n */\nvar Deferred = /** @class */function () {\n  function Deferred() {\n    var _this = this;\n    /**\n     * Promise is an object that represents a value that may not be available yet, but will be resolved at some point in the future.\n     */\n    this.promise = new Promise(function (resolve, reject) {\n      _this.resolve = resolve;\n      _this.reject = reject;\n    });\n    /**\n     * Defines the callback function triggers when the Deferred object is resolved.\n     */\n    this.then = this.promise.then.bind(this.promise);\n    /**\n     * Defines the callback function triggers when the Deferred object is rejected.\n     */\n    this.catch = this.promise.catch.bind(this.promise);\n  }\n  return Deferred;\n}();\nexport { Deferred };","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","Fetch","extend","isNullOrUndefined","DataUtil","Predicate","Query","ODataAdaptor","JsonAdaptor","CacheAdaptor","RemoteSaveAdaptor","CustomDataAdaptor","DataManager","dataSource","query","adaptor","_this","dateParse","timeZoneHandling","persistQuery","isInitialLoad","requests","isEnableCache","data","Array","json","offline","enablePersistence","id","ignoreOnPersist","url","insertUrl","removeUrl","updateUrl","crudUrl","batchUrl","headers","accept","enableCache","timeTillExpiration","cachingPageSize","enableCaching","requestType","key","crossDomain","jsonp","dataType","undefined","requiresFormat","throwError","isCors","defaultQuery","window","addEventListener","setPersistData","bind","isDataAvailable","ready","executeQuery","guidId","getGuid","obj","keys","results","localStorage","setItem","JSON","stringify","Object","defineProperty","prototype","get","enumerable","configurable","getPersistedData","persistedData","getItem","parse","persistData","setPersistQuery","persistedQuery","queries","filter","fn","some","keyword","isComplex","predicates","allPredicates","map","predicateObj","nestedPredicates","nestedPredicate","field","operator","ignoreCase","ignoreAccent","matchCase","condition","and","or","slice","newQuery","setDefaultQuery","executeLocal","processQuery","subQuery","from","fromTable","lookup","lookups","res","isCountRequired","buildHierarchy","fKey","j","processResponse","using","fail","always","makeRequest","deffered","Deferred","args","isCustomDataAdaptor","getDeferedArgs","nextTick","promise","getQueryRequest","req","sorts","groups","filters","searches","aggregates","filterQueries","generateKey","singles","filterQueryLists","page","forEach","direction","fieldName","searchKey","currentFilter","clone","i","previousCacheQuery","pageIndex","cachedItems","indexOf","parseJson","count","setImmediate","setTimeout","extendRequest","fnSuccess","fnFail","type","cache","processData","onSuccess","onFailure","isSelector","subQuerySelector","error","process","xhr","request","actual","virtualSelectRecords","parseInt","toString","fnQueryChild","selector","subDeffer","childArgs","parent","isChild","subUrl","childReq","subData","isGraphQLAdaptor","fetchReqOption","contentType","afterReponseRequest","fetchRequest","index","splice","timeStamp","Date","virtualRecords","catch","dataManagerFailure","useMiddleware","fetch_1","response","beforeSend","send","options","getData","all","_i","arguments","pResult","cResult","reponse","_a","applyPostRequestMiddlewares","applyPreRequestMiddlewares","settings","concat","props","keys_1","prop","set","saveChanges","changes","tableName","original","batchRequest","dofetchRequest","deff_1","fetch_2","batchUpdate","insert","position","addRecord","remove","keyField","getObject","deleteRecord","update","cacheQuery","updateRecord","getModuleName","successFunc","record","failureFunc","action","cacheData","keyColumn","fetchDeffered","fetchFunc","fetch_3","clearPersistence","removeEventListener"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-data/src/manager.js"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/* eslint-disable valid-jsdoc */\n/* eslint-disable security/detect-object-injection */\nimport { Fetch } from '@syncfusion/ej2-base';\nimport { extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DataUtil } from './util';\nimport { Predicate, Query } from './query';\nimport { ODataAdaptor, JsonAdaptor, CacheAdaptor, RemoteSaveAdaptor, CustomDataAdaptor } from './adaptors';\n/**\n * DataManager is used to manage and manipulate relational data.\n */\nvar DataManager = /** @class */ (function () {\n    /**\n     * Constructor for DataManager class\n     *\n     * @param {DataOptions|JSON[]} dataSource?\n     * @param {Query} query?\n     * @param {AdaptorOptions|string} adaptor?\n     * @param dataSource\n     * @param query\n     * @param adaptor\n     * @hidden\n     */\n    function DataManager(dataSource, query, adaptor) {\n        var _this = this;\n        /** @hidden */\n        this.dateParse = true;\n        /** @hidden */\n        this.timeZoneHandling = true;\n        this.persistQuery = {};\n        this.isInitialLoad = false;\n        this.requests = [];\n        this.isEnableCache = false;\n        this.isInitialLoad = true;\n        this.isEnableCache = false;\n        if (!dataSource && !this.dataSource) {\n            dataSource = [];\n        }\n        adaptor = adaptor || dataSource.adaptor;\n        if (dataSource && dataSource.timeZoneHandling === false) {\n            this.timeZoneHandling = dataSource.timeZoneHandling;\n        }\n        var data;\n        if (dataSource instanceof Array) {\n            data = {\n                json: dataSource,\n                offline: true\n            };\n        }\n        else if (typeof dataSource === 'object') {\n            if (!dataSource.json) {\n                dataSource.json = [];\n            }\n            if (!dataSource.enablePersistence) {\n                dataSource.enablePersistence = false;\n            }\n            if (!dataSource.id) {\n                dataSource.id = '';\n            }\n            if (!dataSource.ignoreOnPersist) {\n                dataSource.ignoreOnPersist = [];\n            }\n            data = {\n                url: dataSource.url,\n                insertUrl: dataSource.insertUrl,\n                removeUrl: dataSource.removeUrl,\n                updateUrl: dataSource.updateUrl,\n                crudUrl: dataSource.crudUrl,\n                batchUrl: dataSource.batchUrl,\n                json: dataSource.json,\n                headers: dataSource.headers,\n                accept: dataSource.accept,\n                data: dataSource.data,\n                enableCache: dataSource.enableCache,\n                timeTillExpiration: dataSource.timeTillExpiration,\n                cachingPageSize: dataSource.cachingPageSize,\n                enableCaching: dataSource.enableCaching,\n                requestType: dataSource.requestType,\n                key: dataSource.key,\n                crossDomain: dataSource.crossDomain,\n                jsonp: dataSource.jsonp,\n                dataType: dataSource.dataType,\n                offline: dataSource.offline !== undefined ? dataSource.offline\n                    : dataSource.adaptor instanceof RemoteSaveAdaptor || dataSource.adaptor instanceof CustomDataAdaptor ?\n                        false : dataSource.url ? false : true,\n                requiresFormat: dataSource.requiresFormat,\n                enablePersistence: dataSource.enablePersistence,\n                id: dataSource.id,\n                ignoreOnPersist: dataSource.ignoreOnPersist\n            };\n        }\n        else {\n            DataUtil.throwError('DataManager: Invalid arguments');\n        }\n        if (data.requiresFormat === undefined && !DataUtil.isCors()) {\n            data.requiresFormat = isNullOrUndefined(data.crossDomain) ? true : data.crossDomain;\n        }\n        if (data.dataType === undefined) {\n            data.dataType = 'json';\n        }\n        this.isEnableCache = data.enableCache;\n        this.dataSource = data;\n        this.defaultQuery = query;\n        if (this.dataSource.enablePersistence && this.dataSource.id) {\n            window.addEventListener('unload', this.setPersistData.bind(this));\n        }\n        if (data.url && data.offline && !data.json.length) {\n            this.isDataAvailable = false;\n            this.adaptor = adaptor || new ODataAdaptor();\n            this.dataSource.offline = false;\n            this.ready = this.executeQuery(query || new Query());\n            this.ready.then(function (e) {\n                _this.dataSource.offline = true;\n                _this.isDataAvailable = true;\n                data.json = e.result;\n                _this.adaptor = new JsonAdaptor();\n            });\n        }\n        else {\n            this.adaptor = data.offline ? new JsonAdaptor() : new ODataAdaptor();\n        }\n        if (!data.jsonp && this.adaptor instanceof ODataAdaptor) {\n            data.jsonp = 'callback';\n        }\n        this.adaptor = adaptor || this.adaptor;\n        if (this.isEnableCache) {\n            this.guidId = DataUtil.getGuid('cacheAdaptor');\n            var obj = { keys: [], results: [] };\n            window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n        }\n        if (data.enableCaching) {\n            this.adaptor = new CacheAdaptor(this.adaptor, data.timeTillExpiration, data.cachingPageSize);\n        }\n        return this;\n    }\n    Object.defineProperty(DataManager.prototype, \"moduleName\", {\n        /** @hidden */\n        get: function () { return 'datamanager'; },\n        enumerable: true,\n        configurable: true\n    });\n    ;\n    /**\n     * Get the queries maintained in the persisted state.\n     * @param {string} id - The identifier of the persisted query to retrieve.\n     * @returns {object} The persisted data object.\n     */\n    DataManager.prototype.getPersistedData = function (id) {\n        var persistedData = localStorage.getItem(id || this.dataSource.id);\n        return JSON.parse(persistedData);\n    };\n    /**\n    * Set the queries to be maintained in the persisted state.\n    * @param {Event} e - The event parameter that triggers the setPersistData method.\n    * @param {string} id - The identifier of the persisted query to set.\n    * @param {object} persistData - The data to be persisted.\n    * @returns {void} .\n    */\n    DataManager.prototype.setPersistData = function (e, id, persistData) {\n        localStorage.setItem(id || this.dataSource.id, JSON.stringify(persistData || this.persistQuery));\n    };\n    DataManager.prototype.setPersistQuery = function (query) {\n        var _this = this;\n        var persistedQuery = this.getPersistedData();\n        if (this.isInitialLoad && persistedQuery && Object.keys(persistedQuery).length) {\n            this.persistQuery = persistedQuery;\n            this.persistQuery.queries = this.persistQuery.queries.filter(function (query) {\n                if (_this.dataSource.ignoreOnPersist && _this.dataSource.ignoreOnPersist.length) {\n                    if (query.fn && _this.dataSource.ignoreOnPersist.some(function (keyword) { return query.fn === keyword; })) {\n                        return false; // Exclude the matching query\n                    }\n                }\n                if (query.fn === 'onWhere') {\n                    var e = query.e;\n                    if (e && e.isComplex && e.predicates instanceof Array) {\n                        var allPredicates = e.predicates.map(function (predicateObj) {\n                            if (predicateObj.predicates && predicateObj.predicates instanceof Array) {\n                                // Process nested predicate array\n                                var nestedPredicates = predicateObj.predicates.map(function (nestedPredicate) {\n                                    var field = nestedPredicate.field, operator = nestedPredicate.operator, value = nestedPredicate.value, ignoreCase = nestedPredicate.ignoreCase, ignoreAccent = nestedPredicate.ignoreAccent, matchCase = nestedPredicate.matchCase;\n                                    return new Predicate(field, operator, value, ignoreCase, ignoreAccent, matchCase);\n                                });\n                                return predicateObj.condition === 'and' ? Predicate.and(nestedPredicates) : Predicate.or(nestedPredicates);\n                            }\n                            else {\n                                // Process individual predicate\n                                var field = predicateObj.field, operator = predicateObj.operator, value = predicateObj.value, ignoreCase = predicateObj.ignoreCase, ignoreAccent = predicateObj.ignoreAccent, matchCase = predicateObj.matchCase;\n                                return new Predicate(field, operator, value, ignoreCase, ignoreAccent, matchCase);\n                            }\n                        });\n                        query.e = new Predicate(allPredicates[0], e.condition, allPredicates.slice(1));\n                    }\n                }\n                return true; // Keep all other queries\n            });\n            var newQuery = extend(new Query(), this.persistQuery);\n            this.isInitialLoad = false;\n            return (newQuery);\n        }\n        else {\n            this.persistQuery = query;\n            this.isInitialLoad = false;\n            return query;\n        }\n    };\n    /**\n     * Overrides DataManager's default query with given query.\n     *\n     * @param  {Query} query - Defines the new default query.\n     */\n    DataManager.prototype.setDefaultQuery = function (query) {\n        this.defaultQuery = query;\n        return this;\n    };\n    /**\n     * Executes the given query with local data source.\n     *\n     * @param  {Query} query - Defines the query to retrieve data.\n     */\n    DataManager.prototype.executeLocal = function (query) {\n        if (!this.defaultQuery && !(query instanceof Query)) {\n            DataUtil.throwError('DataManager - executeLocal() : A query is required to execute');\n        }\n        if (!this.dataSource.json) {\n            DataUtil.throwError('DataManager - executeLocal() : Json data is required to execute');\n        }\n        if (this.dataSource.enablePersistence && this.dataSource.id) {\n            query = this.setPersistQuery(query);\n        }\n        query = query || this.defaultQuery;\n        var result = this.adaptor.processQuery(this, query);\n        if (query.subQuery) {\n            var from = query.subQuery.fromTable;\n            var lookup = query.subQuery.lookups;\n            var res = query.isCountRequired ? result.result :\n                result;\n            if (lookup && lookup instanceof Array) {\n                DataUtil.buildHierarchy(query.subQuery.fKey, from, res, lookup, query.subQuery.key);\n            }\n            for (var j = 0; j < res.length; j++) {\n                if (res[j][from] instanceof Array) {\n                    res[j] = extend({}, {}, res[j]);\n                    res[j][from] = this.adaptor.processResponse(query.subQuery.using(new DataManager(res[j][from].slice(0))).executeLocal(), this, query);\n                }\n            }\n        }\n        return this.adaptor.processResponse(result, this, query);\n    };\n    /**\n     * Executes the given query with either local or remote data source.\n     * It will be executed as asynchronously and returns Promise object which will be resolved or rejected after action completed.\n     *\n     * @param  {Query|Function} query - Defines the query to retrieve data.\n     * @param  {Function} done - Defines the callback function and triggers when the Promise is resolved.\n     * @param  {Function} fail - Defines the callback function and triggers when the Promise is rejected.\n     * @param  {Function} always - Defines the callback function and triggers when the Promise is resolved or rejected.\n     */\n    DataManager.prototype.executeQuery = function (query, done, fail, always) {\n        var _this = this;\n        var makeRequest = 'makeRequest';\n        if (this.dataSource.enablePersistence && this.dataSource.id) {\n            query = this.setPersistQuery(query);\n        }\n        if (typeof query === 'function') {\n            always = fail;\n            fail = done;\n            done = query;\n            query = null;\n        }\n        if (!query) {\n            query = this.defaultQuery;\n        }\n        if (!(query instanceof Query)) {\n            DataUtil.throwError('DataManager - executeQuery() : A query is required to execute');\n        }\n        var deffered = new Deferred();\n        var args = { query: query };\n        if (!this.dataSource.offline && (this.dataSource.url !== undefined && this.dataSource.url !== '')\n            || (!isNullOrUndefined(this.adaptor[makeRequest])) || this.isCustomDataAdaptor(this.adaptor)) {\n            var result = this.isEnableCache ? this.processQuery(query) : this.adaptor.processQuery(this, query);\n            if (!isNullOrUndefined(this.adaptor[makeRequest])) {\n                this.adaptor[makeRequest](result, deffered, args, query);\n            }\n            else if (!isNullOrUndefined(result.url) || this.isCustomDataAdaptor(this.adaptor)) {\n                this.requests = [];\n                this.makeRequest(result, deffered, args, query);\n            }\n            else {\n                args = DataManager.getDeferedArgs(query, result, args);\n                deffered.resolve(args);\n            }\n        }\n        else {\n            DataManager.nextTick(function () {\n                var res = _this.executeLocal(query);\n                args = DataManager.getDeferedArgs(query, res, args);\n                deffered.resolve(args);\n            });\n        }\n        if (done || fail) {\n            deffered.promise.then(done, fail);\n        }\n        if (always) {\n            deffered.promise.then(always, always);\n        }\n        return deffered.promise;\n    };\n    DataManager.prototype.getQueryRequest = function (query) {\n        var req = { sorts: [], groups: [], filters: [], searches: [], aggregates: [] };\n        req.sorts = Query.filterQueries(query.queries, 'onSortBy');\n        req.groups = Query.filterQueries(query.queries, 'onGroup');\n        req.filters = Query.filterQueries(query.queries, 'onWhere');\n        req.searches = Query.filterQueries(query.queries, 'onSearch');\n        req.aggregates = Query.filterQueries(query.queries, 'onAggregates');\n        return req;\n    };\n    DataManager.prototype.generateKey = function (url, query) {\n        var queries = this.getQueryRequest(query);\n        var singles = Query.filterQueryLists(query.queries, ['onSelect', 'onPage', 'onSkip', 'onTake', 'onRange']);\n        var key = url;\n        var page = 'onPage';\n        queries.sorts.forEach(function (obj) {\n            key += obj.e.direction + obj.e.fieldName;\n        });\n        queries.groups.forEach(function (obj) {\n            key += obj.e.fieldName;\n        });\n        queries.searches.forEach(function (obj) {\n            key += obj.e.searchKey;\n        });\n        for (var filter = 0; filter < queries.filters.length; filter++) {\n            var currentFilter = queries.filters[filter];\n            if (currentFilter.e.isComplex) {\n                var newQuery = query.clone();\n                newQuery.queries = [];\n                for (var i = 0; i < currentFilter.e.predicates.length; i++) {\n                    newQuery.queries.push({ fn: 'onWhere', e: currentFilter.e.predicates[i], filter: query.queries.filter });\n                }\n                key += currentFilter.e.condition + this.generateKey(url, newQuery);\n            }\n            else {\n                key += currentFilter.e.field + currentFilter.e.operator + currentFilter.e.value;\n            }\n        }\n        if (!isNullOrUndefined(this.previousCacheQuery) && this.previousCacheQuery !== key) {\n            var obj = { keys: [], results: [] };\n            window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n        }\n        this.previousCacheQuery = key;\n        if (page in singles) {\n            key += singles[page].pageIndex;\n        }\n        return key;\n    };\n    DataManager.prototype.processQuery = function (query) {\n        var key = this.generateKey(this.dataSource.url, query);\n        var cachedItems = JSON.parse(window.localStorage.getItem(this.guidId));\n        var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(key)] : null;\n        if (data != null) {\n            return DataUtil.parse.parseJson(data);\n        }\n        return this.adaptor.processQuery(this, query);\n    };\n    DataManager.getDeferedArgs = function (query, result, args) {\n        if (query.isCountRequired) {\n            args.result = result.result;\n            args.count = result.count;\n            args.aggregates = result.aggregates;\n        }\n        else {\n            args.result = result;\n        }\n        return args;\n    };\n    DataManager.nextTick = function (fn) {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        // tslint:disable-next-line:no-any\n        (window.setImmediate || window.setTimeout)(fn, 0);\n        /* eslint-enable @typescript-eslint/no-explicit-any */\n    };\n    DataManager.prototype.extendRequest = function (url, fnSuccess, fnFail) {\n        return extend({}, {\n            type: 'GET',\n            dataType: this.dataSource.dataType,\n            crossDomain: this.dataSource.crossDomain,\n            jsonp: this.dataSource.jsonp,\n            cache: true,\n            processData: false,\n            onSuccess: fnSuccess,\n            onFailure: fnFail\n        }, url);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataManager.prototype.makeRequest = function (url, deffered, args, query) {\n        var _this = this;\n        var isSelector = !!query.subQuerySelector;\n        var fnFail = function (e) {\n            args.error = e;\n            deffered.reject(args);\n        };\n        var process = function (data, count, xhr, request, actual, aggregates, virtualSelectRecords) {\n            args.xhr = xhr;\n            args.count = count ? parseInt(count.toString(), 10) : 0;\n            args.result = data;\n            args.request = request;\n            args.aggregates = aggregates;\n            args.actual = actual;\n            args.virtualSelectRecords = virtualSelectRecords;\n            deffered.resolve(args);\n        };\n        var fnQueryChild = function (data, selector) {\n            var subDeffer = new Deferred();\n            var childArgs = { parent: args };\n            query.subQuery.isChild = true;\n            var subUrl = _this.adaptor.processQuery(_this, query.subQuery, data ? _this.adaptor.processResponse(data) : selector);\n            var childReq = _this.makeRequest(subUrl, subDeffer, childArgs, query.subQuery);\n            if (!isSelector) {\n                subDeffer.then(function (subData) {\n                    if (data) {\n                        DataUtil.buildHierarchy(query.subQuery.fKey, query.subQuery.fromTable, data, subData, query.subQuery.key);\n                        process(data, subData.count, subData.xhr);\n                    }\n                }, fnFail);\n            }\n            return childReq;\n        };\n        var fnSuccess = function (data, request) {\n            if (_this.isGraphQLAdaptor(_this.adaptor)) {\n                // tslint:disable-next-line:no-string-literal\n                if (!isNullOrUndefined(data['errors'])) {\n                    // tslint:disable-next-line:no-string-literal\n                    return fnFail(data['errors'], request);\n                }\n            }\n            if (_this.isCustomDataAdaptor(_this.adaptor)) {\n                request = extend({}, _this.fetchReqOption, request);\n            }\n            if (request.contentType.indexOf('xml') === -1 && _this.dateParse && !_this.isEnableCache) {\n                data = DataUtil.parse.parseJson(data);\n            }\n            var result;\n            var promise = _this.afterReponseRequest(data);\n            promise.then(function (data) {\n                result = _this.adaptor.processResponse(data, _this, query, request.fetchRequest, request);\n                if (_this.isEnableCache) {\n                    /* eslint-enable prefer-spread */\n                    var key = query ? _this.generateKey(_this.dataSource.url, query) : _this.dataSource.url;\n                    var obj = {};\n                    obj = JSON.parse(window.localStorage.getItem(_this.guidId));\n                    var index = obj.keys.indexOf(key);\n                    if (index !== -1) {\n                        obj.results.splice(index, 1);\n                        obj.keys.splice(index, 1);\n                    }\n                    obj.results[obj.keys.push(key) - 1] = { keys: key, result: result.result, timeStamp: new Date(), count: result.count };\n                    window.localStorage.setItem(_this.guidId, JSON.stringify(obj));\n                }\n                if (request.contentType.indexOf('xml') === -1 && _this.dateParse && _this.isEnableCache) {\n                    result = DataUtil.parse.parseJson(result);\n                }\n                var count = 0;\n                var aggregates = null;\n                var virtualSelectRecords = 'virtualSelectRecords';\n                var virtualRecords = data[virtualSelectRecords];\n                if (query.isCountRequired) {\n                    count = result.count;\n                    aggregates = result.aggregates;\n                    result = result.result;\n                }\n                if (!query.subQuery) {\n                    process(result, count, request.fetchRequest, request.type, data, aggregates, virtualRecords);\n                    return;\n                }\n                if (!isSelector) {\n                    fnQueryChild(result, request);\n                }\n                ;\n            }).catch(function (e) { return _this.dataManagerFailure(e, deffered, args); });\n        };\n        var req = this.extendRequest(url, fnSuccess, fnFail);\n        if (!this.isCustomDataAdaptor(this.adaptor)) {\n            var promise = this.useMiddleware(req);\n            var fetch_1;\n            promise.then(function (response) {\n                fetch_1 = new Fetch(req);\n                fetch_1.beforeSend = function () {\n                    _this.beforeSend(fetch_1.fetchRequest, fetch_1, response);\n                };\n                req = fetch_1.send();\n                req.catch(function (e) { return true; });\n                _this.requests.push(fetch_1);\n            }).catch(function (e) { return _this.dataManagerFailure(e, deffered, args); });\n        }\n        else {\n            this.fetchReqOption = req;\n            var request = req;\n            this.adaptor.options.getData({\n                data: request.data,\n                onSuccess: request.onSuccess, onFailure: request.onFailure\n            });\n        }\n        if (isSelector) {\n            var promise = void 0;\n            var res = query.subQuerySelector.call(this, { query: query.subQuery, parent: query });\n            if (res && res.length) {\n                promise = Promise.all([req, fnQueryChild(null, res)]);\n                promise.then(function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    var result = args[0];\n                    var pResult = _this.adaptor.processResponse(result[0], _this, query, _this.requests[0].fetchRequest, _this.requests[0]);\n                    var count = 0;\n                    if (query.isCountRequired) {\n                        count = pResult.count;\n                        pResult = pResult.result;\n                    }\n                    var cResult = _this.adaptor.processResponse(result[1], _this, query.subQuery, _this.requests[1].fetchRequest, _this.requests[1]);\n                    count = 0;\n                    if (query.subQuery.isCountRequired) {\n                        count = cResult.count;\n                        cResult = cResult.result;\n                    }\n                    DataUtil.buildHierarchy(query.subQuery.fKey, query.subQuery.fromTable, pResult, cResult, query.subQuery.key);\n                    isSelector = false;\n                    process(pResult, count, _this.requests[0].fetchRequest);\n                });\n            }\n            else {\n                isSelector = false;\n            }\n        }\n        return req;\n    };\n    /**\n     * @param {Error} e - specifies the string\n     * @param {Deferred} deffered - specifies the deffered\n     * @param {RequestOptions} args - specifies the RequestOptions\n     * @hidden\n     */\n    DataManager.prototype.dataManagerFailure = function (e, deffered, args) {\n        args.error = e;\n        deffered.reject(args);\n    };\n    DataManager.prototype.afterReponseRequest = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var reponse, deffered;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.applyPostRequestMiddlewares(data)];\n                    case 1:\n                        reponse = _a.sent();\n                        deffered = new Deferred();\n                        deffered.resolve(reponse);\n                        return [2 /*return*/, deffered.promise];\n                }\n            });\n        });\n    };\n    /**\n     * Processes the middleware stack after receiving the response.\n     * @param {Response} response - The response object.\n     * @returns {Response} - The potentially modified response.\n     */\n    DataManager.prototype.applyPostRequestMiddlewares = function (response) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, response];\n            });\n        });\n    };\n    /**\n     * Registers a new middleware in the DataManager.\n     * @param {Middleware} middleware - The middleware instance to register.\n     * @returns {void}\n     */\n    DataManager.prototype.useMiddleware = function (request) {\n        return __awaiter(this, void 0, void 0, function () {\n            var reponse, deffered;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.applyPreRequestMiddlewares(request)];\n                    case 1:\n                        reponse = _a.sent();\n                        deffered = new Deferred();\n                        deffered.resolve(reponse);\n                        return [2 /*return*/, deffered.promise];\n                }\n            });\n        });\n    };\n    /**\n     * Processes the middleware stack before sending the request.\n     * @param {Request} request - The request object.\n     * @returns {Request} - The potentially modified request.\n     */\n    DataManager.prototype.applyPreRequestMiddlewares = function (request) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, request];\n            });\n        });\n    };\n    DataManager.prototype.beforeSend = function (request, settings, response) {\n        this.adaptor.beforeSend(this, request, settings);\n        var headers = [];\n        if (this.dataSource.headers) {\n            headers = headers.concat(this.dataSource.headers);\n        }\n        var props;\n        if (response && response.headers) {\n            headers = headers.concat(response.headers);\n        }\n        for (var i = 0; headers && i < headers.length; i++) {\n            props = [];\n            var keys = Object.keys(headers[i]);\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n                var prop = keys_1[_i];\n                props.push(prop);\n                request.headers.set(prop, headers[i][prop]);\n            }\n        }\n    };\n    /**\n     * Save bulk changes to the given table name.\n     * User can add a new record, edit an existing record, and delete a record at the same time.\n     * If the datasource from remote, then updated in a single post.\n     *\n     * @param {Object} changes - Defines the CrudOptions.\n     * @param {string} key - Defines the column field.\n     * @param {string|Query} tableName - Defines the table name.\n     * @param {Query} query - Sets default query for the DataManager.\n     * @param original\n     */\n    DataManager.prototype.saveChanges = function (changes, key, tableName, query, original) {\n        var _this = this;\n        if (tableName instanceof Query) {\n            query = tableName;\n            tableName = null;\n        }\n        var args = {\n            url: tableName,\n            key: key || this.dataSource.key\n        };\n        var req = this.adaptor.batchRequest(this, changes, args, query || new Query(), original);\n        var dofetchRequest = 'dofetchRequest';\n        if (this.dataSource.offline) {\n            return req;\n        }\n        if (!isNullOrUndefined(this.adaptor[dofetchRequest])) {\n            return this.adaptor[dofetchRequest](req);\n        }\n        else if (!this.isCustomDataAdaptor(this.adaptor)) {\n            var deff_1 = new Deferred();\n            var fetch_2 = new Fetch(req);\n            fetch_2.beforeSend = function () {\n                _this.beforeSend(fetch_2.fetchRequest, fetch_2);\n            };\n            fetch_2.onSuccess = function (data, request) {\n                if (_this.isGraphQLAdaptor(_this.adaptor)) {\n                    // tslint:disable-next-line:no-string-literal\n                    if (!isNullOrUndefined(data['errors'])) {\n                        // tslint:disable-next-line:no-string-literal\n                        fetch_2.onFailure(JSON.stringify(data['errors']));\n                    }\n                }\n                deff_1.resolve(_this.adaptor.processResponse(data, _this, null, request.fetchRequest, request, changes, args));\n            };\n            fetch_2.onFailure = function (e) {\n                deff_1.reject([{ error: e }]);\n            };\n            fetch_2.send().catch(function (e) { return true; }); // to handle the failure requests.\n            return deff_1.promise;\n        }\n        else {\n            return this.dofetchRequest(req, this.adaptor.options.batchUpdate, changes);\n        }\n    };\n    /**\n     * Inserts new record in the given table.\n     *\n     * @param {Object} data - Defines the data to insert.\n     * @param {string|Query} tableName - Defines the table name.\n     * @param {Query} query - Sets default query for the DataManager.\n     * @param position\n     */\n    DataManager.prototype.insert = function (data, tableName, query, position) {\n        if (tableName instanceof Query) {\n            query = tableName;\n            tableName = null;\n        }\n        var req = this.adaptor.insert(this, data, tableName, query, position);\n        var dofetchRequest = 'dofetchRequest';\n        if (this.dataSource.offline) {\n            return req;\n        }\n        if (!isNullOrUndefined(this.adaptor[dofetchRequest])) {\n            return this.adaptor[dofetchRequest](req);\n        }\n        else {\n            return this.dofetchRequest(req, this.adaptor.options.addRecord);\n        }\n    };\n    /**\n     * Removes data from the table with the given key.\n     *\n     * @param  {string} keyField - Defines the column field.\n     * @param  {Object} value - Defines the value to find the data in the specified column.\n     * @param  {string|Query} tableName - Defines the table name\n     * @param  {Query} query - Sets default query for the DataManager.\n     */\n    DataManager.prototype.remove = function (keyField, value, tableName, query) {\n        if (typeof value === 'object') {\n            value = DataUtil.getObject(keyField, value);\n        }\n        if (tableName instanceof Query) {\n            query = tableName;\n            tableName = null;\n        }\n        var res = this.adaptor.remove(this, keyField, value, tableName, query);\n        var dofetchRequest = 'dofetchRequest';\n        if (this.dataSource.offline) {\n            return res;\n        }\n        if (!isNullOrUndefined(this.adaptor[dofetchRequest])) {\n            return this.adaptor[dofetchRequest](res);\n        }\n        else {\n            var remove = this.adaptor.options.deleteRecord;\n            return this.dofetchRequest(res, remove);\n        }\n    };\n    /**\n     * Updates existing record in the given table.\n     *\n     * @param {string} keyField - Defines the column field.\n     * @param {Object} value - Defines the value to find the data in the specified column.\n     * @param {string|Query} tableName - Defines the table name\n     * @param {Query} query - Sets default query for the DataManager.\n     * @param original\n     */\n    DataManager.prototype.update = function (keyField, value, tableName, query, original) {\n        if (tableName instanceof Query) {\n            query = tableName;\n            tableName = null;\n        }\n        if (this.isEnableCache) {\n            this.cacheQuery = this.generateKey(this.dataSource.url, query);\n        }\n        var res = this.adaptor.update(this, keyField, value, tableName, query, original);\n        var dofetchRequest = 'dofetchRequest';\n        if (this.dataSource.offline) {\n            return res;\n        }\n        if (!isNullOrUndefined(this.adaptor[dofetchRequest])) {\n            return this.adaptor[dofetchRequest](res);\n        }\n        else {\n            var update = this.adaptor.options.updateRecord;\n            return this.dofetchRequest(res, update);\n        }\n    };\n    DataManager.prototype.isCustomDataAdaptor = function (dataSource) {\n        return this.adaptor.getModuleName &&\n            this.adaptor.getModuleName() === 'CustomDataAdaptor';\n    };\n    DataManager.prototype.isGraphQLAdaptor = function (dataSource) {\n        return this.adaptor.getModuleName &&\n            this.adaptor.getModuleName() === 'GraphQLAdaptor';\n    };\n    DataManager.prototype.successFunc = function (record, request, changes) {\n        if (this.isGraphQLAdaptor(this.adaptor)) {\n            var data = typeof record === 'object' ? record : JSON.parse(record);\n            // tslint:disable-next-line:no-string-literal\n            if (!isNullOrUndefined(data['errors'])) {\n                // tslint:disable-next-line:no-string-literal\n                this.failureFunc(JSON.stringify(data['errors']));\n            }\n        }\n        if (this.isCustomDataAdaptor(this.adaptor)) {\n            request = extend({}, this.fetchReqOption, request);\n        }\n        try {\n            DataUtil.parse.parseJson(record);\n        }\n        catch (e) {\n            record = [];\n        }\n        if (this.isEnableCache) {\n            var requests = JSON.parse(request.data);\n            if (requests.action === 'insert' || requests.action === 'remove') {\n                var obj = { keys: [], results: [] };\n                window.localStorage.setItem(this.guidId, JSON.stringify(obj));\n            }\n            else if (requests.action === 'update') {\n                var cachedItems = JSON.parse(window.localStorage.getItem(this.guidId));\n                var data = cachedItems ? cachedItems.results[cachedItems.keys.indexOf(this.cacheQuery)] : null;\n                if (data && data.result) {\n                    var cacheData = data.result;\n                    for (var i = 0; i < cacheData.length; i++) {\n                        if (cacheData[i][requests.keyColumn] === requests.key) {\n                            cacheData[i] = requests.value;\n                            window.localStorage.setItem(this.guidId, JSON.stringify(cachedItems));\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        record = this.adaptor.processResponse(DataUtil.parse.parseJson(record), this, null, request.fetchRequest, request, changes);\n        this.fetchDeffered.resolve(record);\n    };\n    DataManager.prototype.failureFunc = function (e) {\n        if (this.isEnableCache) {\n            this.cacheQuery = '';\n        }\n        this.fetchDeffered.reject([{ error: e }]);\n    };\n    DataManager.prototype.dofetchRequest = function (res, fetchFunc, changes) {\n        var _this = this;\n        res = extend({}, {\n            type: 'POST',\n            contentType: 'application/json; charset=utf-8',\n            processData: false\n        }, res);\n        this.fetchDeffered = new Deferred();\n        if (!this.isCustomDataAdaptor(this.adaptor)) {\n            var fetch_3 = new Fetch(res);\n            fetch_3.beforeSend = function () {\n                _this.beforeSend(fetch_3.fetchRequest, fetch_3);\n            };\n            fetch_3.onSuccess = this.successFunc.bind(this);\n            fetch_3.onFailure = this.failureFunc.bind(this);\n            fetch_3.send().catch(function (e) { return true; }); // to handle the failure requests.\n        }\n        else {\n            this.fetchReqOption = res;\n            fetchFunc.call(this, {\n                data: res.data, onSuccess: this.successFunc.bind(this),\n                onFailure: this.failureFunc.bind(this),\n                changes: changes\n            });\n        }\n        return this.fetchDeffered.promise;\n    };\n    DataManager.prototype.clearPersistence = function () {\n        window.removeEventListener('unload', this.setPersistData.bind(this));\n        this.dataSource.enablePersistence = false;\n        this.persistQuery = {};\n        window.localStorage.setItem(this.dataSource.id, '[]');\n    };\n    return DataManager;\n}());\nexport { DataManager };\n/**\n * Deferred is used to handle asynchronous operation.\n */\nvar Deferred = /** @class */ (function () {\n    function Deferred() {\n        var _this = this;\n        /**\n         * Promise is an object that represents a value that may not be available yet, but will be resolved at some point in the future.\n         */\n        this.promise = new Promise(function (resolve, reject) {\n            _this.resolve = resolve;\n            _this.reject = reject;\n        });\n        /**\n         * Defines the callback function triggers when the Deferred object is resolved.\n         */\n        this.then = this.promise.then.bind(this.promise);\n        /**\n         * Defines the callback function triggers when the Deferred object is rejected.\n         */\n        this.catch = this.promise.catch.bind(this.promise);\n    }\n    return Deferred;\n}());\nexport { Deferred };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}