{"ast":null,"code":"import { isNullOrUndefined, remove, extend } from '@syncfusion/ej2-base';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport * as events from '../base/constant';\nimport { getScrollBarWidth, getEditedDataIndex, resetRowIndex, setRowElements, getRowIndexFromElement, getGroupKeysAndFields, getPredicates, generateExpandPredicates } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * Infinite Scrolling class\n *\n * @hidden\n */\nvar InfiniteScroll = /** @class */function () {\n  /**\n   * Constructor for the Grid infinite scrolling.\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {ServiceLocator} serviceLocator - specifies the ServiceLocator\n   * @hidden\n   */\n  function InfiniteScroll(parent, serviceLocator) {\n    this.infiniteCache = {};\n    this.infiniteCurrentViewData = {};\n    this.isDownScroll = false;\n    this.isUpScroll = false;\n    this.isScroll = true;\n    this.enableContinuousScroll = false;\n    this.initialRender = true;\n    this.isRemove = false;\n    this.isInitialCollapse = false;\n    this.prevScrollTop = 0;\n    this.actions = ['filtering', 'searching', 'grouping', 'ungrouping', 'reorder', 'sorting', 'refresh'];\n    this.keys = [literals.downArrow, literals.upArrow, literals.enter, literals.shiftEnter];\n    this.rowTop = 0;\n    this.virtualInfiniteData = {};\n    this.isCancel = false;\n    this.emptyRowData = {};\n    this.isNormaledit = false;\n    this.isInfiniteScroll = false;\n    this.isLastPage = false;\n    this.isInitialRender = true;\n    this.isFocusScroll = false;\n    this.isGroupCollapse = false;\n    /** @hidden */\n    this.infiniteDetailDestroy = false;\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.isNormaledit = this.parent.editSettings.mode === 'Normal';\n    this.addEventListener();\n    this.widthService = serviceLocator.getService('widthService');\n    this.rowModelGenerator = new RowModelGenerator(this.parent);\n  }\n  InfiniteScroll.prototype.getModuleName = function () {\n    return 'infiniteScroll';\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  InfiniteScroll.prototype.addEventListener = function () {\n    this.parent.on(events.dataReady, this.onDataReady, this);\n    this.parent.on(events.dataSourceModified, this.dataSourceModified, this);\n    this.parent.on(events.infinitePageQuery, this.infinitePageQuery, this);\n    this.parent.on(events.infiniteScrollHandler, this.infiniteScrollHandler, this);\n    this.parent.on(events.beforeCellFocused, this.infiniteCellFocus, this);\n    this.parent.on(events.appendInfiniteContent, this.appendInfiniteRows, this);\n    this.parent.on(events.removeInfiniteRows, this.removeInfiniteCacheRows, this);\n    this.parent.on(events.resetInfiniteBlocks, this.resetInfiniteBlocks, this);\n    this.parent.on(events.setInfiniteCache, this.setCache, this);\n    this.parent.on(events.initialCollapse, this.ensureIntialCollapse, this);\n    this.parent.on(events.keyPressed, this.infiniteCellFocus, this);\n    this.parent.on(events.infiniteShowHide, this.setDisplayNone, this);\n    this.parent.on(events.virtualScrollEditActionBegin, this.editActionBegin, this);\n    this.parent.on(events.getVirtualData, this.getVirtualInfiniteData, this);\n    this.parent.on(events.editReset, this.resetInfiniteEdit, this);\n    this.parent.on(events.virtualScrollEditSuccess, this.infiniteEditSuccess, this);\n    this.parent.on(events.refreshVirtualCache, this.refreshInfiniteCache, this);\n    this.parent.on(events.refreshInfiniteEditrowindex, this.refreshInfiniteEditrowindex, this);\n    this.parent.on(events.infiniteEditHandler, this.infiniteEditHandler, this);\n    this.parent.on(events.virtualScrollAddActionBegin, this.infiniteAddActionBegin, this);\n    this.parent.on(events.modelChanged, this.modelChanged, this);\n    this.parent.on(events.refreshInfiniteCurrentViewData, this.refreshInfiniteCurrentViewData, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.contentReady, this.selectNewRow, this);\n    this.parent.on(events.captionActionComplete, this.captionActionComplete, this);\n    this.parent.on(events.setVirtualPageQuery, this.setGroupCollapsePageQuery, this);\n    this.parent.on(events.infiniteScrollComplete, this.onActionComplete, this);\n    this.actionBeginFunction = this.actionBegin.bind(this);\n    this.actionCompleteFunction = this.actionComplete.bind(this);\n    this.dataBoundFunction = this.dataBound.bind(this);\n    this.parent.addEventListener(events.actionBegin, this.actionBeginFunction);\n    this.parent.addEventListener(events.actionComplete, this.actionCompleteFunction);\n    this.parent.addEventListener(events.dataBound, this.dataBoundFunction);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  InfiniteScroll.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.dataReady, this.onDataReady);\n    this.parent.off(events.dataSourceModified, this.dataSourceModified);\n    this.parent.off(events.infinitePageQuery, this.infinitePageQuery);\n    this.parent.off(events.infiniteScrollHandler, this.infiniteScrollHandler);\n    this.parent.off(events.beforeCellFocused, this.infiniteCellFocus);\n    this.parent.off(events.appendInfiniteContent, this.appendInfiniteRows);\n    this.parent.off(events.removeInfiniteRows, this.removeInfiniteCacheRows);\n    this.parent.off(events.resetInfiniteBlocks, this.resetInfiniteBlocks);\n    this.parent.off(events.setInfiniteCache, this.setCache);\n    this.parent.off(events.initialCollapse, this.ensureIntialCollapse);\n    this.parent.off(events.keyPressed, this.infiniteCellFocus);\n    this.parent.off(events.infiniteShowHide, this.setDisplayNone);\n    this.parent.off(events.virtualScrollEditActionBegin, this.editActionBegin);\n    this.parent.off(events.getVirtualData, this.getVirtualInfiniteData);\n    this.parent.off(events.editReset, this.resetInfiniteEdit);\n    this.parent.off(events.virtualScrollEditSuccess, this.infiniteEditSuccess);\n    this.parent.off(events.refreshVirtualCache, this.refreshInfiniteCache);\n    this.parent.on(events.refreshInfiniteEditrowindex, this.refreshInfiniteEditrowindex);\n    this.parent.off(events.infiniteEditHandler, this.infiniteEditHandler);\n    this.parent.off(events.virtualScrollAddActionBegin, this.infiniteAddActionBegin);\n    this.parent.off(events.modelChanged, this.modelChanged);\n    this.parent.off(events.refreshInfiniteCurrentViewData, this.refreshInfiniteCurrentViewData);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.contentReady, this.selectNewRow);\n    this.parent.off(events.captionActionComplete, this.captionActionComplete);\n    this.parent.off(events.setVirtualPageQuery, this.setGroupCollapsePageQuery);\n    this.parent.off(events.infiniteScrollComplete, this.onActionComplete);\n    this.parent.removeEventListener(events.actionBegin, this.actionBeginFunction);\n    this.parent.removeEventListener(events.actionComplete, this.actionCompleteFunction);\n    this.parent.removeEventListener(events.dataBound, this.dataBoundFunction);\n  };\n  InfiniteScroll.prototype.dataBound = function () {\n    if (this.groupCaptionAction === 'collapse') {\n      this.groupCaptionAction = 'refresh';\n      this.makeGroupCollapseRequest();\n    } else if (this.groupCaptionAction === 'refresh') {\n      this.parent.hideSpinner();\n      this.groupCaptionAction = this.empty;\n    }\n  };\n  InfiniteScroll.prototype.setGroupCollapsePageQuery = function (args) {\n    var gObj = this.parent;\n    if (!gObj.infiniteScrollSettings.enableCache && this.isGroupCollapse) {\n      args.skipPage = true;\n      this.isGroupCollapse = false;\n      if (this.groupCaptionAction === 'collapse') {\n        var captionRow = gObj.getRowObjectFromUID(this.parentCapUid);\n        var rowObjs = gObj.getRowsObject();\n        var childCount = 0;\n        for (var i = rowObjs.length - 1; i >= 0; i--) {\n          if (rowObjs[parseInt(i.toString(), 10)].indent === captionRow.indent) {\n            break;\n          }\n          if (rowObjs[parseInt(i.toString(), 10)].isDataRow) {\n            childCount++;\n          }\n        }\n        var key = getGroupKeysAndFields(rowObjs.indexOf(captionRow), rowObjs);\n        var pred = generateExpandPredicates(key.fields, key.keys, this);\n        var predicateList = getPredicates(pred);\n        pred = predicateList[predicateList.length - 1];\n        for (var i = predicateList.length - 2; i >= 0; i--) {\n          pred = pred.and(predicateList[parseInt(i.toString(), 10)]);\n        }\n        args.query.where(pred);\n        args.query.skip(childCount);\n        this.parentCapUid = this.empty;\n      } else {\n        var rows = gObj.getRows();\n        var size = gObj.pageSettings.pageSize;\n        var skip = getRowIndexFromElement(rows[rows.length - 1]) + 1;\n        var additionalCnt = skip - skip % size + size - skip;\n        if (skip % size === 0) {\n          additionalCnt = 0;\n        }\n        args.query.skip(skip);\n        args.query.take(gObj.infiniteScrollSettings.initialBlocks * gObj.pageSettings.pageSize + additionalCnt);\n      }\n    }\n  };\n  InfiniteScroll.prototype.captionActionComplete = function (args) {\n    var gObj = this.parent;\n    if (!gObj.infiniteScrollSettings.enableCache && args.isCollapse) {\n      var contetRect = gObj.getContent().firstElementChild.getBoundingClientRect();\n      var tableReact = gObj.contentModule.getTable().getBoundingClientRect();\n      if (Math.round(tableReact.bottom - gObj.getRowHeight()) <= Math.round(contetRect.bottom)) {\n        this.parentCapUid = args.parentUid;\n        this.groupCaptionAction = 'collapse';\n        gObj.showSpinner();\n        var caption = gObj.getRowObjectFromUID(args.parentUid);\n        var childCount = this.getCaptionChildCount(caption);\n        if (!childCount) {\n          this.groupCaptionAction = 'refresh';\n          this.makeGroupCollapseRequest();\n        } else {\n          this.makeGroupCollapseRequest(args.parentUid);\n        }\n      }\n    }\n  };\n  InfiniteScroll.prototype.makeGroupCollapseRequest = function (parentUid) {\n    var gObj = this.parent;\n    var captionRows = [].slice.call(gObj.getContentTable().querySelectorAll('tr'));\n    var rows = gObj.groupSettings.enableLazyLoading ? captionRows : gObj.getRows();\n    var index = !gObj.groupSettings.enableLazyLoading ? getRowIndexFromElement(rows[rows.length - 1]) : gObj.contentModule['visibleRows'].length - 1;\n    var prevPage = this.parent.pageSettings.currentPage;\n    var nextPage = Math.ceil(index / this.parent.pageSettings.pageSize) + 1;\n    if (prevPage >= this.maxPage || nextPage > this.maxPage) {\n      gObj.hideSpinner();\n      return;\n    }\n    this.parent.pageSettings.currentPage = nextPage;\n    var scrollArg = {\n      requestType: 'infiniteScroll',\n      currentPage: this.parent.pageSettings.currentPage,\n      prevPage: prevPage,\n      startIndex: index + 1,\n      direction: 'down',\n      isCaptionCollapse: true,\n      parentUid: parentUid\n    };\n    this.isGroupCollapse = true;\n    this.parent.notify('model-changed', scrollArg);\n  };\n  InfiniteScroll.prototype.getCaptionChildCount = function (caption) {\n    var rowObj = this.parent.getRowsObject();\n    var index = rowObj.indexOf(caption);\n    var make = false;\n    for (var i = index; i < rowObj.length; i++) {\n      if ((rowObj[parseInt(i.toString(), 10)].indent === caption.indent || rowObj[parseInt(i.toString(), 10)].indent < caption.indent) && rowObj[parseInt(i.toString(), 10)].data.key !== caption.data.key) {\n        break;\n      }\n      if (rowObj[parseInt(i.toString(), 10)].isCaptionRow && !this.childCheck(rowObj, rowObj[parseInt(i.toString(), 10)], i)) {\n        make = true;\n        break;\n      }\n    }\n    return make;\n  };\n  InfiniteScroll.prototype.childCheck = function (rowObj, row, index) {\n    var childCount = 0;\n    for (var i = index + 1; i < rowObj.length; i++) {\n      if (rowObj[parseInt(i.toString(), 10)].indent === row.indent) {\n        break;\n      }\n      if (rowObj[parseInt(i.toString(), 10)].indent === row.indent + 1 && rowObj[parseInt(i.toString(), 10)].parentUid === row.uid) {\n        childCount++;\n      }\n    }\n    return row.data.count === childCount;\n  };\n  InfiniteScroll.prototype.updateCurrentViewData = function () {\n    var gObj = this.parent;\n    if (gObj.groupSettings.columns.length) {\n      return;\n    }\n    var keys = Object.keys(this.infiniteCurrentViewData);\n    gObj.currentViewData = [];\n    var page = gObj.pageSettings.currentPage;\n    var isCache = gObj.infiniteScrollSettings.enableCache;\n    var blocks = gObj.infiniteScrollSettings.maxBlocks;\n    var isMiddlePage = isCache && (page > blocks || this.isUpScroll && page > 1);\n    var start = isMiddlePage ? this.isUpScroll ? page : page - blocks + 1 : 1;\n    var end = isMiddlePage ? start + blocks - 1 : isCache ? blocks : keys.length;\n    for (var i = start; i <= end; i++) {\n      if (this.infiniteCurrentViewData[parseInt(i.toString(), 10)]) {\n        gObj.currentViewData = gObj.currentViewData.concat(this.infiniteCurrentViewData[parseInt(i.toString(), 10)]);\n      }\n    }\n  };\n  InfiniteScroll.prototype.refreshInfiniteCurrentViewData = function (e) {\n    var gObj = this.parent;\n    var infiniteDetailModified = gObj.enableInfiniteScrolling && (gObj.childGrid || gObj.detailTemplate) && (e.args.action === 'add' && e.args.requestType === 'save' || e.args.requestType === 'delete');\n    if (e.args.action === 'add' && e.args.requestType === 'save' && !infiniteDetailModified) {\n      this.parent.pageSettings.currentPage = Math.ceil(e.args['index'] / this.parent.pageSettings.pageSize) ? Math.ceil(e.args['index'] / this.parent.pageSettings.pageSize) : 1;\n    }\n    var page = this.parent.pageSettings.currentPage;\n    var size = this.parent.pageSettings.pageSize;\n    var blocks = this.parent.infiniteScrollSettings.initialBlocks;\n    var keys = Object.keys(this.infiniteCurrentViewData);\n    var cache = this.parent.infiniteScrollSettings.enableCache;\n    if (!this.parent.groupSettings.columns.length) {\n      var isAdd = e.args.requestType === 'save' && !(this.parent.sortSettings.columns.length || this.parent.filterSettings.columns.length || this.parent.groupSettings.columns.length || this.parent.searchSettings.key);\n      var isDelete = e.args.requestType === 'delete';\n      if (!cache && (isAdd || isDelete) && !infiniteDetailModified) {\n        if (isAdd) {\n          var indexCount = 0;\n          for (var i = 1; i <= keys.length; i++) {\n            indexCount += this.infiniteCurrentViewData[parseInt(i.toString(), 10)].length - 1;\n            if (e.args.index <= indexCount) {\n              this.resetCurrentViewData(i);\n              this.infiniteCurrentViewData[parseInt(i.toString(), 10)].splice(e.args.index, 0, e.args.data);\n              break;\n            }\n          }\n        } else {\n          this.infiniteCurrentViewData[keys[keys.length - 1]].push(e.data[0]);\n        }\n      } else {\n        if (blocks > 1 && e.data.length === blocks * size) {\n          if (infiniteDetailModified) {\n            this.infiniteCurrentViewData = {};\n            this.firstBlock = 1;\n          }\n          this.setInitialCache(e.data.slice(), {}, cache && e.args.requestType === 'delete', true);\n        } else {\n          this.infiniteCurrentViewData[parseInt(page.toString(), 10)] = e.data.slice();\n        }\n      }\n    }\n  };\n  InfiniteScroll.prototype.resetCurrentViewData = function (startIndex) {\n    var keys = Object.keys(this.infiniteCurrentViewData);\n    for (var i = startIndex; i <= keys.length; i++) {\n      var lastViewData = this.infiniteCurrentViewData[parseInt(i.toString(), 10)][this.infiniteCurrentViewData[parseInt(i.toString(), 10)].length - 1];\n      if (this.infiniteCurrentViewData[i + 1]) {\n        this.infiniteCurrentViewData[i + 1].splice(0, 0, lastViewData);\n      }\n      this.infiniteCurrentViewData[parseInt(i.toString(), 10)].pop();\n    }\n  };\n  InfiniteScroll.prototype.modelChanged = function (args) {\n    var rows = this.parent.getRows();\n    if (args.requestType === 'save' && args.index && args.data) {\n      this.addRowIndex = args.index;\n    }\n    if (rows && rows.length && args.requestType !== 'infiniteScroll' && (args.requestType === 'delete' || this.requestType === 'add')) {\n      this.firstIndex = getRowIndexFromElement(rows[0]);\n      this.firstBlock = Math.ceil((this.firstIndex + 1) / this.parent.pageSettings.pageSize);\n      this.lastIndex = getRowIndexFromElement(rows[rows.length - 1]);\n      if (args.requestType === 'delete') {\n        var rowObj = this.parent.getRowsObject();\n        args.startIndex = this.parent.infiniteScrollSettings.enableCache ? (this.firstBlock - 1) * this.parent.pageSettings.pageSize : rowObj[rowObj.length - 1].index;\n      } else {\n        args.startIndex = this.firstIndex;\n      }\n      if (!this.parent.infiniteScrollSettings.enableCache && this.parent.pageSettings.currentPage === this.maxPage && args.requestType === 'delete') {\n        this.isLastPage = true;\n        this.lastIndex = this.lastIndex - 1;\n      }\n    }\n  };\n  InfiniteScroll.prototype.infiniteAddActionBegin = function (args) {\n    if (this.isNormaledit) {\n      this.isAdd = true;\n      if (this.parent.infiniteScrollSettings.enableCache) {\n        if (!Object.keys(this.emptyRowData).length) {\n          this.createEmptyRowdata();\n        }\n        if (this.parent.pageSettings.currentPage > 1) {\n          args.startEdit = false;\n          this.resetInfiniteBlocks({}, true);\n          this.makeRequest({\n            currentPage: 1\n          });\n        }\n      }\n    }\n  };\n  InfiniteScroll.prototype.infiniteEditHandler = function (args) {\n    if (!this.parent.infiniteScrollSettings.enableCache && (args.e.requestType === 'delete' || args.e.requestType === 'save' && this.requestType === 'add')) {\n      var rowElms = this.parent.getRows();\n      var rows = this.parent.getRowsObject();\n      if (this.ensureRowAvailability(rows, args.result[0])) {\n        if (rowElms.length && !(this.addRowIndex && this.addRowIndex >= rowElms.length)) {\n          this.resetRowIndex(rows, args.e, rowElms, this.requestType === 'add', true);\n        }\n        if (!this.isLastPage) {\n          this.createRow(rows, args);\n        } else {\n          this.isLastPage = false;\n          this.parent.pageSettings.currentPage = this.maxPage;\n          if (this.parent.selectionModule.index < this.parent.frozenRows) {\n            remove(rowElms[this.parent.frozenRows - 1]);\n            this.createRow([rows[this.parent.frozenRows - 1]], args, false, true);\n            setRowElements(this.parent);\n          }\n        }\n      }\n      this.parent.hideSpinner();\n      this.parent.notify(events.refreshInfinitePersistSelection, {});\n      if (this.requestType === 'delete') {\n        this.parent.notify(events.deleteComplete, args.e);\n      } else {\n        this.parent.notify(events.saveComplete, args.e);\n      }\n    }\n    this.parent.notify(events.freezeRender, {\n      case: 'refreshHeight'\n    });\n  };\n  InfiniteScroll.prototype.createRow = function (rows, args, isMovable, isFrozenRows, isFrozenRight) {\n    var row = !isFrozenRows ? this.generateRows(args.result, args.e) : rows;\n    var rowRenderer = new RowRenderer(this.serviceLocator, null, this.parent);\n    this.parent.removeMaskRow();\n    if (args.e.requestType === 'save' && args.e.index && args.e.data) {\n      row[0].index = this.addRowIndex;\n      this.addRowIndex = null;\n      if (row[0].index >= rows.length) {\n        return;\n      }\n    }\n    var tbody;\n    tbody = this.parent.getContent().querySelector(literals.tbody);\n    if (this.parent.frozenRows) {\n      tbody = isFrozenRows && this.requestType !== 'add' || !isFrozenRows && this.requestType === 'add' ? this.parent.getHeaderContent().querySelector(literals.tbody) : tbody;\n    }\n    var notifyArgs = {\n      rows: rows,\n      cancel: false,\n      args: args,\n      isMovable: isMovable,\n      isFrozenRows: isFrozenRows,\n      isFrozenRight: isFrozenRows,\n      row: row\n    };\n    this.parent.notify(events.infiniteCrudCancel, notifyArgs);\n    if (!notifyArgs.cancel) {\n      for (var i = row.length - 1; i >= 0; i--) {\n        if (this.requestType === 'delete') {\n          tbody.appendChild(rowRenderer.render(row[parseInt(i.toString(), 10)], this.parent.getColumns()));\n        } else {\n          tbody.insertBefore(rowRenderer.render(row[parseInt(i.toString(), 10)], this.parent.getColumns()), tbody.rows[args.e.index]);\n        }\n      }\n    }\n    if (!isFrozenRows && this.parent.frozenRows && (this.parent.selectionModule.index < this.parent.frozenRows || this.requestType === 'add')) {\n      var rowElems = this.parent.getRows();\n      var index = (isMovable || isFrozenRight) && this.requestType === 'add' ? this.parent.frozenRows : this.parent.frozenRows - 1;\n      remove(rowElems[parseInt(index.toString(), 10)]);\n      this.createRow([rows[this.parent.frozenRows - 1]], args, false, true, false);\n    }\n    if (!this.parent.infiniteScrollSettings.enableCache && !isFrozenRows) {\n      setRowElements(this.parent);\n      this.parent.contentModule.visibleRows = this.requestType === 'add' ? row.concat(rows) : rows.concat(row);\n    }\n  };\n  InfiniteScroll.prototype.ensureRowAvailability = function (rows, data) {\n    var resume = true;\n    if (this.parent.frozenRows && !this.parent.infiniteScrollSettings.enableCache && this.parent.sortSettings.columns && this.requestType === 'add') {\n      var key = this.parent.getPrimaryKeyFieldNames()[0];\n      for (var i = 0; i < rows.length; i++) {\n        if (rows[parseInt(i.toString(), 10)].data[\"\" + key] === data[\"\" + key]) {\n          resume = false;\n          break;\n        }\n      }\n    }\n    return resume;\n  };\n  InfiniteScroll.prototype.generateRows = function (data, args) {\n    return this.rowModelGenerator.generateRows(data, args);\n  };\n  InfiniteScroll.prototype.resetRowIndex = function (rows, args, rowElms, isAdd, isFrozen) {\n    var _this = this;\n    var keyField = this.parent.getPrimaryKeyFieldNames()[0];\n    var isRemove = !(rowElms.length % this.parent.pageSettings.pageSize);\n    if (isAdd) {\n      if (isRemove) {\n        if (isFrozen && !this.parent.groupSettings.columns.length) {\n          this.swapCurrentViewData(1, true);\n        }\n        remove(rowElms[rows.length - 1]);\n        rowElms.splice(rows.length - 1, 1);\n        rows.splice(rows.length - 1, 1);\n      }\n    } else {\n      rows.filter(function (e, index) {\n        if (e.data[\"\" + keyField] === args.data[0][\"\" + keyField]) {\n          if (isFrozen && !_this.parent.groupSettings.columns.length) {\n            var page = Math.ceil((index + 1) / _this.parent.pageSettings.pageSize);\n            _this.resetInfiniteCurrentViewData(page, index);\n          }\n          rows.splice(index, 1);\n          var rowElement = _this.parent.getRowElementByUID(e.uid);\n          if (rowElement) {\n            var rowElementIndex = rowElms.indexOf(rowElement);\n            remove(rowElement);\n            rowElms.splice(rowElementIndex, 1);\n          }\n        }\n      });\n    }\n    var startIndex = isAdd ? this.addRowIndex ? this.addRowIndex + 1 : 1 : 0;\n    resetRowIndex(this.parent, rows, rowElms, startIndex, this.addRowIndex ? this.addRowIndex : 0);\n  };\n  InfiniteScroll.prototype.resetInfiniteCurrentViewData = function (page, index) {\n    index = index - (page - 1) * this.parent.pageSettings.pageSize;\n    this.infiniteCurrentViewData[parseInt(page.toString(), 10)].splice(index, 1);\n    this.swapCurrentViewData(page, false);\n  };\n  InfiniteScroll.prototype.swapCurrentViewData = function (page, isAdd) {\n    var keys = Object.keys(this.infiniteCurrentViewData);\n    var end = isAdd ? keys.length + 1 : keys.length;\n    for (var i = page; i < end; i++) {\n      if (this.infiniteCurrentViewData[i + 1]) {\n        var pageIndex = isAdd ? i : i + 1;\n        var index = isAdd ? this.infiniteCurrentViewData[parseInt(i.toString(), 10)].length - 1 : 0;\n        var data = this.infiniteCurrentViewData[parseInt(pageIndex.toString(), 10)].splice(index, 1);\n        if (isAdd) {\n          this.infiniteCurrentViewData[i + 1] = data.concat(this.infiniteCurrentViewData[i + 1]);\n          if (i + 1 === end - 1) {\n            this.infiniteCurrentViewData[i + 1].splice(this.infiniteCurrentViewData[i + 1].length - 1, 1);\n          }\n        } else {\n          this.infiniteCurrentViewData[parseInt(i.toString(), 10)].push(data[0]);\n        }\n      }\n    }\n    this.updateCurrentViewData();\n  };\n  InfiniteScroll.prototype.setDisplayNone = function (args) {\n    if (this.parent.infiniteScrollSettings.enableCache) {\n      var keys = Object.keys(this.infiniteCache);\n      for (var i = 1; i <= keys.length; i++) {\n        var cache = this.infiniteCache[parseInt(i.toString(), 10)];\n        cache.filter(function (e) {\n          e.cells[args.index].visible = args.visible === '';\n        });\n      }\n      this.resetContentModuleCache(this.infiniteCache);\n    }\n  };\n  InfiniteScroll.prototype.refreshInfiniteCache = function (args) {\n    this.getEditedRowObject().data = args.data;\n  };\n  InfiniteScroll.prototype.refreshInfiniteCacheRowVisibleLength = function (args, currentPage) {\n    var cPageRowArray = args[parseInt(currentPage.toString(), 10)];\n    if (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) {\n      var length_1 = 0;\n      var vRowLen = 0;\n      var hRowLen = 0;\n      for (var i = 0; i < cPageRowArray.length; i++) {\n        if (cPageRowArray[parseInt(i.toString(), 10)].visible || isNullOrUndefined(cPageRowArray[parseInt(i.toString(), 10)].visible)) {\n          vRowLen++;\n        } else {\n          hRowLen++;\n        }\n      }\n      if (hRowLen > vRowLen) {\n        length_1 = hRowLen - vRowLen;\n        if (length_1 > vRowLen) {\n          length_1 = vRowLen;\n        }\n      } else {\n        length_1 = vRowLen - hRowLen;\n        if (length_1 > hRowLen) {\n          length_1 = hRowLen;\n        }\n      }\n      if (length_1 === 0) {\n        length_1 = 1;\n      }\n      return length_1;\n    } else {\n      return cPageRowArray.length;\n    }\n  };\n  InfiniteScroll.prototype.refreshInfiniteEditrowindex = function (args) {\n    this.editRowIndex = args.index;\n  };\n  InfiniteScroll.prototype.getEditedRowObject = function () {\n    var rowObjects = this.parent.getRowsObject();\n    var editedrow;\n    for (var i = 0; i < rowObjects.length; i++) {\n      if (rowObjects[parseInt(i.toString(), 10)].index === this.editRowIndex) {\n        editedrow = rowObjects[parseInt(i.toString(), 10)];\n      }\n    }\n    return editedrow;\n  };\n  InfiniteScroll.prototype.infiniteEditSuccess = function (args) {\n    if (this.isNormaledit) {\n      if (!this.isAdd && args.data) {\n        this.updateCurrentViewRecords(args.data);\n      }\n      this.isAdd = false || this.parent.editSettings.showAddNewRow;\n    }\n  };\n  InfiniteScroll.prototype.updateCurrentViewRecords = function (data) {\n    var index = getEditedDataIndex(this.parent, data);\n    if (!isNullOrUndefined(index)) {\n      this.parent.getCurrentViewRecords()[parseInt(index.toString(), 10)] = data;\n    }\n  };\n  InfiniteScroll.prototype.actionBegin = function (args) {\n    if (args.requestType === 'add' || args.requestType === 'delete') {\n      this.requestType = args.requestType;\n    } else if (args.action === 'add' && args.requestType === 'save') {\n      this.requestType = args.action;\n    }\n    if (this.parent.isFrozenGrid() && !args.cancel && args.requestType === 'searching' || args.requestType === 'sorting' || args.requestType === 'filtering') {\n      this.isInitialRender = true;\n    }\n  };\n  InfiniteScroll.prototype.actionComplete = function (args) {\n    if (args.requestType === 'delete' || args.requestType === 'save' || args.requestType === 'cancel') {\n      this.requestType = this.empty;\n      this.isCancel = args.requestType === 'cancel' || args.requestType === 'save';\n      this.isAdd = this.isEdit = false || this.parent.editSettings.showAddNewRow;\n      if (this.isNormaledit) {\n        this.editRowIndex = this.empty;\n        this.virtualInfiniteData = {};\n        this.parent.editModule.previousVirtualData = {};\n      }\n    }\n  };\n  /**\n   * The function used to trigger onActionComplete\n   *\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   * @hidden\n   */\n  InfiniteScroll.prototype.onActionComplete = function (e) {\n    var args = {\n      type: events.actionComplete\n    };\n    this.parent.trigger(events.actionComplete, extend(e, args));\n  };\n  InfiniteScroll.prototype.resetInfiniteEdit = function () {\n    if (this.parent.enableInfiniteScrolling && this.isNormaledit) {\n      if (this.parent.editSettings.allowEditing && this.isEdit || this.parent.editSettings.allowAdding && this.isAdd) {\n        this.parent.isEdit = true;\n      }\n    }\n  };\n  InfiniteScroll.prototype.getVirtualInfiniteData = function (data) {\n    this.getVirtualInfiniteEditedData();\n    data.virtualData = this.parent.enableColumnVirtualization && !this.parent.infiniteScrollSettings.enableCache ? data.virtualData : this.virtualInfiniteData;\n    data.isAdd = this.isAdd;\n    data.isCancel = this.isCancel;\n  };\n  InfiniteScroll.prototype.editActionBegin = function (e) {\n    this.isEdit = true;\n    this.editRowIndex = e.index;\n    var rowObject = extend({}, this.getEditedRowObject().data);\n    e.data = Object.keys(this.virtualInfiniteData).length ? this.virtualInfiniteData : rowObject;\n  };\n  InfiniteScroll.prototype.dataSourceModified = function () {\n    this.resetInfiniteBlocks({\n      requestType: this.empty\n    }, true);\n  };\n  InfiniteScroll.prototype.onDataReady = function (e) {\n    if (!isNullOrUndefined(e.count) && e.requestType !== 'infiniteScroll') {\n      this.maxPage = Math.ceil(e.count / this.parent.pageSettings.pageSize);\n    }\n  };\n  InfiniteScroll.prototype.ensureIntialCollapse = function (isExpand) {\n    this.isInitialCollapse = !isExpand;\n  };\n  InfiniteScroll.prototype.infiniteScrollHandler = function (e) {\n    if (this.infiniteDetailDestroy) {\n      return;\n    }\n    this.restoreInfiniteEdit();\n    this.restoreInfiniteAdd();\n    var targetEle = e.target;\n    var isInfinite = targetEle.classList.contains(literals.content);\n    var detailGrid = this.parent.childGrid || this.parent.detailTemplate ? true : false;\n    if (isInfinite && this.parent.enableInfiniteScrolling && !e.isLeft) {\n      var scrollEle = this.parent.getContent().firstElementChild;\n      var captionRows = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      this.prevScrollTop = scrollEle.scrollTop;\n      var rows = detailGrid ? this.parent.getRows().filter(function (row) {\n        return !row.classList.contains('e-detailrow');\n      }) : this.parent.groupSettings.enableLazyLoading ? captionRows : this.parent.getRows();\n      if (!rows.length) {\n        return;\n      }\n      var index = getRowIndexFromElement(rows[rows.length - 1]) + 1;\n      var prevPage = this.parent.pageSettings.currentPage;\n      var args = void 0;\n      var offset = targetEle.scrollHeight - targetEle.scrollTop;\n      var round = Math.round(targetEle.scrollHeight - targetEle.scrollTop);\n      var floor = offset < targetEle.clientHeight ? Math.ceil(offset) : Math.floor(offset);\n      var targetHeight = targetEle.clientHeight;\n      if (floor > targetHeight) {\n        floor = floor - 1;\n      } else if (targetHeight > floor) {\n        targetHeight = targetHeight - 1;\n      }\n      var isBottom = floor === targetHeight || round === targetHeight;\n      if (!isNullOrUndefined(this.groupCaptionAction)) {\n        return;\n      }\n      if (this.isScroll && isBottom && (this.parent.pageSettings.currentPage <= this.maxPage - 1 || this.enableContinuousScroll)) {\n        if (this.parent.infiniteScrollSettings.enableCache) {\n          this.isUpScroll = false;\n          this.isDownScroll = true;\n        }\n        var rows_1 = detailGrid ? this.getGridRows().filter(function (row) {\n          return row.classList.contains('e-row') && !row.classList.contains('e-addedrow');\n        }) : [].slice.call(scrollEle.querySelectorAll('.e-row:not(.e-addedrow)'));\n        var row = rows_1[rows_1.length - 1];\n        var rowIndex = !(this.parent.groupSettings.enableLazyLoading && this.parent.groupSettings.columns.length) ? getRowIndexFromElement(row) : this.parent.contentModule['visibleRows'].length - 1;\n        this.parent.pageSettings.currentPage = Math.ceil(rowIndex / this.parent.pageSettings.pageSize) + 1;\n        args = {\n          requestType: 'infiniteScroll',\n          currentPage: this.parent.pageSettings.currentPage,\n          prevPage: prevPage,\n          startIndex: index,\n          direction: 'down'\n        };\n        this.makeRequest(args);\n      }\n      if (this.isScroll && this.parent.infiniteScrollSettings.enableCache && targetEle.scrollTop === 0 && this.parent.pageSettings.currentPage !== 1) {\n        if (this.parent.infiniteScrollSettings.enableCache) {\n          this.isDownScroll = false;\n          this.isUpScroll = true;\n        }\n        var row = detailGrid ? this.getGridRows().filter(function (row) {\n          return row.classList.contains(literals.row);\n        }) : [].slice.call(scrollEle.getElementsByClassName(literals.row));\n        var rowIndex = getRowIndexFromElement(row[this.parent.pageSettings.pageSize - 1]);\n        var startIndex = getRowIndexFromElement(row[0]) - this.parent.pageSettings.pageSize;\n        this.parent.pageSettings.currentPage = Math.ceil(rowIndex / this.parent.pageSettings.pageSize) - 1;\n        if (this.parent.pageSettings.currentPage) {\n          args = {\n            requestType: 'infiniteScroll',\n            currentPage: this.parent.pageSettings.currentPage,\n            prevPage: prevPage,\n            startIndex: startIndex,\n            direction: 'up'\n          };\n          this.makeRequest(args);\n        }\n      }\n      if (this.parent.infiniteScrollSettings.enableCache && !this.isScroll && isNullOrUndefined(args)) {\n        if (this.isDownScroll || this.isUpScroll) {\n          scrollEle.scrollTop = this.top;\n        }\n      }\n    }\n  };\n  InfiniteScroll.prototype.makeRequest = function (args) {\n    var _this = this;\n    if (this.parent.pageSettings.currentPage !== args.prevPage) {\n      var initBlocks = this.parent.infiniteScrollSettings.initialBlocks;\n      if (initBlocks < this.maxPage && this.parent.pageSettings.currentPage <= this.maxPage) {\n        this.isInfiniteScroll = true;\n        if (isNullOrUndefined(this.infiniteCache[args.currentPage])) {\n          setTimeout(function () {\n            _this.getVirtualInfiniteEditedData();\n            _this.parent.notify('model-changed', args);\n          }, 100);\n        } else {\n          setTimeout(function () {\n            _this.getVirtualInfiniteEditedData();\n            _this.parent.notify(events.refreshInfiniteModeBlocks, args);\n          }, 100);\n        }\n      } else {\n        this.parent.pageSettings.currentPage = this.parent.groupSettings.enableLazyLoading && this.parent.groupSettings.columns.length && initBlocks >= this.maxPage ? 1 : this.maxPage;\n      }\n    }\n  };\n  InfiniteScroll.prototype.infinitePageQuery = function (query) {\n    if (this.initialRender || (this.requestType === 'add' || this.requestType === 'delete') && (this.parent.childGrid || this.parent.detailTemplate)) {\n      this.initialRender = false;\n      this.intialPageQuery(query);\n    } else {\n      if (this.requestType === 'delete' || this.requestType === 'add') {\n        if (!this.isInfiniteScroll && !this.parent.groupSettings.enableLazyLoading) {\n          this.editPageQuery(query);\n        } else if (this.parent.groupSettings.enableLazyLoading && !this.parent.infiniteScrollSettings.enableCache) {\n          if (this.parent.infiniteScrollSettings.initialBlocks < this.parent.pageSettings.currentPage) {\n            query.page(1, this.parent.pageSettings.pageSize * this.parent.pageSettings.currentPage);\n          } else {\n            query.page(1, this.parent.pageSettings.pageSize * this.parent.infiniteScrollSettings.initialBlocks);\n          }\n        } else {\n          query.page(this.parent.pageSettings.currentPage, this.parent.pageSettings.pageSize);\n        }\n      } else {\n        query.page(this.parent.pageSettings.currentPage, this.parent.pageSettings.pageSize);\n      }\n    }\n  };\n  InfiniteScroll.prototype.editPageQuery = function (query) {\n    var initialBlocks = this.parent.infiniteScrollSettings.initialBlocks;\n    var isCache = this.parent.infiniteScrollSettings.enableCache;\n    if (isCache) {\n      this.infiniteCache = {};\n      this.infiniteCurrentViewData = {};\n      query.skip(this.firstIndex);\n      query.take(initialBlocks * this.parent.pageSettings.pageSize);\n    } else {\n      if (this.parent.editSettings.mode === 'Dialog') {\n        this.parent.clearSelection();\n      }\n      var index = this.requestType === 'delete' ? this.lastIndex : this.addRowIndex ? this.addRowIndex : this.firstIndex;\n      query.skip(index);\n      if (!isNullOrUndefined(this.parent.getDataModule().dataManager.dataSource.url) && this.parent.getDataModule().dataManager.dataSource.url !== '' && (this.requestType === 'delete' || this.requestType === 'add')) {\n        query.take(initialBlocks * this.parent.pageSettings.pageSize);\n      } else {\n        query.take(1);\n      }\n    }\n  };\n  InfiniteScroll.prototype.intialPageQuery = function (query) {\n    if (this.parent.infiniteScrollSettings.enableCache && this.parent.infiniteScrollSettings.initialBlocks > this.parent.infiniteScrollSettings.maxBlocks) {\n      this.parent.infiniteScrollSettings.initialBlocks = this.parent.infiniteScrollSettings.maxBlocks;\n    }\n    var pageSize = this.parent.pageSettings.pageSize * this.parent.infiniteScrollSettings.initialBlocks;\n    query.page(1, pageSize);\n  };\n  InfiniteScroll.prototype.scrollToLastFocusedCell = function (e) {\n    var gObj = this.parent;\n    var rowIdx = this.lastFocusInfo.rowIdx + (e.keyArgs.action === literals.upArrow ? -1 : 1);\n    var cellIdx = this.lastFocusInfo.cellIdx;\n    var row = gObj.getRowByIndex(rowIdx);\n    if (!row) {\n      var rowRenderer = new RowRenderer(this.serviceLocator, null, this.parent);\n      var page = Math.floor(rowIdx / this.parent.pageSettings.pageSize) + 1;\n      gObj.pageSettings.currentPage = page;\n      var cols = gObj.getColumns();\n      remove(gObj.getContent().querySelector('tbody'));\n      gObj.getContent().querySelector('table').appendChild(gObj.createElement('tbody', {\n        attrs: {\n          'role': 'rowgroup'\n        }\n      }));\n      var focusRows = [];\n      // eslint-disable-next-line @typescript-eslint/tslint/config\n      for (var i = page === 1 || this.maxPage === page ? 0 : -1, k = 0; k < gObj.infiniteScrollSettings.maxBlocks; this.maxPage === page ? i-- : i++, k++) {\n        var rows = this.infiniteCache[page + i];\n        if (rows) {\n          focusRows = focusRows.concat(rows);\n          for (var j = 0; j < rows.length; j++) {\n            gObj.getContent().querySelector('tbody').appendChild(rowRenderer.render(rows[parseInt(j.toString(), 10)], cols));\n          }\n        }\n      }\n      gObj.notify(events.contentReady, {\n        rows: focusRows,\n        args: {}\n      });\n      setRowElements(gObj);\n    }\n    row = gObj.getRowByIndex(rowIdx);\n    var target = row.cells[parseInt(cellIdx.toString(), 10)];\n    gObj.focusModule.isInfiniteScroll = true;\n    gObj.focusModule.onClick({\n      target: target\n    }, true);\n    gObj.selectRow(rowIdx);\n    target.focus();\n    this.isFocusScroll = false;\n    e.cancel = true;\n  };\n  InfiniteScroll.prototype.setLastCellFocusInfo = function (e) {\n    var cell = e.byClick && e.clickArgs.target || e.byKey && e.keyArgs.target || (!this.isFocusScroll && e).target;\n    if (cell && cell.classList.contains('e-rowcell')) {\n      var cellIdx = parseInt(cell.getAttribute('aria-colindex'), 10) - 1;\n      var rowIdx = parseInt(cell.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n      this.lastFocusInfo = {\n        rowIdx: rowIdx,\n        cellIdx: cellIdx\n      };\n    }\n  };\n  InfiniteScroll.prototype.infiniteCellFocus = function (e) {\n    var gObj = this.parent;\n    var cache = gObj.infiniteScrollSettings.enableCache;\n    if (e.byKey) {\n      if (cache && this.isFocusScroll) {\n        this.scrollToLastFocusedCell(e);\n        return;\n      }\n      var cell = document.activeElement;\n      var rowIndex = getRowIndexFromElement(cell.parentElement);\n      this.cellIndex = parseInt(cell.getAttribute(literals.ariaColIndex), 10) - 1;\n      var content = gObj.getContent().firstElementChild;\n      var totalRowsCount = this.maxPage * gObj.pageSettings.pageSize - 1;\n      var visibleRowCount = Math.floor(content.offsetHeight / this.parent.getRowHeight());\n      var contentRect = content.getBoundingClientRect();\n      if (!isNaN(rowIndex)) {\n        if (e.keyArgs.action === literals.downArrow || e.keyArgs.action === literals.enter) {\n          this.rowIndex = rowIndex += 1;\n          var row = gObj.getRowByIndex(rowIndex);\n          var rowRect = row && row.getBoundingClientRect();\n          if (cache) {\n            rowIndex = cell.parentElement.rowIndex + 1;\n          }\n          if (this.isFocusScroll || !row && rowIndex < totalRowsCount || rowRect && rowRect.bottom >= contentRect.bottom) {\n            if (!this.isFocusScroll) {\n              this.pressedKey = e.keyArgs.action;\n            }\n            this.isFocusScroll = false;\n            content.scrollTop = (rowIndex - visibleRowCount + 1) * this.parent.getRowHeight();\n          } else if (!cache && row) {\n            if (rowRect && (rowRect.bottom >= contentRect.bottom || rowRect.top < contentRect.top)) {\n              row.cells[this.cellIndex].scrollIntoView();\n            }\n          }\n        } else if (e.keyArgs.action === literals.upArrow || e.keyArgs.action === literals.shiftEnter) {\n          this.rowIndex = rowIndex -= 1;\n          var row = gObj.getRowByIndex(rowIndex);\n          var rowRect = row && row.getBoundingClientRect();\n          if (cache) {\n            rowIndex = cell.parentElement.rowIndex - 1;\n          }\n          if (!row || rowRect.top <= contentRect.top) {\n            this.pressedKey = e.keyArgs.action;\n            content.scrollTop = rowIndex * this.parent.getRowHeight();\n          }\n        }\n      }\n    } else if (e.key === 'PageDown' || e.key === 'PageUp') {\n      this.pressedKey = e.key;\n    }\n    this.setLastCellFocusInfo(e);\n  };\n  InfiniteScroll.prototype.createEmptyRowdata = function () {\n    var _this = this;\n    this.parent.getColumns().filter(function (e) {\n      _this.emptyRowData[e.field] = _this.empty;\n    });\n  };\n  InfiniteScroll.prototype.getVirtualInfiniteEditedData = function () {\n    var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n    var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n    var gridForm = this.parent.element.querySelector('.e-gridform');\n    if (this.parent.infiniteScrollSettings.enableCache && (editForm || addForm)) {\n      var rowData = editForm ? extend({}, this.getEditedRowObject().data) : extend({}, this.emptyRowData);\n      this.virtualInfiniteData = this.parent.editModule.getCurrentEditedData(gridForm, rowData);\n      var hiddenColumn = this.parent.getHiddenColumns();\n      for (var i = 0; i < hiddenColumn.length; i++) {\n        if (hiddenColumn[parseInt(i.toString(), 10)].defaultValue) {\n          this.virtualInfiniteData[hiddenColumn[parseInt(i.toString(), 10)].field] = hiddenColumn[parseInt(i.toString(), 10)].defaultValue;\n        }\n      }\n    }\n  };\n  InfiniteScroll.prototype.restoreInfiniteEdit = function () {\n    var content = this.parent.getContent().firstElementChild;\n    var frozenEdit = this.parent.frozenRows ? this.editRowIndex >= this.parent.frozenRows : true;\n    if (this.isNormaledit && this.parent.infiniteScrollSettings.enableCache && frozenEdit) {\n      if (this.parent.editSettings.allowEditing && !isNullOrUndefined(this.editRowIndex)) {\n        var row = this.parent.getRowByIndex(this.editRowIndex);\n        if (Object.keys(this.virtualInfiniteData).length && row && !this.parent.getContent().querySelector('.' + literals.editedRow)) {\n          var top_1 = row.getBoundingClientRect().top;\n          if (top_1 < content.offsetHeight && top_1 > this.parent.getRowHeight()) {\n            this.parent.isEdit = false;\n            this.parent.editModule.startEdit(row);\n          }\n        }\n      }\n    }\n  };\n  InfiniteScroll.prototype.restoreInfiniteAdd = function () {\n    var content = this.parent.getContent().firstElementChild;\n    if (this.parent.getCurrentViewRecords().length && this.parent.getRowByIndex(0) && this.isNormaledit && this.parent.infiniteScrollSettings.enableCache && this.isAdd && !content.querySelector('.' + literals.addedRow)) {\n      var isTop = content.scrollTop < this.parent.getRowHeight();\n      if (isTop) {\n        this.parent.isEdit = false;\n        this.parent.addRecord();\n      }\n    }\n  };\n  InfiniteScroll.prototype.appendInfiniteRows = function (e) {\n    var gObj = this.parent;\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var isInfiniteScroll = this.parent.enableInfiniteScrolling && e.args.requestType === 'infiniteScroll';\n    var infiniteDetailModified = gObj.enableInfiniteScrolling && (gObj.childGrid || gObj.detailTemplate) && (e.args.action === 'add' && e.args.requestType === 'save' || e.args.requestType === 'delete');\n    if (infiniteDetailModified) {\n      scrollEle.scrollTop = 0;\n      gObj.pageSettings.currentPage = 1;\n    }\n    if ((this.parent.isAngular || this.parent.isReact || this.parent.isVue || this.parent.isVue3) && isInfiniteScroll && !e.args.isFrozen && this.parent.infiniteScrollSettings.enableCache) {\n      var isChildGrid = this.parent.childGrid && this.parent.element.querySelectorAll('.e-childgrid').length ? true : false;\n      var rows = this.parent.getDataRows();\n      this.parent.refreshReactTemplateTD(rows, isChildGrid);\n    }\n    if (isInfiniteScroll && !e.args.isFrozen || !isInfiniteScroll) {\n      if (isInfiniteScroll && e.args.direction === 'up') {\n        e.tbody.insertBefore(e.frag, e.tbody.firstElementChild);\n      } else {\n        e.tbody.appendChild(e.frag);\n      }\n    }\n    this.parent.contentModule.getTable().appendChild(e.tbody);\n    this.updateCurrentViewData();\n    if (this.isInitialRender && !e.args.isFrozen) {\n      this.isInitialRender = false;\n      this.parent.scrollModule.setHeight();\n    }\n    if (!e.args.isFrozen) {\n      this.rowTop = !this.rowTop ? this.parent.getRows()[0].getBoundingClientRect().top : this.rowTop;\n      if (isInfiniteScroll) {\n        if (this.parent.infiniteScrollSettings.enableCache && this.isRemove) {\n          scrollEle.scrollTop = this.top;\n        }\n        setRowElements(this.parent);\n      }\n      this.restoreInfiniteAdd();\n      this.isScroll = true;\n    }\n    this.isInfiniteScroll = false;\n    this.infiniteDetailDestroy = false;\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  InfiniteScroll.prototype.selectNewRow = function (args) {\n    var _this = this;\n    var gObj = this.parent;\n    var row = gObj.getRowByIndex(this.rowIndex);\n    var cache = gObj.infiniteScrollSettings.enableCache;\n    if (row && this.keys.some(function (value) {\n      return value === _this.pressedKey;\n    })) {\n      var content = gObj.getContent().firstElementChild;\n      var rowHeight = gObj.getRowHeight();\n      var target = row.cells[this.cellIndex];\n      if (this.pressedKey === literals.downArrow || this.pressedKey === literals.enter || cache && (this.pressedKey === literals.upArrow || this.pressedKey === literals.shiftEnter)) {\n        if (!cache && this.pressedKey !== literals.upArrow && this.pressedKey !== literals.shiftEnter) {\n          content.scrollTop = content.scrollTop + rowHeight;\n        }\n        gObj.focusModule.isInfiniteScroll = true;\n        gObj.focusModule.onClick({\n          target: target\n        }, true);\n        gObj.selectRow(this.rowIndex);\n      }\n    } else if (this.lastFocusInfo && (this.pressedKey === literals.pageDown || this.pressedKey === literals.pageUp)) {\n      var idx = cache ? 0 : this.lastFocusInfo.rowIdx;\n      if (gObj.getRowByIndex(idx)) {\n        var target = gObj.getCellFromIndex(idx, this.lastFocusInfo.cellIdx);\n        if (target) {\n          this.isFocusScroll = true;\n          if (!cache) {\n            gObj.focusModule.isInfiniteScroll = true;\n            gObj.focusModule.onClick({\n              target: target\n            }, true);\n          } else {\n            target.focus({\n              preventScroll: true\n            });\n          }\n        }\n      }\n    }\n    this.pressedKey = undefined;\n  };\n  InfiniteScroll.prototype.removeInfiniteCacheRows = function (e) {\n    var isInfiniteScroll = this.parent.enableInfiniteScrolling && e.args.requestType === 'infiniteScroll';\n    if (!e.args.isFrozen && isInfiniteScroll && this.parent.infiniteScrollSettings.enableCache && this.isRemove) {\n      var detailGrid = this.parent.childGrid || this.parent.detailTemplate ? true : false;\n      var rows = detailGrid ? this.getGridRows().filter(function (row) {\n        return row.classList.contains(literals.row);\n      }) : [].slice.call(this.parent.getContentTable().getElementsByClassName(literals.row));\n      if (e.args.direction === 'down') {\n        if (this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n          var captionRows = detailGrid ? this.getGridRows().filter(function (row) {\n            return !row.classList.contains('e-detailrow');\n          }) : [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n          this.removeCaptionRows(captionRows, e.args);\n        }\n        var addRowCount = this.parent.element.querySelector('.' + literals.addedRow) ? 0 : 1;\n        this.removeTopRows(rows, this.parent.pageSettings.pageSize - addRowCount);\n      }\n      if (e.args.direction === 'up') {\n        if (this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n          var captionRows = detailGrid ? this.getGridRows().filter(function (row) {\n            return !row.classList.contains('e-detailrow');\n          }) : [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n          this.removeCaptionRows(captionRows, e.args);\n        } else {\n          this.removeBottomRows(rows, rows.length - 1, e.args);\n        }\n      }\n      this.isScroll = false;\n      this.top = this.calculateScrollTop(e.args);\n    }\n  };\n  InfiniteScroll.prototype.calculateScrollTop = function (args) {\n    var top = 0;\n    var scrollCnt = this.parent.getContent().firstElementChild;\n    if (args.direction === 'down') {\n      if (this.parent.allowGrouping && this.parent.groupSettings.columns.length && !this.isInitialCollapse) {\n        top = this.captionRowHeight();\n      }\n      var captionRows = [].slice.call(this.parent.getContent().firstElementChild.querySelectorAll('tr:not(.e-row)'));\n      var captionCount = 0;\n      if (this.isInitialCollapse && !isNullOrUndefined(captionRows)) {\n        captionCount = Math.round((captionRows.length - 1) / this.parent.groupSettings.columns.length);\n      }\n      var value = captionCount ? captionCount : this.parent.pageSettings.pageSize * (this.parent.infiniteScrollSettings.maxBlocks - 1);\n      var currentViewRowCount = 0;\n      var i = 0;\n      while (currentViewRowCount < scrollCnt.clientHeight) {\n        i++;\n        currentViewRowCount = i * this.parent.getRowHeight();\n      }\n      i = i - 1;\n      top += (value - i) * this.parent.getRowHeight();\n    }\n    if (args.direction === 'up') {\n      if (this.parent.allowGrouping && this.parent.groupSettings.columns.length && !this.isInitialCollapse) {\n        var len = this.refreshInfiniteCacheRowVisibleLength(this.infiniteCache, this.parent.pageSettings.currentPage);\n        top = len * this.parent.getRowHeight();\n      } else if (this.isInitialCollapse) {\n        var groupedData = this.infiniteCache[this.parent.pageSettings.currentPage];\n        var count = 0;\n        for (var i = 0; i < groupedData.length; i++) {\n          if (groupedData[parseInt(i.toString(), 10)].isCaptionRow) {\n            count++;\n          }\n        }\n        top += Math.round(count / this.parent.groupSettings.columns.length) * this.parent.getRowHeight();\n      } else {\n        top += this.parent.pageSettings.pageSize * this.parent.getRowHeight() + getScrollBarWidth();\n      }\n    }\n    return top;\n  };\n  InfiniteScroll.prototype.captionRowHeight = function () {\n    var rows = [].slice.call(this.parent.getContent().querySelectorAll('tr:not(.e-row)'));\n    return rows.length * this.parent.getRowHeight();\n  };\n  InfiniteScroll.prototype.removeTopRows = function (rows, maxIndx) {\n    for (var i = 0; i <= maxIndx; i++) {\n      if (this.parent.frozenRows && this.parent.pageSettings.currentPage === this.parent.infiniteScrollSettings.maxBlocks + 1 && i > maxIndx - this.parent.frozenRows) {\n        continue;\n      }\n      remove(rows[parseInt(i.toString(), 10)]);\n    }\n  };\n  InfiniteScroll.prototype.removeBottomRows = function (rows, maxIndx, args) {\n    var cnt = 0;\n    var pageSize = this.parent.pageSettings.pageSize;\n    if (this.infiniteCache[args.prevPage].length < pageSize) {\n      cnt = this.parent.pageSettings.pageSize - this.infiniteCache[args.prevPage].length;\n    }\n    for (var i = maxIndx; cnt < pageSize; i--) {\n      cnt++;\n      remove(rows[parseInt(i.toString(), 10)]);\n    }\n  };\n  InfiniteScroll.prototype.removeCaptionRows = function (rows, args) {\n    var detailGrid = this.parent.childGrid || this.parent.detailTemplate ? true : false;\n    var rowElements = detailGrid ? this.getGridRows().filter(function (row) {\n      return row.classList.contains(literals.row);\n    }) : [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n    if (args.direction === 'down') {\n      var lastRow = rowElements[this.parent.pageSettings.pageSize - 1];\n      var lastRowIndex = getRowIndexFromElement(lastRow) - 1;\n      var k = 0;\n      for (var i = 0; k < lastRowIndex; i++) {\n        if (!rows[parseInt(i.toString(), 10)].classList.contains(literals.row)) {\n          remove(rows[parseInt(i.toString(), 10)]);\n        } else {\n          k = getRowIndexFromElement(rows[parseInt(i.toString(), 10)]);\n        }\n      }\n    }\n    if (args.direction === 'up') {\n      var lastIndex = getRowIndexFromElement(rowElements[rowElements.length - 1]);\n      var page = Math.ceil(lastIndex / this.parent.pageSettings.pageSize);\n      var startIndex = 0;\n      for (var i = this.parent.pageSettings.currentPage + 1; i < page; i++) {\n        startIndex += detailGrid ? this.infiniteCache[parseInt(i.toString(), 10)].filter(function (row) {\n          return !row.isDetailRow;\n        }).length : this.infiniteCache[parseInt(i.toString(), 10)].length;\n      }\n      for (var i = startIndex; i < rows.length; i++) {\n        remove(rows[parseInt(i.toString(), 10)]);\n      }\n    }\n  };\n  InfiniteScroll.prototype.getGridRows = function () {\n    return [].slice.call(this.parent.getContentTable().rows);\n  };\n  InfiniteScroll.prototype.resetInfiniteBlocks = function (args, isDataModified) {\n    var isInfiniteScroll = this.parent.enableInfiniteScrolling && args.requestType !== 'infiniteScroll';\n    if (!this.initialRender && !isNullOrUndefined(this.parent.infiniteScrollModule) && isInfiniteScroll) {\n      if (this.actions.some(function (value) {\n        return value === args.requestType;\n      }) || isDataModified || args.requestType === 'save' && (this.parent.sortSettings.columns.length || this.parent.filterSettings.columns.length || this.parent.groupSettings.columns.length || this.parent.searchSettings.key)) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        this.parent.notify(events.detachDetailTemplate, {});\n        this.initialRender = true;\n        scrollEle.scrollTop = 0;\n        this.parent.pageSettings.currentPage = 1;\n        this.infiniteCache = {};\n        this.infiniteCurrentViewData = {};\n        this.resetContentModuleCache({});\n        this.isRemove = false;\n        this.top = 0;\n        this.isInitialCollapse = false;\n        this.parent.contentModule.isRemove = this.isRemove;\n        this.parent.contentModule.isAddRows = this.isRemove;\n        this.parent.contentModule.visibleRows = [];\n        this.parent.contentModule.visibleFrozenRows = [];\n      }\n    }\n  };\n  InfiniteScroll.prototype.setCache = function (e) {\n    if (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) {\n      var gObj = this.parent;\n      var infiniteDetailModified = (gObj.childGrid || gObj.detailTemplate) && (e.args.action === 'add' && e.args.requestType === 'save' || e.args.requestType === 'delete');\n      var isEdit = e.args.requestType !== 'infiniteScroll' && (this.requestType === 'delete' || this.requestType === 'add');\n      var currentPage = this.parent.pageSettings.currentPage;\n      if (!Object.keys(this.infiniteCache).length || isEdit) {\n        if (infiniteDetailModified) {\n          this.infiniteCache = {};\n        }\n        this.setInitialCache(e.modelData, e.args, isEdit);\n      }\n      if (isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage]) && !infiniteDetailModified) {\n        this.infiniteCache[this.parent.pageSettings.currentPage] = e.modelData;\n        this.resetContentModuleCache(this.infiniteCache);\n      }\n      if (e.isInfiniteScroll && !this.isRemove) {\n        this.isRemove = (currentPage - 1) % this.parent.infiniteScrollSettings.maxBlocks === 0;\n        this.parent.contentModule.isRemove = this.isRemove;\n      }\n    }\n  };\n  InfiniteScroll.prototype.setInitialCache = function (data, args, isEdit, isCurrentViewData) {\n    var k = !isEdit ? 1 : isNullOrUndefined(this.firstBlock) ? 1 : this.firstBlock;\n    for (var i = 1; i <= this.parent.infiniteScrollSettings.initialBlocks; i++) {\n      var startIndex = (i - 1) * this.parent.pageSettings.pageSize;\n      var endIndex = i * this.parent.pageSettings.pageSize;\n      if (this.parent.allowGrouping && this.parent.groupSettings.columns.length && !isCurrentViewData) {\n        this.setInitialGroupCache(data, k, startIndex, endIndex);\n      } else {\n        if (isCurrentViewData) {\n          this.infiniteCurrentViewData[parseInt(k.toString(), 10)] = data.slice(startIndex, endIndex);\n        } else {\n          this.infiniteCache[parseInt(k.toString(), 10)] = data.slice(startIndex, endIndex);\n          this.resetContentModuleCache(this.infiniteCache);\n        }\n      }\n      k++;\n    }\n  };\n  InfiniteScroll.prototype.setInitialGroupCache = function (data, index, sIndex, eIndex) {\n    var pageData = [];\n    var startIndex = 0;\n    for (var i = 1; i <= Object.keys(this.infiniteCache).length; i++) {\n      startIndex += this.infiniteCache[parseInt(i.toString(), 10)].length;\n    }\n    var k = sIndex;\n    for (var i = startIndex; i < data.length && k < eIndex; i++) {\n      if (data[parseInt(i.toString(), 10)].index < eIndex || data[parseInt(i.toString(), 10)].isCaptionRow) {\n        k = data[parseInt(i.toString(), 10)].isCaptionRow ? k : data[parseInt(i.toString(), 10)].index;\n        pageData.push(data[parseInt(i.toString(), 10)]);\n      }\n      if (data[parseInt(i.toString(), 10)].index >= eIndex || data[parseInt(i.toString(), 10)].index === eIndex - 1) {\n        break;\n      }\n    }\n    this.infiniteCache[parseInt(index.toString(), 10)] = pageData;\n    this.resetContentModuleCache(this.infiniteCache);\n  };\n  InfiniteScroll.prototype.resetContentModuleCache = function (data) {\n    this.parent.contentModule.infiniteCache = data;\n  };\n  /**\n   * @param {Row<Column>[]} rowObjects - Defines the grid's row objects\n   * @returns {void}\n   * @hidden\n   */\n  InfiniteScroll.prototype.resetInfiniteCache = function (rowObjects) {\n    var blockLength = Object.keys(this.infiniteCache).length;\n    this.infiniteCache = {};\n    for (var i = 1; i <= blockLength; i++) {\n      var startIndex = (i - 1) * this.parent.pageSettings.pageSize;\n      var endIndex = i * this.parent.pageSettings.pageSize;\n      if (this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n        this.setInitialGroupCache(rowObjects, i, startIndex, endIndex);\n      } else {\n        this.infiniteCache[parseInt(i.toString(), 10)] = rowObjects.slice(startIndex, endIndex);\n        this.resetContentModuleCache(this.infiniteCache);\n      }\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  InfiniteScroll.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n  return InfiniteScroll;\n}();\nexport { InfiniteScroll };","map":{"version":3,"names":["isNullOrUndefined","remove","extend","RowModelGenerator","RowRenderer","events","getScrollBarWidth","getEditedDataIndex","resetRowIndex","setRowElements","getRowIndexFromElement","getGroupKeysAndFields","getPredicates","generateExpandPredicates","literals","InfiniteScroll","parent","serviceLocator","infiniteCache","infiniteCurrentViewData","isDownScroll","isUpScroll","isScroll","enableContinuousScroll","initialRender","isRemove","isInitialCollapse","prevScrollTop","actions","keys","downArrow","upArrow","enter","shiftEnter","rowTop","virtualInfiniteData","isCancel","emptyRowData","isNormaledit","isInfiniteScroll","isLastPage","isInitialRender","isFocusScroll","isGroupCollapse","infiniteDetailDestroy","editSettings","mode","addEventListener","widthService","getService","rowModelGenerator","prototype","getModuleName","on","dataReady","onDataReady","dataSourceModified","infinitePageQuery","infiniteScrollHandler","beforeCellFocused","infiniteCellFocus","appendInfiniteContent","appendInfiniteRows","removeInfiniteRows","removeInfiniteCacheRows","resetInfiniteBlocks","setInfiniteCache","setCache","initialCollapse","ensureIntialCollapse","keyPressed","infiniteShowHide","setDisplayNone","virtualScrollEditActionBegin","editActionBegin","getVirtualData","getVirtualInfiniteData","editReset","resetInfiniteEdit","virtualScrollEditSuccess","infiniteEditSuccess","refreshVirtualCache","refreshInfiniteCache","refreshInfiniteEditrowindex","infiniteEditHandler","virtualScrollAddActionBegin","infiniteAddActionBegin","modelChanged","refreshInfiniteCurrentViewData","destroy","contentReady","selectNewRow","captionActionComplete","setVirtualPageQuery","setGroupCollapsePageQuery","infiniteScrollComplete","onActionComplete","actionBeginFunction","actionBegin","bind","actionCompleteFunction","actionComplete","dataBoundFunction","dataBound","removeEventListener","isDestroyed","off","groupCaptionAction","makeGroupCollapseRequest","hideSpinner","empty","args","gObj","infiniteScrollSettings","enableCache","skipPage","captionRow","getRowObjectFromUID","parentCapUid","rowObjs","getRowsObject","childCount","i","length","parseInt","toString","indent","isDataRow","key","indexOf","pred","fields","predicateList","and","query","where","skip","rows","getRows","size","pageSettings","pageSize","additionalCnt","take","initialBlocks","isCollapse","contetRect","getContent","firstElementChild","getBoundingClientRect","tableReact","contentModule","getTable","Math","round","bottom","getRowHeight","parentUid","showSpinner","caption","getCaptionChildCount","captionRows","slice","call","getContentTable","querySelectorAll","groupSettings","enableLazyLoading","index","prevPage","currentPage","nextPage","ceil","maxPage","scrollArg","requestType","startIndex","direction","isCaptionCollapse","notify","rowObj","make","data","isCaptionRow","childCheck","row","uid","count","updateCurrentViewData","columns","Object","currentViewData","page","isCache","blocks","maxBlocks","isMiddlePage","start","end","concat","e","infiniteDetailModified","enableInfiniteScrolling","childGrid","detailTemplate","action","cache","isAdd","sortSettings","filterSettings","searchSettings","isDelete","indexCount","resetCurrentViewData","splice","push","firstBlock","setInitialCache","lastViewData","pop","addRowIndex","firstIndex","lastIndex","createEmptyRowdata","startEdit","makeRequest","rowElms","ensureRowAvailability","result","createRow","selectionModule","frozenRows","refreshInfinitePersistSelection","deleteComplete","saveComplete","freezeRender","case","isMovable","isFrozenRows","isFrozenRight","generateRows","rowRenderer","removeMaskRow","tbody","querySelector","getHeaderContent","notifyArgs","cancel","infiniteCrudCancel","appendChild","render","getColumns","insertBefore","rowElems","visibleRows","resume","getPrimaryKeyFieldNames","isFrozen","_this","keyField","swapCurrentViewData","filter","resetInfiniteCurrentViewData","rowElement","getRowElementByUID","rowElementIndex","pageIndex","cells","visible","resetContentModuleCache","getEditedRowObject","refreshInfiniteCacheRowVisibleLength","cPageRowArray","length_1","vRowLen","hRowLen","editRowIndex","rowObjects","editedrow","updateCurrentViewRecords","showAddNewRow","getCurrentViewRecords","isFrozenGrid","isEdit","editModule","previousVirtualData","type","trigger","allowEditing","allowAdding","getVirtualInfiniteEditedData","virtualData","enableColumnVirtualization","rowObject","isExpand","restoreInfiniteEdit","restoreInfiniteAdd","targetEle","target","isInfinite","classList","contains","content","detailGrid","isLeft","scrollEle","scrollTop","offset","scrollHeight","floor","clientHeight","targetHeight","isBottom","rows_1","getGridRows","rowIndex","getElementsByClassName","top","initBlocks","setTimeout","refreshInfiniteModeBlocks","intialPageQuery","editPageQuery","clearSelection","getDataModule","dataManager","dataSource","url","scrollToLastFocusedCell","rowIdx","lastFocusInfo","keyArgs","cellIdx","getRowByIndex","cols","createElement","attrs","focusRows","k","j","focusModule","onClick","selectRow","focus","setLastCellFocusInfo","cell","byClick","clickArgs","byKey","getAttribute","parentElement","document","activeElement","cellIndex","ariaColIndex","totalRowsCount","visibleRowCount","offsetHeight","contentRect","isNaN","rowRect","pressedKey","scrollIntoView","field","editForm","element","editedRow","addForm","addedRow","gridForm","rowData","getCurrentEditedData","hiddenColumn","getHiddenColumns","defaultValue","frozenEdit","top_1","isTop","addRecord","isAngular","isReact","isVue","isVue3","isChildGrid","getDataRows","refreshReactTemplateTD","frag","scrollModule","setHeight","some","value","rowHeight","pageDown","pageUp","idx","getCellFromIndex","preventScroll","undefined","allowGrouping","removeCaptionRows","addRowCount","removeTopRows","removeBottomRows","calculateScrollTop","scrollCnt","captionRowHeight","captionCount","currentViewRowCount","len","groupedData","maxIndx","cnt","rowElements","lastRow","lastRowIndex","isDetailRow","isDataModified","infiniteScrollModule","detachDetailTemplate","isAddRows","visibleFrozenRows","modelData","isCurrentViewData","endIndex","setInitialGroupCache","sIndex","eIndex","pageData","resetInfiniteCache","blockLength"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-grids/src/grid/actions/infinite-scroll.js"],"sourcesContent":["import { isNullOrUndefined, remove, extend } from '@syncfusion/ej2-base';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport * as events from '../base/constant';\nimport { getScrollBarWidth, getEditedDataIndex, resetRowIndex, setRowElements, getRowIndexFromElement, getGroupKeysAndFields, getPredicates, generateExpandPredicates } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * Infinite Scrolling class\n *\n * @hidden\n */\nvar InfiniteScroll = /** @class */ (function () {\n    /**\n     * Constructor for the Grid infinite scrolling.\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} serviceLocator - specifies the ServiceLocator\n     * @hidden\n     */\n    function InfiniteScroll(parent, serviceLocator) {\n        this.infiniteCache = {};\n        this.infiniteCurrentViewData = {};\n        this.isDownScroll = false;\n        this.isUpScroll = false;\n        this.isScroll = true;\n        this.enableContinuousScroll = false;\n        this.initialRender = true;\n        this.isRemove = false;\n        this.isInitialCollapse = false;\n        this.prevScrollTop = 0;\n        this.actions = ['filtering', 'searching', 'grouping', 'ungrouping', 'reorder', 'sorting', 'refresh'];\n        this.keys = [literals.downArrow, literals.upArrow, literals.enter, literals.shiftEnter];\n        this.rowTop = 0;\n        this.virtualInfiniteData = {};\n        this.isCancel = false;\n        this.emptyRowData = {};\n        this.isNormaledit = false;\n        this.isInfiniteScroll = false;\n        this.isLastPage = false;\n        this.isInitialRender = true;\n        this.isFocusScroll = false;\n        this.isGroupCollapse = false;\n        /** @hidden */\n        this.infiniteDetailDestroy = false;\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.isNormaledit = this.parent.editSettings.mode === 'Normal';\n        this.addEventListener();\n        this.widthService = serviceLocator.getService('widthService');\n        this.rowModelGenerator = new RowModelGenerator(this.parent);\n    }\n    InfiniteScroll.prototype.getModuleName = function () {\n        return 'infiniteScroll';\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    InfiniteScroll.prototype.addEventListener = function () {\n        this.parent.on(events.dataReady, this.onDataReady, this);\n        this.parent.on(events.dataSourceModified, this.dataSourceModified, this);\n        this.parent.on(events.infinitePageQuery, this.infinitePageQuery, this);\n        this.parent.on(events.infiniteScrollHandler, this.infiniteScrollHandler, this);\n        this.parent.on(events.beforeCellFocused, this.infiniteCellFocus, this);\n        this.parent.on(events.appendInfiniteContent, this.appendInfiniteRows, this);\n        this.parent.on(events.removeInfiniteRows, this.removeInfiniteCacheRows, this);\n        this.parent.on(events.resetInfiniteBlocks, this.resetInfiniteBlocks, this);\n        this.parent.on(events.setInfiniteCache, this.setCache, this);\n        this.parent.on(events.initialCollapse, this.ensureIntialCollapse, this);\n        this.parent.on(events.keyPressed, this.infiniteCellFocus, this);\n        this.parent.on(events.infiniteShowHide, this.setDisplayNone, this);\n        this.parent.on(events.virtualScrollEditActionBegin, this.editActionBegin, this);\n        this.parent.on(events.getVirtualData, this.getVirtualInfiniteData, this);\n        this.parent.on(events.editReset, this.resetInfiniteEdit, this);\n        this.parent.on(events.virtualScrollEditSuccess, this.infiniteEditSuccess, this);\n        this.parent.on(events.refreshVirtualCache, this.refreshInfiniteCache, this);\n        this.parent.on(events.refreshInfiniteEditrowindex, this.refreshInfiniteEditrowindex, this);\n        this.parent.on(events.infiniteEditHandler, this.infiniteEditHandler, this);\n        this.parent.on(events.virtualScrollAddActionBegin, this.infiniteAddActionBegin, this);\n        this.parent.on(events.modelChanged, this.modelChanged, this);\n        this.parent.on(events.refreshInfiniteCurrentViewData, this.refreshInfiniteCurrentViewData, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.contentReady, this.selectNewRow, this);\n        this.parent.on(events.captionActionComplete, this.captionActionComplete, this);\n        this.parent.on(events.setVirtualPageQuery, this.setGroupCollapsePageQuery, this);\n        this.parent.on(events.infiniteScrollComplete, this.onActionComplete, this);\n        this.actionBeginFunction = this.actionBegin.bind(this);\n        this.actionCompleteFunction = this.actionComplete.bind(this);\n        this.dataBoundFunction = this.dataBound.bind(this);\n        this.parent.addEventListener(events.actionBegin, this.actionBeginFunction);\n        this.parent.addEventListener(events.actionComplete, this.actionCompleteFunction);\n        this.parent.addEventListener(events.dataBound, this.dataBoundFunction);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    InfiniteScroll.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.dataReady, this.onDataReady);\n        this.parent.off(events.dataSourceModified, this.dataSourceModified);\n        this.parent.off(events.infinitePageQuery, this.infinitePageQuery);\n        this.parent.off(events.infiniteScrollHandler, this.infiniteScrollHandler);\n        this.parent.off(events.beforeCellFocused, this.infiniteCellFocus);\n        this.parent.off(events.appendInfiniteContent, this.appendInfiniteRows);\n        this.parent.off(events.removeInfiniteRows, this.removeInfiniteCacheRows);\n        this.parent.off(events.resetInfiniteBlocks, this.resetInfiniteBlocks);\n        this.parent.off(events.setInfiniteCache, this.setCache);\n        this.parent.off(events.initialCollapse, this.ensureIntialCollapse);\n        this.parent.off(events.keyPressed, this.infiniteCellFocus);\n        this.parent.off(events.infiniteShowHide, this.setDisplayNone);\n        this.parent.off(events.virtualScrollEditActionBegin, this.editActionBegin);\n        this.parent.off(events.getVirtualData, this.getVirtualInfiniteData);\n        this.parent.off(events.editReset, this.resetInfiniteEdit);\n        this.parent.off(events.virtualScrollEditSuccess, this.infiniteEditSuccess);\n        this.parent.off(events.refreshVirtualCache, this.refreshInfiniteCache);\n        this.parent.on(events.refreshInfiniteEditrowindex, this.refreshInfiniteEditrowindex);\n        this.parent.off(events.infiniteEditHandler, this.infiniteEditHandler);\n        this.parent.off(events.virtualScrollAddActionBegin, this.infiniteAddActionBegin);\n        this.parent.off(events.modelChanged, this.modelChanged);\n        this.parent.off(events.refreshInfiniteCurrentViewData, this.refreshInfiniteCurrentViewData);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.contentReady, this.selectNewRow);\n        this.parent.off(events.captionActionComplete, this.captionActionComplete);\n        this.parent.off(events.setVirtualPageQuery, this.setGroupCollapsePageQuery);\n        this.parent.off(events.infiniteScrollComplete, this.onActionComplete);\n        this.parent.removeEventListener(events.actionBegin, this.actionBeginFunction);\n        this.parent.removeEventListener(events.actionComplete, this.actionCompleteFunction);\n        this.parent.removeEventListener(events.dataBound, this.dataBoundFunction);\n    };\n    InfiniteScroll.prototype.dataBound = function () {\n        if (this.groupCaptionAction === 'collapse') {\n            this.groupCaptionAction = 'refresh';\n            this.makeGroupCollapseRequest();\n        }\n        else if (this.groupCaptionAction === 'refresh') {\n            this.parent.hideSpinner();\n            this.groupCaptionAction = this.empty;\n        }\n    };\n    InfiniteScroll.prototype.setGroupCollapsePageQuery = function (args) {\n        var gObj = this.parent;\n        if (!gObj.infiniteScrollSettings.enableCache && this.isGroupCollapse) {\n            args.skipPage = true;\n            this.isGroupCollapse = false;\n            if (this.groupCaptionAction === 'collapse') {\n                var captionRow = gObj.getRowObjectFromUID(this.parentCapUid);\n                var rowObjs = gObj.getRowsObject();\n                var childCount = 0;\n                for (var i = rowObjs.length - 1; i >= 0; i--) {\n                    if (rowObjs[parseInt(i.toString(), 10)].indent === captionRow.indent) {\n                        break;\n                    }\n                    if (rowObjs[parseInt(i.toString(), 10)].isDataRow) {\n                        childCount++;\n                    }\n                }\n                var key = getGroupKeysAndFields(rowObjs.indexOf(captionRow), rowObjs);\n                var pred = generateExpandPredicates(key.fields, key.keys, this);\n                var predicateList = getPredicates(pred);\n                pred = predicateList[predicateList.length - 1];\n                for (var i = predicateList.length - 2; i >= 0; i--) {\n                    pred = pred.and(predicateList[parseInt(i.toString(), 10)]);\n                }\n                args.query.where(pred);\n                args.query.skip(childCount);\n                this.parentCapUid = this.empty;\n            }\n            else {\n                var rows = gObj.getRows();\n                var size = gObj.pageSettings.pageSize;\n                var skip = getRowIndexFromElement(rows[rows.length - 1]) + 1;\n                var additionalCnt = ((skip - (skip % size)) + size) - skip;\n                if ((skip % size) === 0) {\n                    additionalCnt = 0;\n                }\n                args.query.skip(skip);\n                args.query.take((gObj.infiniteScrollSettings.initialBlocks * gObj.pageSettings.pageSize) + additionalCnt);\n            }\n        }\n    };\n    InfiniteScroll.prototype.captionActionComplete = function (args) {\n        var gObj = this.parent;\n        if (!gObj.infiniteScrollSettings.enableCache && args.isCollapse) {\n            var contetRect = gObj.getContent().firstElementChild.getBoundingClientRect();\n            var tableReact = gObj.contentModule.getTable().getBoundingClientRect();\n            if (Math.round(tableReact.bottom - gObj.getRowHeight()) <= Math.round(contetRect.bottom)) {\n                this.parentCapUid = args.parentUid;\n                this.groupCaptionAction = 'collapse';\n                gObj.showSpinner();\n                var caption = gObj.getRowObjectFromUID(args.parentUid);\n                var childCount = this.getCaptionChildCount(caption);\n                if (!childCount) {\n                    this.groupCaptionAction = 'refresh';\n                    this.makeGroupCollapseRequest();\n                }\n                else {\n                    this.makeGroupCollapseRequest(args.parentUid);\n                }\n            }\n        }\n    };\n    InfiniteScroll.prototype.makeGroupCollapseRequest = function (parentUid) {\n        var gObj = this.parent;\n        var captionRows = [].slice.call(gObj.getContentTable().querySelectorAll('tr'));\n        var rows = gObj.groupSettings.enableLazyLoading ? captionRows : gObj.getRows();\n        var index = !gObj.groupSettings.enableLazyLoading ? getRowIndexFromElement(rows[rows.length - 1]) :\n            gObj.contentModule['visibleRows'].length - 1;\n        var prevPage = this.parent.pageSettings.currentPage;\n        var nextPage = Math.ceil(index / this.parent.pageSettings.pageSize) + 1;\n        if ((prevPage >= this.maxPage) || (nextPage > this.maxPage)) {\n            gObj.hideSpinner();\n            return;\n        }\n        this.parent.pageSettings.currentPage = nextPage;\n        var scrollArg = {\n            requestType: 'infiniteScroll',\n            currentPage: this.parent.pageSettings.currentPage,\n            prevPage: prevPage,\n            startIndex: index + 1,\n            direction: 'down',\n            isCaptionCollapse: true,\n            parentUid: parentUid\n        };\n        this.isGroupCollapse = true;\n        this.parent.notify('model-changed', scrollArg);\n    };\n    InfiniteScroll.prototype.getCaptionChildCount = function (caption) {\n        var rowObj = this.parent.getRowsObject();\n        var index = rowObj.indexOf(caption);\n        var make = false;\n        for (var i = index; i < rowObj.length; i++) {\n            if ((rowObj[parseInt(i.toString(), 10)].indent === caption.indent || rowObj[parseInt(i.toString(), 10)].indent < caption.indent)\n                && rowObj[parseInt(i.toString(), 10)].data.key !== caption.data.key) {\n                break;\n            }\n            if (rowObj[parseInt(i.toString(), 10)].isCaptionRow && !this.childCheck(rowObj, rowObj[parseInt(i.toString(), 10)], i)) {\n                make = true;\n                break;\n            }\n        }\n        return make;\n    };\n    InfiniteScroll.prototype.childCheck = function (rowObj, row, index) {\n        var childCount = 0;\n        for (var i = index + 1; i < rowObj.length; i++) {\n            if (rowObj[parseInt(i.toString(), 10)].indent === row.indent) {\n                break;\n            }\n            if (rowObj[parseInt(i.toString(), 10)].indent === (row.indent + 1)\n                && rowObj[parseInt(i.toString(), 10)].parentUid === row.uid) {\n                childCount++;\n            }\n        }\n        return row.data.count === childCount;\n    };\n    InfiniteScroll.prototype.updateCurrentViewData = function () {\n        var gObj = this.parent;\n        if (gObj.groupSettings.columns.length) {\n            return;\n        }\n        var keys = Object.keys(this.infiniteCurrentViewData);\n        gObj.currentViewData = [];\n        var page = gObj.pageSettings.currentPage;\n        var isCache = gObj.infiniteScrollSettings.enableCache;\n        var blocks = gObj.infiniteScrollSettings.maxBlocks;\n        var isMiddlePage = isCache && (page > blocks || (this.isUpScroll && page > 1));\n        var start = isMiddlePage ? this.isUpScroll ? page : (page - blocks) + 1 : 1;\n        var end = isMiddlePage ? (start + blocks) - 1 : isCache ? blocks : keys.length;\n        for (var i = start; i <= end; i++) {\n            if (this.infiniteCurrentViewData[parseInt(i.toString(), 10)]) {\n                gObj.currentViewData = gObj.currentViewData.concat(this.infiniteCurrentViewData[parseInt(i.toString(), 10)]);\n            }\n        }\n    };\n    InfiniteScroll.prototype.refreshInfiniteCurrentViewData = function (e) {\n        var gObj = this.parent;\n        var infiniteDetailModified = gObj.enableInfiniteScrolling && (gObj.childGrid || gObj.detailTemplate)\n            && ((e.args.action === 'add' && e.args.requestType === 'save') || e.args.requestType === 'delete');\n        if (e.args.action === 'add' && e.args.requestType === 'save' && !infiniteDetailModified) {\n            this.parent.pageSettings.currentPage = Math.ceil(e.args['index'] / this.parent.pageSettings.pageSize) ?\n                Math.ceil(e.args['index'] / this.parent.pageSettings.pageSize) : 1;\n        }\n        var page = this.parent.pageSettings.currentPage;\n        var size = this.parent.pageSettings.pageSize;\n        var blocks = this.parent.infiniteScrollSettings.initialBlocks;\n        var keys = Object.keys(this.infiniteCurrentViewData);\n        var cache = this.parent.infiniteScrollSettings.enableCache;\n        if (!this.parent.groupSettings.columns.length) {\n            var isAdd = e.args.requestType === 'save' && !(this.parent.sortSettings.columns.length\n                || this.parent.filterSettings.columns.length || this.parent.groupSettings.columns.length\n                || this.parent.searchSettings.key);\n            var isDelete = e.args.requestType === 'delete';\n            if (!cache && (isAdd || isDelete) && !infiniteDetailModified) {\n                if (isAdd) {\n                    var indexCount = 0;\n                    for (var i = 1; i <= keys.length; i++) {\n                        indexCount += this.infiniteCurrentViewData[parseInt(i.toString(), 10)].length - 1;\n                        if (e.args.index <= indexCount) {\n                            this.resetCurrentViewData(i);\n                            this.infiniteCurrentViewData[parseInt(i.toString(), 10)]\n                                .splice(e.args.index, 0, e.args.data);\n                            break;\n                        }\n                    }\n                }\n                else {\n                    this.infiniteCurrentViewData[keys[keys.length - 1]].push(e.data[0]);\n                }\n            }\n            else {\n                if (blocks > 1 && e.data.length === (blocks * size)) {\n                    if (infiniteDetailModified) {\n                        this.infiniteCurrentViewData = {};\n                        this.firstBlock = 1;\n                    }\n                    this.setInitialCache(e.data.slice(), {}, cache && e.args.requestType === 'delete', true);\n                }\n                else {\n                    this.infiniteCurrentViewData[parseInt(page.toString(), 10)] = e.data.slice();\n                }\n            }\n        }\n    };\n    InfiniteScroll.prototype.resetCurrentViewData = function (startIndex) {\n        var keys = Object.keys(this.infiniteCurrentViewData);\n        for (var i = startIndex; i <= keys.length; i++) {\n            var lastViewData = this.infiniteCurrentViewData[parseInt(i.toString(), 10)][this\n                .infiniteCurrentViewData[parseInt(i.toString(), 10)].length - 1];\n            if (this.infiniteCurrentViewData[i + 1]) {\n                this.infiniteCurrentViewData[i + 1].splice(0, 0, lastViewData);\n            }\n            this.infiniteCurrentViewData[parseInt(i.toString(), 10)].pop();\n        }\n    };\n    InfiniteScroll.prototype.modelChanged = function (args) {\n        var rows = this.parent.getRows();\n        if (args.requestType === 'save' && args.index && args.data) {\n            this.addRowIndex = args.index;\n        }\n        if (rows && rows.length && args.requestType !== 'infiniteScroll' && (args.requestType === 'delete' || this.requestType === 'add')) {\n            this.firstIndex = getRowIndexFromElement(rows[0]);\n            this.firstBlock = Math.ceil((this.firstIndex + 1) / this.parent.pageSettings.pageSize);\n            this.lastIndex = getRowIndexFromElement(rows[rows.length - 1]);\n            if (args.requestType === 'delete') {\n                var rowObj = this.parent.getRowsObject();\n                args.startIndex = this.parent.infiniteScrollSettings.enableCache\n                    ? (this.firstBlock - 1) * this.parent.pageSettings.pageSize : rowObj[rowObj.length - 1].index;\n            }\n            else {\n                args.startIndex = this.firstIndex;\n            }\n            if (!this.parent.infiniteScrollSettings.enableCache\n                && this.parent.pageSettings.currentPage === this.maxPage && args.requestType === 'delete') {\n                this.isLastPage = true;\n                this.lastIndex = this.lastIndex - 1;\n            }\n        }\n    };\n    InfiniteScroll.prototype.infiniteAddActionBegin = function (args) {\n        if (this.isNormaledit) {\n            this.isAdd = true;\n            if (this.parent.infiniteScrollSettings.enableCache) {\n                if (!Object.keys(this.emptyRowData).length) {\n                    this.createEmptyRowdata();\n                }\n                if (this.parent.pageSettings.currentPage > 1) {\n                    args.startEdit = false;\n                    this.resetInfiniteBlocks({}, true);\n                    this.makeRequest({ currentPage: 1 });\n                }\n            }\n        }\n    };\n    InfiniteScroll.prototype.infiniteEditHandler = function (args) {\n        if (!this.parent.infiniteScrollSettings.enableCache && (args.e.requestType === 'delete'\n            || (args.e.requestType === 'save' && this.requestType === 'add'))) {\n            var rowElms = this.parent.getRows();\n            var rows = this.parent.getRowsObject();\n            if (this.ensureRowAvailability(rows, args.result[0])) {\n                if (rowElms.length && !(this.addRowIndex && this.addRowIndex >= rowElms.length)) {\n                    this.resetRowIndex(rows, args.e, rowElms, this.requestType === 'add', true);\n                }\n                if (!this.isLastPage) {\n                    this.createRow(rows, args);\n                }\n                else {\n                    this.isLastPage = false;\n                    this.parent.pageSettings.currentPage = this.maxPage;\n                    if (this.parent.selectionModule.index < this.parent.frozenRows) {\n                        remove(rowElms[this.parent.frozenRows - 1]);\n                        this.createRow([rows[this.parent.frozenRows - 1]], args, false, true);\n                        setRowElements(this.parent);\n                    }\n                }\n            }\n            this.parent.hideSpinner();\n            this.parent.notify(events.refreshInfinitePersistSelection, {});\n            if (this.requestType === 'delete') {\n                this.parent.notify(events.deleteComplete, args.e);\n            }\n            else {\n                this.parent.notify(events.saveComplete, args.e);\n            }\n        }\n        this.parent.notify(events.freezeRender, { case: 'refreshHeight' });\n    };\n    InfiniteScroll.prototype.createRow = function (rows, args, isMovable, isFrozenRows, isFrozenRight) {\n        var row = !isFrozenRows ? this.generateRows(args.result, args.e) : rows;\n        var rowRenderer = new RowRenderer(this.serviceLocator, null, this.parent);\n        this.parent.removeMaskRow();\n        if (args.e.requestType === 'save' && args.e.index && args.e.data) {\n            row[0].index = this.addRowIndex;\n            this.addRowIndex = null;\n            if (row[0].index >= rows.length) {\n                return;\n            }\n        }\n        var tbody;\n        tbody = this.parent.getContent().querySelector(literals.tbody);\n        if (this.parent.frozenRows) {\n            tbody = isFrozenRows && this.requestType !== 'add' || !isFrozenRows && this.requestType === 'add'\n                ? this.parent.getHeaderContent().querySelector(literals.tbody) : tbody;\n        }\n        var notifyArgs = {\n            rows: rows, cancel: false, args: args, isMovable: isMovable,\n            isFrozenRows: isFrozenRows, isFrozenRight: isFrozenRows, row: row\n        };\n        this.parent.notify(events.infiniteCrudCancel, notifyArgs);\n        if (!notifyArgs.cancel) {\n            for (var i = row.length - 1; i >= 0; i--) {\n                if (this.requestType === 'delete') {\n                    tbody.appendChild(rowRenderer.render(row[parseInt(i.toString(), 10)], this.parent.getColumns()));\n                }\n                else {\n                    tbody.insertBefore(rowRenderer.render(row[parseInt(i.toString(), 10)], this.parent.getColumns()), tbody.rows[(args.e.index)]);\n                }\n            }\n        }\n        if (!isFrozenRows && this.parent.frozenRows\n            && (this.parent.selectionModule.index < this.parent.frozenRows || this.requestType === 'add')) {\n            var rowElems = this.parent.getRows();\n            var index = (isMovable || isFrozenRight) && this.requestType === 'add'\n                ? this.parent.frozenRows : this.parent.frozenRows - 1;\n            remove(rowElems[parseInt(index.toString(), 10)]);\n            this.createRow([rows[this.parent.frozenRows - 1]], args, false, true, false);\n        }\n        if (!this.parent.infiniteScrollSettings.enableCache && !isFrozenRows) {\n            setRowElements(this.parent);\n            this.parent.contentModule.visibleRows = this.requestType === 'add'\n                ? row.concat(rows) : rows.concat(row);\n        }\n    };\n    InfiniteScroll.prototype.ensureRowAvailability = function (rows, data) {\n        var resume = true;\n        if (this.parent.frozenRows && !this.parent.infiniteScrollSettings.enableCache\n            && this.parent.sortSettings.columns && this.requestType === 'add') {\n            var key = this.parent.getPrimaryKeyFieldNames()[0];\n            for (var i = 0; i < rows.length; i++) {\n                if (rows[parseInt(i.toString(), 10)].data[\"\" + key] === data[\"\" + key]) {\n                    resume = false;\n                    break;\n                }\n            }\n        }\n        return resume;\n    };\n    InfiniteScroll.prototype.generateRows = function (data, args) {\n        return this.rowModelGenerator.generateRows(data, args);\n    };\n    InfiniteScroll.prototype.resetRowIndex = function (rows, args, rowElms, isAdd, isFrozen) {\n        var _this = this;\n        var keyField = this.parent.getPrimaryKeyFieldNames()[0];\n        var isRemove = !(rowElms.length % this.parent.pageSettings.pageSize);\n        if (isAdd) {\n            if (isRemove) {\n                if (isFrozen && !this.parent.groupSettings.columns.length) {\n                    this.swapCurrentViewData(1, true);\n                }\n                remove(rowElms[rows.length - 1]);\n                rowElms.splice(rows.length - 1, 1);\n                rows.splice(rows.length - 1, 1);\n            }\n        }\n        else {\n            rows.filter(function (e, index) {\n                if (e.data[\"\" + keyField] === args.data[0][\"\" + keyField]) {\n                    if (isFrozen && !_this.parent.groupSettings.columns.length) {\n                        var page = Math.ceil((index + 1) / _this.parent.pageSettings.pageSize);\n                        _this.resetInfiniteCurrentViewData(page, index);\n                    }\n                    rows.splice(index, 1);\n                    var rowElement = _this.parent.getRowElementByUID(e.uid);\n                    if (rowElement) {\n                        var rowElementIndex = rowElms.indexOf(rowElement);\n                        remove(rowElement);\n                        rowElms.splice(rowElementIndex, 1);\n                    }\n                }\n            });\n        }\n        var startIndex = isAdd ? this.addRowIndex ? this.addRowIndex + 1 : 1 : 0;\n        resetRowIndex(this.parent, rows, rowElms, startIndex, this.addRowIndex ? this.addRowIndex : 0);\n    };\n    InfiniteScroll.prototype.resetInfiniteCurrentViewData = function (page, index) {\n        index = index - ((page - 1) * this.parent.pageSettings.pageSize);\n        this.infiniteCurrentViewData[parseInt(page.toString(), 10)].splice(index, 1);\n        this.swapCurrentViewData(page, false);\n    };\n    InfiniteScroll.prototype.swapCurrentViewData = function (page, isAdd) {\n        var keys = Object.keys(this.infiniteCurrentViewData);\n        var end = isAdd ? keys.length + 1 : keys.length;\n        for (var i = page; i < end; i++) {\n            if (this.infiniteCurrentViewData[i + 1]) {\n                var pageIndex = isAdd ? i : i + 1;\n                var index = isAdd ? this.infiniteCurrentViewData[parseInt(i.toString(), 10)].length - 1 : 0;\n                var data = this.infiniteCurrentViewData[parseInt(pageIndex.toString(), 10)].splice(index, 1);\n                if (isAdd) {\n                    this.infiniteCurrentViewData[i + 1] = data.concat(this.infiniteCurrentViewData[i + 1]);\n                    if ((i + 1) === end - 1) {\n                        this.infiniteCurrentViewData[i + 1].splice(this.infiniteCurrentViewData[i + 1].length - 1, 1);\n                    }\n                }\n                else {\n                    this.infiniteCurrentViewData[parseInt(i.toString(), 10)].push(data[0]);\n                }\n            }\n        }\n        this.updateCurrentViewData();\n    };\n    InfiniteScroll.prototype.setDisplayNone = function (args) {\n        if (this.parent.infiniteScrollSettings.enableCache) {\n            var keys = Object.keys(this.infiniteCache);\n            for (var i = 1; i <= keys.length; i++) {\n                var cache = this.infiniteCache[parseInt(i.toString(), 10)];\n                cache.filter(function (e) {\n                    e.cells[args.index].visible = args.visible === '';\n                });\n            }\n            this.resetContentModuleCache(this.infiniteCache);\n        }\n    };\n    InfiniteScroll.prototype.refreshInfiniteCache = function (args) {\n        this.getEditedRowObject().data = args.data;\n    };\n    InfiniteScroll.prototype.refreshInfiniteCacheRowVisibleLength = function (args, currentPage) {\n        var cPageRowArray = args[parseInt(currentPage.toString(), 10)];\n        if (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) {\n            var length_1 = 0;\n            var vRowLen = 0;\n            var hRowLen = 0;\n            for (var i = 0; i < cPageRowArray.length; i++) {\n                if (cPageRowArray[parseInt(i.toString(), 10)].visible\n                    || isNullOrUndefined(cPageRowArray[parseInt(i.toString(), 10)].visible)) {\n                    vRowLen++;\n                }\n                else {\n                    hRowLen++;\n                }\n            }\n            if (hRowLen > vRowLen) {\n                length_1 = hRowLen - vRowLen;\n                if (length_1 > vRowLen) {\n                    length_1 = vRowLen;\n                }\n            }\n            else {\n                length_1 = vRowLen - hRowLen;\n                if (length_1 > hRowLen) {\n                    length_1 = hRowLen;\n                }\n            }\n            if (length_1 === 0) {\n                length_1 = 1;\n            }\n            return length_1;\n        }\n        else {\n            return cPageRowArray.length;\n        }\n    };\n    InfiniteScroll.prototype.refreshInfiniteEditrowindex = function (args) {\n        this.editRowIndex = args.index;\n    };\n    InfiniteScroll.prototype.getEditedRowObject = function () {\n        var rowObjects = this.parent.getRowsObject();\n        var editedrow;\n        for (var i = 0; i < rowObjects.length; i++) {\n            if (rowObjects[parseInt(i.toString(), 10)].index === this.editRowIndex) {\n                editedrow = rowObjects[parseInt(i.toString(), 10)];\n            }\n        }\n        return editedrow;\n    };\n    InfiniteScroll.prototype.infiniteEditSuccess = function (args) {\n        if (this.isNormaledit) {\n            if (!this.isAdd && args.data) {\n                this.updateCurrentViewRecords(args.data);\n            }\n            this.isAdd = false || this.parent.editSettings.showAddNewRow;\n        }\n    };\n    InfiniteScroll.prototype.updateCurrentViewRecords = function (data) {\n        var index = getEditedDataIndex(this.parent, data);\n        if (!isNullOrUndefined(index)) {\n            this.parent.getCurrentViewRecords()[parseInt(index.toString(), 10)] = data;\n        }\n    };\n    InfiniteScroll.prototype.actionBegin = function (args) {\n        if (args.requestType === 'add' || args.requestType === 'delete') {\n            this.requestType = args.requestType;\n        }\n        else if (args.action === 'add' && args.requestType === 'save') {\n            this.requestType = args.action;\n        }\n        if (this.parent.isFrozenGrid() && !args.cancel && args.requestType === 'searching'\n            || args.requestType === 'sorting' || args.requestType === 'filtering') {\n            this.isInitialRender = true;\n        }\n    };\n    InfiniteScroll.prototype.actionComplete = function (args) {\n        if (args.requestType === 'delete' || args.requestType === 'save' || args.requestType === 'cancel') {\n            this.requestType = this.empty;\n            this.isCancel = args.requestType === 'cancel' || args.requestType === 'save';\n            this.isAdd = this.isEdit = false || this.parent.editSettings.showAddNewRow;\n            if (this.isNormaledit) {\n                this.editRowIndex = this.empty;\n                this.virtualInfiniteData = {};\n                this.parent.editModule.previousVirtualData = {};\n            }\n        }\n    };\n    /**\n     * The function used to trigger onActionComplete\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    InfiniteScroll.prototype.onActionComplete = function (e) {\n        var args = { type: events.actionComplete };\n        this.parent.trigger(events.actionComplete, extend(e, args));\n    };\n    InfiniteScroll.prototype.resetInfiniteEdit = function () {\n        if (this.parent.enableInfiniteScrolling && this.isNormaledit) {\n            if ((this.parent.editSettings.allowEditing && this.isEdit) || (this.parent.editSettings.allowAdding && this.isAdd)) {\n                this.parent.isEdit = true;\n            }\n        }\n    };\n    InfiniteScroll.prototype.getVirtualInfiniteData = function (data) {\n        this.getVirtualInfiniteEditedData();\n        data.virtualData = this.parent.enableColumnVirtualization && !this.parent.infiniteScrollSettings.enableCache ? data.virtualData\n            : this.virtualInfiniteData;\n        data.isAdd = this.isAdd;\n        data.isCancel = this.isCancel;\n    };\n    InfiniteScroll.prototype.editActionBegin = function (e) {\n        this.isEdit = true;\n        this.editRowIndex = e.index;\n        var rowObject = extend({}, this.getEditedRowObject().data);\n        e.data = Object.keys(this.virtualInfiniteData).length ? this.virtualInfiniteData : rowObject;\n    };\n    InfiniteScroll.prototype.dataSourceModified = function () {\n        this.resetInfiniteBlocks({ requestType: this.empty }, true);\n    };\n    InfiniteScroll.prototype.onDataReady = function (e) {\n        if (!isNullOrUndefined(e.count) && e.requestType !== 'infiniteScroll') {\n            this.maxPage = Math.ceil(e.count / this.parent.pageSettings.pageSize);\n        }\n    };\n    InfiniteScroll.prototype.ensureIntialCollapse = function (isExpand) {\n        this.isInitialCollapse = !isExpand;\n    };\n    InfiniteScroll.prototype.infiniteScrollHandler = function (e) {\n        if (this.infiniteDetailDestroy) {\n            return;\n        }\n        this.restoreInfiniteEdit();\n        this.restoreInfiniteAdd();\n        var targetEle = e.target;\n        var isInfinite = targetEle.classList.contains(literals.content);\n        var detailGrid = this.parent.childGrid || this.parent.detailTemplate ? true : false;\n        if (isInfinite && this.parent.enableInfiniteScrolling && !e.isLeft) {\n            var scrollEle = this.parent.getContent().firstElementChild;\n            var captionRows = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n            this.prevScrollTop = scrollEle.scrollTop;\n            var rows = detailGrid ? this.parent.getRows().filter(function (row) { return !row.classList.contains('e-detailrow'); })\n                : this.parent.groupSettings.enableLazyLoading ? captionRows : this.parent.getRows();\n            if (!rows.length) {\n                return;\n            }\n            var index = getRowIndexFromElement(rows[rows.length - 1]) + 1;\n            var prevPage = this.parent.pageSettings.currentPage;\n            var args = void 0;\n            var offset = targetEle.scrollHeight - targetEle.scrollTop;\n            var round = Math.round(targetEle.scrollHeight - targetEle.scrollTop);\n            var floor = offset < targetEle.clientHeight ? Math.ceil(offset) : Math.floor(offset);\n            var targetHeight = targetEle.clientHeight;\n            if (floor > targetHeight) {\n                floor = floor - 1;\n            }\n            else if (targetHeight > floor) {\n                targetHeight = targetHeight - 1;\n            }\n            var isBottom = (floor === targetHeight || round === targetHeight);\n            if (!isNullOrUndefined(this.groupCaptionAction)) {\n                return;\n            }\n            if (this.isScroll && isBottom && (this.parent.pageSettings.currentPage <= this.maxPage - 1 || this.enableContinuousScroll)) {\n                if (this.parent.infiniteScrollSettings.enableCache) {\n                    this.isUpScroll = false;\n                    this.isDownScroll = true;\n                }\n                var rows_1 = detailGrid ? this.getGridRows().filter(function (row) { return row.classList.contains('e-row')\n                    && !row.classList.contains('e-addedrow'); }) : [].slice.call(scrollEle.querySelectorAll('.e-row:not(.e-addedrow)'));\n                var row = rows_1[rows_1.length - 1];\n                var rowIndex = !(this.parent.groupSettings.enableLazyLoading && this.parent.groupSettings.columns.length)\n                    ? getRowIndexFromElement(row) : this.parent.contentModule['visibleRows'].length - 1;\n                this.parent.pageSettings.currentPage = Math.ceil(rowIndex / this.parent.pageSettings.pageSize) + 1;\n                args = {\n                    requestType: 'infiniteScroll',\n                    currentPage: this.parent.pageSettings.currentPage,\n                    prevPage: prevPage,\n                    startIndex: index,\n                    direction: 'down'\n                };\n                this.makeRequest(args);\n            }\n            if (this.isScroll && this.parent.infiniteScrollSettings.enableCache && targetEle.scrollTop === 0\n                && this.parent.pageSettings.currentPage !== 1) {\n                if (this.parent.infiniteScrollSettings.enableCache) {\n                    this.isDownScroll = false;\n                    this.isUpScroll = true;\n                }\n                var row = detailGrid ? this.getGridRows().filter(function (row) { return row.classList.contains(literals.row); })\n                    : [].slice.call(scrollEle.getElementsByClassName(literals.row));\n                var rowIndex = getRowIndexFromElement(row[this.parent.pageSettings.pageSize - 1]);\n                var startIndex = getRowIndexFromElement(row[0]) - this.parent.pageSettings.pageSize;\n                this.parent.pageSettings.currentPage = Math.ceil(rowIndex / this.parent.pageSettings.pageSize) - 1;\n                if (this.parent.pageSettings.currentPage) {\n                    args = {\n                        requestType: 'infiniteScroll',\n                        currentPage: this.parent.pageSettings.currentPage,\n                        prevPage: prevPage,\n                        startIndex: startIndex,\n                        direction: 'up'\n                    };\n                    this.makeRequest(args);\n                }\n            }\n            if (this.parent.infiniteScrollSettings.enableCache && !this.isScroll && isNullOrUndefined(args)) {\n                if (this.isDownScroll || this.isUpScroll) {\n                    scrollEle.scrollTop = this.top;\n                }\n            }\n        }\n    };\n    InfiniteScroll.prototype.makeRequest = function (args) {\n        var _this = this;\n        if (this.parent.pageSettings.currentPage !== args.prevPage) {\n            var initBlocks = this.parent.infiniteScrollSettings.initialBlocks;\n            if (initBlocks < this.maxPage && this.parent.pageSettings.currentPage <= this.maxPage) {\n                this.isInfiniteScroll = true;\n                if (isNullOrUndefined(this.infiniteCache[args.currentPage])) {\n                    setTimeout(function () {\n                        _this.getVirtualInfiniteEditedData();\n                        _this.parent.notify('model-changed', args);\n                    }, 100);\n                }\n                else {\n                    setTimeout(function () {\n                        _this.getVirtualInfiniteEditedData();\n                        _this.parent.notify(events.refreshInfiniteModeBlocks, args);\n                    }, 100);\n                }\n            }\n            else {\n                this.parent.pageSettings.currentPage = this.parent.groupSettings.enableLazyLoading\n                    && this.parent.groupSettings.columns.length && initBlocks >= this.maxPage ? 1 : this.maxPage;\n            }\n        }\n    };\n    InfiniteScroll.prototype.infinitePageQuery = function (query) {\n        if (this.initialRender || ((this.requestType === 'add' || this.requestType === 'delete')\n            && (this.parent.childGrid || this.parent.detailTemplate))) {\n            this.initialRender = false;\n            this.intialPageQuery(query);\n        }\n        else {\n            if ((this.requestType === 'delete' || this.requestType === 'add')) {\n                if (!this.isInfiniteScroll && !this.parent.groupSettings.enableLazyLoading) {\n                    this.editPageQuery(query);\n                }\n                else if (this.parent.groupSettings.enableLazyLoading && !this.parent.infiniteScrollSettings.enableCache) {\n                    if (this.parent.infiniteScrollSettings.initialBlocks < this.parent.pageSettings.currentPage) {\n                        query.page(1, this.parent.pageSettings.pageSize * this.parent.pageSettings.currentPage);\n                    }\n                    else {\n                        query.page(1, this.parent.pageSettings.pageSize * this.parent.infiniteScrollSettings.initialBlocks);\n                    }\n                }\n                else {\n                    query.page(this.parent.pageSettings.currentPage, this.parent.pageSettings.pageSize);\n                }\n            }\n            else {\n                query.page(this.parent.pageSettings.currentPage, this.parent.pageSettings.pageSize);\n            }\n        }\n    };\n    InfiniteScroll.prototype.editPageQuery = function (query) {\n        var initialBlocks = this.parent.infiniteScrollSettings.initialBlocks;\n        var isCache = this.parent.infiniteScrollSettings.enableCache;\n        if (isCache) {\n            this.infiniteCache = {};\n            this.infiniteCurrentViewData = {};\n            query.skip(this.firstIndex);\n            query.take(initialBlocks * this.parent.pageSettings.pageSize);\n        }\n        else {\n            if (this.parent.editSettings.mode === 'Dialog') {\n                this.parent.clearSelection();\n            }\n            var index = this.requestType === 'delete' ? this.lastIndex : this.addRowIndex ? this.addRowIndex : this.firstIndex;\n            query.skip(index);\n            if (!isNullOrUndefined(this.parent.getDataModule().dataManager.dataSource.url) &&\n                this.parent.getDataModule().dataManager.dataSource.url !== '' && (this.requestType === 'delete' ||\n                this.requestType === 'add')) {\n                query.take(initialBlocks * this.parent.pageSettings.pageSize);\n            }\n            else {\n                query.take(1);\n            }\n        }\n    };\n    InfiniteScroll.prototype.intialPageQuery = function (query) {\n        if (this.parent.infiniteScrollSettings.enableCache\n            && this.parent.infiniteScrollSettings.initialBlocks > this.parent.infiniteScrollSettings.maxBlocks) {\n            this.parent.infiniteScrollSettings.initialBlocks = this.parent.infiniteScrollSettings.maxBlocks;\n        }\n        var pageSize = this.parent.pageSettings.pageSize * this.parent.infiniteScrollSettings.initialBlocks;\n        query.page(1, pageSize);\n    };\n    InfiniteScroll.prototype.scrollToLastFocusedCell = function (e) {\n        var gObj = this.parent;\n        var rowIdx = this.lastFocusInfo.rowIdx + (e.keyArgs.action === literals.upArrow ? -1 : 1);\n        var cellIdx = this.lastFocusInfo.cellIdx;\n        var row = gObj.getRowByIndex(rowIdx);\n        if (!row) {\n            var rowRenderer = new RowRenderer(this.serviceLocator, null, this.parent);\n            var page = Math.floor(rowIdx / this.parent.pageSettings.pageSize) + 1;\n            gObj.pageSettings.currentPage = page;\n            var cols = gObj.getColumns();\n            remove(gObj.getContent().querySelector('tbody'));\n            gObj.getContent().querySelector('table').appendChild(gObj.createElement('tbody', { attrs: { 'role': 'rowgroup' } }));\n            var focusRows = [];\n            // eslint-disable-next-line @typescript-eslint/tslint/config\n            for (var i = (page === 1 || this.maxPage === page) ? 0 : -1, k = 0; k < gObj.infiniteScrollSettings.maxBlocks; this.maxPage === page ? i-- : i++, k++) {\n                var rows = this.infiniteCache[page + i];\n                if (rows) {\n                    focusRows = focusRows.concat(rows);\n                    for (var j = 0; j < rows.length; j++) {\n                        gObj.getContent().querySelector('tbody').appendChild(rowRenderer.render(rows[parseInt(j.toString(), 10)], cols));\n                    }\n                }\n            }\n            gObj.notify(events.contentReady, { rows: focusRows, args: {} });\n            setRowElements(gObj);\n        }\n        row = gObj.getRowByIndex(rowIdx);\n        var target = row.cells[parseInt(cellIdx.toString(), 10)];\n        gObj.focusModule.isInfiniteScroll = true;\n        gObj.focusModule.onClick({ target: target }, true);\n        gObj.selectRow(rowIdx);\n        target.focus();\n        this.isFocusScroll = false;\n        e.cancel = true;\n    };\n    InfiniteScroll.prototype.setLastCellFocusInfo = function (e) {\n        var cell = ((e.byClick && e.clickArgs.target) || (e.byKey && e.keyArgs.target)\n            || (!this.isFocusScroll && e).target);\n        if (cell && cell.classList.contains('e-rowcell')) {\n            var cellIdx = parseInt(cell.getAttribute('aria-colindex'), 10) - 1;\n            var rowIdx = parseInt(cell.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            this.lastFocusInfo = { rowIdx: rowIdx, cellIdx: cellIdx };\n        }\n    };\n    InfiniteScroll.prototype.infiniteCellFocus = function (e) {\n        var gObj = this.parent;\n        var cache = gObj.infiniteScrollSettings.enableCache;\n        if (e.byKey) {\n            if (cache && this.isFocusScroll) {\n                this.scrollToLastFocusedCell(e);\n                return;\n            }\n            var cell = document.activeElement;\n            var rowIndex = getRowIndexFromElement(cell.parentElement);\n            this.cellIndex = parseInt(cell.getAttribute(literals.ariaColIndex), 10) - 1;\n            var content = gObj.getContent().firstElementChild;\n            var totalRowsCount = (this.maxPage * gObj.pageSettings.pageSize) - 1;\n            var visibleRowCount = Math.floor(content.offsetHeight / this.parent.getRowHeight());\n            var contentRect = content.getBoundingClientRect();\n            if (!isNaN(rowIndex)) {\n                if (e.keyArgs.action === literals.downArrow || e.keyArgs.action === literals.enter) {\n                    this.rowIndex = rowIndex += 1;\n                    var row = gObj.getRowByIndex(rowIndex);\n                    var rowRect = row && row.getBoundingClientRect();\n                    if (cache) {\n                        rowIndex = cell.parentElement.rowIndex + 1;\n                    }\n                    if (this.isFocusScroll || (!row && rowIndex < totalRowsCount)\n                        || (rowRect && rowRect.bottom >= contentRect.bottom)) {\n                        if (!this.isFocusScroll) {\n                            this.pressedKey = e.keyArgs.action;\n                        }\n                        this.isFocusScroll = false;\n                        content.scrollTop = ((rowIndex - visibleRowCount) + 1) * this.parent.getRowHeight();\n                    }\n                    else if (!cache && row) {\n                        if (rowRect && (rowRect.bottom >= contentRect.bottom || rowRect.top < contentRect.top)) {\n                            row.cells[this.cellIndex].scrollIntoView();\n                        }\n                    }\n                }\n                else if (e.keyArgs.action === literals.upArrow || e.keyArgs.action === literals.shiftEnter) {\n                    this.rowIndex = rowIndex -= 1;\n                    var row = gObj.getRowByIndex(rowIndex);\n                    var rowRect = row && row.getBoundingClientRect();\n                    if (cache) {\n                        rowIndex = cell.parentElement.rowIndex - 1;\n                    }\n                    if (!row || rowRect.top <= contentRect.top) {\n                        this.pressedKey = e.keyArgs.action;\n                        content.scrollTop = rowIndex * this.parent.getRowHeight();\n                    }\n                }\n            }\n        }\n        else if (e.key === 'PageDown' || e.key === 'PageUp') {\n            this.pressedKey = e.key;\n        }\n        this.setLastCellFocusInfo(e);\n    };\n    InfiniteScroll.prototype.createEmptyRowdata = function () {\n        var _this = this;\n        this.parent.getColumns().filter(function (e) {\n            _this.emptyRowData[e.field] = _this.empty;\n        });\n    };\n    InfiniteScroll.prototype.getVirtualInfiniteEditedData = function () {\n        var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n        var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n        var gridForm = this.parent.element.querySelector('.e-gridform');\n        if (this.parent.infiniteScrollSettings.enableCache && (editForm || addForm)) {\n            var rowData = editForm ? extend({}, this.getEditedRowObject().data)\n                : extend({}, this.emptyRowData);\n            this.virtualInfiniteData = this.parent.editModule.getCurrentEditedData(gridForm, rowData);\n            var hiddenColumn = this.parent.getHiddenColumns();\n            for (var i = 0; i < hiddenColumn.length; i++) {\n                if (hiddenColumn[parseInt(i.toString(), 10)].defaultValue) {\n                    this.virtualInfiniteData[hiddenColumn[parseInt(i.toString(), 10)].field] =\n                        hiddenColumn[parseInt(i.toString(), 10)].defaultValue;\n                }\n            }\n        }\n    };\n    InfiniteScroll.prototype.restoreInfiniteEdit = function () {\n        var content = this.parent.getContent().firstElementChild;\n        var frozenEdit = this.parent.frozenRows ? this.editRowIndex >= this.parent.frozenRows : true;\n        if (this.isNormaledit && this.parent.infiniteScrollSettings.enableCache && frozenEdit) {\n            if (this.parent.editSettings.allowEditing && !isNullOrUndefined(this.editRowIndex)) {\n                var row = this.parent.getRowByIndex(this.editRowIndex);\n                if (Object.keys(this.virtualInfiniteData).length && row && !this.parent.getContent().querySelector('.' + literals.editedRow)) {\n                    var top_1 = row.getBoundingClientRect().top;\n                    if (top_1 < content.offsetHeight && top_1 > this.parent.getRowHeight()) {\n                        this.parent.isEdit = false;\n                        this.parent.editModule.startEdit(row);\n                    }\n                }\n            }\n        }\n    };\n    InfiniteScroll.prototype.restoreInfiniteAdd = function () {\n        var content = this.parent.getContent().firstElementChild;\n        if (this.parent.getCurrentViewRecords().length && this.parent.getRowByIndex(0) && this.isNormaledit &&\n            this.parent.infiniteScrollSettings.enableCache && this.isAdd && !content.querySelector('.' + literals.addedRow)) {\n            var isTop = content.scrollTop < this.parent.getRowHeight();\n            if (isTop) {\n                this.parent.isEdit = false;\n                this.parent.addRecord();\n            }\n        }\n    };\n    InfiniteScroll.prototype.appendInfiniteRows = function (e) {\n        var gObj = this.parent;\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var isInfiniteScroll = this.parent.enableInfiniteScrolling && e.args.requestType === 'infiniteScroll';\n        var infiniteDetailModified = gObj.enableInfiniteScrolling && (gObj.childGrid || gObj.detailTemplate)\n            && ((e.args.action === 'add' && e.args.requestType === 'save') || e.args.requestType === 'delete');\n        if (infiniteDetailModified) {\n            scrollEle.scrollTop = 0;\n            gObj.pageSettings.currentPage = 1;\n        }\n        if ((this.parent.isAngular || this.parent.isReact || this.parent.isVue || this.parent.isVue3) && isInfiniteScroll &&\n            !e.args.isFrozen && this.parent.infiniteScrollSettings.enableCache) {\n            var isChildGrid = this.parent.childGrid && this.parent.element.querySelectorAll('.e-childgrid').length ? true : false;\n            var rows = this.parent.getDataRows();\n            this.parent.refreshReactTemplateTD(rows, isChildGrid);\n        }\n        if ((isInfiniteScroll && !e.args.isFrozen) || !isInfiniteScroll) {\n            if (isInfiniteScroll && e.args.direction === 'up') {\n                e.tbody.insertBefore(e.frag, e.tbody.firstElementChild);\n            }\n            else {\n                e.tbody.appendChild(e.frag);\n            }\n        }\n        this.parent.contentModule.getTable().appendChild(e.tbody);\n        this.updateCurrentViewData();\n        if (this.isInitialRender && !e.args.isFrozen) {\n            this.isInitialRender = false;\n            this.parent.scrollModule.setHeight();\n        }\n        if (!e.args.isFrozen) {\n            this.rowTop = !this.rowTop ? this.parent.getRows()[0].getBoundingClientRect().top : this.rowTop;\n            if (isInfiniteScroll) {\n                if (this.parent.infiniteScrollSettings.enableCache && this.isRemove) {\n                    scrollEle.scrollTop = this.top;\n                }\n                setRowElements(this.parent);\n            }\n            this.restoreInfiniteAdd();\n            this.isScroll = true;\n        }\n        this.isInfiniteScroll = false;\n        this.infiniteDetailDestroy = false;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    InfiniteScroll.prototype.selectNewRow = function (args) {\n        var _this = this;\n        var gObj = this.parent;\n        var row = gObj.getRowByIndex(this.rowIndex);\n        var cache = gObj.infiniteScrollSettings.enableCache;\n        if (row && this.keys.some(function (value) { return value === _this.pressedKey; })) {\n            var content = gObj.getContent().firstElementChild;\n            var rowHeight = gObj.getRowHeight();\n            var target = row.cells[this.cellIndex];\n            if ((this.pressedKey === literals.downArrow || this.pressedKey === literals.enter)\n                || (cache && (this.pressedKey === literals.upArrow || this.pressedKey === literals.shiftEnter))) {\n                if (!cache && this.pressedKey !== literals.upArrow && this.pressedKey !== literals.shiftEnter) {\n                    content.scrollTop = content.scrollTop + rowHeight;\n                }\n                gObj.focusModule.isInfiniteScroll = true;\n                gObj.focusModule.onClick({ target: target }, true);\n                gObj.selectRow(this.rowIndex);\n            }\n        }\n        else if (this.lastFocusInfo && (this.pressedKey === literals.pageDown || this.pressedKey === literals.pageUp)) {\n            var idx = cache ? 0 : this.lastFocusInfo.rowIdx;\n            if (gObj.getRowByIndex(idx)) {\n                var target = gObj.getCellFromIndex(idx, this.lastFocusInfo.cellIdx);\n                if (target) {\n                    this.isFocusScroll = true;\n                    if (!cache) {\n                        gObj.focusModule.isInfiniteScroll = true;\n                        gObj.focusModule.onClick({ target: target }, true);\n                    }\n                    else {\n                        target.focus({ preventScroll: true });\n                    }\n                }\n            }\n        }\n        this.pressedKey = undefined;\n    };\n    InfiniteScroll.prototype.removeInfiniteCacheRows = function (e) {\n        var isInfiniteScroll = this.parent.enableInfiniteScrolling && e.args.requestType === 'infiniteScroll';\n        if (!e.args.isFrozen && isInfiniteScroll && this.parent.infiniteScrollSettings.enableCache && this.isRemove) {\n            var detailGrid = this.parent.childGrid || this.parent.detailTemplate ? true : false;\n            var rows = detailGrid ? this.getGridRows().filter(function (row) { return row.classList.contains(literals.row); })\n                : [].slice.call(this.parent.getContentTable().getElementsByClassName(literals.row));\n            if (e.args.direction === 'down') {\n                if (this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n                    var captionRows = detailGrid ? this.getGridRows().filter(function (row) { return !row.classList\n                        .contains('e-detailrow'); }) : [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n                    this.removeCaptionRows(captionRows, e.args);\n                }\n                var addRowCount = this.parent.element.querySelector('.' + literals.addedRow) ? 0 : 1;\n                this.removeTopRows(rows, this.parent.pageSettings.pageSize - addRowCount);\n            }\n            if (e.args.direction === 'up') {\n                if (this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n                    var captionRows = detailGrid ? this.getGridRows().filter(function (row) { return !row.classList\n                        .contains('e-detailrow'); }) : [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n                    this.removeCaptionRows(captionRows, e.args);\n                }\n                else {\n                    this.removeBottomRows(rows, rows.length - 1, e.args);\n                }\n            }\n            this.isScroll = false;\n            this.top = this.calculateScrollTop(e.args);\n        }\n    };\n    InfiniteScroll.prototype.calculateScrollTop = function (args) {\n        var top = 0;\n        var scrollCnt = this.parent.getContent().firstElementChild;\n        if (args.direction === 'down') {\n            if (this.parent.allowGrouping && this.parent.groupSettings.columns.length && !this.isInitialCollapse) {\n                top = this.captionRowHeight();\n            }\n            var captionRows = [].slice.call(this.parent.getContent().firstElementChild.querySelectorAll('tr:not(.e-row)'));\n            var captionCount = 0;\n            if (this.isInitialCollapse && !isNullOrUndefined(captionRows)) {\n                captionCount = Math.round((captionRows.length - 1) / this.parent.groupSettings.columns.length);\n            }\n            var value = captionCount ? captionCount\n                : this.parent.pageSettings.pageSize * (this.parent.infiniteScrollSettings.maxBlocks - 1);\n            var currentViewRowCount = 0;\n            var i = 0;\n            while (currentViewRowCount < scrollCnt.clientHeight) {\n                i++;\n                currentViewRowCount = i * this.parent.getRowHeight();\n            }\n            i = i - 1;\n            top += (value - i) * this.parent.getRowHeight();\n        }\n        if (args.direction === 'up') {\n            if (this.parent.allowGrouping && this.parent.groupSettings.columns.length && !this.isInitialCollapse) {\n                var len = this.refreshInfiniteCacheRowVisibleLength(this.infiniteCache, this.parent.pageSettings.currentPage);\n                top = len * this.parent.getRowHeight();\n            }\n            else if (this.isInitialCollapse) {\n                var groupedData = this.infiniteCache[this.parent.pageSettings.currentPage];\n                var count = 0;\n                for (var i = 0; i < groupedData.length; i++) {\n                    if (groupedData[parseInt(i.toString(), 10)].isCaptionRow) {\n                        count++;\n                    }\n                }\n                top += Math.round(count / this.parent.groupSettings.columns.length) * this.parent.getRowHeight();\n            }\n            else {\n                top += (this.parent.pageSettings.pageSize * this.parent.getRowHeight() + getScrollBarWidth());\n            }\n        }\n        return top;\n    };\n    InfiniteScroll.prototype.captionRowHeight = function () {\n        var rows = [].slice.call(this.parent.getContent().querySelectorAll('tr:not(.e-row)'));\n        return rows.length * this.parent.getRowHeight();\n    };\n    InfiniteScroll.prototype.removeTopRows = function (rows, maxIndx) {\n        for (var i = 0; i <= maxIndx; i++) {\n            if (this.parent.frozenRows && this.parent.pageSettings.currentPage === this.parent.infiniteScrollSettings.maxBlocks + 1\n                && i > (maxIndx - this.parent.frozenRows)) {\n                continue;\n            }\n            remove(rows[parseInt(i.toString(), 10)]);\n        }\n    };\n    InfiniteScroll.prototype.removeBottomRows = function (rows, maxIndx, args) {\n        var cnt = 0;\n        var pageSize = this.parent.pageSettings.pageSize;\n        if (this.infiniteCache[args.prevPage].length < pageSize) {\n            cnt = this.parent.pageSettings.pageSize - this.infiniteCache[args.prevPage].length;\n        }\n        for (var i = maxIndx; cnt < pageSize; i--) {\n            cnt++;\n            remove(rows[parseInt(i.toString(), 10)]);\n        }\n    };\n    InfiniteScroll.prototype.removeCaptionRows = function (rows, args) {\n        var detailGrid = this.parent.childGrid || this.parent.detailTemplate ? true : false;\n        var rowElements = detailGrid ? this.getGridRows().filter(function (row) { return row.classList.contains(literals.row); })\n            : [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n        if (args.direction === 'down') {\n            var lastRow = rowElements[this.parent.pageSettings.pageSize - 1];\n            var lastRowIndex = getRowIndexFromElement(lastRow) - 1;\n            var k = 0;\n            for (var i = 0; k < lastRowIndex; i++) {\n                if (!rows[parseInt(i.toString(), 10)].classList.contains(literals.row)) {\n                    remove(rows[parseInt(i.toString(), 10)]);\n                }\n                else {\n                    k = getRowIndexFromElement(rows[parseInt(i.toString(), 10)]);\n                }\n            }\n        }\n        if (args.direction === 'up') {\n            var lastIndex = getRowIndexFromElement(rowElements[rowElements.length - 1]);\n            var page = Math.ceil(lastIndex / this.parent.pageSettings.pageSize);\n            var startIndex = 0;\n            for (var i = this.parent.pageSettings.currentPage + 1; i < page; i++) {\n                startIndex += detailGrid ? this.infiniteCache[parseInt(i.toString(), 10)]\n                    .filter(function (row) { return !row.isDetailRow; }).length : this.infiniteCache[parseInt(i.toString(), 10)].length;\n            }\n            for (var i = startIndex; i < rows.length; i++) {\n                remove(rows[parseInt(i.toString(), 10)]);\n            }\n        }\n    };\n    InfiniteScroll.prototype.getGridRows = function () {\n        return [].slice.call(this.parent.getContentTable().rows);\n    };\n    InfiniteScroll.prototype.resetInfiniteBlocks = function (args, isDataModified) {\n        var isInfiniteScroll = this.parent.enableInfiniteScrolling && args.requestType !== 'infiniteScroll';\n        if (!this.initialRender && !isNullOrUndefined(this.parent.infiniteScrollModule) && isInfiniteScroll) {\n            if (this.actions.some(function (value) { return value === args.requestType; }) || isDataModified || (args.requestType === 'save'\n                && (this.parent.sortSettings.columns.length || this.parent.filterSettings.columns.length\n                    || this.parent.groupSettings.columns.length || this.parent.searchSettings.key))) {\n                var scrollEle = this.parent.getContent().firstElementChild;\n                this.parent.notify(events.detachDetailTemplate, {});\n                this.initialRender = true;\n                scrollEle.scrollTop = 0;\n                this.parent.pageSettings.currentPage = 1;\n                this.infiniteCache = {};\n                this.infiniteCurrentViewData = {};\n                this.resetContentModuleCache({});\n                this.isRemove = false;\n                this.top = 0;\n                this.isInitialCollapse = false;\n                this.parent.contentModule.isRemove = this.isRemove;\n                this.parent.contentModule.isAddRows = this.isRemove;\n                this.parent.contentModule.visibleRows = [];\n                this.parent.contentModule.visibleFrozenRows = [];\n            }\n        }\n    };\n    InfiniteScroll.prototype.setCache = function (e) {\n        if (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) {\n            var gObj = this.parent;\n            var infiniteDetailModified = (gObj.childGrid || gObj.detailTemplate) && ((e.args.action === 'add'\n                && e.args.requestType === 'save') || e.args.requestType === 'delete');\n            var isEdit = e.args.requestType !== 'infiniteScroll'\n                && (this.requestType === 'delete' || this.requestType === 'add');\n            var currentPage = this.parent.pageSettings.currentPage;\n            if (!Object.keys(this.infiniteCache).length || isEdit) {\n                if (infiniteDetailModified) {\n                    this.infiniteCache = {};\n                }\n                this.setInitialCache(e.modelData, e.args, isEdit);\n            }\n            if (isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage]) && !infiniteDetailModified) {\n                this.infiniteCache[this.parent.pageSettings.currentPage] = e.modelData;\n                this.resetContentModuleCache(this.infiniteCache);\n            }\n            if (e.isInfiniteScroll && !this.isRemove) {\n                this.isRemove = (currentPage - 1) % this.parent.infiniteScrollSettings.maxBlocks === 0;\n                this.parent.contentModule.isRemove = this.isRemove;\n            }\n        }\n    };\n    InfiniteScroll.prototype.setInitialCache = function (data, args, isEdit, isCurrentViewData) {\n        var k = !isEdit ? 1 : isNullOrUndefined(this.firstBlock) ? 1 : this.firstBlock;\n        for (var i = 1; i <= this.parent.infiniteScrollSettings.initialBlocks; i++) {\n            var startIndex = (i - 1) * this.parent.pageSettings.pageSize;\n            var endIndex = i * this.parent.pageSettings.pageSize;\n            if (this.parent.allowGrouping && this.parent.groupSettings.columns.length && !isCurrentViewData) {\n                this.setInitialGroupCache(data, k, startIndex, endIndex);\n            }\n            else {\n                if (isCurrentViewData) {\n                    this.infiniteCurrentViewData[parseInt(k.toString(), 10)] = data.slice(startIndex, endIndex);\n                }\n                else {\n                    this.infiniteCache[parseInt(k.toString(), 10)] = data.slice(startIndex, endIndex);\n                    this.resetContentModuleCache(this.infiniteCache);\n                }\n            }\n            k++;\n        }\n    };\n    InfiniteScroll.prototype.setInitialGroupCache = function (data, index, sIndex, eIndex) {\n        var pageData = [];\n        var startIndex = 0;\n        for (var i = 1; i <= Object.keys(this.infiniteCache).length; i++) {\n            startIndex += this.infiniteCache[parseInt(i.toString(), 10)].length;\n        }\n        var k = sIndex;\n        for (var i = startIndex; i < data.length && k < eIndex; i++) {\n            if (data[parseInt(i.toString(), 10)].index < eIndex || data[parseInt(i.toString(), 10)].isCaptionRow) {\n                k = data[parseInt(i.toString(), 10)].isCaptionRow ? k : data[parseInt(i.toString(), 10)].index;\n                pageData.push(data[parseInt(i.toString(), 10)]);\n            }\n            if (data[parseInt(i.toString(), 10)].index >= eIndex || data[parseInt(i.toString(), 10)].index === eIndex - 1) {\n                break;\n            }\n        }\n        this.infiniteCache[parseInt(index.toString(), 10)] = pageData;\n        this.resetContentModuleCache(this.infiniteCache);\n    };\n    InfiniteScroll.prototype.resetContentModuleCache = function (data) {\n        this.parent.contentModule\n            .infiniteCache = data;\n    };\n    /**\n     * @param {Row<Column>[]} rowObjects - Defines the grid's row objects\n     * @returns {void}\n     * @hidden\n     */\n    InfiniteScroll.prototype.resetInfiniteCache = function (rowObjects) {\n        var blockLength = Object.keys(this.infiniteCache).length;\n        this.infiniteCache = {};\n        for (var i = 1; i <= blockLength; i++) {\n            var startIndex = (i - 1) * this.parent.pageSettings.pageSize;\n            var endIndex = i * this.parent.pageSettings.pageSize;\n            if (this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n                this.setInitialGroupCache(rowObjects, i, startIndex, endIndex);\n            }\n            else {\n                this.infiniteCache[parseInt(i.toString(), 10)] = rowObjects.slice(startIndex, endIndex);\n                this.resetContentModuleCache(this.infiniteCache);\n            }\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    InfiniteScroll.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    return InfiniteScroll;\n}());\nexport { InfiniteScroll };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}