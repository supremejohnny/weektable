{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nimport { Component, removeClass } from '@syncfusion/ej2-base';\nimport { EventHandler, isNullOrUndefined } from '@syncfusion/ej2-base';\nvar SignatureBase = /** @class */function (_super) {\n  __extends(SignatureBase, _super);\n  function SignatureBase() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    /* minDistance(distance between the two point) was calaculated for smoothness.*/\n    _this.minDistance = 5;\n    _this.previous = 0;\n    /* interval handles for the smoothness in the mouse move event.*/\n    _this.interval = 30;\n    _this.timeout = null;\n    _this.isSignatureEmpty = true;\n    _this.backgroundLoaded = null;\n    _this.isBlazor = false;\n    _this.isResponsive = false;\n    _this.signPointsColl = [];\n    _this.signRatioPointsColl = [];\n    _this.canRedraw = true;\n    return _this;\n  }\n  /**\n   * To Initialize the component rendering\n   *\n   * @private\n   * @param {HTMLCanvasElement} element - Specifies the canvas element.\n   * @param {BlazorDotnetObject} dotnetRef - Specifies for blazor client to server communication.\n   * @returns {void}\n   */\n  SignatureBase.prototype.initialize = function (element, dotnetRef) {\n    this.clearArray = [];\n    this.element = element;\n    this.canvasContext = this.element.getContext('2d');\n    this.canvasContext.canvas.tabIndex = -1;\n    if (dotnetRef) {\n      this.dotnetRef = dotnetRef;\n      this.isBlazor = true;\n      if (this.signatureValue) {\n        this.loadPersistedSignature();\n      }\n    }\n    this.setHTMLProperties();\n    if (isNullOrUndefined(this.signatureValue)) {\n      this.updateSnapCollection(true);\n    }\n    this.wireEvents();\n    if (!this.isBlazor) {\n      this.trigger('created', null);\n    }\n  };\n  SignatureBase.prototype.wireEvents = function () {\n    if (isNullOrUndefined(this.pointColl) && !this.isReadOnly && !this.disabled) {\n      EventHandler.add(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler, this);\n      EventHandler.add(this.canvasContext.canvas, 'keydown', this.keyboardHandler, this);\n      window.addEventListener('resize', this.resizeHandler.bind(this));\n    } else if (this.pointColl) {\n      EventHandler.add(this.canvasContext.canvas, 'mousemove touchmove', this.mouseMoveHandler, this);\n      EventHandler.add(this.canvasContext.canvas, 'mouseup touchend', this.mouseUpHandler, this);\n      EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    }\n  };\n  SignatureBase.prototype.unwireEvents = function (type) {\n    if (type === 'mouseup' || type === 'touchend') {\n      if (this.canvasContext) {\n        EventHandler.remove(this.canvasContext.canvas, 'mousemove touchmove', this.mouseMoveHandler);\n        EventHandler.remove(this.canvasContext.canvas, 'mouseup touchend', this.mouseUpHandler);\n      }\n      EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n    } else {\n      if (this.canvasContext) {\n        EventHandler.remove(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler);\n        EventHandler.remove(this.canvasContext.canvas, 'keydown', this.keyboardHandler);\n      }\n      window.removeEventListener('resize', this.resizeHandler);\n    }\n  };\n  SignatureBase.prototype.setHTMLProperties = function () {\n    // eslint-disable-next-line max-len\n    if (this.element.height === 150 && this.element.width === 300 && this.element.offsetHeight !== 0 && this.element.offsetWidth !== 0) {\n      this.element.height = this.element.offsetHeight;\n      this.element.width = this.element.offsetWidth;\n      this.isResponsive = true;\n    } else if ((this.element.height !== this.element.offsetHeight - 1 || this.element.width !== this.element.offsetWidth - 1) && this.element.offsetHeight !== 0 && this.element.offsetWidth !== 0) {\n      this.element.height = this.element.offsetHeight;\n      this.element.width = this.element.offsetWidth;\n    }\n    this.canvasContext.fillStyle = this.strokeColor;\n    this.tempCanvas = this.createElement('canvas', {\n      className: 'e-' + this.getModuleName() + '-temp'\n    });\n    this.tempContext = this.tempCanvas.getContext('2d');\n    this.tempCanvas.width = this.element.width;\n    this.tempCanvas.height = this.element.height;\n    if (this.backgroundImage) {\n      this.canvasContext.canvas.style.backgroundImage = 'url(' + this.backgroundImage + ')';\n      this.canvasContext.canvas.style.backgroundRepeat = 'no-repeat';\n      if (this.saveWithBackground) {\n        this.setBackgroundImage(this.backgroundImage, 'temp');\n      }\n    } else if (this.backgroundColor) {\n      this.canvasContext.canvas.style.backgroundColor = this.backgroundColor;\n    }\n  };\n  SignatureBase.prototype.mouseDownHandler = function (e) {\n    if (e.buttons === 1 || e.buttons === 2 || e.type === 'touchstart') {\n      if (e.type === 'touchstart') {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n      this.beginStroke(e);\n      this.wireEvents();\n    }\n  };\n  SignatureBase.prototype.mouseMoveHandler = function (e) {\n    if (e.buttons === 1 || e.buttons === 2 || e.type === 'touchmove') {\n      if (e.type === 'touchmove') {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n      if (this.interval) {\n        this.updateStrokeWithThrottle(e);\n      } else {\n        this.updateStroke(e);\n      }\n    }\n  };\n  SignatureBase.prototype.mouseUpHandler = function (e) {\n    var args = {\n      actionName: 'strokeUpdate'\n    };\n    if (e.type === 'touchstart') {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n    this.endDraw();\n    this.updateSnapCollection();\n    this.unwireEvents(e.type);\n    if (!this.isBlazor) {\n      this.trigger('change', args);\n    } else {\n      this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'mouseUp');\n    }\n    this.signatureValue = this.snapColl[this.incStep];\n    for (var i = 0; i < this.signPointsColl.length; i++) {\n      this.signRatioPointsColl.push({\n        x: this.signPointsColl[i].x / this.canvasContext.canvas.width,\n        y: this.signPointsColl[i].y / this.canvasContext.canvas.height\n      });\n    }\n    this.signPointsColl = [];\n  };\n  SignatureBase.prototype.keyboardHandler = function (e) {\n    var _this = this;\n    var args = {\n      fileName: 'Signature',\n      type: 'Png',\n      cancel: false\n    };\n    switch (e.key) {\n      case 'Delete':\n        this.clear();\n        break;\n      case e.ctrlKey && 's':\n        if (!this.isBlazor) {\n          this.trigger('beforeSave', args, function (observableSaveArgs) {\n            if (!args.cancel) {\n              _this.save(observableSaveArgs.type, observableSaveArgs.fileName);\n            }\n          });\n        } else {\n          this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'beforeSave');\n        }\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        break;\n      case e.ctrlKey && 'z':\n        this.undo();\n        break;\n      case e.ctrlKey && 'y':\n        this.redo();\n        break;\n    }\n  };\n  SignatureBase.prototype.resizeHandler = function () {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    if (this.isResponsive && this.canRedraw && this.canvasContext && this.element) {\n      this.canvasContext.canvas.width = this.element.offsetWidth;\n      this.canvasContext.canvas.height = this.element.offsetHeight;\n      this.canvasContext.scale(1, 1);\n      this.canvasContext.fillStyle = this.strokeColor;\n      var pointSize = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n      for (var i = 0; i < this.signRatioPointsColl.length; i++) {\n        this.arcDraw(this.signRatioPointsColl[i].x * this.canvasContext.canvas.width, this.signRatioPointsColl[i].y * this.canvasContext.canvas.height, pointSize);\n      }\n      this.signPointsColl = [];\n      this.canvasContext.closePath();\n      this.canvasContext.fill();\n    } else if (this.canvasContext && this.element) {\n      var restoreImg_1 = new Image();\n      restoreImg_1.src = this.snapColl[this.incStep];\n      restoreImg_1.onload = function () {\n        proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n        proxy.canvasContext.drawImage(restoreImg_1, 0, 0, proxy.element.width, proxy.element.height);\n      };\n    }\n  };\n  SignatureBase.prototype.beginStroke = function (e) {\n    this.internalRefresh();\n    this.updateStroke(e);\n  };\n  SignatureBase.prototype.updateStroke = function (e) {\n    var point = this.createPoint(e);\n    this.addPoint(point);\n  };\n  SignatureBase.prototype.updateStrokeWithThrottle = function (args) {\n    var now = Date.now();\n    var remaining = this.interval - (now - this.previous);\n    this.storedArgs = args;\n    if (remaining <= 0 || remaining > this.interval) {\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = null;\n      }\n      this.previous = now;\n      this.updateStroke(this.storedArgs);\n      if (!this.timeout) {\n        this.storedArgs = null;\n      }\n    } else if (!this.timeout) {\n      this.timeout = window.setTimeout(this.delay.bind(this), remaining);\n    }\n  };\n  SignatureBase.prototype.delay = function () {\n    this.previous = Date.now();\n    this.timeout = null;\n    this.updateStroke(this.storedArgs);\n    if (!this.timeout) {\n      this.storedArgs = null;\n    }\n  };\n  SignatureBase.prototype.createPoint = function (e) {\n    var rect = this.canvasContext.canvas.getBoundingClientRect();\n    if (e.type === 'mousedown' || e.type === 'mousemove') {\n      return this.point(e.clientX - rect.left, e.clientY - rect.top, new Date().getTime());\n    } else {\n      return this.point(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top, new Date().getTime());\n    }\n  };\n  /* Returns the current point corrdinates(x, y) and time.*/\n  SignatureBase.prototype.point = function (pointX, pointY, time) {\n    this.pointX = pointX;\n    this.pointY = pointY;\n    this.time = time || new Date().getTime();\n    return {\n      x: this.pointX,\n      y: this.pointY,\n      time: this.time\n    };\n  };\n  SignatureBase.prototype.addPoint = function (point) {\n    var points = this.pointColl;\n    var controlPoint1;\n    var controlPoint2;\n    var lastPoint = points.length > 0 && points[points.length - 1];\n    var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= this.minDistance : false;\n    if (!lastPoint || !(lastPoint && isLastPointTooClose)) {\n      points.push(point);\n      if (points.length > 2) {\n        if (points.length === 3) {\n          points.unshift(points[0]);\n        }\n        controlPoint1 = this.calculateCurveControlPoints(points[0], points[1], points[2]).controlPoint2;\n        controlPoint2 = this.calculateCurveControlPoints(points[1], points[2], points[3]).controlPoint1;\n        this.startPoint = points[1];\n        this.controlPoint1 = controlPoint1;\n        this.controlPoint2 = controlPoint2;\n        this.endPoint = points[2];\n        this.startDraw();\n        points.shift();\n      }\n    }\n  };\n  SignatureBase.prototype.startDraw = function () {\n    var velocity;\n    velocity = this.pointVelocityCalc(this.startPoint);\n    velocity = this.velocity * velocity + (1 - this.velocity) * this.lastVelocity;\n    var newWidth = Math.max(this.maxStrokeWidth / (velocity + 1), this.minStrokeWidth);\n    this.curveDraw(this.lastWidth, newWidth);\n    this.lastVelocity = velocity;\n    this.lastWidth = newWidth;\n  };\n  SignatureBase.prototype.endDraw = function () {\n    if (isNullOrUndefined(this.pointColl)) {\n      return;\n    }\n    var canDrawCurve = this.pointColl.length > 2;\n    var point = this.pointColl[0];\n    if (!canDrawCurve && point) {\n      this.strokeDraw(point);\n    }\n  };\n  /* Calculate the Bezier (x, y) coordinate of the curve. */\n  SignatureBase.prototype.curveDraw = function (startWidth, endWidth) {\n    var context = this.canvasContext;\n    var width;\n    var i;\n    var t1;\n    var t2;\n    var t3;\n    var u1;\n    var u2;\n    var u3;\n    var x;\n    var y;\n    var widthValue = endWidth - startWidth;\n    var bezierLength = this.bezierLengthCalc();\n    var drawSteps = Math.ceil(bezierLength) * 2;\n    context.beginPath();\n    for (i = 0; i < drawSteps; i++) {\n      t1 = i / drawSteps;\n      t2 = t1 * t1;\n      t3 = t2 * t1;\n      u1 = 1 - t1;\n      u2 = u1 * u1;\n      u3 = u2 * u1;\n      x = u3 * this.startPoint.x;\n      x += 3 * u2 * t1 * this.controlPoint1.x;\n      x += 3 * u1 * t2 * this.controlPoint2.x;\n      x += t3 * this.endPoint.x;\n      y = u3 * this.startPoint.y;\n      y += 3 * u2 * t1 * this.controlPoint1.y;\n      y += 3 * u1 * t2 * this.controlPoint2.y;\n      y += t3 * this.endPoint.y;\n      width = Math.min(startWidth + t3 * widthValue, this.maxStrokeWidth);\n      this.arcDraw(x, y, width);\n    }\n    context.closePath();\n    context.fill();\n    this.isSignatureEmpty = false;\n  };\n  SignatureBase.prototype.strokeDraw = function (point) {\n    var context = this.canvasContext;\n    var pointSize = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n    context.beginPath();\n    this.arcDraw(point.x, point.y, pointSize);\n    context.closePath();\n    context.fill();\n    this.isSignatureEmpty = false;\n  };\n  SignatureBase.prototype.arcDraw = function (x, y, size) {\n    this.signPointsColl.push({\n      x: x,\n      y: y\n    });\n    var context = this.canvasContext;\n    context.moveTo(x, y);\n    context.arc(x, y, size, 0, 2 * Math.PI, false);\n  };\n  /* Utility functions for Bezier algorithm*/\n  SignatureBase.prototype.calculateCurveControlPoints = function (p1, p2, p3) {\n    var dx1 = p1.x - p2.x;\n    var dy1 = p1.y - p2.y;\n    var dx2 = p2.x - p3.x;\n    var dy2 = p2.y - p3.y;\n    var m1 = {\n      x: (p1.x + p2.x) / 2.0,\n      y: (p1.y + p2.y) / 2.0\n    };\n    var m2 = {\n      x: (p2.x + p3.x) / 2.0,\n      y: (p2.y + p3.y) / 2.0\n    };\n    var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n    var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n    var dxm = m1.x - m2.x;\n    var dym = m1.y - m2.y;\n    var k = l2 / (l1 + l2);\n    var cm = {\n      x: m2.x + dxm * k,\n      y: m2.y + dym * k\n    };\n    var tx = p2.x - cm.x;\n    var ty = p2.y - cm.y;\n    return {\n      controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n      controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n    };\n  };\n  /* Returns approximated bezier length of the curuve.*/\n  SignatureBase.prototype.bezierLengthCalc = function () {\n    var steps = 10;\n    var length = 0;\n    var i;\n    var t;\n    var pointx1;\n    var pointy1;\n    var pointx2;\n    var pointy2;\n    var pointx3;\n    var pointy3;\n    for (i = 0; i <= steps; i++) {\n      t = i / steps;\n      pointx1 = this.bezierPointCalc(t, this.startPoint.x, this.controlPoint1.x, this.controlPoint2.x, this.endPoint.x);\n      pointy1 = this.bezierPointCalc(t, this.startPoint.y, this.controlPoint1.y, this.controlPoint2.y, this.endPoint.y);\n      if (i > 0) {\n        pointx3 = pointx1 - pointx2;\n        pointy3 = pointy1 - pointy2;\n        length += Math.sqrt(pointx3 * pointx3 + pointy3 * pointy3);\n      }\n      pointx2 = pointx1;\n      pointy2 = pointy1;\n    }\n    return length;\n  };\n  /* Calculate parametric value of x or y given t and the\n     four point(startpoint, controlpoint1, controlpoint2, endpoint) coordinates of a cubic bezier curve.*/\n  SignatureBase.prototype.bezierPointCalc = function (t, startpoint, cp1, cp2, endpoint) {\n    return startpoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 * cp2 * (1.0 - t) * t * t + endpoint * t * t * t;\n  };\n  /* Velocity between the current point and last point.*/\n  SignatureBase.prototype.pointVelocityCalc = function (startPoint) {\n    return this.time !== startPoint.time ? this.distanceTo(startPoint) / (this.time - startPoint.time) : 0;\n  };\n  /* Distance between the current point and last point.*/\n  SignatureBase.prototype.distanceTo = function (start) {\n    return Math.sqrt(Math.pow(this.pointX - start.x, 2) + Math.pow(this.pointY - start.y, 2));\n  };\n  SignatureBase.prototype.isRead = function (isRead) {\n    if (isRead) {\n      EventHandler.remove(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler);\n    } else if (!this.disabled) {\n      EventHandler.add(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler, this);\n    }\n  };\n  SignatureBase.prototype.enableOrDisable = function (isDisable) {\n    this.disabled = isDisable;\n    if (isDisable) {\n      this.canvasContext.canvas.style.filter = 'opacity(0.5)';\n      this.isRead(true);\n    } else {\n      this.canvasContext.canvas.style.filter = '';\n      this.isRead(false);\n    }\n  };\n  SignatureBase.prototype.updateSnapCollection = function (isClear) {\n    if (isNullOrUndefined(this.incStep)) {\n      this.incStep = -1;\n      this.incStep++;\n      this.snapColl = [];\n      this.clearArray = [];\n    } else {\n      this.incStep++;\n    }\n    if (this.incStep < this.snapColl.length) {\n      this.snapColl.length = this.incStep;\n    }\n    if (this.incStep > 0) {\n      var canvasNew = this.createElement('canvas', {\n        className: 'e-' + this.getModuleName() + '-wrapper'\n      });\n      var canvasContextNew = canvasNew.getContext('2d');\n      if (this.canvasContext) {\n        canvasNew.width = this.canvasContext.canvas.width;\n        canvasNew.height = this.canvasContext.canvas.height;\n        canvasContextNew.drawImage(this.canvasContext.canvas, 0, 0, canvasNew.width, canvasNew.height);\n        this.snapColl.push(canvasNew.toDataURL());\n      }\n    } else {\n      this.snapColl.push(this.canvasContext.canvas.toDataURL());\n    }\n    if (isClear) {\n      this.clearArray.push(this.incStep);\n    }\n  };\n  SignatureBase.prototype.setBackgroundImage = function (imageSrc, type) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var imageObj = new Image();\n    imageObj.crossOrigin = 'anonymous';\n    imageObj.src = imageSrc;\n    if (type === 'temp') {\n      imageObj.onload = function () {\n        proxy.tempContext.globalCompositeOperation = 'source-over';\n        proxy.tempContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n      };\n    } else {\n      imageObj.onload = function () {\n        proxy.canvasContext.globalCompositeOperation = 'source-over';\n        proxy.canvasContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n        proxy.updateSnapCollection();\n        proxy.saveBackground(true);\n      };\n      this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    }\n  };\n  SignatureBase.prototype.setBackgroundColor = function (color) {\n    var canvasEle = this.canvasContext;\n    canvasEle.strokeStyle = color;\n    var i;\n    var j;\n    for (i = 1; i <= canvasEle.canvas.width; i++) {\n      for (j = 1; j <= canvasEle.canvas.height; j++) {\n        canvasEle.strokeRect(0, 0, i, j);\n      }\n    }\n    this.updateSnapCollection();\n  };\n  SignatureBase.prototype.loadPersistedSignature = function () {\n    if (isNullOrUndefined(this.signatureValue)) {\n      return;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var lastImage = new Image();\n    lastImage.src = this.signatureValue;\n    lastImage.onload = function () {\n      proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n      proxy.canvasContext.drawImage(lastImage, 0, 0);\n      proxy.updateSnapCollection();\n    };\n    this.isSignatureEmpty = false;\n  };\n  /**\n   * To get the signature as Blob.\n   *\n   * @param {string} url - specify the url/base 64 string to get blob of the signature.\n   * @returns {Blob}.\n   */\n  SignatureBase.prototype.getBlob = function (url) {\n    var arr = url.split(',');\n    var type = arr[0].match(/:(.*?);/)[1];\n    var bstr = atob(arr[1]);\n    var n = bstr.length;\n    var u8arr = new Uint8Array(n);\n    while (n--) {\n      u8arr[n] = bstr.charCodeAt(n);\n    }\n    return new Blob([u8arr], {\n      type: type\n    });\n  };\n  SignatureBase.prototype.download = function (blob, fileName) {\n    var blobUrl = URL.createObjectURL(blob);\n    var a = document.createElement('a');\n    a.href = blobUrl;\n    a.target = '_parent';\n    a.download = fileName;\n    (document.body || document.documentElement).appendChild(a);\n    a.click();\n    a.parentNode.removeChild(a);\n  };\n  SignatureBase.prototype.internalRefresh = function () {\n    this.pointColl = [];\n    this.lastVelocity = 0;\n    this.lastWidth = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n  };\n  /**\n   * To refresh the signature.\n   *\n   * @returns {void}.\n   */\n  SignatureBase.prototype.refresh = function () {\n    this.isResponsive = false;\n    this.setHTMLProperties();\n    this.resizeHandler();\n    this.internalRefresh();\n  };\n  /**\n   * Erases all the signature strokes signed by user.\n   *\n   * @returns {void}.\n   */\n  SignatureBase.prototype.clear = function () {\n    var args = {\n      actionName: 'clear'\n    };\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    this.tempContext.clearRect(0, 0, this.tempContext.canvas.width, this.tempContext.canvas.height);\n    if (this.saveWithBackground && this.backgroundImage) {\n      this.setBackgroundImage(this.backgroundImage, 'temp');\n    }\n    this.internalRefresh();\n    this.signRatioPointsColl = [];\n    this.updateSnapCollection(true);\n    this.isSignatureEmpty = this.canRedraw = true;\n    if (!this.isBlazor) {\n      this.trigger('change', args);\n    } else {\n      this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Clear');\n    }\n  };\n  /**\n   * Undo the last user action.\n   *\n   * @returns {void}.\n   */\n  SignatureBase.prototype.undo = function () {\n    var args = {\n      actionName: 'undo'\n    };\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    if (this.incStep > 0) {\n      this.incStep--;\n      var undoImg_1 = new Image();\n      undoImg_1.src = this.snapColl[this.incStep];\n      undoImg_1.onload = function () {\n        proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n        proxy.canvasContext.drawImage(undoImg_1, 0, 0, proxy.element.width, proxy.element.height);\n      };\n    }\n    this.isClear();\n    if (!this.isBlazor) {\n      this.trigger('change', args);\n    } else {\n      this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Undo');\n    }\n  };\n  /**\n   * Redo the last user action.\n   *\n   * @returns {void}.\n   */\n  SignatureBase.prototype.redo = function () {\n    var args = {\n      actionName: 'redo'\n    };\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    if (this.incStep < this.snapColl.length - 1) {\n      this.incStep++;\n      var redoImg_1 = new Image();\n      redoImg_1.src = this.snapColl[this.incStep];\n      redoImg_1.onload = function () {\n        proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n        proxy.canvasContext.drawImage(redoImg_1, 0, 0, proxy.element.width, proxy.element.height);\n      };\n    }\n    this.isClear();\n    if (!this.isBlazor) {\n      this.trigger('change', args);\n    } else {\n      this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Redo');\n    }\n  };\n  SignatureBase.prototype.isClear = function () {\n    if (this.clearArray) {\n      var empty = false;\n      for (var i = 0; i < this.clearArray.length; i++) {\n        if (this.clearArray[i] === this.incStep) {\n          this.isSignatureEmpty = true;\n          empty = true;\n        }\n      }\n      if (!empty) {\n        this.isSignatureEmpty = false;\n      }\n    }\n  };\n  /**\n   * To check whether the signature is empty or not.\n   *\n   * @returns {boolean}.\n   */\n  SignatureBase.prototype.isEmpty = function () {\n    return this.isSignatureEmpty;\n  };\n  /**\n   * To check whether the undo collection is empty or not.\n   *\n   * @returns {boolean}.\n   */\n  SignatureBase.prototype.canUndo = function () {\n    return this.incStep > 0;\n  };\n  /**\n   * To check whether the redo collection is empty or not.\n   *\n   * @returns {boolean}.\n   */\n  SignatureBase.prototype.canRedo = function () {\n    return this.incStep < this.snapColl.length - 1;\n  };\n  /**\n   * To draw the signature based on the given text, with the font family and font size.\n   *\n   * @param {string} text - specify text to be drawn as signature.\n   * @param {string} fontFamily - specify font family of a signature.\n   * @param {number} fontSize - specify font size of a signature.\n   * @param {number} x- Specifies the x-coordinate to start the text of a signature. Default to the center point of the image if it not specified.\n   * @param {number} y - Specifies the y-coordinate to start the text of a signature. Default to the center point of the image if it not specified.\n   *\n   * @returns {void}.\n   */\n  SignatureBase.prototype.draw = function (text, fontFamily, fontSize, x, y) {\n    var args = {\n      actionName: 'draw-text'\n    };\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    fontFamily = fontFamily || 'Arial';\n    fontSize = fontSize || 30;\n    this.canvasContext.font = fontSize + 'px ' + fontFamily;\n    var startX = this.element.width / 2;\n    var startY = this.element.height / 2;\n    if (isNullOrUndefined(x) && isNullOrUndefined(y)) {\n      this.canvasContext.textAlign = 'center';\n      this.canvasContext.textBaseline = 'middle';\n    } else {\n      startX = isNullOrUndefined(x) ? startX : x;\n      startY = isNullOrUndefined(y) ? startY + fontSize / 2 : y + fontSize / 2;\n    }\n    this.canvasContext.fillText(text, startX, startY);\n    this.updateSnapCollection();\n    this.isSignatureEmpty = false;\n    this.trigger('change', args);\n  };\n  /**\n   * To load the signature with the given base 64 string, height and width.\n   *\n   * @param {string} signature - specify the url/base 64 string to be drawn as signature.\n   * @param {number} width - specify the width of the loaded signature image.\n   * @param {number} height - specify the height of the loaded signature image.\n   * @returns {void}.\n   */\n  SignatureBase.prototype.load = function (signature, width, height) {\n    height = height || this.element.height;\n    width = width || this.element.width;\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var bitmapImage = new Image();\n    bitmapImage.src = signature;\n    if (signature.slice(0, 4) !== 'data') {\n      bitmapImage.crossOrigin = 'anonymous';\n    }\n    bitmapImage.onload = function () {\n      Promise.all([createImageBitmap(bitmapImage, 0, 0, width, height)]).then(function (results) {\n        var tempCanvas = document.createElement('canvas');\n        tempCanvas.width = width;\n        tempCanvas.height = height;\n        tempCanvas.getContext('2d').drawImage(results[0], 0, 0);\n        if (signature.slice(0, 4) !== 'data') {\n          proxy.canvasContext.globalCompositeOperation = 'source-over';\n        }\n        proxy.canvasContext.drawImage(tempCanvas, 0, 0, width, height, 0, 0, proxy.element.width, proxy.element.height);\n        proxy.updateSnapCollection();\n      });\n    };\n    this.isSignatureEmpty = this.canRedraw = false;\n  };\n  SignatureBase.prototype.saveBackground = function (savebg) {\n    var imageSrc;\n    if (savebg && this.backgroundImage) {\n      imageSrc = this.snapColl[this.incStep - 1];\n    } else {\n      imageSrc = this.snapColl[this.incStep];\n    }\n    if (!savebg) {\n      this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n      if (this.backgroundImage) {\n        this.setBackgroundImage(this.backgroundImage);\n      } else if (this.backgroundColor) {\n        this.setBackgroundColor(this.backgroundColor);\n        savebg = true;\n      }\n    }\n    if (savebg) {\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      var proxy_1 = this;\n      var imageObj_1 = new Image();\n      imageObj_1.crossOrigin = 'anonymous';\n      imageObj_1.src = imageSrc;\n      imageObj_1.onload = function () {\n        proxy_1.backgroundLoaded = true;\n        proxy_1.canvasContext.globalCompositeOperation = 'source-over';\n        proxy_1.canvasContext.drawImage(imageObj_1, 0, 0, proxy_1.element.width, proxy_1.element.height);\n        proxy_1.save(proxy_1.fileType, proxy_1.fileName);\n      };\n    }\n  };\n  /**\n   * To save the signature with the given file type and file name.\n   *\n   * @param {SignatureFileType} type - specify type of the file to be saved a signature.\n   * @param {string} fileName - specify name of the file to be saved a signature.\n   *\n   * @returns {void}.\n   */\n  SignatureBase.prototype.save = function (type, fileName) {\n    if (this.saveWithBackground && this.backgroundLoaded == null && (this.backgroundImage || this.backgroundColor)) {\n      this.backgroundLoaded = false;\n      this.fileType = type;\n      this.fileName = fileName;\n      this.saveBackground(false);\n    } else if (type === 'Svg') {\n      fileName = fileName || 'Signature';\n      this.toSVG(fileName);\n    } else if (type === 'Jpeg') {\n      fileName = fileName || 'Signature';\n      if (!this.saveWithBackground || this.saveWithBackground && !(this.backgroundImage || this.backgroundColor)) {\n        this.toJPEG(fileName);\n      } else {\n        var dataURL = this.canvasContext.canvas.toDataURL('image/jpeg');\n        this.download(this.getBlob(dataURL), fileName + '.' + 'jpeg');\n      }\n    } else {\n      fileName = fileName || 'Signature';\n      var dataURL = this.canvasContext.canvas.toDataURL('image/png');\n      this.download(this.getBlob(dataURL), fileName + '.' + 'png');\n    }\n    if (this.saveWithBackground && this.backgroundLoaded) {\n      this.resetSnap();\n    }\n  };\n  SignatureBase.prototype.resetSnap = function () {\n    this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var restoreObj = new Image();\n    restoreObj.src = this.snapColl[this.incStep - 1];\n    restoreObj.onload = function () {\n      proxy.canvasContext.drawImage(restoreObj, 0, 0, proxy.element.width, proxy.element.height);\n      proxy.updateSnapCollection();\n    };\n    this.backgroundLoaded = null;\n    this.snapColl.pop();\n    this.incStep--;\n    this.snapColl.pop();\n    this.incStep--;\n  };\n  SignatureBase.prototype.toJPEG = function (fileName) {\n    var _this = this;\n    var imageSrc = this.snapColl[this.incStep];\n    this.setBackgroundColor('#ffffff');\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var imageObj = new Image();\n    imageObj.crossOrigin = 'anonymous';\n    imageObj.src = imageSrc;\n    imageObj.onload = function () {\n      proxy.canvasContext.globalCompositeOperation = 'source-over';\n      proxy.canvasContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n      var dataURL = proxy.canvasContext.canvas.toDataURL('image/jpeg');\n      proxy.download(proxy.getBlob(dataURL), fileName + '.' + 'jpeg');\n      proxy.canvasContext.clearRect(0, 0, proxy.canvasContext.canvas.width, proxy.canvasContext.canvas.height);\n      _this.resizeHandler();\n    };\n    this.snapColl.pop();\n    this.incStep--;\n  };\n  SignatureBase.prototype.toSVG = function (fileName, dataUrl) {\n    var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    svg.setAttribute('width', this.canvasContext.canvas.width.toString());\n    svg.setAttribute('height', this.canvasContext.canvas.height.toString());\n    var XLinkNS = 'http://www.w3.org/1999/xlink';\n    var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n    img.setAttributeNS(null, 'height', this.canvasContext.canvas.height.toString());\n    img.setAttributeNS(null, 'width', this.canvasContext.canvas.width.toString());\n    img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n    svg.appendChild(img);\n    var prefix = 'data:image/svg+xml;base64,';\n    var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"' + (\" width=\\\"\" + this.canvasContext.canvas.width + \"\\\"\") + (\" height=\\\"\" + this.canvasContext.canvas.height + \"\\\"\") + '>';\n    var footer = '</svg>';\n    var body = svg.innerHTML;\n    var data = header + body + footer;\n    var svgDataUrl = prefix + btoa(data);\n    if (fileName == null) {\n      return svgDataUrl;\n    } else {\n      this.download(this.getBlob(svgDataUrl), fileName + '.' + 'svg');\n      return null;\n    }\n  };\n  /**\n   * To save the signature as Blob.\n   *\n   * @returns {Blob}.\n   */\n  SignatureBase.prototype.saveAsBlob = function () {\n    return this.getBlob(this.canvasContext.canvas.toDataURL('image/png'));\n  };\n  /**\n   * Gets the signature as a Base 64 string.\n   *\n   * This method is used to retrieve the current signature on the canvas as a Base 64-encoded string, in the specified image format.\n   *\n   * @param {SignatureFileType} [type] - Specifies the type of the image format.\n   * Can be one of 'Png', 'Jpeg', or 'Svg'. If not specified, the default is 'Png'.\n   * @returns {string} - Returns the Base 64 string of the signature in the specified format.\n   */\n  SignatureBase.prototype.getSignature = function (type) {\n    if (this.saveWithBackground && this.backgroundColor && !this.backgroundImage) {\n      this.tempContext.fillStyle = this.backgroundColor;\n      this.tempContext.fillRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    } else if (!this.backgroundColor && !this.backgroundImage && type === 'Jpeg') {\n      this.tempContext.fillStyle = '#fff';\n      this.tempContext.fillRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n    }\n    this.tempContext.drawImage(this.element, 0, 0);\n    if (type === 'Jpeg') {\n      return this.tempCanvas.toDataURL('image/jpeg');\n    } else if (type === 'Svg') {\n      return this.toSVG(null, this.tempCanvas.toDataURL('image/png'));\n    } else {\n      return this.tempCanvas.toDataURL('image/png');\n    }\n  };\n  /**\n   * Get component name.\n   *\n   * @returns {string} - Module Name\n   * @private\n   */\n  SignatureBase.prototype.getModuleName = function () {\n    return 'signature';\n  };\n  /**\n   * To get the properties to be maintained in the persisted state.\n   *\n   * @returns {string} - Persist data\n   */\n  SignatureBase.prototype.getPersistData = function () {\n    this.signatureValue = this.snapColl[this.incStep];\n    return this.addOnPersist(['signatureValue']);\n  };\n  /**\n   * Removes the component from the DOM and detaches all its related event handlers.\n   * Also it maintains the initial input element from the DOM.\n   *\n   * @method destroy\n   * @returns {void}\n   */\n  SignatureBase.prototype.destroy = function () {\n    if (this.getModuleName() !== 'image-editor') {\n      this.unwireEvents(null);\n      removeClass([this.element], 'e-' + this.getModuleName());\n      this.element.removeAttribute('tabindex');\n      this.pointColl = null;\n      this.tempContext = null;\n      this.tempCanvas = null;\n      this.canvasContext = null;\n    }\n    _super.prototype.destroy.call(this);\n    this.element = null;\n  };\n  /**\n   * Modified onPropertyChanged method for both blazor and EJ2 signature component.\n   *\n   * @private\n   * @param {string} key - Specifies the property, which changed.\n   * @param {string} value - Specifies the property value changed.\n   * @returns {void}\n   */\n  SignatureBase.prototype.propertyChanged = function (key, value) {\n    var canvasNew = this.canvasContext;\n    switch (key) {\n      case 'backgroundColor':\n        canvasNew.canvas.style.backgroundColor = value;\n        this.backgroundColor = value;\n        break;\n      case 'backgroundImage':\n        canvasNew.canvas.style.backgroundImage = 'url(' + value + ')';\n        this.backgroundImage = value;\n        if (this.saveWithBackground) {\n          this.setBackgroundImage(this.backgroundImage, 'temp');\n        }\n        break;\n      case 'strokeColor':\n        canvasNew.fillStyle = value;\n        this.strokeColor = value;\n        break;\n      case 'saveWithBackground':\n        this.saveWithBackground = value;\n        break;\n      case 'maxStrokeWidth':\n        this.maxStrokeWidth = value;\n        break;\n      case 'minStrokeWidth':\n        this.minStrokeWidth = value;\n        break;\n      case 'velocity':\n        this.velocity = value;\n        break;\n      case 'isReadOnly':\n        this.isRead(value);\n        break;\n      case 'disabled':\n        this.enableOrDisable(value);\n        break;\n    }\n  };\n  return SignatureBase;\n}(Component);\nexport { SignatureBase };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","Component","removeClass","EventHandler","isNullOrUndefined","SignatureBase","_super","_this","apply","arguments","minDistance","previous","interval","timeout","isSignatureEmpty","backgroundLoaded","isBlazor","isResponsive","signPointsColl","signRatioPointsColl","canRedraw","initialize","element","dotnetRef","clearArray","canvasContext","getContext","canvas","tabIndex","signatureValue","loadPersistedSignature","setHTMLProperties","updateSnapCollection","wireEvents","trigger","pointColl","isReadOnly","disabled","add","mouseDownHandler","keyboardHandler","window","addEventListener","resizeHandler","bind","mouseMoveHandler","mouseUpHandler","document","unwireEvents","type","remove","removeEventListener","height","width","offsetHeight","offsetWidth","fillStyle","strokeColor","tempCanvas","createElement","className","getModuleName","tempContext","backgroundImage","style","backgroundRepeat","saveWithBackground","setBackgroundImage","backgroundColor","e","buttons","preventDefault","stopPropagation","beginStroke","updateStrokeWithThrottle","updateStroke","args","actionName","endDraw","invokeMethodAsync","snapColl","incStep","i","length","push","x","y","fileName","cancel","key","clear","ctrlKey","observableSaveArgs","save","stopImmediatePropagation","undo","redo","proxy","scale","pointSize","minStrokeWidth","maxStrokeWidth","arcDraw","closePath","fill","restoreImg_1","Image","src","onload","clearRect","drawImage","internalRefresh","point","createPoint","addPoint","now","Date","remaining","storedArgs","clearTimeout","setTimeout","delay","rect","getBoundingClientRect","clientX","left","clientY","top","getTime","touches","pointX","pointY","time","points","controlPoint1","controlPoint2","lastPoint","isLastPointTooClose","distanceTo","unshift","calculateCurveControlPoints","startPoint","endPoint","startDraw","shift","velocity","pointVelocityCalc","lastVelocity","newWidth","Math","max","curveDraw","lastWidth","canDrawCurve","strokeDraw","startWidth","endWidth","context","t1","t2","t3","u1","u2","u3","widthValue","bezierLength","bezierLengthCalc","drawSteps","ceil","beginPath","min","size","moveTo","arc","PI","p1","p2","p3","dx1","dy1","dx2","dy2","m1","m2","l1","sqrt","l2","dxm","dym","k","cm","tx","ty","steps","t","pointx1","pointy1","pointx2","pointy2","pointx3","pointy3","bezierPointCalc","startpoint","cp1","cp2","endpoint","start","pow","isRead","enableOrDisable","isDisable","filter","isClear","canvasNew","canvasContextNew","toDataURL","imageSrc","imageObj","crossOrigin","globalCompositeOperation","saveBackground","setBackgroundColor","color","canvasEle","strokeStyle","j","strokeRect","lastImage","getBlob","url","arr","split","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","Blob","download","blob","blobUrl","URL","createObjectURL","a","href","target","body","documentElement","appendChild","click","parentNode","removeChild","refresh","undoImg_1","redoImg_1","empty","isEmpty","canUndo","canRedo","draw","text","fontFamily","fontSize","font","startX","startY","textAlign","textBaseline","fillText","load","signature","bitmapImage","slice","Promise","all","createImageBitmap","then","results","savebg","proxy_1","imageObj_1","fileType","toSVG","toJPEG","dataURL","resetSnap","restoreObj","pop","dataUrl","svg","createElementNS","setAttribute","toString","XLinkNS","img","setAttributeNS","prefix","header","footer","innerHTML","data","svgDataUrl","btoa","saveAsBlob","getSignature","fillRect","getPersistData","addOnPersist","destroy","removeAttribute","call","propertyChanged","value"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-inputs/src/common/signature-base.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Component, removeClass } from '@syncfusion/ej2-base';\nimport { EventHandler, isNullOrUndefined } from '@syncfusion/ej2-base';\nvar SignatureBase = /** @class */ (function (_super) {\n    __extends(SignatureBase, _super);\n    function SignatureBase() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        /* minDistance(distance between the two point) was calaculated for smoothness.*/\n        _this.minDistance = 5;\n        _this.previous = 0;\n        /* interval handles for the smoothness in the mouse move event.*/\n        _this.interval = 30;\n        _this.timeout = null;\n        _this.isSignatureEmpty = true;\n        _this.backgroundLoaded = null;\n        _this.isBlazor = false;\n        _this.isResponsive = false;\n        _this.signPointsColl = [];\n        _this.signRatioPointsColl = [];\n        _this.canRedraw = true;\n        return _this;\n    }\n    /**\n     * To Initialize the component rendering\n     *\n     * @private\n     * @param {HTMLCanvasElement} element - Specifies the canvas element.\n     * @param {BlazorDotnetObject} dotnetRef - Specifies for blazor client to server communication.\n     * @returns {void}\n     */\n    SignatureBase.prototype.initialize = function (element, dotnetRef) {\n        this.clearArray = [];\n        this.element = element;\n        this.canvasContext = this.element.getContext('2d');\n        this.canvasContext.canvas.tabIndex = -1;\n        if (dotnetRef) {\n            this.dotnetRef = dotnetRef;\n            this.isBlazor = true;\n            if (this.signatureValue) {\n                this.loadPersistedSignature();\n            }\n        }\n        this.setHTMLProperties();\n        if (isNullOrUndefined(this.signatureValue)) {\n            this.updateSnapCollection(true);\n        }\n        this.wireEvents();\n        if (!this.isBlazor) {\n            this.trigger('created', null);\n        }\n    };\n    SignatureBase.prototype.wireEvents = function () {\n        if (isNullOrUndefined(this.pointColl) && !this.isReadOnly && !this.disabled) {\n            EventHandler.add(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler, this);\n            EventHandler.add(this.canvasContext.canvas, 'keydown', this.keyboardHandler, this);\n            window.addEventListener('resize', this.resizeHandler.bind(this));\n        }\n        else if (this.pointColl) {\n            EventHandler.add(this.canvasContext.canvas, 'mousemove touchmove', this.mouseMoveHandler, this);\n            EventHandler.add(this.canvasContext.canvas, 'mouseup touchend', this.mouseUpHandler, this);\n            EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n        }\n    };\n    SignatureBase.prototype.unwireEvents = function (type) {\n        if (type === 'mouseup' || type === 'touchend') {\n            if (this.canvasContext) {\n                EventHandler.remove(this.canvasContext.canvas, 'mousemove touchmove', this.mouseMoveHandler);\n                EventHandler.remove(this.canvasContext.canvas, 'mouseup touchend', this.mouseUpHandler);\n            }\n            EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        }\n        else {\n            if (this.canvasContext) {\n                EventHandler.remove(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler);\n                EventHandler.remove(this.canvasContext.canvas, 'keydown', this.keyboardHandler);\n            }\n            window.removeEventListener('resize', this.resizeHandler);\n        }\n    };\n    SignatureBase.prototype.setHTMLProperties = function () {\n        // eslint-disable-next-line max-len\n        if (this.element.height === 150 && this.element.width === 300 && this.element.offsetHeight !== 0 && this.element.offsetWidth !== 0) {\n            this.element.height = this.element.offsetHeight;\n            this.element.width = this.element.offsetWidth;\n            this.isResponsive = true;\n        }\n        else if ((this.element.height !== this.element.offsetHeight - 1 || this.element.width !== this.element.offsetWidth - 1)\n            && this.element.offsetHeight !== 0 && this.element.offsetWidth !== 0) {\n            this.element.height = this.element.offsetHeight;\n            this.element.width = this.element.offsetWidth;\n        }\n        this.canvasContext.fillStyle = this.strokeColor;\n        this.tempCanvas = this.createElement('canvas', { className: 'e-' + this.getModuleName() + '-temp' });\n        this.tempContext = this.tempCanvas.getContext('2d');\n        this.tempCanvas.width = this.element.width;\n        this.tempCanvas.height = this.element.height;\n        if (this.backgroundImage) {\n            this.canvasContext.canvas.style.backgroundImage = 'url(' + this.backgroundImage + ')';\n            this.canvasContext.canvas.style.backgroundRepeat = 'no-repeat';\n            if (this.saveWithBackground) {\n                this.setBackgroundImage(this.backgroundImage, 'temp');\n            }\n        }\n        else if (this.backgroundColor) {\n            this.canvasContext.canvas.style.backgroundColor = this.backgroundColor;\n        }\n    };\n    SignatureBase.prototype.mouseDownHandler = function (e) {\n        if (e.buttons === 1 || e.buttons === 2 || e.type === 'touchstart') {\n            if (e.type === 'touchstart') {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n            this.beginStroke(e);\n            this.wireEvents();\n        }\n    };\n    SignatureBase.prototype.mouseMoveHandler = function (e) {\n        if (e.buttons === 1 || e.buttons === 2 || e.type === 'touchmove') {\n            if (e.type === 'touchmove') {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n            if (this.interval) {\n                this.updateStrokeWithThrottle(e);\n            }\n            else {\n                this.updateStroke(e);\n            }\n        }\n    };\n    SignatureBase.prototype.mouseUpHandler = function (e) {\n        var args = { actionName: 'strokeUpdate' };\n        if (e.type === 'touchstart') {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        this.endDraw();\n        this.updateSnapCollection();\n        this.unwireEvents(e.type);\n        if (!this.isBlazor) {\n            this.trigger('change', args);\n        }\n        else {\n            this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'mouseUp');\n        }\n        this.signatureValue = this.snapColl[this.incStep];\n        for (var i = 0; i < this.signPointsColl.length; i++) {\n            this.signRatioPointsColl.push({ x: (this.signPointsColl[i].x / this.canvasContext.canvas.width),\n                y: (this.signPointsColl[i].y / this.canvasContext.canvas.height) });\n        }\n        this.signPointsColl = [];\n    };\n    SignatureBase.prototype.keyboardHandler = function (e) {\n        var _this = this;\n        var args = { fileName: 'Signature', type: 'Png', cancel: false };\n        switch (e.key) {\n            case 'Delete':\n                this.clear();\n                break;\n            case (e.ctrlKey && 's'):\n                if (!this.isBlazor) {\n                    this.trigger('beforeSave', args, function (observableSaveArgs) {\n                        if (!args.cancel) {\n                            _this.save(observableSaveArgs.type, observableSaveArgs.fileName);\n                        }\n                    });\n                }\n                else {\n                    this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'beforeSave');\n                }\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                break;\n            case (e.ctrlKey && 'z'):\n                this.undo();\n                break;\n            case (e.ctrlKey && 'y'):\n                this.redo();\n                break;\n        }\n    };\n    SignatureBase.prototype.resizeHandler = function () {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (this.isResponsive && this.canRedraw && this.canvasContext && this.element) {\n            this.canvasContext.canvas.width = this.element.offsetWidth;\n            this.canvasContext.canvas.height = this.element.offsetHeight;\n            this.canvasContext.scale(1, 1);\n            this.canvasContext.fillStyle = this.strokeColor;\n            var pointSize = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n            for (var i = 0; i < this.signRatioPointsColl.length; i++) {\n                this.arcDraw((this.signRatioPointsColl[i].x * this.canvasContext.canvas.width), (this.signRatioPointsColl[i].y * this.canvasContext.canvas.height), pointSize);\n            }\n            this.signPointsColl = [];\n            this.canvasContext.closePath();\n            this.canvasContext.fill();\n        }\n        else if (this.canvasContext && this.element) {\n            var restoreImg_1 = new Image();\n            restoreImg_1.src = this.snapColl[this.incStep];\n            restoreImg_1.onload = function () {\n                proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n                proxy.canvasContext.drawImage(restoreImg_1, 0, 0, proxy.element.width, proxy.element.height);\n            };\n        }\n    };\n    SignatureBase.prototype.beginStroke = function (e) {\n        this.internalRefresh();\n        this.updateStroke(e);\n    };\n    SignatureBase.prototype.updateStroke = function (e) {\n        var point = this.createPoint(e);\n        this.addPoint(point);\n    };\n    SignatureBase.prototype.updateStrokeWithThrottle = function (args) {\n        var now = Date.now();\n        var remaining = this.interval - (now - this.previous);\n        this.storedArgs = args;\n        if (remaining <= 0 || remaining > this.interval) {\n            if (this.timeout) {\n                clearTimeout(this.timeout);\n                this.timeout = null;\n            }\n            this.previous = now;\n            this.updateStroke(this.storedArgs);\n            if (!this.timeout) {\n                this.storedArgs = null;\n            }\n        }\n        else if (!this.timeout) {\n            this.timeout = window.setTimeout(this.delay.bind(this), remaining);\n        }\n    };\n    SignatureBase.prototype.delay = function () {\n        this.previous = Date.now();\n        this.timeout = null;\n        this.updateStroke(this.storedArgs);\n        if (!this.timeout) {\n            this.storedArgs = null;\n        }\n    };\n    SignatureBase.prototype.createPoint = function (e) {\n        var rect = this.canvasContext.canvas.getBoundingClientRect();\n        if (e.type === 'mousedown' || e.type === 'mousemove') {\n            return this.point(e.clientX - rect.left, e.clientY - rect.top, new Date().getTime());\n        }\n        else {\n            return this.point(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top, new Date().getTime());\n        }\n    };\n    /* Returns the current point corrdinates(x, y) and time.*/\n    SignatureBase.prototype.point = function (pointX, pointY, time) {\n        this.pointX = pointX;\n        this.pointY = pointY;\n        this.time = time || new Date().getTime();\n        return { x: this.pointX, y: this.pointY, time: this.time };\n    };\n    SignatureBase.prototype.addPoint = function (point) {\n        var points = this.pointColl;\n        var controlPoint1;\n        var controlPoint2;\n        var lastPoint = points.length > 0 && points[points.length - 1];\n        var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= this.minDistance : false;\n        if (!lastPoint || !(lastPoint && isLastPointTooClose)) {\n            points.push(point);\n            if (points.length > 2) {\n                if (points.length === 3) {\n                    points.unshift(points[0]);\n                }\n                controlPoint1 = (this.calculateCurveControlPoints(points[0], points[1], points[2])).controlPoint2;\n                controlPoint2 = (this.calculateCurveControlPoints(points[1], points[2], points[3])).controlPoint1;\n                this.startPoint = points[1];\n                this.controlPoint1 = controlPoint1;\n                this.controlPoint2 = controlPoint2;\n                this.endPoint = points[2];\n                this.startDraw();\n                points.shift();\n            }\n        }\n    };\n    SignatureBase.prototype.startDraw = function () {\n        var velocity;\n        velocity = this.pointVelocityCalc(this.startPoint);\n        velocity = this.velocity * velocity + (1 - this.velocity) * this.lastVelocity;\n        var newWidth = Math.max(this.maxStrokeWidth / (velocity + 1), this.minStrokeWidth);\n        this.curveDraw(this.lastWidth, newWidth);\n        this.lastVelocity = velocity;\n        this.lastWidth = newWidth;\n    };\n    SignatureBase.prototype.endDraw = function () {\n        if (isNullOrUndefined(this.pointColl)) {\n            return;\n        }\n        var canDrawCurve = this.pointColl.length > 2;\n        var point = this.pointColl[0];\n        if (!canDrawCurve && point) {\n            this.strokeDraw(point);\n        }\n    };\n    /* Calculate the Bezier (x, y) coordinate of the curve. */\n    SignatureBase.prototype.curveDraw = function (startWidth, endWidth) {\n        var context = this.canvasContext;\n        var width;\n        var i;\n        var t1;\n        var t2;\n        var t3;\n        var u1;\n        var u2;\n        var u3;\n        var x;\n        var y;\n        var widthValue = endWidth - startWidth;\n        var bezierLength = this.bezierLengthCalc();\n        var drawSteps = Math.ceil(bezierLength) * 2;\n        context.beginPath();\n        for (i = 0; i < drawSteps; i++) {\n            t1 = i / drawSteps;\n            t2 = t1 * t1;\n            t3 = t2 * t1;\n            u1 = 1 - t1;\n            u2 = u1 * u1;\n            u3 = u2 * u1;\n            x = u3 * this.startPoint.x;\n            x += 3 * u2 * t1 * this.controlPoint1.x;\n            x += 3 * u1 * t2 * this.controlPoint2.x;\n            x += t3 * this.endPoint.x;\n            y = u3 * this.startPoint.y;\n            y += 3 * u2 * t1 * this.controlPoint1.y;\n            y += 3 * u1 * t2 * this.controlPoint2.y;\n            y += t3 * this.endPoint.y;\n            width = Math.min(startWidth + t3 * widthValue, this.maxStrokeWidth);\n            this.arcDraw(x, y, width);\n        }\n        context.closePath();\n        context.fill();\n        this.isSignatureEmpty = false;\n    };\n    SignatureBase.prototype.strokeDraw = function (point) {\n        var context = this.canvasContext;\n        var pointSize = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n        context.beginPath();\n        this.arcDraw(point.x, point.y, pointSize);\n        context.closePath();\n        context.fill();\n        this.isSignatureEmpty = false;\n    };\n    SignatureBase.prototype.arcDraw = function (x, y, size) {\n        this.signPointsColl.push({ x: x, y: y });\n        var context = this.canvasContext;\n        context.moveTo(x, y);\n        context.arc(x, y, size, 0, 2 * Math.PI, false);\n    };\n    /* Utility functions for Bezier algorithm*/\n    SignatureBase.prototype.calculateCurveControlPoints = function (p1, p2, p3) {\n        var dx1 = p1.x - p2.x;\n        var dy1 = p1.y - p2.y;\n        var dx2 = p2.x - p3.x;\n        var dy2 = p2.y - p3.y;\n        var m1 = { x: (p1.x + p2.x) / 2.0, y: (p1.y + p2.y) / 2.0 };\n        var m2 = { x: (p2.x + p3.x) / 2.0, y: (p2.y + p3.y) / 2.0 };\n        var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n        var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n        var dxm = (m1.x - m2.x);\n        var dym = (m1.y - m2.y);\n        var k = l2 / (l1 + l2);\n        var cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\n        var tx = p2.x - cm.x;\n        var ty = p2.y - cm.y;\n        return {\n            controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n            controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n        };\n    };\n    /* Returns approximated bezier length of the curuve.*/\n    SignatureBase.prototype.bezierLengthCalc = function () {\n        var steps = 10;\n        var length = 0;\n        var i;\n        var t;\n        var pointx1;\n        var pointy1;\n        var pointx2;\n        var pointy2;\n        var pointx3;\n        var pointy3;\n        for (i = 0; i <= steps; i++) {\n            t = i / steps;\n            pointx1 = this.bezierPointCalc(t, this.startPoint.x, this.controlPoint1.x, this.controlPoint2.x, this.endPoint.x);\n            pointy1 = this.bezierPointCalc(t, this.startPoint.y, this.controlPoint1.y, this.controlPoint2.y, this.endPoint.y);\n            if (i > 0) {\n                pointx3 = pointx1 - pointx2;\n                pointy3 = pointy1 - pointy2;\n                length += Math.sqrt(pointx3 * pointx3 + pointy3 * pointy3);\n            }\n            pointx2 = pointx1;\n            pointy2 = pointy1;\n        }\n        return length;\n    };\n    /* Calculate parametric value of x or y given t and the\n       four point(startpoint, controlpoint1, controlpoint2, endpoint) coordinates of a cubic bezier curve.*/\n    SignatureBase.prototype.bezierPointCalc = function (t, startpoint, cp1, cp2, endpoint) {\n        return startpoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 *\n            cp2 * (1.0 - t) * t * t + endpoint * t * t * t;\n    };\n    /* Velocity between the current point and last point.*/\n    SignatureBase.prototype.pointVelocityCalc = function (startPoint) {\n        return (this.time !== startPoint.time) ? this.distanceTo(startPoint) / (this.time - startPoint.time) : 0;\n    };\n    /* Distance between the current point and last point.*/\n    SignatureBase.prototype.distanceTo = function (start) {\n        return Math.sqrt(Math.pow(this.pointX - start.x, 2) + Math.pow(this.pointY - start.y, 2));\n    };\n    SignatureBase.prototype.isRead = function (isRead) {\n        if (isRead) {\n            EventHandler.remove(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler);\n        }\n        else if (!this.disabled) {\n            EventHandler.add(this.canvasContext.canvas, 'mousedown touchstart', this.mouseDownHandler, this);\n        }\n    };\n    SignatureBase.prototype.enableOrDisable = function (isDisable) {\n        this.disabled = isDisable;\n        if (isDisable) {\n            this.canvasContext.canvas.style.filter = 'opacity(0.5)';\n            this.isRead(true);\n        }\n        else {\n            this.canvasContext.canvas.style.filter = '';\n            this.isRead(false);\n        }\n    };\n    SignatureBase.prototype.updateSnapCollection = function (isClear) {\n        if (isNullOrUndefined(this.incStep)) {\n            this.incStep = -1;\n            this.incStep++;\n            this.snapColl = [];\n            this.clearArray = [];\n        }\n        else {\n            this.incStep++;\n        }\n        if (this.incStep < this.snapColl.length) {\n            this.snapColl.length = this.incStep;\n        }\n        if (this.incStep > 0) {\n            var canvasNew = this.createElement('canvas', { className: 'e-' + this.getModuleName() + '-wrapper' });\n            var canvasContextNew = canvasNew.getContext('2d');\n            if (this.canvasContext) {\n                canvasNew.width = this.canvasContext.canvas.width;\n                canvasNew.height = this.canvasContext.canvas.height;\n                canvasContextNew.drawImage(this.canvasContext.canvas, 0, 0, canvasNew.width, canvasNew.height);\n                this.snapColl.push(canvasNew.toDataURL());\n            }\n        }\n        else {\n            this.snapColl.push(this.canvasContext.canvas.toDataURL());\n        }\n        if (isClear) {\n            this.clearArray.push(this.incStep);\n        }\n    };\n    SignatureBase.prototype.setBackgroundImage = function (imageSrc, type) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var imageObj = new Image();\n        imageObj.crossOrigin = 'anonymous';\n        imageObj.src = imageSrc;\n        if (type === 'temp') {\n            imageObj.onload = function () {\n                proxy.tempContext.globalCompositeOperation = 'source-over';\n                proxy.tempContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n            };\n        }\n        else {\n            imageObj.onload = function () {\n                proxy.canvasContext.globalCompositeOperation = 'source-over';\n                proxy.canvasContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n                proxy.updateSnapCollection();\n                proxy.saveBackground(true);\n            };\n            this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        }\n    };\n    SignatureBase.prototype.setBackgroundColor = function (color) {\n        var canvasEle = this.canvasContext;\n        canvasEle.strokeStyle = color;\n        var i;\n        var j;\n        for (i = 1; i <= canvasEle.canvas.width; i++) {\n            for (j = 1; j <= canvasEle.canvas.height; j++) {\n                canvasEle.strokeRect(0, 0, i, j);\n            }\n        }\n        this.updateSnapCollection();\n    };\n    SignatureBase.prototype.loadPersistedSignature = function () {\n        if (isNullOrUndefined(this.signatureValue)) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var lastImage = new Image();\n        lastImage.src = this.signatureValue;\n        lastImage.onload = function () {\n            proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n            proxy.canvasContext.drawImage(lastImage, 0, 0);\n            proxy.updateSnapCollection();\n        };\n        this.isSignatureEmpty = false;\n    };\n    /**\n     * To get the signature as Blob.\n     *\n     * @param {string} url - specify the url/base 64 string to get blob of the signature.\n     * @returns {Blob}.\n     */\n    SignatureBase.prototype.getBlob = function (url) {\n        var arr = url.split(',');\n        var type = arr[0].match(/:(.*?);/)[1];\n        var bstr = atob(arr[1]);\n        var n = bstr.length;\n        var u8arr = new Uint8Array(n);\n        while (n--) {\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], { type: type });\n    };\n    SignatureBase.prototype.download = function (blob, fileName) {\n        var blobUrl = URL.createObjectURL(blob);\n        var a = document.createElement('a');\n        a.href = blobUrl;\n        a.target = '_parent';\n        a.download = fileName;\n        (document.body || document.documentElement).appendChild(a);\n        a.click();\n        a.parentNode.removeChild(a);\n    };\n    SignatureBase.prototype.internalRefresh = function () {\n        this.pointColl = [];\n        this.lastVelocity = 0;\n        this.lastWidth = (this.minStrokeWidth + this.maxStrokeWidth) / 2;\n    };\n    /**\n     * To refresh the signature.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.refresh = function () {\n        this.isResponsive = false;\n        this.setHTMLProperties();\n        this.resizeHandler();\n        this.internalRefresh();\n    };\n    /**\n     * Erases all the signature strokes signed by user.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.clear = function () {\n        var args = { actionName: 'clear' };\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        this.tempContext.clearRect(0, 0, this.tempContext.canvas.width, this.tempContext.canvas.height);\n        if (this.saveWithBackground && this.backgroundImage) {\n            this.setBackgroundImage(this.backgroundImage, 'temp');\n        }\n        this.internalRefresh();\n        this.signRatioPointsColl = [];\n        this.updateSnapCollection(true);\n        this.isSignatureEmpty = this.canRedraw = true;\n        if (!this.isBlazor) {\n            this.trigger('change', args);\n        }\n        else {\n            this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Clear');\n        }\n    };\n    /**\n     * Undo the last user action.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.undo = function () {\n        var args = { actionName: 'undo' };\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (this.incStep > 0) {\n            this.incStep--;\n            var undoImg_1 = new Image();\n            undoImg_1.src = this.snapColl[this.incStep];\n            undoImg_1.onload = function () {\n                proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n                proxy.canvasContext.drawImage(undoImg_1, 0, 0, proxy.element.width, proxy.element.height);\n            };\n        }\n        this.isClear();\n        if (!this.isBlazor) {\n            this.trigger('change', args);\n        }\n        else {\n            this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Undo');\n        }\n    };\n    /**\n     * Redo the last user action.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.redo = function () {\n        var args = { actionName: 'redo' };\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (this.incStep < this.snapColl.length - 1) {\n            this.incStep++;\n            var redoImg_1 = new Image();\n            redoImg_1.src = this.snapColl[this.incStep];\n            redoImg_1.onload = function () {\n                proxy.canvasContext.clearRect(0, 0, proxy.element.width, proxy.element.height);\n                proxy.canvasContext.drawImage(redoImg_1, 0, 0, proxy.element.width, proxy.element.height);\n            };\n        }\n        this.isClear();\n        if (!this.isBlazor) {\n            this.trigger('change', args);\n        }\n        else {\n            this.dotnetRef.invokeMethodAsync('TriggerEventAsync', 'Redo');\n        }\n    };\n    SignatureBase.prototype.isClear = function () {\n        if (this.clearArray) {\n            var empty = false;\n            for (var i = 0; i < this.clearArray.length; i++) {\n                if (this.clearArray[i] === this.incStep) {\n                    this.isSignatureEmpty = true;\n                    empty = true;\n                }\n            }\n            if (!empty) {\n                this.isSignatureEmpty = false;\n            }\n        }\n    };\n    /**\n     * To check whether the signature is empty or not.\n     *\n     * @returns {boolean}.\n     */\n    SignatureBase.prototype.isEmpty = function () {\n        return this.isSignatureEmpty;\n    };\n    /**\n     * To check whether the undo collection is empty or not.\n     *\n     * @returns {boolean}.\n     */\n    SignatureBase.prototype.canUndo = function () {\n        return this.incStep > 0;\n    };\n    /**\n     * To check whether the redo collection is empty or not.\n     *\n     * @returns {boolean}.\n     */\n    SignatureBase.prototype.canRedo = function () {\n        return this.incStep < this.snapColl.length - 1;\n    };\n    /**\n     * To draw the signature based on the given text, with the font family and font size.\n     *\n     * @param {string} text - specify text to be drawn as signature.\n     * @param {string} fontFamily - specify font family of a signature.\n     * @param {number} fontSize - specify font size of a signature.\n     * @param {number} x- Specifies the x-coordinate to start the text of a signature. Default to the center point of the image if it not specified.\n     * @param {number} y - Specifies the y-coordinate to start the text of a signature. Default to the center point of the image if it not specified.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.draw = function (text, fontFamily, fontSize, x, y) {\n        var args = { actionName: 'draw-text' };\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        fontFamily = fontFamily || 'Arial';\n        fontSize = fontSize || 30;\n        this.canvasContext.font = fontSize + 'px ' + fontFamily;\n        var startX = this.element.width / 2;\n        var startY = this.element.height / 2;\n        if (isNullOrUndefined(x) && isNullOrUndefined(y)) {\n            this.canvasContext.textAlign = 'center';\n            this.canvasContext.textBaseline = 'middle';\n        }\n        else {\n            startX = isNullOrUndefined(x) ? startX : x;\n            startY = isNullOrUndefined(y) ? startY + fontSize / 2 : (y + fontSize / 2);\n        }\n        this.canvasContext.fillText(text, startX, startY);\n        this.updateSnapCollection();\n        this.isSignatureEmpty = false;\n        this.trigger('change', args);\n    };\n    /**\n     * To load the signature with the given base 64 string, height and width.\n     *\n     * @param {string} signature - specify the url/base 64 string to be drawn as signature.\n     * @param {number} width - specify the width of the loaded signature image.\n     * @param {number} height - specify the height of the loaded signature image.\n     * @returns {void}.\n     */\n    SignatureBase.prototype.load = function (signature, width, height) {\n        height = height || this.element.height;\n        width = width || this.element.width;\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var bitmapImage = new Image();\n        bitmapImage.src = signature;\n        if (signature.slice(0, 4) !== 'data') {\n            bitmapImage.crossOrigin = 'anonymous';\n        }\n        bitmapImage.onload = function () {\n            Promise.all([\n                createImageBitmap(bitmapImage, 0, 0, width, height)\n            ]).then(function (results) {\n                var tempCanvas = document.createElement('canvas');\n                tempCanvas.width = width;\n                tempCanvas.height = height;\n                tempCanvas.getContext('2d').drawImage(results[0], 0, 0);\n                if (signature.slice(0, 4) !== 'data') {\n                    proxy.canvasContext.globalCompositeOperation = 'source-over';\n                }\n                proxy.canvasContext.drawImage(tempCanvas, 0, 0, width, height, 0, 0, proxy.element.width, proxy.element.height);\n                proxy.updateSnapCollection();\n            });\n        };\n        this.isSignatureEmpty = this.canRedraw = false;\n    };\n    SignatureBase.prototype.saveBackground = function (savebg) {\n        var imageSrc;\n        if (savebg && this.backgroundImage) {\n            imageSrc = this.snapColl[this.incStep - 1];\n        }\n        else {\n            imageSrc = this.snapColl[this.incStep];\n        }\n        if (!savebg) {\n            this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n            if (this.backgroundImage) {\n                this.setBackgroundImage(this.backgroundImage);\n            }\n            else if (this.backgroundColor) {\n                this.setBackgroundColor(this.backgroundColor);\n                savebg = true;\n            }\n        }\n        if (savebg) {\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            var proxy_1 = this;\n            var imageObj_1 = new Image();\n            imageObj_1.crossOrigin = 'anonymous';\n            imageObj_1.src = imageSrc;\n            imageObj_1.onload = function () {\n                proxy_1.backgroundLoaded = true;\n                proxy_1.canvasContext.globalCompositeOperation = 'source-over';\n                proxy_1.canvasContext.drawImage(imageObj_1, 0, 0, proxy_1.element.width, proxy_1.element.height);\n                proxy_1.save(proxy_1.fileType, proxy_1.fileName);\n            };\n        }\n    };\n    /**\n     * To save the signature with the given file type and file name.\n     *\n     * @param {SignatureFileType} type - specify type of the file to be saved a signature.\n     * @param {string} fileName - specify name of the file to be saved a signature.\n     *\n     * @returns {void}.\n     */\n    SignatureBase.prototype.save = function (type, fileName) {\n        if (this.saveWithBackground && this.backgroundLoaded == null && (this.backgroundImage || this.backgroundColor)) {\n            this.backgroundLoaded = false;\n            this.fileType = type;\n            this.fileName = fileName;\n            this.saveBackground(false);\n        }\n        else if (type === 'Svg') {\n            fileName = fileName || 'Signature';\n            this.toSVG(fileName);\n        }\n        else if (type === 'Jpeg') {\n            fileName = fileName || 'Signature';\n            if (!this.saveWithBackground || this.saveWithBackground && !(this.backgroundImage || this.backgroundColor)) {\n                this.toJPEG(fileName);\n            }\n            else {\n                var dataURL = this.canvasContext.canvas.toDataURL('image/jpeg');\n                this.download(this.getBlob(dataURL), fileName + '.' + 'jpeg');\n            }\n        }\n        else {\n            fileName = fileName || 'Signature';\n            var dataURL = this.canvasContext.canvas.toDataURL('image/png');\n            this.download(this.getBlob(dataURL), fileName + '.' + 'png');\n        }\n        if (this.saveWithBackground && this.backgroundLoaded) {\n            this.resetSnap();\n        }\n    };\n    SignatureBase.prototype.resetSnap = function () {\n        this.canvasContext.clearRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var restoreObj = new Image();\n        restoreObj.src = this.snapColl[this.incStep - 1];\n        restoreObj.onload = function () {\n            proxy.canvasContext.drawImage(restoreObj, 0, 0, proxy.element.width, proxy.element.height);\n            proxy.updateSnapCollection();\n        };\n        this.backgroundLoaded = null;\n        this.snapColl.pop();\n        this.incStep--;\n        this.snapColl.pop();\n        this.incStep--;\n    };\n    SignatureBase.prototype.toJPEG = function (fileName) {\n        var _this = this;\n        var imageSrc = this.snapColl[this.incStep];\n        this.setBackgroundColor('#ffffff');\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var imageObj = new Image();\n        imageObj.crossOrigin = 'anonymous';\n        imageObj.src = imageSrc;\n        imageObj.onload = function () {\n            proxy.canvasContext.globalCompositeOperation = 'source-over';\n            proxy.canvasContext.drawImage(imageObj, 0, 0, proxy.element.width, proxy.element.height);\n            var dataURL = proxy.canvasContext.canvas.toDataURL('image/jpeg');\n            proxy.download(proxy.getBlob(dataURL), fileName + '.' + 'jpeg');\n            proxy.canvasContext.clearRect(0, 0, proxy.canvasContext.canvas.width, proxy.canvasContext.canvas.height);\n            _this.resizeHandler();\n        };\n        this.snapColl.pop();\n        this.incStep--;\n    };\n    SignatureBase.prototype.toSVG = function (fileName, dataUrl) {\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('width', this.canvasContext.canvas.width.toString());\n        svg.setAttribute('height', this.canvasContext.canvas.height.toString());\n        var XLinkNS = 'http://www.w3.org/1999/xlink';\n        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n        img.setAttributeNS(null, 'height', this.canvasContext.canvas.height.toString());\n        img.setAttributeNS(null, 'width', this.canvasContext.canvas.width.toString());\n        img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n        svg.appendChild(img);\n        var prefix = 'data:image/svg+xml;base64,';\n        var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"'\n            + (\" width=\\\"\" + this.canvasContext.canvas.width + \"\\\"\") + (\" height=\\\"\" + this.canvasContext.canvas.height + \"\\\"\") + '>';\n        var footer = '</svg>';\n        var body = svg.innerHTML;\n        var data = header + body + footer;\n        var svgDataUrl = prefix + btoa(data);\n        if (fileName == null) {\n            return svgDataUrl;\n        }\n        else {\n            this.download(this.getBlob(svgDataUrl), fileName + '.' + 'svg');\n            return null;\n        }\n    };\n    /**\n     * To save the signature as Blob.\n     *\n     * @returns {Blob}.\n     */\n    SignatureBase.prototype.saveAsBlob = function () {\n        return this.getBlob(this.canvasContext.canvas.toDataURL('image/png'));\n    };\n    /**\n     * Gets the signature as a Base 64 string.\n     *\n     * This method is used to retrieve the current signature on the canvas as a Base 64-encoded string, in the specified image format.\n     *\n     * @param {SignatureFileType} [type] - Specifies the type of the image format.\n     * Can be one of 'Png', 'Jpeg', or 'Svg'. If not specified, the default is 'Png'.\n     * @returns {string} - Returns the Base 64 string of the signature in the specified format.\n     */\n    SignatureBase.prototype.getSignature = function (type) {\n        if (this.saveWithBackground && this.backgroundColor && !this.backgroundImage) {\n            this.tempContext.fillStyle = this.backgroundColor;\n            this.tempContext.fillRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        }\n        else if (!this.backgroundColor && !this.backgroundImage && type === 'Jpeg') {\n            this.tempContext.fillStyle = '#fff';\n            this.tempContext.fillRect(0, 0, this.canvasContext.canvas.width, this.canvasContext.canvas.height);\n        }\n        this.tempContext.drawImage(this.element, 0, 0);\n        if (type === 'Jpeg') {\n            return this.tempCanvas.toDataURL('image/jpeg');\n        }\n        else if (type === 'Svg') {\n            return this.toSVG(null, this.tempCanvas.toDataURL('image/png'));\n        }\n        else {\n            return this.tempCanvas.toDataURL('image/png');\n        }\n    };\n    /**\n     * Get component name.\n     *\n     * @returns {string} - Module Name\n     * @private\n     */\n    SignatureBase.prototype.getModuleName = function () {\n        return 'signature';\n    };\n    /**\n     * To get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Persist data\n     */\n    SignatureBase.prototype.getPersistData = function () {\n        this.signatureValue = this.snapColl[this.incStep];\n        return this.addOnPersist(['signatureValue']);\n    };\n    /**\n     * Removes the component from the DOM and detaches all its related event handlers.\n     * Also it maintains the initial input element from the DOM.\n     *\n     * @method destroy\n     * @returns {void}\n     */\n    SignatureBase.prototype.destroy = function () {\n        if (this.getModuleName() !== 'image-editor') {\n            this.unwireEvents(null);\n            removeClass([this.element], 'e-' + this.getModuleName());\n            this.element.removeAttribute('tabindex');\n            this.pointColl = null;\n            this.tempContext = null;\n            this.tempCanvas = null;\n            this.canvasContext = null;\n        }\n        _super.prototype.destroy.call(this);\n        this.element = null;\n    };\n    /**\n     * Modified onPropertyChanged method for both blazor and EJ2 signature component.\n     *\n     * @private\n     * @param {string} key - Specifies the property, which changed.\n     * @param {string} value - Specifies the property value changed.\n     * @returns {void}\n     */\n    SignatureBase.prototype.propertyChanged = function (key, value) {\n        var canvasNew = this.canvasContext;\n        switch (key) {\n            case 'backgroundColor':\n                canvasNew.canvas.style.backgroundColor = value;\n                this.backgroundColor = value;\n                break;\n            case 'backgroundImage':\n                canvasNew.canvas.style.backgroundImage = 'url(' + value + ')';\n                this.backgroundImage = value;\n                if (this.saveWithBackground) {\n                    this.setBackgroundImage(this.backgroundImage, 'temp');\n                }\n                break;\n            case 'strokeColor':\n                canvasNew.fillStyle = value;\n                this.strokeColor = value;\n                break;\n            case 'saveWithBackground':\n                this.saveWithBackground = value;\n                break;\n            case 'maxStrokeWidth':\n                this.maxStrokeWidth = value;\n                break;\n            case 'minStrokeWidth':\n                this.minStrokeWidth = value;\n                break;\n            case 'velocity':\n                this.velocity = value;\n                break;\n            case 'isReadOnly':\n                this.isRead(value);\n                break;\n            case 'disabled':\n                this.enableOrDisable(value);\n                break;\n        }\n    };\n    return SignatureBase;\n}(Component));\nexport { SignatureBase };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}