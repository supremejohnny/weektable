{"ast":null,"code":"var _jsxFileName = \"D:\\\\weektable\\\\frontend\\\\src\\\\components\\\\Stats.js\",\n  _s = $RefreshSig$();\n// src/components/Stats.js\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Stats({\n  weekly,\n  tasks\n}) {\n  _s();\n  const [allRecords, setAllRecords] = useState([]);\n\n  // 拉取所有打卡记录\n  useEffect(() => {\n    axios.get('/api/daily_records/all').then(res => setAllRecords(res.data)).catch(err => console.error('获取全部记录失败', err));\n  }, []);\n\n  // 全局坚持天数：去重后的日期数\n  const uniqueDays = new Set(allRecords.map(r => r.date)).size;\n  // 全局完成总项：总记录条目数\n  const totalDoneGlobal = allRecords.length;\n\n  // 本周坚持天数 & 本周完成总数，复用 weekly prop\n  const daysThisWeek = weekly.filter(day => tasks.some(t => day[`task_${t.id}`])).length;\n  const totalThisWeek = weekly.reduce((sum, day) => sum + tasks.reduce((s, t) => s + (day[`task_${t.id}`] ? 1 : 0), 0), 0);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"\\u8BB0\\u5F55\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\u4ECE\\u5F00\\u59CB\\u5230\\u73B0\\u5728\\uFF0C\\u4F60\\u575A\\u6301\\u4E86 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: uniqueDays\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 21\n      }, this), \" \\u5929\\uFF0C\\u5B8C\\u6210\\u4E86 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: totalDoneGlobal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 57\n      }, this), \" \\u9879\\u4EFB\\u52A1\\u3002\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\u672C\\u5468\\u4F60\\u575A\\u6301\\u4E86 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: daysThisWeek\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 16\n      }, this), \" \\u5929\\uFF0C\\u5B8C\\u6210\\u4E86 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: totalThisWeek\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 54\n      }, this), \" \\u9879\\u4EFB\\u52A1\\u3002\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 31,\n    columnNumber: 5\n  }, this);\n}\n_s(Stats, \"yPlAe3jX+VpHjrOoGFCK4XVHpdw=\");\n_c = Stats;\nvar _c;\n$RefreshReg$(_c, \"Stats\");","map":{"version":3,"names":["React","useEffect","useState","axios","jsxDEV","_jsxDEV","Stats","weekly","tasks","_s","allRecords","setAllRecords","get","then","res","data","catch","err","console","error","uniqueDays","Set","map","r","date","size","totalDoneGlobal","length","daysThisWeek","filter","day","some","t","id","totalThisWeek","reduce","sum","s","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/weektable/frontend/src/components/Stats.js"],"sourcesContent":["// src/components/Stats.js\r\nimport React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nexport default function Stats({ weekly, tasks }) {\r\n  const [allRecords, setAllRecords] = useState([]);\r\n\r\n  // 拉取所有打卡记录\r\n  useEffect(() => {\r\n    axios.get('/api/daily_records/all')\r\n      .then(res => setAllRecords(res.data))\r\n      .catch(err => console.error('获取全部记录失败', err));\r\n  }, []);\r\n\r\n  // 全局坚持天数：去重后的日期数\r\n  const uniqueDays = new Set(allRecords.map(r => r.date)).size;\r\n  // 全局完成总项：总记录条目数\r\n  const totalDoneGlobal = allRecords.length;\r\n\r\n  // 本周坚持天数 & 本周完成总数，复用 weekly prop\r\n  const daysThisWeek = weekly.filter(day =>\r\n    tasks.some(t => day[`task_${t.id}`])\r\n  ).length;\r\n  const totalThisWeek = weekly.reduce((sum, day) =>\r\n    sum + tasks.reduce((s,t) =>\r\n      s + (day[`task_${t.id}`] ? 1 : 0)\r\n    ,0)\r\n  ,0);\r\n\r\n  return (\r\n    <div>\r\n      <h3>记录</h3>\r\n      <p>\r\n        从开始到现在，你坚持了 <strong>{uniqueDays}</strong> 天，完成了 <strong>{totalDoneGlobal}</strong> 项任务。\r\n      </p>\r\n      <p>\r\n        本周你坚持了 <strong>{daysThisWeek}</strong> 天，完成了 <strong>{totalThisWeek}</strong> 项任务。\r\n      </p>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,eAAe,SAASC,KAAKA,CAAC;EAAEC,MAAM;EAAEC;AAAM,CAAC,EAAE;EAAAC,EAAA;EAC/C,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGT,QAAQ,CAAC,EAAE,CAAC;;EAEhD;EACAD,SAAS,CAAC,MAAM;IACdE,KAAK,CAACS,GAAG,CAAC,wBAAwB,CAAC,CAChCC,IAAI,CAACC,GAAG,IAAIH,aAAa,CAACG,GAAG,CAACC,IAAI,CAAC,CAAC,CACpCC,KAAK,CAACC,GAAG,IAAIC,OAAO,CAACC,KAAK,CAAC,UAAU,EAAEF,GAAG,CAAC,CAAC;EACjD,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMG,UAAU,GAAG,IAAIC,GAAG,CAACX,UAAU,CAACY,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,IAAI;EAC5D;EACA,MAAMC,eAAe,GAAGhB,UAAU,CAACiB,MAAM;;EAEzC;EACA,MAAMC,YAAY,GAAGrB,MAAM,CAACsB,MAAM,CAACC,GAAG,IACpCtB,KAAK,CAACuB,IAAI,CAACC,CAAC,IAAIF,GAAG,CAAC,QAAQE,CAAC,CAACC,EAAE,EAAE,CAAC,CACrC,CAAC,CAACN,MAAM;EACR,MAAMO,aAAa,GAAG3B,MAAM,CAAC4B,MAAM,CAAC,CAACC,GAAG,EAAEN,GAAG,KAC3CM,GAAG,GAAG5B,KAAK,CAAC2B,MAAM,CAAC,CAACE,CAAC,EAACL,CAAC,KACrBK,CAAC,IAAIP,GAAG,CAAC,QAAQE,CAAC,CAACC,EAAE,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAClC,CAAC,CAAC,EACJ,CAAC,CAAC;EAEH,oBACE5B,OAAA;IAAAiC,QAAA,gBACEjC,OAAA;MAAAiC,QAAA,EAAI;IAAE;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACXrC,OAAA;MAAAiC,QAAA,GAAG,qEACW,eAAAjC,OAAA;QAAAiC,QAAA,EAASlB;MAAU;QAAAmB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAS,CAAC,oCAAO,eAAArC,OAAA;QAAAiC,QAAA,EAASZ;MAAe;QAAAa,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAS,CAAC,6BACpF;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,eACJrC,OAAA;MAAAiC,QAAA,GAAG,uCACM,eAAAjC,OAAA;QAAAiC,QAAA,EAASV;MAAY;QAAAW,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAS,CAAC,oCAAO,eAAArC,OAAA;QAAAiC,QAAA,EAASJ;MAAa;QAAAK,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAS,CAAC,6BAC/E;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACD,CAAC;AAEV;AAACjC,EAAA,CApCuBH,KAAK;AAAAqC,EAAA,GAALrC,KAAK;AAAA,IAAAqC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}