{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nimport { remove, createElement, closest, formatUnit, Browser, extend } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { dataReady, modelChanged, refreshVirtualBlock, contentReady } from '../base/constant';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { ContentRender } from './content-renderer';\nimport { HeaderRender } from './header-renderer';\nimport { InterSectionObserver } from '../services/intersection-observer';\nimport { VirtualRowModelGenerator } from '../services/virtual-row-model-generator';\nimport { isGroupAdaptive, ensureLastRow, ensureFirstRow, getEditedDataIndex, getTransformValues, checkIsVirtual, getVisiblePage, parentsUntil } from '../base/util';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport * as literals from '../base/string-literals';\n/**\n * VirtualContentRenderer\n *\n * @hidden\n */\nvar VirtualContentRenderer = /** @class */function (_super) {\n  __extends(VirtualContentRenderer, _super);\n  function VirtualContentRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n    _this.prevHeight = 0;\n    /** @hidden */\n    _this.startIndex = 0;\n    _this.preStartIndex = 0;\n    _this.preventEvent = false;\n    _this.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];\n    /** @hidden */\n    _this.offsets = {};\n    _this.tmpOffsets = {};\n    /** @hidden */\n    _this.virtualEle = new VirtualElementHandler();\n    _this.offsetKeys = [];\n    _this.isFocused = false;\n    _this.isSelection = false;\n    _this.isBottom = false;\n    _this.isBottomNotify = false;\n    _this.diff = 0;\n    _this.heightChange = false;\n    /** @hidden */\n    _this.isTop = false;\n    _this.empty = undefined;\n    _this.isCancel = false;\n    _this.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save', 'sorting'];\n    _this.isNormaledit = _this.parent.editSettings.mode === 'Normal';\n    /** @hidden */\n    _this.virtualData = {};\n    _this.virtualInfiniteData = {};\n    _this.emptyRowData = {};\n    _this.isContextMenuOpen = false;\n    _this.isSelectionScroll = false;\n    _this.validationCheck = false;\n    /** @hidden */\n    _this.firstCellFocus = false;\n    _this.prevPage = 0;\n    _this.prevCurrentInfo = {};\n    _this.locator = locator;\n    _this.eventListener('on');\n    _this.widthServices = locator.getService('widthService');\n    _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n    _this.vgenerator = _this.generator;\n    return _this;\n  }\n  VirtualContentRenderer.prototype.renderTable = function () {\n    this.header = this.locator.getService('rendererFactory').getRenderer(RenderType.Header);\n    _super.prototype.renderTable.call(this);\n    this.virtualEle.table = this.getTable();\n    this.virtualEle.content = this.content = this.getPanel().querySelector('.' + literals.content);\n    this.virtualEle.renderWrapper(this.parent.height);\n    this.virtualEle.renderPlaceHolder();\n    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n      this.virtualEle.wrapper.style.position = 'absolute';\n    }\n    var debounceEvent = this.parent.dataSource instanceof DataManager && !this.parent.dataSource.dataSource.offline;\n    var opt = {\n      container: this.content,\n      pageHeight: this.getBlockHeight() * 2,\n      debounceEvent: debounceEvent,\n      axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y']\n    };\n    this.observer = new InterSectionObserver(this.virtualEle.wrapper, opt);\n  };\n  VirtualContentRenderer.prototype.renderEmpty = function (tbody) {\n    this.getTable().appendChild(tbody);\n    if (this.parent.frozenRows) {\n      this.parent.getHeaderContent().querySelector(literals.tbody).innerHTML = '';\n    }\n    this.virtualEle.adjustTable(0, 0);\n  };\n  VirtualContentRenderer.prototype.getReorderedFrozenRows = function (args) {\n    var blockIndex = args.virtualInfo.blockIndexes;\n    var colsIndex = args.virtualInfo.columnIndexes;\n    var page = args.virtualInfo.page;\n    args.virtualInfo.blockIndexes = [1, 2];\n    args.virtualInfo.page = 1;\n    args.virtualInfo.columnIndexes = [];\n    var recordslength = this.parent.getCurrentViewRecords().length;\n    var firstRecords = this.parent.renderModule.data.dataManager.dataSource.json.slice(0, recordslength);\n    var virtualRows = this.vgenerator.generateRows(firstRecords, args);\n    args.virtualInfo.blockIndexes = blockIndex;\n    args.virtualInfo.columnIndexes = colsIndex;\n    args.virtualInfo.page = page;\n    return virtualRows.splice(0, this.parent.frozenRows);\n  };\n  VirtualContentRenderer.prototype.scrollListener = function (scrollArgs) {\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization && (scrollArgs.direction === 'up' || scrollArgs.direction === 'down') || this.isBottomNotify) {\n      return;\n    }\n    this.scrollAfterEdit();\n    if (this.parent.enablePersistence) {\n      this.parent.scrollPosition = scrollArgs.offset;\n    }\n    if (this.preventEvent || this.parent.isDestroyed) {\n      this.preventEvent = false;\n      return;\n    }\n    if (isNullOrUndefined(document.activeElement)) {\n      this.isFocused = false;\n    } else {\n      this.isFocused = this.content === closest(document.activeElement, '.' + literals.content) || this.content === document.activeElement;\n    }\n    if (this.parent.islazyloadRequest && scrollArgs.direction === 'down') {\n      this.parent.removeMaskRow();\n      this.parent.islazyloadRequest = false;\n      return;\n    }\n    var info = scrollArgs.sentinel;\n    var viewInfo = this.currentInfo = this.getInfoFromView(scrollArgs.direction, info, scrollArgs.offset);\n    if (isGroupAdaptive(this.parent)) {\n      if (viewInfo.blockIndexes && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString()) {\n        this.parent.removeMaskRow();\n        return;\n      } else {\n        viewInfo.event = 'refresh-virtual-block';\n        if (!isNullOrUndefined(viewInfo.offsets)) {\n          viewInfo.offsets.top = this.content.scrollTop;\n        }\n        this.parent.pageSettings.currentPage = viewInfo.page;\n        if (this.parent.enableVirtualMaskRow) {\n          this.parent.showMaskRow(info.axis);\n          this.parent.addShimmerEffect();\n        }\n        if (this.parent.editSettings.showAddNewRow) {\n          this.parent.closeEdit();\n        }\n        this.parent.notify(viewInfo.event, {\n          requestType: 'virtualscroll',\n          virtualInfo: viewInfo,\n          focusElement: scrollArgs.focusElement\n        });\n        return;\n      }\n    }\n    if (this.prevInfo && (info.axis === 'Y' && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString() || info.axis === 'X' && this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString() || this.parent.isFrozenGrid() && info.axis === 'X' && this.parent.getVisibleFrozenLeftCount() >= viewInfo.columnIndexes[0] && this.prevInfo.columnIndexes.toString().includes(viewInfo.columnIndexes.toString()))) {\n      this.parent.removeMaskRow();\n      if (Browser.isIE) {\n        this.parent.hideSpinner();\n      }\n      this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n      if (info.axis === 'Y') {\n        this.restoreEdit();\n      }\n      if (this.parent.groupSettings.enableLazyLoading && this.prevInfo.blockIndexes[0] === 1 && viewInfo.blockIndexes[0] === 1 && scrollArgs.direction === 'up') {\n        this.virtualEle.adjustTable(0, viewInfo.offsets.top < this.offsets[1] ? 0 : this.getBlockHeight());\n      }\n      return;\n    }\n    this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? viewInfo.columnIndexes : []);\n    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n      this.parent.pageSettings.currentPage = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n    }\n    this.requestType = 'virtualscroll';\n    if (this.parent.enableVirtualMaskRow) {\n      this.parent.showMaskRow(info.axis);\n      this.parent.addShimmerEffect();\n    }\n    this.parent.islazyloadRequest = false;\n    if (this.parent.editSettings.showAddNewRow) {\n      this.parent.closeEdit();\n    }\n    this.parent.notify(events.renderResponsiveColumnChooserDiv, {\n      action: 'clear'\n    });\n    if (!(!this.parent.isInitialLoad && this.parent.enablePersistence)) {\n      if (this.prevPage === this.parent.pageSettings.currentPage && viewInfo.event === modelChanged) {\n        this.currentInfo = this.prevCurrentInfo;\n        return;\n      }\n      if (viewInfo.event === modelChanged) {\n        this.prevPage = this.parent.pageSettings.currentPage;\n        this.prevCurrentInfo = this.currentInfo;\n      }\n      this.isBottomNotify = this.isBottom && viewInfo.event === modelChanged;\n      this.parent.notify(viewInfo.event, {\n        requestType: 'virtualscroll',\n        virtualInfo: viewInfo,\n        focusElement: scrollArgs.focusElement\n      });\n    }\n    if (this.parent.enableColumnVirtualization && !this.parent.getContentTable().querySelector('tr.e-row')) {\n      this.parent.removeMaskRow();\n      this.appendContent(undefined, undefined, {\n        requestType: 'virtualscroll',\n        virtualInfo: viewInfo,\n        focusElement: scrollArgs.focusElement\n      });\n      this.prevInfo = viewInfo;\n    }\n  };\n  VirtualContentRenderer.prototype.block = function (blk) {\n    return this.vgenerator.isBlockAvailable(blk);\n  };\n  VirtualContentRenderer.prototype.getInfoFromView = function (direction, info, e) {\n    var isBlockAdded = false;\n    var tempBlocks = [];\n    var infoType = {\n      direction: direction,\n      sentinelInfo: info,\n      offsets: e,\n      startIndex: this.preStartIndex,\n      endIndex: this.preEndIndex\n    };\n    infoType.page = this.getPageFromTop(e.top, infoType);\n    infoType.blockIndexes = tempBlocks = this.vgenerator.getBlockIndexes(infoType.page);\n    infoType.loadSelf = !this.vgenerator.isBlockAvailable(tempBlocks[infoType.block]);\n    var blocks = this.ensureBlocks(infoType);\n    if (this.activeKey === 'upArrow' && infoType.blockIndexes.toString() !== blocks.toString()) {\n      // To avoid dupilcate row index problem in key focus support\n      var newBlock = blocks[blocks.length - 1];\n      if (infoType.blockIndexes.indexOf(newBlock) === -1) {\n        isBlockAdded = true;\n      }\n    }\n    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n      infoType.blockIndexes = blocks;\n    }\n    infoType.loadNext = !blocks.filter(function (val) {\n      return tempBlocks.indexOf(val) === -1;\n    }).every(this.block.bind(this));\n    infoType.event = infoType.loadNext || infoType.loadSelf ? modelChanged : refreshVirtualBlock;\n    infoType.nextInfo = infoType.loadNext ? {\n      page: Math.max(1, infoType.page + (direction === 'down' ? 1 : -1))\n    } : {};\n    if (isBlockAdded) {\n      infoType.blockIndexes = [infoType.blockIndexes[0] - 1, infoType.blockIndexes[0], infoType.blockIndexes[0] + 1];\n    }\n    if (this.activeKey === 'downArrow' && !isNaN(this.rowIndex)) {\n      var firstBlock = Math.ceil(this.rowIndex / this.getBlockSize());\n      if (firstBlock !== 1 && (infoType.blockIndexes[1] !== firstBlock || infoType.blockIndexes.length < 3)) {\n        infoType.blockIndexes = [firstBlock - 1, firstBlock, firstBlock + 1];\n        if (infoType.loadNext) {\n          var nextBlock = this.vgenerator.getBlockIndexes(infoType.nextInfo.page);\n          var hasCommonValue = false;\n          for (var i = 0; i < infoType.blockIndexes.length; i++) {\n            for (var j = 0; j < nextBlock.length; j++) {\n              if (infoType.blockIndexes[parseInt(i.toString(), 10)] === nextBlock[parseInt(j.toString(), 10)]) {\n                hasCommonValue = true;\n                break;\n              }\n            }\n            if (hasCommonValue) {\n              break;\n            }\n          }\n          if (!hasCommonValue) {\n            infoType.loadNext = false;\n            infoType.nextInfo = {};\n            infoType.event = refreshVirtualBlock;\n          }\n        }\n      }\n    }\n    infoType.columnIndexes = info.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();\n    if (this.parent.enableColumnVirtualization && info.axis === 'X') {\n      infoType.event = refreshVirtualBlock;\n    }\n    return infoType;\n  };\n  VirtualContentRenderer.prototype.ensureBlocks = function (info) {\n    var _this = this;\n    var index = info.blockIndexes[info.block];\n    var mIdx;\n    var old = index;\n    var max = Math.max;\n    var indexes = info.direction === 'down' ? [max(index, 1), ++index, ++index] : [max(index - 1, 1), index, index + 1];\n    this.prevInfo = this.prevInfo || this.vgenerator.getData();\n    indexes = indexes.filter(function (val, ind) {\n      return indexes.indexOf(val) === ind;\n    });\n    var preventSelf = false;\n    if (checkIsVirtual(this.parent) && info.direction === 'up' && ((info.page + 1 === this.prevInfo.page || info.page === this.prevInfo.page) && (info.block === 1 || info.block === 0 && info.page === 1) || info.page === this.prevInfo.page && indexes.length === 2) && this.vgenerator.isBlockAvailable(info.blockIndexes[1] + 1)) {\n      preventSelf = info.page + 1 === this.prevInfo.page && info.block === 1;\n      index += 1;\n      indexes = [max(index - 1, 1), index, index + 1];\n    }\n    if (this.prevInfo.blockIndexes.toString() === indexes.toString()) {\n      return indexes;\n    }\n    if (info.loadSelf && !preventSelf || info.direction === 'down' && this.isEndBlock(old)) {\n      indexes = this.vgenerator.getBlockIndexes(info.page);\n    }\n    indexes.some(function (val, ind) {\n      var result = val === (isGroupAdaptive(_this.parent) ? _this.getGroupedTotalBlocks() : _this.getTotalBlocks());\n      if (result) {\n        mIdx = ind;\n      }\n      return result;\n    });\n    if (mIdx !== undefined) {\n      indexes = indexes.slice(0, mIdx + 1);\n      if (info.block === 0 && indexes.length === 1 && this.vgenerator.isBlockAvailable(indexes[0] - 1)) {\n        indexes = [indexes[0] - 1, indexes[0]];\n      }\n    }\n    return indexes;\n  };\n  // tslint:disable-next-line:max-func-body-length\n  VirtualContentRenderer.prototype.appendContent = function (target, newChild, e) {\n    var _this = this;\n    // currentInfo value will be used if there are multiple dom updates happened due to mousewheel\n    var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && this.currentInfo.page && this.currentInfo.page !== e.virtualInfo.page ? this.currentInfo : e.virtualInfo;\n    this.prevInfo = this.prevInfo || e.virtualInfo;\n    var cBlock = info.columnIndexes[0] - 1;\n    var cOffset = this.getColumnOffset(cBlock);\n    var width;\n    var blocks = info.blockIndexes;\n    if (this.parent.groupSettings.columns.length) {\n      this.refreshOffsets();\n    }\n    if (this.parent.height === '100%') {\n      this.parent.element.style.height = '100%';\n    }\n    var vHeight = this.parent.height.toString().indexOf('%') < 0 ? this.content.getBoundingClientRect().height : this.parent.element.getBoundingClientRect().height;\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n      vHeight = 0;\n    }\n    var reduceWidth = 0;\n    if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n      var frzLeftWidth_1 = 0;\n      this.parent.getColumns().filter(function (col) {\n        if (col.visible) {\n          reduceWidth += parseInt(col.width.toString(), 10);\n          if (col.freeze === 'Left') {\n            frzLeftWidth_1 += parseInt(col.width.toString(), 10);\n          }\n        }\n      });\n      var cIndex = info.columnIndexes;\n      width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n      if (cBlock > this.parent.getVisibleFrozenLeftCount()) {\n        cOffset = cOffset - frzLeftWidth_1;\n      }\n      this.resetStickyLeftPos(cOffset, newChild);\n    }\n    if (!this.requestTypes.some(function (value) {\n      return value === _this.requestType;\n    })) {\n      var translate = this.getTranslateY(this.content.scrollTop, vHeight, info);\n      if (this.parent.groupSettings.enableLazyLoading && info && this.prevInfo && this.prevInfo.blockIndexes[0] === 1 && info.blockIndexes[0] === 1 && info.direction === 'up') {\n        this.virtualEle.adjustTable(0, this.content.scrollTop < this.offsets[1] ? 0 : this.getBlockHeight());\n      } else {\n        this.virtualEle.adjustTable(cOffset, translate);\n      }\n    }\n    if (this.parent.enableColumnVirtualization) {\n      this.header.virtualEle.adjustTable(cOffset, 0);\n    }\n    if (this.parent.enableColumnVirtualization) {\n      var cIndex = info.columnIndexes;\n      width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n      if (this.parent.isFrozenGrid()) {\n        width = reduceWidth.toString();\n        if (this.parent.allowResizing) {\n          this.parent.getHeaderTable().style.width = reduceWidth + 'px';\n          this.parent.getContentTable().style.width = reduceWidth + 'Px';\n        }\n      }\n      this.header.virtualEle.setWrapperWidth(width);\n    }\n    this.virtualEle.setWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n    if (this.parent.enableColumnVirtualization && isNullOrUndefined(target) && isNullOrUndefined(newChild)) {\n      return;\n    }\n    if (!isNullOrUndefined(target) && !isNullOrUndefined(target.parentNode)) {\n      remove(target);\n    }\n    var tbody = this.parent.element.querySelector('.' + literals.content).querySelector(literals.tbody);\n    if (tbody) {\n      remove(tbody);\n      target = null;\n    }\n    var isReact = this.parent.isReact && !isNullOrUndefined(this.parent.rowTemplate);\n    if (!isReact) {\n      target = this.parent.createElement(literals.tbody, {\n        attrs: {\n          role: 'rowgroup'\n        }\n      });\n      target.appendChild(newChild);\n    } else {\n      target = newChild;\n    }\n    if (this.parent.frozenRows && e.requestType === 'virtualscroll' && (this.parent.pageSettings.currentPage === 1 || this.isInfiniteColumnvirtualization())) {\n      for (var i = 0; i < this.parent.frozenRows; i++) {\n        target.children[0].remove();\n      }\n    }\n    this.getTable().appendChild(target);\n    this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization && (info.direction === 'right' || info.direction === 'left')) {\n      this.content.scrollTop = this.currentInfo.offsets.top;\n      this.content.scrollLeft = this.currentInfo.offsets.left;\n    }\n    if (this.parent.groupSettings.columns.length) {\n      if (!isGroupAdaptive(this.parent) && info.direction === 'up') {\n        var blk = this.offsets[this.getTotalBlocks()] - this.prevHeight;\n        var sTop = this.content.scrollTop;\n        this.content.scrollTop = sTop + blk;\n      }\n      this.setVirtualHeight();\n      if (!this.parent.groupSettings.enableLazyLoading) {\n        this.observer.setPageHeight(this.getOffset(blocks[blocks.length - 1]) - this.getOffset(blocks[0] - 1));\n      }\n    }\n    if (!this.parent.groupSettings.enableLazyLoading && this.parent.groupSettings.columns.length === 0 && e.requestType === 'ungrouping') {\n      this.observer.setPageHeight(this.getBlockHeight() * 2);\n    }\n    this.prevInfo = info;\n    if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {\n      this.content.focus();\n    }\n    var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n    if (this.isBottom) {\n      this.isBottom = false;\n      this.isBottomNotify = false;\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n    }\n    if ((this.parent.pageSettings.currentPage + 1 === lastPage || this.parent.pageSettings.currentPage === lastPage) && blocks.length === 2 && e.requestType === 'delete') {\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n    }\n    if (this.parent.pageSettings.currentPage === lastPage && blocks.length === 1) {\n      this.isBottom = true;\n      setTimeout(function () {\n        var scrollElement = _this.parent.getContent().firstElementChild;\n        scrollElement.scrollTop = _this.offsets[_this.offsetKeys.length - 2];\n        var scrollValues = {\n          direction: 'up',\n          sentinel: _this.observer.sentinelInfo.up,\n          offset: {\n            top: scrollElement.scrollTop,\n            left: scrollElement.scrollLeft\n          },\n          focusElement: _this.parent.element\n        };\n        _this.scrollListener(scrollValues);\n      }, 0);\n    }\n    if (this.isTop) {\n      this.parent.getContent().firstElementChild.scrollTop = 0;\n      this.isTop = false;\n    }\n    if (e.requestType === 'virtualscroll' && e.virtualInfo.sentinelInfo.axis === 'X') {\n      this.parent.notify(events.autoCol, {});\n    }\n    this.focusCell(e);\n    if (this.firstCellFocus) {\n      this.firstCellFocus = false;\n      var focusModule = this.parent.focusModule;\n      var current = focusModule.active.matrix.current;\n      var cell = this.parent.getContentTable().rows[current[0]].cells[current[1]];\n      focusModule.currentInfo.element = cell;\n      focusModule.currentInfo.elementToFocus = cell;\n      cell.classList.add('e-focus');\n      cell.classList.add('e-focused');\n      cell.tabIndex = 0;\n      cell.focus();\n    }\n    this.restoreEdit(e);\n    this.restoreAdd();\n    this.ensureSelectedRowPosition();\n    this.validationScrollLeft();\n    if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {\n      this.widthServices.refreshFrozenScrollbar();\n    }\n    if (!this.initialRowTop) {\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      if (this.parent.getRowByIndex(0)) {\n        this.initialRowTop = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.validationScrollLeft = function () {\n    if (this.validationCheck) {\n      if (this.validationCol) {\n        var offset = this.vgenerator.cOffsets[this.validationCol.index - this.parent.getVisibleFrozenColumns() - 1];\n        this.validationCol = null;\n        this.content.scrollLeft = offset;\n      } else {\n        this.validationCheck = false;\n        this.parent.editModule.editFormValidate();\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.ensureSelectedRowPosition = function () {\n    if (!this.isSelection && this.isSelectionScroll && !isNullOrUndefined(this.selectRowIndex)) {\n      this.isSelectionScroll = false;\n      var row = this.parent.getRowByIndex(this.selectRowIndex);\n      if (row && !this.isRowInView(row)) {\n        this.rowSelected({\n          rowIndex: this.selectRowIndex,\n          row: row\n        }, true);\n      }\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  VirtualContentRenderer.prototype.focusCell = function (e) {\n    if (this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n      return;\n    }\n    var row = this.parent.getRowByIndex(this.rowIndex);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var cell = row.cells[this.cellIndex];\n    cell.focus({\n      preventScroll: true\n    });\n    if (!this.parent.selectionSettings.checkboxOnly) {\n      this.parent.selectRow(parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1);\n    }\n    this.activeKey = this.empty;\n  };\n  VirtualContentRenderer.prototype.restoreEdit = function (e) {\n    if (this.isNormaledit) {\n      if (this.parent.editSettings.allowEditing && this.parent.editModule && !isNullOrUndefined(this.editedRowIndex)) {\n        var row = this.getRowByIndex(this.editedRowIndex);\n        var content = this.content;\n        var keys = Object.keys(this.virtualData);\n        var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n        if (keys.length && row && !content.querySelector('.' + literals.editedRow) && ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'].indexOf(e.requestType) === -1) {\n          var top_1 = row.getBoundingClientRect().top - this.parent.element.getBoundingClientRect().top;\n          if (isXaxis || top_1 < this.content.offsetHeight && top_1 > this.parent.getRowHeight()) {\n            this.parent.isEdit = false;\n            this.parent.editModule.startEdit(row);\n          }\n        }\n        if (row && this.content.querySelector('.' + literals.editedRow) && !keys.length) {\n          var rowData = !this.parent.enableVirtualization && this.parent.enableColumnVirtualization ? this.enableCacheOnInfiniteColumnVirtual() ? this.virtualInfiniteData : extend({}, this.parent.getCurrentViewRecords()[this.editedRowIndex]) : extend({}, this.getRowObjectByIndex(this.editedRowIndex));\n          this.virtualData = this.getVirtualEditedData(rowData);\n        }\n      }\n      this.restoreAdd();\n    }\n  };\n  VirtualContentRenderer.prototype.getVirtualEditedData = function (rowData) {\n    var editForms = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));\n    var isFormDestroyed = this.parent.editModule && this.parent.editModule.formObj && this.parent.editModule.formObj.isDestroyed;\n    if (!isFormDestroyed) {\n      for (var i = 0; i < editForms.length; i++) {\n        rowData = this.parent.editModule.getCurrentEditedData(editForms[parseInt(i.toString(), 10)], rowData);\n      }\n    }\n    return rowData;\n  };\n  VirtualContentRenderer.prototype.restoreAdd = function () {\n    var startAdd = !this.parent.element.querySelector('.' + literals.addedRow);\n    if (this.isNormaledit && this.isAdd && startAdd) {\n      var isTop = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();\n      var isBottom = this.parent.editSettings.newRowPosition === 'Bottom' && this.parent.pageSettings.currentPage === this.maxPage;\n      if (isTop || isBottom) {\n        this.parent.isEdit = false;\n        this.parent.addRecord();\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.onDataReady = function (e) {\n    if (!isNullOrUndefined(e.count)) {\n      this.count = e.count;\n      this.maxPage = Math.ceil((this.parent.groupSettings.columns.length && this.parent.vcRows.length ? this.parent.vcRows.length : e.count) / this.parent.pageSettings.pageSize);\n    }\n    this.vgenerator.checkAndResetCache(e.requestType);\n    if (['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', undefined].some(function (value) {\n      return e.requestType === value;\n    })) {\n      this.refreshOffsets();\n    }\n    this.setVirtualHeight();\n    this.resetScrollPosition(e.requestType);\n  };\n  /**\n   * @param {number} height - specifies the height\n   * @returns {void}\n   * @hidden\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  VirtualContentRenderer.prototype.setVirtualHeight = function (height) {\n    var width = this.parent.enableColumnVirtualization ? this.getColumnOffset(this.parent.getVisibleColumns().length + this.parent.groupSettings.columns.length - 1) + 'px' : '100%';\n    var virtualHeight = this.offsets[isGroupAdaptive(this.parent) && this.count !== 0 ? this.getGroupedTotalBlocks() : this.getTotalBlocks()];\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n      virtualHeight = 0;\n    }\n    var totalBlocks = isGroupAdaptive(this.parent) && this.count !== 0 ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    var lastPage = Math.ceil(totalBlocks / 2);\n    var placeHolderBottom = Math.round(this.virtualEle.placeholder.getBoundingClientRect().bottom);\n    var wrapperBottom = Math.round(this.virtualEle.wrapper.getBoundingClientRect().bottom);\n    if ((this.currentInfo.page === lastPage || this.currentInfo.page + 1 === lastPage) && this.currentInfo.direction === 'down' && placeHolderBottom > wrapperBottom && !this.diff) {\n      this.diff = placeHolderBottom - wrapperBottom;\n    }\n    if (this.diff && this.currentInfo.page === lastPage && placeHolderBottom > wrapperBottom && !(this.isAdd && this.parent.editSettings.newRowPosition === 'Bottom')) {\n      virtualHeight -= this.diff;\n      this.heightChange = true;\n    } else if (this.requestType === 'virtualscroll' && this.diff && this.heightChange) {\n      virtualHeight -= this.diff;\n      this.heightChange = false;\n    }\n    this.virtualEle.setVirtualHeight(virtualHeight, width);\n    if (this.virtualEle && this.virtualEle.wrapper) {\n      if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n        this.virtualEle.wrapper.style.minHeight = '';\n      } else {\n        this.virtualEle.wrapper.style.minHeight = !isNullOrUndefined(virtualHeight) ? formatUnit(this.parent.height) : '0px';\n      }\n    }\n    if (this.parent.enableColumnVirtualization) {\n      this.header.virtualEle.setVirtualHeight(1, width);\n    }\n  };\n  /**\n   * @param {number} sTop - specifies the sTop\n   * @param {VirtualInfo} info - specifies the info\n   * @returns {number} - return the page\n   * @hidden\n   */\n  VirtualContentRenderer.prototype.getPageFromTop = function (sTop, info) {\n    var _this = this;\n    var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    var page = 0;\n    this.offsetKeys.some(function (offset) {\n      var iOffset = Number(offset);\n      var border = sTop <= _this.offsets[\"\" + offset] || iOffset === total && sTop > _this.offsets[\"\" + offset];\n      if (border) {\n        if (_this.offsetKeys.length % 2 !== 0 && iOffset.toString() === _this.offsetKeys[_this.offsetKeys.length - 2] && sTop <= _this.offsets[_this.offsetKeys.length - 1]) {\n          iOffset = iOffset + 1;\n        }\n        info.block = iOffset % 2 === 0 ? 1 : 0;\n        page = Math.max(1, Math.min(_this.vgenerator.getPage(iOffset), _this.maxPage));\n      }\n      return border;\n    });\n    return page;\n  };\n  VirtualContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n    if (info === undefined) {\n      info = {\n        page: this.getPageFromTop(sTop, {})\n      };\n      info.blockIndexes = this.vgenerator.getBlockIndexes(info.page);\n    }\n    var block = (info.blockIndexes[0] || 1) - 1;\n    var translate = this.getOffset(block);\n    var endTranslate = this.getOffset(info.blockIndexes[info.blockIndexes.length - 1]);\n    if (isOnenter) {\n      info = this.prevInfo;\n    }\n    var result = translate > sTop ? this.getOffset(block - 1) : endTranslate < sTop + cHeight ? this.getOffset(block + 1) : translate;\n    var blockHeight = this.offsets[info.blockIndexes[info.blockIndexes.length - 1]] - this.tmpOffsets[info.blockIndexes[0]];\n    var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    if (result + blockHeight > this.offsets[parseInt(totalBlocks.toString(), 10)]) {\n      result -= result + blockHeight - this.offsets[parseInt(totalBlocks.toString(), 10)];\n    }\n    if (info.page === 1 && info.block === 0 && info.direction === 'up') {\n      result = 0;\n    }\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n      result = 0;\n    }\n    return result;\n  };\n  VirtualContentRenderer.prototype.getOffset = function (block) {\n    return Math.min(this.offsets[parseInt(block.toString(), 10)] | 0, this.offsets[this.maxBlock] | 0);\n  };\n  VirtualContentRenderer.prototype.onEntered = function () {\n    var _this = this;\n    return function (element, current, direction, e, isWheel, check) {\n      if ((direction === 'down' || direction === 'up') && !_this.parent.enableVirtualization && _this.parent.enableColumnVirtualization) {\n        return;\n      }\n      if (Browser.isIE && !isWheel && check && !_this.preventEvent && !_this.parent.enableVirtualMaskRow) {\n        _this.parent.showSpinner();\n      }\n      _this.prevInfo = _this.prevInfo || _this.vgenerator.getData();\n      var viewInfo = _this.getInfoFromView(direction, current, e);\n      if (_this.parent.isFrozenGrid() && current.axis === 'X' && _this.parent.getVisibleFrozenLeftCount() >= viewInfo.columnIndexes[0] && _this.prevInfo && _this.prevInfo.columnIndexes.toString().includes(viewInfo.columnIndexes.toString())) {\n        return;\n      }\n      if (_this.parent.enableVirtualMaskRow && !_this.preventEvent) {\n        var firstOffSetKey = parseInt(_this.offsetKeys[0], 10);\n        var lastOffSetKey = parseInt(_this.offsetKeys[_this.offsetKeys.length - 1], 10);\n        var blockIndex = _this.currentInfo.blockIndexes;\n        var disableShowMaskRow = _this.prevInfo && current.axis === 'X' && _this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString() || direction === 'down' && _this.parent.allowGrouping && _this.parent.groupSettings.columns.length && (_this.parent.allowFiltering && _this.parent.filterSettings.columns.length || _this.parent.searchSettings.key.length) && _this.offsetKeys.length <= 2;\n        if (!(blockIndex && blockIndex[0] === firstOffSetKey && direction === 'up' || blockIndex && blockIndex[blockIndex.length - 1] === lastOffSetKey && direction === 'down' || disableShowMaskRow)) {\n          setTimeout(function () {\n            _this.parent.showMaskRow(current.axis);\n          }, 0);\n        }\n      }\n      var xAxis = current.axis === 'X';\n      var top = _this.prevInfo.offsets ? _this.prevInfo.offsets.top : null;\n      var height = _this.content.getBoundingClientRect().height;\n      var x = _this.getColumnOffset(xAxis ? _this.vgenerator.getColumnIndexes()[0] - 1 : _this.prevInfo.columnIndexes[0] - 1);\n      if (_this.parent.isFrozenGrid() && _this.parent.enableColumnVirtualization && _this.currentInfo && _this.currentInfo.columnIndexes) {\n        var cBlock = _this.currentInfo.columnIndexes[0] - 1;\n        var frzLeftWidth_2 = 0;\n        _this.parent.getColumns().filter(function (col) {\n          if (col.visible && col.freeze === 'Left') {\n            frzLeftWidth_2 += parseInt(col.width.toString(), 10);\n          }\n        });\n        if (cBlock > _this.parent.getVisibleFrozenLeftCount()) {\n          x = x - frzLeftWidth_2;\n        }\n      }\n      if (xAxis) {\n        var idx = Object.keys(_this.vgenerator.cOffsets).length - _this.prevInfo.columnIndexes.length;\n        var maxLeft = _this.vgenerator.cOffsets[idx - 1];\n        x = x > maxLeft ? maxLeft : x; //TODO: This fix horizontal scrollbar jumping issue in column virtualization.\n      }\n      if (!_this.parent.enableVirtualization && _this.parent.enableColumnVirtualization) {\n        _this.virtualEle.adjustTable(x, 0);\n      } else {\n        var y = _this.getTranslateY(e.top, height, xAxis && top === e.top ? _this.prevInfo : undefined, true);\n        _this.virtualEle.adjustTable(x, Math.min(y, _this.offsets[_this.maxBlock]));\n      }\n      if (_this.parent.enableColumnVirtualization) {\n        _this.header.virtualEle.adjustTable(x, 0);\n        if (_this.parent.isFrozenGrid()) {\n          _this.resetStickyLeftPos(x);\n        }\n      }\n    };\n  };\n  VirtualContentRenderer.prototype.dataBound = function () {\n    this.parent.notify(events.refreshVirtualFrozenHeight, {});\n    if (this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n      this.parent.selectRow(this.selectedRowIndex);\n    } else {\n      this.activeKey = this.empty;\n      this.requestType = this.empty;\n    }\n  };\n  /**\n   * To calculate the position of frozen cells\n   *\n   * @param {number} valueX - specifies the transform X value\n   * @param {DocumentFragment | HTMLElement} newChild - specifies the element to transform\n   * @returns {void}\n   * @hidden\n   */\n  VirtualContentRenderer.prototype.resetStickyLeftPos = function (valueX, newChild) {\n    var cells = [].slice.call(this.parent.getHeaderContent().querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')).concat([].slice.call((newChild ? newChild : this.parent.getContent()).querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')));\n    var frzLeftWidth = 0;\n    var frzRightWidth = 0;\n    if (this.parent.getHeaderContent().querySelectorAll('.e-fixedfreeze').length) {\n      frzLeftWidth = this.parent.leftrightColumnWidth('left');\n      frzRightWidth = this.parent.leftrightColumnWidth('right');\n    }\n    if (cells.length) {\n      for (var i = 0; i < cells.length; i++) {\n        var cell = cells[parseInt(i.toString(), 10)];\n        var col = void 0;\n        if (cell.classList.contains('e-rowcell')) {\n          if (isNullOrUndefined(cell.getAttribute('aria-colindex')) && cell.querySelector('[e-mappinguid]')) {\n            var uid = cell.querySelector('[e-mappinguid]').getAttribute('e-mappinguid');\n            col = this.parent.getColumnByUid(uid);\n          } else {\n            var idx = parseInt(cell.getAttribute('aria-colindex'), 10) - 1;\n            col = this.parent.getColumnByIndex(parseInt(idx.toString(), 10));\n          }\n        } else {\n          if (cell.classList.contains('e-headercell') || cell.classList.contains('e-filterbarcell')) {\n            var uid = cell.classList.contains('e-filterbarcell') ? cell.getAttribute('e-mappinguid') : cell.querySelector('[e-mappinguid]').getAttribute('e-mappinguid');\n            col = this.parent.getColumnByUid(uid);\n          }\n        }\n        if (col.freeze === 'Left') {\n          cell.style.left = col.valueX - valueX + 'px';\n        } else if (col.freeze === 'Right') {\n          cell.style.right = col.valueX + valueX + 'px';\n        } else if (col.freeze === 'Fixed') {\n          cell.style.left = frzLeftWidth - valueX + 'px';\n          cell.style.right = frzRightWidth + valueX + 'px';\n        }\n      }\n    }\n    this.parent.translateX = valueX;\n  };\n  VirtualContentRenderer.prototype.rowSelected = function (args, isSelection) {\n    if ((this.isSelection || isSelection) && !this.isLastBlockRow(args.rowIndex)) {\n      var transform = getTransformValues(this.content.firstElementChild);\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      var rowTop = args.row.getBoundingClientRect().top - gridTop;\n      var height = this.content.getBoundingClientRect().height;\n      var isBottom = height < rowTop;\n      var remainHeight = isBottom ? rowTop - height : this.initialRowTop - rowTop;\n      var translateY = isBottom ? transform.height - remainHeight : transform.height + remainHeight;\n      this.virtualEle.adjustTable(transform.width, translateY);\n      var wrapperInfo = this.virtualEle.wrapper.getBoundingClientRect();\n      var contentInfo = this.content.getBoundingClientRect();\n      if (wrapperInfo.top > contentInfo.top) {\n        this.virtualEle.adjustTable(transform.width, translateY - (wrapperInfo.top - contentInfo.top));\n      }\n      var lastRowTop = this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top - gridTop;\n      if (lastRowTop < height) {\n        translateY = translateY + (height - (args.row.getBoundingClientRect().top - gridTop));\n        this.virtualEle.adjustTable(transform.width, translateY - this.parent.getRowHeight() / 2);\n      } else if (contentInfo.bottom > wrapperInfo.bottom) {\n        this.virtualEle.adjustTable(transform.width, translateY + (contentInfo.bottom - wrapperInfo.bottom));\n      }\n      if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {\n        this.resetStickyLeftPos(transform.width);\n      }\n    }\n    this.isSelection = false;\n  };\n  VirtualContentRenderer.prototype.isLastBlockRow = function (index) {\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n    var startIdx = this.maxPage * this.parent.pageSettings.pageSize - visibleRowCount;\n    return index >= startIdx;\n  };\n  VirtualContentRenderer.prototype.refreshMaxPage = function () {\n    if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {\n      this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);\n    }\n  };\n  VirtualContentRenderer.prototype.setVirtualPageQuery = function (args) {\n    var visiblePage = [];\n    if (this.prevInfo && this.prevInfo.blockIndexes) {\n      visiblePage = getVisiblePage(this.prevInfo.blockIndexes);\n    }\n    if ((this.requestType === 'sorting' || this.requestType === 'delete') && visiblePage.length && checkIsVirtual(this.parent)) {\n      args.query.skip(this.parent.pageSettings.pageSize * (visiblePage[0] - 1));\n      args.query.take(this.parent.pageSettings.pageSize * visiblePage.length);\n      args.skipPage = true;\n      return;\n    }\n    var row = this.parent.getContent().querySelector('.e-row');\n    if (this.requestType === 'virtualscroll' && this.vgenerator.currentInfo.blockIndexes) {\n      this.vgenerator.currentInfo = {};\n    }\n    if (row && this.parent.isManualRefresh && this.currentInfo.blockIndexes && (this.currentInfo.blockIndexes.length === 3 || visiblePage.length > 1)) {\n      this.vgenerator.startIndex = parseInt(row.getAttribute('aria-rowindex'), 10) - 1;\n      this.vgenerator.currentInfo = extend({}, this.currentInfo);\n      this.vgenerator.currentInfo.blockIndexes = this.currentInfo.blockIndexes.slice();\n      var includePrevPage = this.vgenerator.includePrevPage = this.currentInfo.blockIndexes[0] % 2 === 0;\n      if (includePrevPage) {\n        this.vgenerator.startIndex = this.vgenerator.startIndex - this.getBlockSize();\n        this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0] - 1);\n      } else {\n        this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length - 1] + 1);\n      }\n      var skip = (this.vgenerator.currentInfo.blockIndexes[0] - 1) * this.getBlockSize();\n      var take = this.vgenerator.currentInfo.blockIndexes.length * this.getBlockSize();\n      args.query.skip(skip);\n      args.query.take(take);\n      args.skipPage = true;\n    }\n  };\n  VirtualContentRenderer.prototype.eventListener = function (action) {\n    var _this = this;\n    this.parent[\"\" + action](dataReady, this.onDataReady, this);\n    this.parent.addEventListener(events.dataBound, this.dataBound.bind(this));\n    this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n    this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n    this.parent.addEventListener(events.rowSelected, this.rowSelected.bind(this));\n    this.parent[\"\" + action](refreshVirtualBlock, this.refreshContentRows, this);\n    this.parent[\"\" + action](events.refreshVirtualLazyLoadCache, this.refreshVirtualLazyLoadCache, this);\n    this.parent[\"\" + action](events.selectVirtualRow, this.selectVirtualRow, this);\n    this.parent[\"\" + action](events.virtaulCellFocus, this.virtualCellFocus, this);\n    this.parent[\"\" + action](events.virtualScrollEditActionBegin, this.editActionBegin, this);\n    this.parent[\"\" + action](events.virtualScrollAddActionBegin, this.addActionBegin, this);\n    this.parent[\"\" + action](events.virtualScrollEdit, this.restoreEdit, this);\n    this.parent[\"\" + action](events.virtualScrollEditSuccess, this.editSuccess, this);\n    this.parent[\"\" + action](events.refreshVirtualCache, this.refreshCache, this);\n    this.parent[\"\" + action](events.editReset, this.resetIsedit, this);\n    this.parent[\"\" + action](events.getVirtualData, this.getVirtualData, this);\n    this.parent[\"\" + action](events.virtualScrollEditCancel, this.editCancel, this);\n    this.parent[\"\" + action](events.refreshVirtualMaxPage, this.refreshMaxPage, this);\n    this.parent[\"\" + action](events.setVirtualPageQuery, this.setVirtualPageQuery, this);\n    this.parent[\"\" + action](events.selectRowOnContextOpen, this.selectRowOnContextOpen, this);\n    this.parent[\"\" + action](events.resetVirtualFocus, this.resetVirtualFocus, this);\n    this.parent[\"\" + action](events.refreshVirtualEditFormCells, this.refreshCells, this);\n    this.parent[\"\" + action](events.scrollToEdit, this.scrollToEdit, this);\n    var event = this.actions;\n    for (var i = 0; i < event.length; i++) {\n      this.parent[\"\" + action](event[parseInt(i.toString(), 10)] + \"-begin\", this.onActionBegin, this);\n    }\n    var fn = function () {\n      _this.observer.observe(function (scrollArgs) {\n        return _this.scrollListener(scrollArgs);\n      }, _this.onEntered());\n      var gObj = _this.parent;\n      if (gObj.enablePersistence && gObj.scrollPosition) {\n        if (gObj.scrollPosition.top > 0) {\n          _this.content.scrollTop = gObj.scrollPosition.top;\n          var scrollValues = {\n            direction: 'down',\n            sentinel: _this.observer.sentinelInfo.down,\n            offset: gObj.scrollPosition,\n            focusElement: gObj.element\n          };\n          _this.scrollListener(scrollValues);\n        }\n        if (gObj.enableColumnVirtualization) {\n          _this.content.scrollLeft = gObj.scrollPosition.left;\n        }\n      }\n      _this.parent.off(contentReady, fn);\n    };\n    this.parent.on(contentReady, fn, this);\n  };\n  VirtualContentRenderer.prototype.refreshVirtualLazyLoadCache = function (e) {\n    var blockIndex = this.currentInfo.blockIndexes;\n    if (isNullOrUndefined(this.currentInfo.blockIndexes)) {\n      blockIndex = [1, 2];\n    }\n    var block;\n    var index;\n    var cache;\n    for (var i = 0; i < blockIndex.length; i++) {\n      var rows = this.vgenerator.cache[blockIndex[parseInt(i.toString(), 10)]];\n      for (var j = 0; j < rows.length; j++) {\n        if (rows[parseInt(j.toString(), 10)].uid === e.uid) {\n          block = blockIndex[parseInt(i.toString(), 10)];\n          index = j;\n          cache = rows;\n          break;\n        }\n      }\n    }\n    if (e.count) {\n      this.vgenerator.cache[parseInt(block.toString(), 10)].splice(index + 1, e.count);\n    } else if (e.rows && e.rows.length) {\n      this.vgenerator.cache[parseInt(block.toString(), 10)] = [].slice.call(cache.slice(0, index + 1)).concat([].slice.call(e.rows)).concat([].slice.call(cache.slice(index + 1, cache.length)));\n    }\n    this.refreshOffsets();\n  };\n  VirtualContentRenderer.prototype.scrollToEdit = function (col) {\n    var allowScroll = true;\n    this.validationCheck = true;\n    if (this.isAdd && this.content.scrollTop > 0) {\n      allowScroll = false;\n      var keys = Object.keys(this.offsets);\n      this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[keys.length - 1];\n    }\n    var row = this.parent.getRowByIndex(this.editedRowIndex);\n    if (!row && !isNullOrUndefined(this.editedRowIndex)) {\n      if (!row || !this.isRowInView(row)) {\n        var rowIndex = this.parent.getRowHeight();\n        var scrollTop = this.editedRowIndex * rowIndex;\n        if (!isNullOrUndefined(scrollTop)) {\n          allowScroll = false;\n          this.content.scrollTop = scrollTop;\n        }\n      }\n    }\n    if (col && allowScroll) {\n      var offset = this.vgenerator.cOffsets[col.index - this.parent.getVisibleFrozenColumns() - 1];\n      if (!this.parent.enableColumnVirtualization) {\n        var header = this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid=\"' + col.uid + '\"]');\n        offset = header.parentElement.offsetLeft;\n      }\n      if (this.parent.enableColumnVirtualization && this.parent.getVisibleFrozenLeftCount()) {\n        offset -= this.parent.leftrightColumnWidth('left');\n      }\n      this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n    }\n    if (col && !allowScroll) {\n      this.validationCol = col;\n    }\n  };\n  VirtualContentRenderer.prototype.refreshCells = function (rowObj) {\n    rowObj.cells = this.vgenerator.generateCells(rowObj.foreignKeyData);\n  };\n  VirtualContentRenderer.prototype.resetVirtualFocus = function (e) {\n    this.isCancel = e.isCancel;\n  };\n  /**\n   * @param {Object} data - specifies the data\n   * @param {Object} data.virtualData -specifies the data\n   * @param {boolean} data.isAdd - specifies isAdd\n   * @param {boolean} data.isCancel - specifies boolean in cancel\n   * @param {boolean} data.isScroll - specifies boolean for scroll\n   * @returns {void}\n   * @hidden\n   */\n  VirtualContentRenderer.prototype.getVirtualData = function (data) {\n    if (this.isNormaledit) {\n      var error = this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])');\n      var keys = Object.keys(this.virtualData);\n      data.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n      if (error) {\n        return;\n      }\n      this.virtualData = keys.length ? this.virtualData : data.virtualData;\n      this.getVirtualEditedData(this.virtualData);\n      data.virtualData = this.virtualData;\n      data.isAdd = this.isAdd || this.parent.editSettings.showAddNewRow;\n      data.isCancel = this.isCancel;\n    }\n  };\n  VirtualContentRenderer.prototype.selectRowOnContextOpen = function (args) {\n    this.isContextMenuOpen = args.isOpen;\n  };\n  VirtualContentRenderer.prototype.editCancel = function (args) {\n    var dataIndex = getEditedDataIndex(this.parent, args.data);\n    if (!isNullOrUndefined(dataIndex)) {\n      args.data = this.parent.getCurrentViewRecords()[parseInt(dataIndex.toString(), 10)];\n    }\n  };\n  VirtualContentRenderer.prototype.editSuccess = function (args) {\n    if (this.isNormaledit) {\n      if (!this.isAdd && args.data) {\n        this.updateCurrentViewData(args.data);\n      }\n      this.isAdd = false;\n    }\n  };\n  VirtualContentRenderer.prototype.updateCurrentViewData = function (data) {\n    var dataIndex = getEditedDataIndex(this.parent, data);\n    if (!isNullOrUndefined(dataIndex)) {\n      this.parent.getCurrentViewRecords()[parseInt(dataIndex.toString(), 10)] = data;\n    }\n  };\n  VirtualContentRenderer.prototype.actionBegin = function (args) {\n    if (args.requestType !== 'virtualscroll') {\n      this.requestType = args.requestType;\n    }\n    if (!args.cancel) {\n      this.parent.notify(events.refreshVirtualFrozenRows, args);\n    }\n  };\n  VirtualContentRenderer.prototype.virtualCellFocus = function (e) {\n    // To decide the action (select or scroll), when using arrow keys for cell focus\n    var ele = document.activeElement;\n    if (!ele.classList.contains(literals.rowCell) && (ele instanceof HTMLInputElement || !isNullOrUndefined(ele.closest('.e-templatecell')))) {\n      ele = ele.closest('.e-rowcell');\n    }\n    if (this.parent.allowGrouping && this.parent.groupSettings.columns.length && ele && (ele.classList.contains(literals.rowCell) || !isNullOrUndefined(parentsUntil(ele, literals.groupCaptionRow))) && e && (e.action === 'shiftEnter' || e.action === 'upArrow' || e.action === 'downArrow')) {\n      var scrollEle = this.parent.getContent().firstElementChild;\n      var scrollEleInfo = scrollEle.getBoundingClientRect();\n      var row = closest(ele, 'tr');\n      var nextFocusRow = e.action === 'downArrow' ? row.nextElementSibling : row.previousElementSibling;\n      var nextFocusRowInfo = !isNullOrUndefined(nextFocusRow) ? nextFocusRow.getBoundingClientRect() : undefined;\n      if (isNullOrUndefined(nextFocusRow) || e.action === 'downArrow' && nextFocusRowInfo.bottom > scrollEleInfo.bottom || (e.action === 'upArrow' || e.action === 'shiftEnter') && nextFocusRowInfo.top < scrollEleInfo.top) {\n        this.activeKey = e.action;\n        this.parent.focusModule.virtualSelectionInfo = {\n          isPending: isNullOrUndefined(nextFocusRow),\n          direction: e.action,\n          event: e\n        };\n        var viewDifference = isNullOrUndefined(nextFocusRow) ? this.parent.getRowHeight() : e.action === 'downArrow' ? nextFocusRowInfo.bottom - scrollEleInfo.bottom : scrollEleInfo.top - nextFocusRowInfo.top;\n        scrollEle.scrollTop = e.action === 'downArrow' ? scrollEle.scrollTop + viewDifference : scrollEle.scrollTop - viewDifference;\n      } else {\n        this.activeKey = this.empty;\n      }\n      return;\n    }\n    if (ele && ele.classList.contains(literals.rowCell) && e && (e.action === 'upArrow' || e.action === 'downArrow' || e.action === 'shiftEnter')) {\n      var rowIndex = parseInt(ele.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n      if (e && (e.action === 'upArrow' || e.action === 'shiftEnter' || e.action === 'downArrow')) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        if (e.action === 'downArrow') {\n          rowIndex += 1;\n        } else {\n          rowIndex -= 1;\n        }\n        this.rowIndex = rowIndex;\n        this.cellIndex = parseInt(ele.getAttribute(literals.ariaColIndex), 10) - 1;\n        var row = this.parent.getRowByIndex(rowIndex);\n        var page = this.parent.pageSettings.currentPage;\n        var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        var emptyRow = false;\n        if (isNullOrUndefined(row)) {\n          emptyRow = true;\n          if (e.action === 'downArrow' && page === this.maxPage - 1 || (e.action === 'upArrow' || e.action === 'shiftEnter') && page === 1) {\n            emptyRow = false;\n          }\n        }\n        if (emptyRow || ensureLastRow(row, this.parent) && e.action === 'downArrow' || ensureFirstRow(row, this.parent.getRowHeight() * 2) && (e.action === 'upArrow' || e.action === 'shiftEnter')) {\n          this.activeKey = e.action;\n          scrollEle.scrollTop = e.action === 'downArrow' ? (rowIndex - visibleRowCount) * this.parent.getRowHeight() : rowIndex * this.parent.getRowHeight();\n        } else {\n          this.activeKey = this.empty;\n        }\n        if (!this.parent.selectionSettings.checkboxOnly) {\n          this.parent.selectRow(rowIndex);\n        }\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.editActionBegin = function (e) {\n    this.editedRowIndex = e.index;\n    var rowData = !this.parent.enableVirtualization && this.parent.enableColumnVirtualization ? extend({}, this.parent.getCurrentViewRecords()[e.index]) : extend({}, this.getRowObjectByIndex(e.index));\n    var keys = Object.keys(this.virtualData);\n    e.data = keys.length && !this.parent.editSettings.showAddNewRow ? this.virtualData : this.isInfiniteColumnvirtualization() ? e.data : rowData;\n    if (this.enableCacheOnInfiniteColumnVirtual()) {\n      this.virtualInfiniteData = e.data;\n    }\n    e.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n  };\n  VirtualContentRenderer.prototype.getEditedRowObject = function () {\n    var rowObjects = this.parent.vcRows;\n    var editedrow;\n    for (var i = 0; i < rowObjects.length; i++) {\n      if (rowObjects[parseInt(i.toString(), 10)].index === this.editedRowIndex) {\n        editedrow = rowObjects[parseInt(i.toString(), 10)];\n      }\n    }\n    return editedrow;\n  };\n  VirtualContentRenderer.prototype.refreshCache = function (args) {\n    if (this.isInfiniteColumnvirtualization()) {\n      return;\n    }\n    var block = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());\n    if (this.parent.allowPaging && this.parent.enableColumnVirtualization) {\n      block = Math.ceil((this.editedRowIndex + 1 + (this.parent.pageSettings.currentPage - 1) * this.parent.pageSettings.pageSize) / this.getBlockSize());\n    }\n    var index = this.parent.allowPaging && this.parent.enableColumnVirtualization ? this.editedRowIndex % this.getBlockSize() : this.editedRowIndex - (block - 1) * this.getBlockSize();\n    if (this.parent.groupSettings.columns.length) {\n      var editRowObject = this.getEditedRowObject();\n      if (editRowObject) {\n        editRowObject.data = args.data;\n      }\n    } else {\n      this.vgenerator.cache[parseInt(block.toString(), 10)][parseInt(index.toString(), 10)].data = args.data;\n    }\n  };\n  VirtualContentRenderer.prototype.actionComplete = function (args) {\n    if (!(this.parent.enableVirtualization || this.parent.enableColumnVirtualization)) {\n      return;\n    }\n    var editRequestTypes = ['delete', 'save', 'cancel'];\n    var dataActionRequestTypes = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];\n    if (editRequestTypes.some(function (value) {\n      return value === args.requestType;\n    })) {\n      this.refreshOffsets();\n      this.refreshVirtualElement();\n    }\n    if (this.isNormaledit && (dataActionRequestTypes.some(function (value) {\n      return value === args.requestType;\n    }) || editRequestTypes.some(function (value) {\n      return value === args.requestType;\n    }))) {\n      this.isCancel = true;\n      this.isAdd = false || this.parent.editSettings.showAddNewRow;\n      this.editedRowIndex = this.empty;\n      this.virtualData = {};\n      this.virtualInfiniteData = {};\n      if (this.parent.editModule) {\n        this.parent.editModule.editModule.previousData = undefined;\n      }\n    }\n    if (this.parent.enableColumnVirtualization && args.requestType === 'filterAfterOpen' && this.currentInfo.columnIndexes && this.currentInfo.columnIndexes[0] > 0) {\n      this.parent.resetFilterDlgPosition(args.columnName);\n    }\n  };\n  VirtualContentRenderer.prototype.resetIsedit = function () {\n    if (this.parent.enableVirtualization && this.isNormaledit) {\n      if (this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length || this.parent.editSettings.allowAdding && this.isAdd) {\n        this.parent.isEdit = true;\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.scrollAfterEdit = function () {\n    if (this.parent.editModule && this.parent.editSettings.allowEditing && this.isNormaledit) {\n      if (this.parent.element.querySelector('.e-gridform')) {\n        var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n        var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n        if (editForm || addForm) {\n          var rowData = editForm ? extend({}, this.getRowObjectByIndex(this.editedRowIndex)) : extend({}, this.emptyRowData);\n          var keys = Object.keys(this.virtualData);\n          this.virtualData = keys.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(rowData);\n        }\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.createEmptyRowdata = function () {\n    var _this = this;\n    this.parent.columnModel.filter(function (e) {\n      _this.emptyRowData[e.field] = _this.empty;\n    });\n  };\n  VirtualContentRenderer.prototype.addActionBegin = function (args) {\n    if (this.isNormaledit) {\n      if (!Object.keys(this.emptyRowData).length) {\n        this.createEmptyRowdata();\n      }\n      this.isAdd = true;\n      var page = this.parent.pageSettings.currentPage;\n      if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {\n        this.isAdd = true;\n        this.onActionBegin();\n        args.startEdit = false;\n        this.content.scrollTop = 0;\n      }\n      if (page < this.maxPage - 1 && this.parent.editSettings.newRowPosition === 'Bottom') {\n        this.isAdd = true;\n        this.parent.setProperties({\n          pageSettings: {\n            currentPage: this.maxPage - 1\n          }\n        }, true);\n        args.startEdit = false;\n        this.content.scrollTop = this.offsets[this.offsetKeys.length];\n      }\n    }\n  };\n  /**\n   * @param {number} index - specifies the index\n   * @returns {Object} returns the object\n   * @hidden\n   */\n  VirtualContentRenderer.prototype.getRowObjectByIndex = function (index) {\n    var data = this.getRowCollection(index, true);\n    return data;\n  };\n  VirtualContentRenderer.prototype.getBlockSize = function () {\n    return this.parent.pageSettings.pageSize >> 1;\n  };\n  VirtualContentRenderer.prototype.getBlockHeight = function () {\n    return this.getBlockSize() * this.parent.getRowHeight();\n  };\n  VirtualContentRenderer.prototype.isEndBlock = function (index) {\n    var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    return index >= totalBlocks || index === totalBlocks - 1;\n  };\n  VirtualContentRenderer.prototype.isOddPageSize = function () {\n    return this.parent.pageSettings.pageSize % 2 !== 0;\n  };\n  VirtualContentRenderer.prototype.getOddBlockSize = function () {\n    return this.isOddPageSize() ? this.parent.pageSettings.pageSize / 2 : this.getBlockSize();\n  };\n  VirtualContentRenderer.prototype.getGroupedTotalBlocks = function () {\n    var rows = this.parent.vcRows;\n    return Math.floor(rows.length / this.getOddBlockSize() < 1 ? 1 : rows.length / this.getOddBlockSize());\n  };\n  VirtualContentRenderer.prototype.getTotalBlocks = function () {\n    return Math.ceil(this.count / this.getOddBlockSize());\n  };\n  VirtualContentRenderer.prototype.getColumnOffset = function (block) {\n    return this.vgenerator.cOffsets[parseInt(block.toString(), 10)] | 0;\n  };\n  VirtualContentRenderer.prototype.getModelGenerator = function () {\n    return new VirtualRowModelGenerator(this.parent);\n  };\n  VirtualContentRenderer.prototype.resetScrollPosition = function (action) {\n    if (this.actions.some(function (value) {\n      return value === action;\n    })) {\n      this.preventEvent = this.content.scrollTop !== 0;\n      this.content.scrollTop = 0;\n    }\n    if (action !== 'virtualscroll') {\n      this.isAdd = false;\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  VirtualContentRenderer.prototype.onActionBegin = function (e) {\n    //Update property silently..\n    this.parent.setProperties({\n      pageSettings: {\n        currentPage: 1\n      }\n    }, true);\n  };\n  VirtualContentRenderer.prototype.getRows = function () {\n    return this.isInfiniteColumnvirtualization() ? this.getInfiniteRows() : this.vgenerator.getRows();\n  };\n  VirtualContentRenderer.prototype.getRowByIndex = function (index) {\n    var row;\n    if (isGroupAdaptive(this.parent)) {\n      if (!isNullOrUndefined(index) && this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n        for (var i = 0; i < this.parent.getDataRows().length; i++) {\n          if (parseInt(this.parent.getDataRows()[parseInt(i.toString(), 10)].getAttribute(literals.ariaRowIndex), 10) - 1 === index) {\n            row = this.parent.getDataRows()[parseInt(i.toString(), 10)];\n          }\n        }\n      } else {\n        row = !isNullOrUndefined(index) ? this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n      }\n    } else if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n      row = !isNullOrUndefined(index) ? this.enableCacheOnInfiniteColumnVirtual() ? this.parent.getDataRows().find(function (element) {\n        return parseInt(element.getAttribute(literals.ariaRowIndex), 10) - 1 === index;\n      }) : this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n    } else if (this.prevInfo) {\n      row = this.getRowCollection(index, false);\n    }\n    return row;\n  };\n  VirtualContentRenderer.prototype.getMovableVirtualRowByIndex = function (index) {\n    return this.getRowCollection(index, false);\n  };\n  VirtualContentRenderer.prototype.getFrozenRightVirtualRowByIndex = function (index) {\n    return this.getRowCollection(index, false);\n  };\n  VirtualContentRenderer.prototype.getRowCollection = function (index, isRowObject) {\n    var prev = this.prevInfo.blockIndexes;\n    var startIdx = (prev[0] - 1) * this.getBlockSize();\n    if (this.parent.pageSettings.pageSize % 2 !== 0) {\n      startIdx += Math.floor(startIdx / this.getBlockSize() / 2);\n    }\n    var rowCollection = this.parent.getDataRows();\n    var collection = isRowObject ? this.parent.getCurrentViewRecords() : rowCollection;\n    if (isRowObject && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n      startIdx = parseInt(this.parent.getRows()[0].getAttribute(literals.ariaRowIndex), 10) - 1;\n      collection = collection.filter(function (m) {\n        return isNullOrUndefined(m.items);\n      });\n    }\n    if (!isRowObject && this.parent.allowGrouping && this.parent.groupSettings.columns.length && rowCollection.length) {\n      startIdx = parseInt(rowCollection[0].getAttribute(literals.ariaRowIndex), 10) - 1;\n    }\n    var selectedRow = collection[index - startIdx];\n    if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n      if (!isRowObject) {\n        selectedRow = index <= this.parent.frozenRows ? rowCollection[parseInt(index.toString(), 10)] : rowCollection[index - startIdx + this.parent.frozenRows];\n      } else {\n        selectedRow = index <= this.parent.frozenRows ? this.parent.getRowsObject()[parseInt(index.toString(), 10)].data : selectedRow;\n      }\n    }\n    return selectedRow;\n  };\n  VirtualContentRenderer.prototype.getVirtualRowIndex = function (index) {\n    var prev = this.prevInfo.blockIndexes;\n    var startIdx = (prev[0] - 1) * this.getBlockSize();\n    if (this.parent.enableVirtualization && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n      var vGroupedRows = this.vgenerator.cache[prev[0]];\n      for (var i = 0; i < vGroupedRows.length; i++) {\n        if (vGroupedRows[\"\" + i].isDataRow) {\n          startIdx = vGroupedRows[\"\" + i].index;\n          break;\n        }\n      }\n    }\n    return startIdx + index;\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n  VirtualContentRenderer.prototype.refreshOffsets = function () {\n    var gObj = this.parent;\n    var row = 0;\n    var blockSize = this.getBlockSize();\n    var oddBlockSize = this.getOddBlockSize();\n    var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    this.prevHeight = this.offsets[parseInt(total.toString(), 10)];\n    this.maxBlock = total % 2 === 0 ? total - 2 : total - 1;\n    this.offsets = {};\n    //Row offset update\n    // eslint-disable-next-line prefer-spread\n    var blocks = Array.apply(null, Array(total)).map(function () {\n      return ++row;\n    });\n    for (var i = 0; i < blocks.length; i++) {\n      var tmp = (this.vgenerator.cache[blocks[parseInt(i.toString(), 10)]] || []).length;\n      var rem = !isGroupAdaptive(this.parent) ? this.isOddPageSize() ? Math.ceil(this.count % oddBlockSize) : this.count % blockSize : this.isOddPageSize() ? Math.ceil(gObj.vcRows.length % oddBlockSize) : gObj.vcRows.length % blockSize;\n      var size = !isGroupAdaptive(this.parent) && blocks[parseInt(i.toString(), 10)] in this.vgenerator.cache ? tmp * this.parent.getRowHeight() : rem && blocks[parseInt(i.toString(), 10)] === total ? rem * this.parent.getRowHeight() : this.getBlockHeight();\n      if (this.isOddPageSize() && !(blocks[parseInt(i.toString(), 10)] in this.vgenerator.cache) && !(rem && blocks[parseInt(i.toString(), 10)] === total)) {\n        size = (blocks[parseInt(i.toString(), 10)] % 2 !== 0 ? Math.floor(oddBlockSize) : Math.ceil(oddBlockSize)) * this.parent.getRowHeight();\n      }\n      // let size: number = this.parent.groupSettings.columns.length && block in this.vgenerator.cache ?\n      // tmp * getRowHeight() : this.getBlockHeight();\n      this.offsets[blocks[parseInt(i.toString(), 10)]] = (this.offsets[blocks[parseInt(i.toString(), 10)] - 1] | 0) + size;\n      this.tmpOffsets[blocks[parseInt(i.toString(), 10)]] = this.offsets[blocks[parseInt(i.toString(), 10)] - 1] | 0;\n    }\n    this.offsetKeys = Object.keys(this.offsets);\n    if (isGroupAdaptive(this.parent)) {\n      this.parent.vGroupOffsets = this.offsets;\n    }\n    //Column offset update\n    if (this.parent.enableColumnVirtualization) {\n      this.vgenerator.refreshColOffsets();\n    }\n  };\n  VirtualContentRenderer.prototype.refreshVirtualElement = function () {\n    this.vgenerator.refreshColOffsets();\n    this.setVirtualHeight();\n  };\n  VirtualContentRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var rows = [];\n    rows = this.getRows();\n    var testRow;\n    rows.some(function (r) {\n      if (r.isDataRow) {\n        testRow = r;\n      }\n      return r.isDataRow;\n    });\n    var isRefresh = true;\n    if (!gObj.groupSettings.columns.length && testRow) {\n      isRefresh = false;\n    }\n    var tr = gObj.getDataRows();\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[parseInt(c.toString(), 10)];\n      var idx = gObj.getNormalizedColumnIndex(column.uid);\n      var displayVal = column.visible === true ? '' : 'none';\n      var colGrp = this.getColGroup().children;\n      if (idx !== -1 && testRow && idx < testRow.cells.length) {\n        setStyleAttribute(colGrp[parseInt(idx.toString(), 10)], {\n          'display': displayVal\n        });\n      }\n      if (!isRefresh) {\n        var width = void 0;\n        if (column.width) {\n          if (column.visible) {\n            width = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n          } else {\n            width = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n          }\n        }\n        if (width > gObj.width) {\n          this.setDisplayNone(tr, idx, displayVal, rows);\n          if (this.parent.enableColumnVirtualization) {\n            this.virtualEle.setWrapperWidth(width + '');\n          }\n          this.refreshVirtualElement();\n        } else {\n          isRefresh = true;\n        }\n      }\n      if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n        this.parent.updateMediaColumns(column);\n      }\n      this.parent.invokedFromMedia = false;\n    }\n    if (isRefresh) {\n      this.refreshContentRows({\n        requestType: 'refresh'\n      });\n    } else {\n      this.parent.notify(events.partialRefresh, {\n        rows: rows,\n        args: {\n          isFrozen: false,\n          rows: rows\n        }\n      });\n    }\n  };\n  VirtualContentRenderer.prototype.selectVirtualRow = function (args) {\n    var _this = this;\n    var count = isGroupAdaptive(this.parent) ? this.vgenerator.recordsCount : this.count;\n    args.isAvailable = args.selectedIndex < count;\n    if (args.isAvailable && !this.isContextMenuOpen && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow' && !this.isSelection && !this.requestTypes.some(function (value) {\n      return value === _this.requestType;\n    }) && !this.parent.selectionModule.isInteracted) {\n      var selectedRow = this.parent.getRowByIndex(args.selectedIndex);\n      var rowHeight = this.parent.getRowHeight();\n      if (!selectedRow || !this.isRowInView(selectedRow)) {\n        this.isSelection = true;\n        this.selectedRowIndex = args.selectedIndex;\n        var scrollTop = args.selectedIndex * rowHeight;\n        if (isGroupAdaptive(this.parent)) {\n          var selectedRowObjectIndex = this.parent.vcRows.findIndex(function (row) {\n            return row.index === args.selectedIndex;\n          });\n          scrollTop = selectedRowObjectIndex !== -1 ? selectedRowObjectIndex * rowHeight : undefined;\n          this.isSelection = selectedRowObjectIndex !== -1 ? this.isSelection : false;\n        } else if (this.parent.groupSettings.columns.length && this.parent.getDataModule().isRemote()) {\n          var page = Math.ceil((args.selectedIndex + 1) / this.parent.pageSettings.pageSize);\n          var blockIndexes = this.vgenerator.getBlockIndexes(page);\n          scrollTop = this.offsets[blockIndexes[0]];\n        }\n        if (!isNullOrUndefined(scrollTop)) {\n          var direction = this.content.scrollTop < scrollTop ? 'down' : 'up';\n          this.selectRowIndex = args.selectedIndex;\n          this.content.scrollTop = scrollTop;\n          this.isSelectionScroll = this.observer.check(direction);\n        }\n      }\n    }\n    this.requestType = this.empty;\n  };\n  VirtualContentRenderer.prototype.isRowInView = function (row) {\n    var top = row.getBoundingClientRect().top;\n    var bottom = row.getBoundingClientRect().bottom;\n    return top >= this.content.getBoundingClientRect().top && bottom <= this.content.getBoundingClientRect().bottom;\n  };\n  return VirtualContentRenderer;\n}(ContentRender);\nexport { VirtualContentRenderer };\n/**\n * @hidden\n */\nvar VirtualHeaderRenderer = /** @class */function (_super) {\n  __extends(VirtualHeaderRenderer, _super);\n  function VirtualHeaderRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n    _this.virtualEle = new VirtualElementHandler();\n    _this.isMovable = false;\n    _this.gen = new VirtualRowModelGenerator(_this.parent);\n    _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n    _this.parent.on(refreshVirtualBlock, function (e) {\n      return e.virtualInfo.sentinelInfo.axis === 'X' ? _this.refreshUI() : null;\n    }, _this);\n    return _this;\n  }\n  VirtualHeaderRenderer.prototype.renderTable = function () {\n    this.gen.refreshColOffsets();\n    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n    _super.prototype.renderTable.call(this);\n    this.virtualEle.table = this.getTable();\n    this.virtualEle.content = this.getPanel().querySelector('.' + literals.headerContent);\n    this.virtualEle.content.style.position = 'relative';\n    this.virtualEle.renderWrapper();\n    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n    !(this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.parent.enableColumnVirtualization ? this.virtualEle.renderPlaceHolder() : this.virtualEle.renderPlaceHolder('absolute');\n  };\n  VirtualHeaderRenderer.prototype.appendContent = function (table) {\n    this.virtualEle.wrapper.appendChild(table);\n  };\n  VirtualHeaderRenderer.prototype.refreshUI = function () {\n    this.gen.refreshColOffsets();\n    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n    _super.prototype.refreshUI.call(this);\n  };\n  VirtualHeaderRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var displayVal;\n    var idx;\n    var needFullRefresh;\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[parseInt(c.toString(), 10)];\n      idx = gObj.getNormalizedColumnIndex(column.uid);\n      displayVal = column.visible ? '' : 'none';\n      var colGrp = this.getColGroup().children;\n      if (gObj.getColumnByField(column.field)) {\n        setStyleAttribute(colGrp[parseInt(idx.toString(), 10)], {\n          'display': displayVal\n        });\n      }\n      if (gObj.enableColumnVirtualization && !gObj.groupSettings.columns.length) {\n        var tablewidth = void 0;\n        if (column.visible) {\n          tablewidth = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n        } else {\n          tablewidth = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n        }\n        if (tablewidth > gObj.width) {\n          this.setDisplayNone(column, displayVal);\n          this.virtualEle.setWrapperWidth(tablewidth + '');\n          this.gen.refreshColOffsets();\n        } else {\n          needFullRefresh = true;\n        }\n      } else {\n        needFullRefresh = true;\n      }\n      if (needFullRefresh) {\n        this.refreshUI();\n      }\n    }\n  };\n  VirtualHeaderRenderer.prototype.setDisplayNone = function (col, displayVal) {\n    var table = this.getTable();\n    for (var _i = 0, _a = [].slice.apply(table.querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n      var ele = _a[_i];\n      if (ele.querySelector('[e-mappinguid]') && ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === col.uid) {\n        setStyleAttribute(ele, {\n          'display': displayVal\n        });\n        if (displayVal === '') {\n          removeClass([ele], 'e-hide');\n        }\n        break;\n      }\n    }\n  };\n  return VirtualHeaderRenderer;\n}(HeaderRender);\nexport { VirtualHeaderRenderer };\n/**\n * @hidden\n */\nvar VirtualElementHandler = /** @class */function () {\n  function VirtualElementHandler() {}\n  VirtualElementHandler.prototype.renderWrapper = function (height) {\n    this.wrapper = createElement('div', {\n      className: 'e-virtualtable'\n    });\n    this.wrapper.style.minHeight = formatUnit(height);\n    this.wrapper.appendChild(this.table);\n    this.content.appendChild(this.wrapper);\n  };\n  VirtualElementHandler.prototype.renderPlaceHolder = function (position) {\n    if (position === void 0) {\n      position = 'relative';\n    }\n    this.placeholder = createElement('div', {\n      className: 'e-virtualtrack'\n    });\n    this.placeholder.style.position = position;\n    this.content.appendChild(this.placeholder);\n  };\n  VirtualElementHandler.prototype.renderFrozenWrapper = function (height) {\n    this.wrapper = createElement('div', {\n      className: 'e-virtualtable'\n    });\n    this.wrapper.style.cssText = \"min-height:\" + formatUnit(height) + \"; display: flex;\";\n    this.content.appendChild(this.wrapper);\n  };\n  VirtualElementHandler.prototype.renderFrozenPlaceHolder = function () {\n    this.placeholder = createElement('div', {\n      className: 'e-virtualtrack'\n    });\n    this.content.appendChild(this.placeholder);\n  };\n  VirtualElementHandler.prototype.adjustTable = function (xValue, yValue) {\n    this.wrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n  };\n  VirtualElementHandler.prototype.setWrapperWidth = function (width, full) {\n    if (width && width.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(width, 10))) {\n      width = undefined;\n      full = true;\n    }\n    this.wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n  VirtualElementHandler.prototype.setVirtualHeight = function (height, width) {\n    this.placeholder.style.height = !isNullOrUndefined(height) ? height + \"px\" : '0px';\n    if (width && width.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(width, 10))) {\n      width = '100%';\n    }\n    this.placeholder.style.width = width;\n  };\n  VirtualElementHandler.prototype.setFreezeWrapperWidth = function (wrapper, width, full) {\n    wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n  return VirtualElementHandler;\n}();\nexport { VirtualElementHandler };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","remove","createElement","closest","formatUnit","Browser","extend","isNullOrUndefined","removeClass","DataManager","dataReady","modelChanged","refreshVirtualBlock","contentReady","events","RenderType","ContentRender","HeaderRender","InterSectionObserver","VirtualRowModelGenerator","isGroupAdaptive","ensureLastRow","ensureFirstRow","getEditedDataIndex","getTransformValues","checkIsVirtual","getVisiblePage","parentsUntil","setStyleAttribute","literals","VirtualContentRenderer","_super","parent","locator","_this","call","prevHeight","startIndex","preStartIndex","preventEvent","actions","offsets","tmpOffsets","virtualEle","VirtualElementHandler","offsetKeys","isFocused","isSelection","isBottom","isBottomNotify","diff","heightChange","isTop","empty","undefined","isCancel","requestTypes","isNormaledit","editSettings","mode","virtualData","virtualInfiniteData","emptyRowData","isContextMenuOpen","isSelectionScroll","validationCheck","firstCellFocus","prevPage","prevCurrentInfo","eventListener","widthServices","getService","on","columnVisibilityChanged","setVisible","vgenerator","generator","renderTable","header","getRenderer","Header","table","getTable","content","getPanel","querySelector","renderWrapper","height","renderPlaceHolder","enableVirtualization","enableColumnVirtualization","wrapper","style","position","debounceEvent","dataSource","offline","opt","container","pageHeight","getBlockHeight","axes","observer","renderEmpty","tbody","appendChild","frozenRows","getHeaderContent","innerHTML","adjustTable","getReorderedFrozenRows","args","blockIndex","virtualInfo","blockIndexes","colsIndex","columnIndexes","page","recordslength","getCurrentViewRecords","length","firstRecords","renderModule","data","dataManager","json","slice","virtualRows","generateRows","splice","scrollListener","scrollArgs","direction","scrollAfterEdit","enablePersistence","scrollPosition","offset","isDestroyed","document","activeElement","islazyloadRequest","removeMaskRow","info","sentinel","viewInfo","currentInfo","getInfoFromView","prevInfo","toString","event","top","scrollTop","pageSettings","currentPage","enableVirtualMaskRow","showMaskRow","axis","addShimmerEffect","showAddNewRow","closeEdit","notify","requestType","focusElement","isFrozenGrid","getVisibleFrozenLeftCount","includes","isIE","hideSpinner","restoreEdit","groupSettings","enableLazyLoading","setColumnIndexesInView","loadNext","loadSelf","nextInfo","renderResponsiveColumnChooserDiv","action","isInitialLoad","getContentTable","appendContent","block","blk","isBlockAvailable","e","isBlockAdded","tempBlocks","infoType","sentinelInfo","endIndex","preEndIndex","getPageFromTop","getBlockIndexes","blocks","ensureBlocks","activeKey","newBlock","indexOf","filter","val","every","bind","Math","max","isNaN","rowIndex","firstBlock","ceil","getBlockSize","nextBlock","hasCommonValue","i","j","parseInt","getColumnIndexes","getColumnIndexesInView","index","mIdx","old","indexes","getData","ind","preventSelf","isEndBlock","some","result","getGroupedTotalBlocks","getTotalBlocks","target","newChild","cBlock","cOffset","getColumnOffset","width","columns","refreshOffsets","element","vHeight","getBoundingClientRect","reduceWidth","frzLeftWidth_1","getColumns","col","visible","freeze","cIndex","resetStickyLeftPos","value","translate","getTranslateY","allowResizing","getHeaderTable","setWrapperWidth","name","parentNode","isReact","rowTemplate","attrs","role","isInfiniteColumnvirtualization","children","scrollLeft","left","sTop","setVirtualHeight","setPageHeight","getOffset","focus","lastPage","getContent","firstElementChild","setTimeout","scrollElement","scrollValues","up","autoCol","focusCell","focusModule","current","active","matrix","cell","rows","cells","elementToFocus","classList","add","tabIndex","restoreAdd","ensureSelectedRowPosition","validationScrollLeft","refreshFrozenScrollbar","initialRowTop","gridTop","getRowByIndex","validationCol","cOffsets","getVisibleFrozenColumns","editModule","editFormValidate","selectRowIndex","row","isRowInView","rowSelected","cellIndex","preventScroll","selectionSettings","checkboxOnly","selectRow","getAttribute","ariaRowIndex","allowEditing","editedRowIndex","keys","isXaxis","editedRow","top_1","offsetHeight","getRowHeight","isEdit","startEdit","rowData","enableCacheOnInfiniteColumnVirtual","getRowObjectByIndex","getVirtualEditedData","editForms","getElementsByClassName","isFormDestroyed","formObj","getCurrentEditedData","startAdd","addedRow","isAdd","newRowPosition","maxPage","addRecord","onDataReady","count","vcRows","pageSize","checkAndResetCache","resetScrollPosition","getVisibleColumns","virtualHeight","totalBlocks","placeHolderBottom","round","placeholder","bottom","wrapperBottom","minHeight","total","iOffset","Number","border","min","getPage","cHeight","isOnenter","endTranslate","blockHeight","maxBlock","onEntered","isWheel","check","showSpinner","firstOffSetKey","lastOffSetKey","disableShowMaskRow","allowGrouping","allowFiltering","filterSettings","searchSettings","key","xAxis","x","frzLeftWidth_2","idx","maxLeft","y","dataBound","refreshVirtualFrozenHeight","selectedRowIndex","valueX","querySelectorAll","concat","frzLeftWidth","frzRightWidth","leftrightColumnWidth","contains","uid","getColumnByUid","getColumnByIndex","right","translateX","isLastBlockRow","transform","rowTop","remainHeight","translateY","wrapperInfo","contentInfo","lastRowTop","lastElementChild","scrollEle","visibleRowCount","floor","startIdx","refreshMaxPage","setVirtualPageQuery","visiblePage","query","skip","take","skipPage","isManualRefresh","includePrevPage","unshift","push","addEventListener","actionBegin","actionComplete","refreshContentRows","refreshVirtualLazyLoadCache","selectVirtualRow","virtaulCellFocus","virtualCellFocus","virtualScrollEditActionBegin","editActionBegin","virtualScrollAddActionBegin","addActionBegin","virtualScrollEdit","virtualScrollEditSuccess","editSuccess","refreshVirtualCache","refreshCache","editReset","resetIsedit","getVirtualData","virtualScrollEditCancel","editCancel","refreshVirtualMaxPage","selectRowOnContextOpen","resetVirtualFocus","refreshVirtualEditFormCells","refreshCells","scrollToEdit","onActionBegin","fn","observe","gObj","down","off","cache","allowScroll","parentElement","offsetLeft","enableRtl","abs","rowObj","generateCells","foreignKeyData","error","isScroll","isOpen","dataIndex","updateCurrentViewData","cancel","refreshVirtualFrozenRows","ele","rowCell","HTMLInputElement","groupCaptionRow","scrollEleInfo","nextFocusRow","nextElementSibling","previousElementSibling","nextFocusRowInfo","virtualSelectionInfo","isPending","viewDifference","ariaColIndex","emptyRow","getEditedRowObject","rowObjects","editedrow","allowPaging","editRowObject","editRequestTypes","dataActionRequestTypes","refreshVirtualElement","previousData","resetFilterDlgPosition","columnName","allowAdding","editForm","addForm","createEmptyRowdata","columnModel","field","setProperties","getRowCollection","isOddPageSize","getOddBlockSize","getModelGenerator","getRows","getInfiniteRows","getDataRows","find","getMovableVirtualRowByIndex","getFrozenRightVirtualRowByIndex","isRowObject","prev","rowCollection","collection","m","items","selectedRow","getRowsObject","getVirtualRowIndex","vGroupedRows","isDataRow","blockSize","oddBlockSize","apply","map","tmp","rem","size","vGroupOffsets","refreshColOffsets","testRow","r","isRefresh","tr","c","clen","column","getNormalizedColumnIndex","displayVal","colGrp","getColGroup","offsetWidth","setDisplayNone","invokedFromMedia","hideAtMedia","updateMediaColumns","partialRefresh","isFrozen","recordsCount","isAvailable","selectedIndex","selectionModule","isInteracted","rowHeight","selectedRowObjectIndex","findIndex","getDataModule","isRemote","VirtualHeaderRenderer","isMovable","gen","refreshUI","headerContent","enableInfiniteScrolling","needFullRefresh","getColumnByField","tablewidth","_i","_a","className","renderFrozenWrapper","cssText","renderFrozenPlaceHolder","xValue","yValue","full","setFreezeWrapperWidth"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-grids/src/grid/renderer/virtual-content-renderer.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { remove, createElement, closest, formatUnit, Browser, extend } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { dataReady, modelChanged, refreshVirtualBlock, contentReady } from '../base/constant';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { ContentRender } from './content-renderer';\nimport { HeaderRender } from './header-renderer';\nimport { InterSectionObserver } from '../services/intersection-observer';\nimport { VirtualRowModelGenerator } from '../services/virtual-row-model-generator';\nimport { isGroupAdaptive, ensureLastRow, ensureFirstRow, getEditedDataIndex, getTransformValues, checkIsVirtual, getVisiblePage, parentsUntil } from '../base/util';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport * as literals from '../base/string-literals';\n/**\n * VirtualContentRenderer\n *\n * @hidden\n */\nvar VirtualContentRenderer = /** @class */ (function (_super) {\n    __extends(VirtualContentRenderer, _super);\n    function VirtualContentRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.prevHeight = 0;\n        /** @hidden */\n        _this.startIndex = 0;\n        _this.preStartIndex = 0;\n        _this.preventEvent = false;\n        _this.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];\n        /** @hidden */\n        _this.offsets = {};\n        _this.tmpOffsets = {};\n        /** @hidden */\n        _this.virtualEle = new VirtualElementHandler();\n        _this.offsetKeys = [];\n        _this.isFocused = false;\n        _this.isSelection = false;\n        _this.isBottom = false;\n        _this.isBottomNotify = false;\n        _this.diff = 0;\n        _this.heightChange = false;\n        /** @hidden */\n        _this.isTop = false;\n        _this.empty = undefined;\n        _this.isCancel = false;\n        _this.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save', 'sorting'];\n        _this.isNormaledit = _this.parent.editSettings.mode === 'Normal';\n        /** @hidden */\n        _this.virtualData = {};\n        _this.virtualInfiniteData = {};\n        _this.emptyRowData = {};\n        _this.isContextMenuOpen = false;\n        _this.isSelectionScroll = false;\n        _this.validationCheck = false;\n        /** @hidden */\n        _this.firstCellFocus = false;\n        _this.prevPage = 0;\n        _this.prevCurrentInfo = {};\n        _this.locator = locator;\n        _this.eventListener('on');\n        _this.widthServices = locator.getService('widthService');\n        _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n        _this.vgenerator = _this.generator;\n        return _this;\n    }\n    VirtualContentRenderer.prototype.renderTable = function () {\n        this.header = this.locator.getService('rendererFactory').getRenderer(RenderType.Header);\n        _super.prototype.renderTable.call(this);\n        this.virtualEle.table = this.getTable();\n        this.virtualEle.content = this.content = this.getPanel().querySelector('.' + literals.content);\n        this.virtualEle.renderWrapper(this.parent.height);\n        this.virtualEle.renderPlaceHolder();\n        if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n            this.virtualEle.wrapper.style.position = 'absolute';\n        }\n        var debounceEvent = (this.parent.dataSource instanceof DataManager && !this.parent.dataSource.dataSource.offline);\n        var opt = {\n            container: this.content, pageHeight: this.getBlockHeight() * 2, debounceEvent: debounceEvent,\n            axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y']\n        };\n        this.observer = new InterSectionObserver(this.virtualEle.wrapper, opt);\n    };\n    VirtualContentRenderer.prototype.renderEmpty = function (tbody) {\n        this.getTable().appendChild(tbody);\n        if (this.parent.frozenRows) {\n            this.parent.getHeaderContent().querySelector(literals.tbody).innerHTML = '';\n        }\n        this.virtualEle.adjustTable(0, 0);\n    };\n    VirtualContentRenderer.prototype.getReorderedFrozenRows = function (args) {\n        var blockIndex = args.virtualInfo.blockIndexes;\n        var colsIndex = args.virtualInfo.columnIndexes;\n        var page = args.virtualInfo.page;\n        args.virtualInfo.blockIndexes = [1, 2];\n        args.virtualInfo.page = 1;\n        args.virtualInfo.columnIndexes = [];\n        var recordslength = this.parent.getCurrentViewRecords().length;\n        var firstRecords = this.parent.renderModule.data.dataManager.dataSource.json.slice(0, recordslength);\n        var virtualRows = this.vgenerator.generateRows(firstRecords, args);\n        args.virtualInfo.blockIndexes = blockIndex;\n        args.virtualInfo.columnIndexes = colsIndex;\n        args.virtualInfo.page = page;\n        return virtualRows.splice(0, this.parent.frozenRows);\n    };\n    VirtualContentRenderer.prototype.scrollListener = function (scrollArgs) {\n        if ((!this.parent.enableVirtualization && this.parent.enableColumnVirtualization && (scrollArgs.direction === 'up'\n            || scrollArgs.direction === 'down')) || this.isBottomNotify) {\n            return;\n        }\n        this.scrollAfterEdit();\n        if (this.parent.enablePersistence) {\n            this.parent.scrollPosition = scrollArgs.offset;\n        }\n        if (this.preventEvent || this.parent.isDestroyed) {\n            this.preventEvent = false;\n            return;\n        }\n        if (isNullOrUndefined(document.activeElement)) {\n            this.isFocused = false;\n        }\n        else {\n            this.isFocused = this.content === closest(document.activeElement, '.' + literals.content) || this.content === document.activeElement;\n        }\n        if (this.parent.islazyloadRequest && scrollArgs.direction === 'down') {\n            this.parent.removeMaskRow();\n            this.parent.islazyloadRequest = false;\n            return;\n        }\n        var info = scrollArgs.sentinel;\n        var viewInfo = this.currentInfo = this.getInfoFromView(scrollArgs.direction, info, scrollArgs.offset);\n        if (isGroupAdaptive(this.parent)) {\n            if (viewInfo.blockIndexes && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString()) {\n                this.parent.removeMaskRow();\n                return;\n            }\n            else {\n                viewInfo.event = 'refresh-virtual-block';\n                if (!isNullOrUndefined(viewInfo.offsets)) {\n                    viewInfo.offsets.top = this.content.scrollTop;\n                }\n                this.parent.pageSettings.currentPage = viewInfo.page;\n                if (this.parent.enableVirtualMaskRow) {\n                    this.parent.showMaskRow(info.axis);\n                    this.parent.addShimmerEffect();\n                }\n                if (this.parent.editSettings.showAddNewRow) {\n                    this.parent.closeEdit();\n                }\n                this.parent.notify(viewInfo.event, { requestType: 'virtualscroll', virtualInfo: viewInfo, focusElement: scrollArgs.focusElement });\n                return;\n            }\n        }\n        if (this.prevInfo && ((info.axis === 'Y' && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString())\n            || ((info.axis === 'X' && this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString())\n                || (this.parent.isFrozenGrid() && info.axis === 'X' && this.parent.getVisibleFrozenLeftCount() >= viewInfo.columnIndexes[0]\n                    && this.prevInfo.columnIndexes.toString().includes(viewInfo.columnIndexes.toString()))))) {\n            this.parent.removeMaskRow();\n            if (Browser.isIE) {\n                this.parent.hideSpinner();\n            }\n            this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n            if (info.axis === 'Y') {\n                this.restoreEdit();\n            }\n            if (this.parent.groupSettings.enableLazyLoading && this.prevInfo.blockIndexes[0] === 1 && viewInfo.blockIndexes[0] === 1 &&\n                scrollArgs.direction === 'up') {\n                this.virtualEle.adjustTable(0, viewInfo.offsets.top < this.offsets[1] ? 0 : this.getBlockHeight());\n            }\n            return;\n        }\n        this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? viewInfo.columnIndexes : []);\n        if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n            this.parent.pageSettings.currentPage = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n        }\n        this.requestType = 'virtualscroll';\n        if (this.parent.enableVirtualMaskRow) {\n            this.parent.showMaskRow(info.axis);\n            this.parent.addShimmerEffect();\n        }\n        this.parent.islazyloadRequest = false;\n        if (this.parent.editSettings.showAddNewRow) {\n            this.parent.closeEdit();\n        }\n        this.parent.notify(events.renderResponsiveColumnChooserDiv, { action: 'clear' });\n        if (!(!this.parent.isInitialLoad && this.parent.enablePersistence)) {\n            if (this.prevPage === this.parent.pageSettings.currentPage && viewInfo.event === modelChanged) {\n                this.currentInfo = this.prevCurrentInfo;\n                return;\n            }\n            if (viewInfo.event === modelChanged) {\n                this.prevPage = this.parent.pageSettings.currentPage;\n                this.prevCurrentInfo = this.currentInfo;\n            }\n            this.isBottomNotify = this.isBottom && viewInfo.event === modelChanged;\n            this.parent.notify(viewInfo.event, {\n                requestType: 'virtualscroll', virtualInfo: viewInfo,\n                focusElement: scrollArgs.focusElement\n            });\n        }\n        if (this.parent.enableColumnVirtualization && !this.parent.getContentTable().querySelector('tr.e-row')) {\n            this.parent.removeMaskRow();\n            this.appendContent(undefined, undefined, {\n                requestType: 'virtualscroll', virtualInfo: viewInfo,\n                focusElement: scrollArgs.focusElement\n            });\n            this.prevInfo = viewInfo;\n        }\n    };\n    VirtualContentRenderer.prototype.block = function (blk) {\n        return this.vgenerator.isBlockAvailable(blk);\n    };\n    VirtualContentRenderer.prototype.getInfoFromView = function (direction, info, e) {\n        var isBlockAdded = false;\n        var tempBlocks = [];\n        var infoType = { direction: direction, sentinelInfo: info, offsets: e,\n            startIndex: this.preStartIndex, endIndex: this.preEndIndex };\n        infoType.page = this.getPageFromTop(e.top, infoType);\n        infoType.blockIndexes = tempBlocks = this.vgenerator.getBlockIndexes(infoType.page);\n        infoType.loadSelf = !this.vgenerator.isBlockAvailable(tempBlocks[infoType.block]);\n        var blocks = this.ensureBlocks(infoType);\n        if (this.activeKey === 'upArrow' && infoType.blockIndexes.toString() !== blocks.toString()) {\n            // To avoid dupilcate row index problem in key focus support\n            var newBlock = blocks[blocks.length - 1];\n            if (infoType.blockIndexes.indexOf(newBlock) === -1) {\n                isBlockAdded = true;\n            }\n        }\n        if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n            infoType.blockIndexes = blocks;\n        }\n        infoType.loadNext = !blocks.filter(function (val) { return tempBlocks.indexOf(val) === -1; })\n            .every(this.block.bind(this));\n        infoType.event = (infoType.loadNext || infoType.loadSelf) ? modelChanged : refreshVirtualBlock;\n        infoType.nextInfo = infoType.loadNext ? { page: Math.max(1, infoType.page + (direction === 'down' ? 1 : -1)) } : {};\n        if (isBlockAdded) {\n            infoType.blockIndexes = [infoType.blockIndexes[0] - 1, infoType.blockIndexes[0], infoType.blockIndexes[0] + 1];\n        }\n        if (this.activeKey === 'downArrow' && !isNaN(this.rowIndex)) {\n            var firstBlock = Math.ceil(this.rowIndex / this.getBlockSize());\n            if (firstBlock !== 1 && (infoType.blockIndexes[1] !== firstBlock || infoType.blockIndexes.length < 3)) {\n                infoType.blockIndexes = [firstBlock - 1, firstBlock, firstBlock + 1];\n                if (infoType.loadNext) {\n                    var nextBlock = this.vgenerator.getBlockIndexes(infoType.nextInfo.page);\n                    var hasCommonValue = false;\n                    for (var i = 0; i < infoType.blockIndexes.length; i++) {\n                        for (var j = 0; j < nextBlock.length; j++) {\n                            if (infoType.blockIndexes[parseInt(i.toString(), 10)] === nextBlock[parseInt(j.toString(), 10)]) {\n                                hasCommonValue = true;\n                                break;\n                            }\n                        }\n                        if (hasCommonValue) {\n                            break;\n                        }\n                    }\n                    if (!hasCommonValue) {\n                        infoType.loadNext = false;\n                        infoType.nextInfo = {};\n                        infoType.event = refreshVirtualBlock;\n                    }\n                }\n            }\n        }\n        infoType.columnIndexes = info.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();\n        if (this.parent.enableColumnVirtualization && info.axis === 'X') {\n            infoType.event = refreshVirtualBlock;\n        }\n        return infoType;\n    };\n    VirtualContentRenderer.prototype.ensureBlocks = function (info) {\n        var _this = this;\n        var index = info.blockIndexes[info.block];\n        var mIdx;\n        var old = index;\n        var max = Math.max;\n        var indexes = info.direction === 'down' ? [max(index, 1), ++index, ++index] : [max(index - 1, 1), index, index + 1];\n        this.prevInfo = this.prevInfo || this.vgenerator.getData();\n        indexes = indexes.filter(function (val, ind) { return indexes.indexOf(val) === ind; });\n        var preventSelf = false;\n        if (checkIsVirtual(this.parent) && info.direction === 'up' && (((info.page + 1 === this.prevInfo.page\n            || info.page === this.prevInfo.page) && (info.block === 1 || (info.block === 0\n            && info.page === 1))) || (info.page === this.prevInfo.page && indexes.length === 2))\n            && this.vgenerator.isBlockAvailable(info.blockIndexes[1] + 1)) {\n            preventSelf = (info.page + 1) === this.prevInfo.page && info.block === 1;\n            index += 1;\n            indexes = [max(index - 1, 1), index, index + 1];\n        }\n        if (this.prevInfo.blockIndexes.toString() === indexes.toString()) {\n            return indexes;\n        }\n        if ((info.loadSelf && !preventSelf) || (info.direction === 'down' && this.isEndBlock(old))) {\n            indexes = this.vgenerator.getBlockIndexes(info.page);\n        }\n        indexes.some(function (val, ind) {\n            var result = val === (isGroupAdaptive(_this.parent) ? _this.getGroupedTotalBlocks() : _this.getTotalBlocks());\n            if (result) {\n                mIdx = ind;\n            }\n            return result;\n        });\n        if (mIdx !== undefined) {\n            indexes = indexes.slice(0, mIdx + 1);\n            if (info.block === 0 && indexes.length === 1 && this.vgenerator.isBlockAvailable(indexes[0] - 1)) {\n                indexes = [indexes[0] - 1, indexes[0]];\n            }\n        }\n        return indexes;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    VirtualContentRenderer.prototype.appendContent = function (target, newChild, e) {\n        var _this = this;\n        // currentInfo value will be used if there are multiple dom updates happened due to mousewheel\n        var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && this.currentInfo.page &&\n            this.currentInfo.page !== e.virtualInfo.page ? this.currentInfo : e.virtualInfo;\n        this.prevInfo = this.prevInfo || e.virtualInfo;\n        var cBlock = (info.columnIndexes[0]) - 1;\n        var cOffset = this.getColumnOffset(cBlock);\n        var width;\n        var blocks = info.blockIndexes;\n        if (this.parent.groupSettings.columns.length) {\n            this.refreshOffsets();\n        }\n        if (this.parent.height === '100%') {\n            this.parent.element.style.height = '100%';\n        }\n        var vHeight = this.parent.height.toString().indexOf('%') < 0 ? this.content.getBoundingClientRect().height :\n            this.parent.element.getBoundingClientRect().height;\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n            vHeight = 0;\n        }\n        var reduceWidth = 0;\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n            var frzLeftWidth_1 = 0;\n            this.parent.getColumns().filter(function (col) {\n                if (col.visible) {\n                    reduceWidth += parseInt(col.width.toString(), 10);\n                    if (col.freeze === 'Left') {\n                        frzLeftWidth_1 += parseInt(col.width.toString(), 10);\n                    }\n                }\n            });\n            var cIndex = info.columnIndexes;\n            width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n            if (cBlock > this.parent.getVisibleFrozenLeftCount()) {\n                cOffset = cOffset - frzLeftWidth_1;\n            }\n            this.resetStickyLeftPos(cOffset, newChild);\n        }\n        if (!this.requestTypes.some(function (value) { return value === _this.requestType; })) {\n            var translate = this.getTranslateY(this.content.scrollTop, vHeight, info);\n            if (this.parent.groupSettings.enableLazyLoading && info && this.prevInfo && this.prevInfo.blockIndexes[0] === 1 &&\n                info.blockIndexes[0] === 1 && info.direction === 'up') {\n                this.virtualEle.adjustTable(0, this.content.scrollTop < this.offsets[1] ? 0 : this.getBlockHeight());\n            }\n            else {\n                this.virtualEle.adjustTable(cOffset, translate);\n            }\n        }\n        if (this.parent.enableColumnVirtualization) {\n            this.header.virtualEle.adjustTable(cOffset, 0);\n        }\n        if (this.parent.enableColumnVirtualization) {\n            var cIndex = info.columnIndexes;\n            width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n            if (this.parent.isFrozenGrid()) {\n                width = reduceWidth.toString();\n                if (this.parent.allowResizing) {\n                    this.parent.getHeaderTable().style.width = reduceWidth + 'px';\n                    this.parent.getContentTable().style.width = reduceWidth + 'Px';\n                }\n            }\n            this.header.virtualEle.setWrapperWidth(width);\n        }\n        this.virtualEle.setWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n        if (this.parent.enableColumnVirtualization && isNullOrUndefined(target) && isNullOrUndefined(newChild)) {\n            return;\n        }\n        if (!isNullOrUndefined(target) && !isNullOrUndefined(target.parentNode)) {\n            remove(target);\n        }\n        var tbody = this.parent.element.querySelector('.' + literals.content).querySelector(literals.tbody);\n        if (tbody) {\n            remove(tbody);\n            target = null;\n        }\n        var isReact = this.parent.isReact && !isNullOrUndefined(this.parent.rowTemplate);\n        if (!isReact) {\n            target = this.parent.createElement(literals.tbody, { attrs: { role: 'rowgroup' } });\n            target.appendChild(newChild);\n        }\n        else {\n            target = newChild;\n        }\n        if (this.parent.frozenRows && e.requestType === 'virtualscroll' && (this.parent.pageSettings.currentPage === 1\n            || this.isInfiniteColumnvirtualization())) {\n            for (var i = 0; i < this.parent.frozenRows; i++) {\n                target.children[0].remove();\n            }\n        }\n        this.getTable().appendChild(target);\n        this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization && (info.direction === 'right' || info.direction === 'left')) {\n            this.content.scrollTop = this.currentInfo.offsets.top;\n            this.content.scrollLeft = this.currentInfo.offsets.left;\n        }\n        if (this.parent.groupSettings.columns.length) {\n            if (!isGroupAdaptive(this.parent) && info.direction === 'up') {\n                var blk = this.offsets[this.getTotalBlocks()] - this.prevHeight;\n                var sTop = this.content.scrollTop;\n                this.content.scrollTop = sTop + blk;\n            }\n            this.setVirtualHeight();\n            if (!this.parent.groupSettings.enableLazyLoading) {\n                this.observer.setPageHeight(this.getOffset(blocks[blocks.length - 1]) - this.getOffset(blocks[0] - 1));\n            }\n        }\n        if (!this.parent.groupSettings.enableLazyLoading && this.parent.groupSettings.columns.length === 0 &&\n            e.requestType === 'ungrouping') {\n            this.observer.setPageHeight(this.getBlockHeight() * 2);\n        }\n        this.prevInfo = info;\n        if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {\n            this.content.focus();\n        }\n        var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n        if (this.isBottom) {\n            this.isBottom = false;\n            this.isBottomNotify = false;\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n        }\n        if ((this.parent.pageSettings.currentPage + 1 === lastPage || this.parent.pageSettings.currentPage === lastPage) &&\n            blocks.length === 2 && e.requestType === 'delete') {\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n        }\n        if ((this.parent.pageSettings.currentPage === lastPage) && blocks.length === 1) {\n            this.isBottom = true;\n            setTimeout(function () {\n                var scrollElement = _this.parent.getContent().firstElementChild;\n                scrollElement.scrollTop = _this.offsets[_this.offsetKeys.length - 2];\n                var scrollValues = { direction: 'up', sentinel: _this.observer.sentinelInfo.up,\n                    offset: { top: scrollElement.scrollTop, left: scrollElement.scrollLeft }, focusElement: _this.parent.element };\n                _this.scrollListener(scrollValues);\n            }, 0);\n        }\n        if (this.isTop) {\n            this.parent.getContent().firstElementChild.scrollTop = 0;\n            this.isTop = false;\n        }\n        if (e.requestType === 'virtualscroll' && e.virtualInfo.sentinelInfo.axis === 'X') {\n            this.parent.notify(events.autoCol, {});\n        }\n        this.focusCell(e);\n        if (this.firstCellFocus) {\n            this.firstCellFocus = false;\n            var focusModule = this.parent.focusModule;\n            var current = focusModule.active.matrix.current;\n            var cell = this.parent.getContentTable().rows[current[0]].cells[current[1]];\n            focusModule.currentInfo.element = cell;\n            focusModule.currentInfo.elementToFocus = cell;\n            cell.classList.add('e-focus');\n            cell.classList.add('e-focused');\n            cell.tabIndex = 0;\n            cell.focus();\n        }\n        this.restoreEdit(e);\n        this.restoreAdd();\n        this.ensureSelectedRowPosition();\n        this.validationScrollLeft();\n        if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {\n            this.widthServices.refreshFrozenScrollbar();\n        }\n        if (!this.initialRowTop) {\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            if (this.parent.getRowByIndex(0)) {\n                this.initialRowTop = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.validationScrollLeft = function () {\n        if (this.validationCheck) {\n            if (this.validationCol) {\n                var offset = this.vgenerator.cOffsets[(this.validationCol.index - this.parent.getVisibleFrozenColumns()) - 1];\n                this.validationCol = null;\n                this.content.scrollLeft = offset;\n            }\n            else {\n                this.validationCheck = false;\n                this.parent.editModule.editFormValidate();\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.ensureSelectedRowPosition = function () {\n        if (!this.isSelection && this.isSelectionScroll && !isNullOrUndefined(this.selectRowIndex)) {\n            this.isSelectionScroll = false;\n            var row = this.parent.getRowByIndex(this.selectRowIndex);\n            if (row && !this.isRowInView(row)) {\n                this.rowSelected({ rowIndex: this.selectRowIndex, row: row }, true);\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.focusCell = function (e) {\n        if (this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n            return;\n        }\n        var row = this.parent.getRowByIndex(this.rowIndex);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var cell = row.cells[this.cellIndex];\n        cell.focus({ preventScroll: true });\n        if (!this.parent.selectionSettings.checkboxOnly) {\n            this.parent.selectRow(parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1);\n        }\n        this.activeKey = this.empty;\n    };\n    VirtualContentRenderer.prototype.restoreEdit = function (e) {\n        if (this.isNormaledit) {\n            if (this.parent.editSettings.allowEditing\n                && this.parent.editModule && !isNullOrUndefined(this.editedRowIndex)) {\n                var row = this.getRowByIndex(this.editedRowIndex);\n                var content = this.content;\n                var keys = Object.keys(this.virtualData);\n                var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n                if (keys.length && row && !content.querySelector('.' + literals.editedRow) &&\n                    ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'].indexOf(e.requestType) === -1) {\n                    var top_1 = row.getBoundingClientRect().top - this.parent.element.getBoundingClientRect().top;\n                    if (isXaxis || (top_1 < this.content.offsetHeight && top_1 > this.parent.getRowHeight())) {\n                        this.parent.isEdit = false;\n                        this.parent.editModule.startEdit(row);\n                    }\n                }\n                if (row && this.content.querySelector('.' + literals.editedRow) && !keys.length) {\n                    var rowData = (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) ?\n                        this.enableCacheOnInfiniteColumnVirtual() ? this.virtualInfiniteData :\n                            extend({}, this.parent.getCurrentViewRecords()[this.editedRowIndex]) :\n                        extend({}, this.getRowObjectByIndex(this.editedRowIndex));\n                    this.virtualData = this.getVirtualEditedData(rowData);\n                }\n            }\n            this.restoreAdd();\n        }\n    };\n    VirtualContentRenderer.prototype.getVirtualEditedData = function (rowData) {\n        var editForms = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));\n        var isFormDestroyed = this.parent.editModule && this.parent.editModule.formObj\n            && this.parent.editModule.formObj.isDestroyed;\n        if (!isFormDestroyed) {\n            for (var i = 0; i < editForms.length; i++) {\n                rowData = this.parent.editModule.getCurrentEditedData(editForms[parseInt(i.toString(), 10)], rowData);\n            }\n        }\n        return rowData;\n    };\n    VirtualContentRenderer.prototype.restoreAdd = function () {\n        var startAdd = !this.parent.element.querySelector('.' + literals.addedRow);\n        if (this.isNormaledit && this.isAdd && startAdd) {\n            var isTop = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();\n            var isBottom = this.parent.editSettings.newRowPosition === 'Bottom'\n                && this.parent.pageSettings.currentPage === this.maxPage;\n            if (isTop || isBottom) {\n                this.parent.isEdit = false;\n                this.parent.addRecord();\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.onDataReady = function (e) {\n        if (!isNullOrUndefined(e.count)) {\n            this.count = e.count;\n            this.maxPage = Math.ceil((this.parent.groupSettings.columns.length && this.parent.vcRows.length ? this.parent.vcRows.length\n                : e.count) / this.parent.pageSettings.pageSize);\n        }\n        this.vgenerator.checkAndResetCache(e.requestType);\n        if (['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', undefined]\n            .some(function (value) { return e.requestType === value; })) {\n            this.refreshOffsets();\n        }\n        this.setVirtualHeight();\n        this.resetScrollPosition(e.requestType);\n    };\n    /**\n     * @param {number} height - specifies the height\n     * @returns {void}\n     * @hidden\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.setVirtualHeight = function (height) {\n        var width = this.parent.enableColumnVirtualization ?\n            this.getColumnOffset(this.parent.getVisibleColumns().length + this.parent.groupSettings.columns.length - 1) + 'px' : '100%';\n        var virtualHeight = (this.offsets[isGroupAdaptive(this.parent) && this.count !== 0 ? this.getGroupedTotalBlocks() :\n            this.getTotalBlocks()]);\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n            virtualHeight = 0;\n        }\n        var totalBlocks = isGroupAdaptive(this.parent) && this.count !== 0 ? this.getGroupedTotalBlocks()\n            : this.getTotalBlocks();\n        var lastPage = Math.ceil(totalBlocks / 2);\n        var placeHolderBottom = Math.round(this.virtualEle.placeholder.getBoundingClientRect().bottom);\n        var wrapperBottom = Math.round(this.virtualEle.wrapper.getBoundingClientRect().bottom);\n        if ((this.currentInfo.page === lastPage || this.currentInfo.page + 1 === lastPage) && this.currentInfo.direction === 'down' &&\n            placeHolderBottom > wrapperBottom && !this.diff) {\n            this.diff = placeHolderBottom - wrapperBottom;\n        }\n        if (this.diff && (this.currentInfo.page === lastPage) && placeHolderBottom > wrapperBottom &&\n            !(this.isAdd && this.parent.editSettings.newRowPosition === 'Bottom')) {\n            virtualHeight -= this.diff;\n            this.heightChange = true;\n        }\n        else if (this.requestType === 'virtualscroll' && this.diff && this.heightChange) {\n            virtualHeight -= this.diff;\n            this.heightChange = false;\n        }\n        this.virtualEle.setVirtualHeight(virtualHeight, width);\n        if (this.virtualEle && this.virtualEle.wrapper) {\n            if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n                this.virtualEle.wrapper.style.minHeight = '';\n            }\n            else {\n                this.virtualEle.wrapper.style.minHeight = !isNullOrUndefined(virtualHeight) ? formatUnit(this.parent.height) : '0px';\n            }\n        }\n        if (this.parent.enableColumnVirtualization) {\n            this.header.virtualEle.setVirtualHeight(1, width);\n        }\n    };\n    /**\n     * @param {number} sTop - specifies the sTop\n     * @param {VirtualInfo} info - specifies the info\n     * @returns {number} - return the page\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getPageFromTop = function (sTop, info) {\n        var _this = this;\n        var total = (isGroupAdaptive(this.parent)) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        var page = 0;\n        this.offsetKeys.some(function (offset) {\n            var iOffset = Number(offset);\n            var border = sTop <= _this.offsets[\"\" + offset] || (iOffset === total && sTop > _this.offsets[\"\" + offset]);\n            if (border) {\n                if (_this.offsetKeys.length % 2 !== 0 && iOffset.toString() === _this.offsetKeys[_this.offsetKeys.length - 2]\n                    && sTop <= _this.offsets[_this.offsetKeys.length - 1]) {\n                    iOffset = iOffset + 1;\n                }\n                info.block = iOffset % 2 === 0 ? 1 : 0;\n                page = Math.max(1, Math.min(_this.vgenerator.getPage(iOffset), _this.maxPage));\n            }\n            return border;\n        });\n        return page;\n    };\n    VirtualContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n        if (info === undefined) {\n            info = { page: this.getPageFromTop(sTop, {}) };\n            info.blockIndexes = this.vgenerator.getBlockIndexes(info.page);\n        }\n        var block = (info.blockIndexes[0] || 1) - 1;\n        var translate = this.getOffset(block);\n        var endTranslate = this.getOffset(info.blockIndexes[info.blockIndexes.length - 1]);\n        if (isOnenter) {\n            info = this.prevInfo;\n        }\n        var result = translate > sTop ?\n            this.getOffset(block - 1) : endTranslate < (sTop + cHeight) ? this.getOffset(block + 1) : translate;\n        var blockHeight = this.offsets[info.blockIndexes[info.blockIndexes.length - 1]] -\n            this.tmpOffsets[info.blockIndexes[0]];\n        var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        if (result + blockHeight > this.offsets[parseInt(totalBlocks.toString(), 10)]) {\n            result -= (result + blockHeight) - this.offsets[parseInt(totalBlocks.toString(), 10)];\n        }\n        if (info.page === 1 && info.block === 0 && info.direction === 'up') {\n            result = 0;\n        }\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n            result = 0;\n        }\n        return result;\n    };\n    VirtualContentRenderer.prototype.getOffset = function (block) {\n        return Math.min(this.offsets[parseInt(block.toString(), 10)] | 0, this.offsets[this.maxBlock] | 0);\n    };\n    VirtualContentRenderer.prototype.onEntered = function () {\n        var _this = this;\n        return function (element, current, direction, e, isWheel, check) {\n            if ((direction === 'down' || direction === 'up') && !_this.parent.enableVirtualization && _this.parent.enableColumnVirtualization) {\n                return;\n            }\n            if (Browser.isIE && !isWheel && check && !_this.preventEvent && !_this.parent.enableVirtualMaskRow) {\n                _this.parent.showSpinner();\n            }\n            _this.prevInfo = _this.prevInfo || _this.vgenerator.getData();\n            var viewInfo = _this.getInfoFromView(direction, current, e);\n            if (_this.parent.isFrozenGrid() && current.axis === 'X' && _this.parent.getVisibleFrozenLeftCount() >= viewInfo.columnIndexes[0]\n                && _this.prevInfo && _this.prevInfo.columnIndexes.toString().includes(viewInfo.columnIndexes.toString())) {\n                return;\n            }\n            if (_this.parent.enableVirtualMaskRow && !_this.preventEvent) {\n                var firstOffSetKey = parseInt(_this.offsetKeys[0], 10);\n                var lastOffSetKey = parseInt(_this.offsetKeys[_this.offsetKeys.length - 1], 10);\n                var blockIndex = _this.currentInfo.blockIndexes;\n                var disableShowMaskRow = (_this.prevInfo && current.axis === 'X'\n                    && _this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString())\n                    || (direction === 'down' && _this.parent.allowGrouping && _this.parent.groupSettings.columns.length\n                        && ((_this.parent.allowFiltering && _this.parent.filterSettings.columns.length)\n                            || _this.parent.searchSettings.key.length) && _this.offsetKeys.length <= 2);\n                if (!((blockIndex && blockIndex[0] === firstOffSetKey && direction === 'up') ||\n                    (blockIndex && blockIndex[blockIndex.length - 1] === lastOffSetKey && direction === 'down') || disableShowMaskRow)) {\n                    setTimeout(function () {\n                        _this.parent.showMaskRow(current.axis);\n                    }, 0);\n                }\n            }\n            var xAxis = current.axis === 'X';\n            var top = _this.prevInfo.offsets ? _this.prevInfo.offsets.top : null;\n            var height = _this.content.getBoundingClientRect().height;\n            var x = _this.getColumnOffset(xAxis ? _this.vgenerator.getColumnIndexes()[0] - 1 : _this.prevInfo.columnIndexes[0] - 1);\n            if (_this.parent.isFrozenGrid() && _this.parent.enableColumnVirtualization && _this.currentInfo &&\n                _this.currentInfo.columnIndexes) {\n                var cBlock = _this.currentInfo.columnIndexes[0] - 1;\n                var frzLeftWidth_2 = 0;\n                _this.parent.getColumns().filter(function (col) {\n                    if (col.visible && col.freeze === 'Left') {\n                        frzLeftWidth_2 += parseInt(col.width.toString(), 10);\n                    }\n                });\n                if (cBlock > _this.parent.getVisibleFrozenLeftCount()) {\n                    x = x - frzLeftWidth_2;\n                }\n            }\n            if (xAxis) {\n                var idx = Object.keys(_this.vgenerator.cOffsets).length - _this.prevInfo.columnIndexes.length;\n                var maxLeft = _this.vgenerator.cOffsets[idx - 1];\n                x = x > maxLeft ? maxLeft : x; //TODO: This fix horizontal scrollbar jumping issue in column virtualization.\n            }\n            if (!_this.parent.enableVirtualization && _this.parent.enableColumnVirtualization) {\n                _this.virtualEle.adjustTable(x, 0);\n            }\n            else {\n                var y = _this.getTranslateY(e.top, height, xAxis && top === e.top ? _this.prevInfo : undefined, true);\n                _this.virtualEle.adjustTable(x, Math.min(y, _this.offsets[_this.maxBlock]));\n            }\n            if (_this.parent.enableColumnVirtualization) {\n                _this.header.virtualEle.adjustTable(x, 0);\n                if (_this.parent.isFrozenGrid()) {\n                    _this.resetStickyLeftPos(x);\n                }\n            }\n        };\n    };\n    VirtualContentRenderer.prototype.dataBound = function () {\n        this.parent.notify(events.refreshVirtualFrozenHeight, {});\n        if (this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n            this.parent.selectRow(this.selectedRowIndex);\n        }\n        else {\n            this.activeKey = this.empty;\n            this.requestType = this.empty;\n        }\n    };\n    /**\n     * To calculate the position of frozen cells\n     *\n     * @param {number} valueX - specifies the transform X value\n     * @param {DocumentFragment | HTMLElement} newChild - specifies the element to transform\n     * @returns {void}\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.resetStickyLeftPos = function (valueX, newChild) {\n        var cells = [].slice.call(this.parent.getHeaderContent().querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')).concat([].slice.call((newChild ? newChild : this.parent.getContent()).querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')));\n        var frzLeftWidth = 0;\n        var frzRightWidth = 0;\n        if (this.parent.getHeaderContent().querySelectorAll('.e-fixedfreeze').length) {\n            frzLeftWidth = this.parent.leftrightColumnWidth('left');\n            frzRightWidth = this.parent.leftrightColumnWidth('right');\n        }\n        if (cells.length) {\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[parseInt(i.toString(), 10)];\n                var col = void 0;\n                if (cell.classList.contains('e-rowcell')) {\n                    if (isNullOrUndefined(cell.getAttribute('aria-colindex')) && cell.querySelector('[e-mappinguid]')) {\n                        var uid = cell.querySelector('[e-mappinguid]').getAttribute('e-mappinguid');\n                        col = this.parent.getColumnByUid(uid);\n                    }\n                    else {\n                        var idx = parseInt(cell.getAttribute('aria-colindex'), 10) - 1;\n                        col = this.parent.getColumnByIndex(parseInt(idx.toString(), 10));\n                    }\n                }\n                else {\n                    if (cell.classList.contains('e-headercell') || cell.classList.contains('e-filterbarcell')) {\n                        var uid = cell.classList.contains('e-filterbarcell') ? cell.getAttribute('e-mappinguid') :\n                            cell.querySelector('[e-mappinguid]').getAttribute('e-mappinguid');\n                        col = this.parent.getColumnByUid(uid);\n                    }\n                }\n                if (col.freeze === 'Left') {\n                    cell.style.left = (col.valueX - valueX) + 'px';\n                }\n                else if (col.freeze === 'Right') {\n                    cell.style.right = (col.valueX + valueX) + 'px';\n                }\n                else if (col.freeze === 'Fixed') {\n                    cell.style.left = (frzLeftWidth - valueX) + 'px';\n                    cell.style.right = (frzRightWidth + valueX) + 'px';\n                }\n            }\n        }\n        this.parent.translateX = valueX;\n    };\n    VirtualContentRenderer.prototype.rowSelected = function (args, isSelection) {\n        if ((this.isSelection || isSelection) && !this.isLastBlockRow(args.rowIndex)) {\n            var transform = getTransformValues(this.content.firstElementChild);\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            var rowTop = args.row.getBoundingClientRect().top - gridTop;\n            var height = this.content.getBoundingClientRect().height;\n            var isBottom = height < rowTop;\n            var remainHeight = isBottom ? rowTop - height : this.initialRowTop - rowTop;\n            var translateY = isBottom ? transform.height - remainHeight : transform.height + remainHeight;\n            this.virtualEle.adjustTable(transform.width, translateY);\n            var wrapperInfo = this.virtualEle.wrapper.getBoundingClientRect();\n            var contentInfo = this.content.getBoundingClientRect();\n            if (wrapperInfo.top > contentInfo.top) {\n                this.virtualEle.adjustTable(transform.width, translateY - (wrapperInfo.top - contentInfo.top));\n            }\n            var lastRowTop = this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top - gridTop;\n            if (lastRowTop < height) {\n                translateY = translateY + (height - (args.row.getBoundingClientRect().top - gridTop));\n                this.virtualEle.adjustTable(transform.width, translateY - (this.parent.getRowHeight() / 2));\n            }\n            else if (contentInfo.bottom > wrapperInfo.bottom) {\n                this.virtualEle.adjustTable(transform.width, translateY + (contentInfo.bottom - wrapperInfo.bottom));\n            }\n            if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {\n                this.resetStickyLeftPos(transform.width);\n            }\n        }\n        this.isSelection = false;\n    };\n    VirtualContentRenderer.prototype.isLastBlockRow = function (index) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        var startIdx = (this.maxPage * this.parent.pageSettings.pageSize) - visibleRowCount;\n        return index >= startIdx;\n    };\n    VirtualContentRenderer.prototype.refreshMaxPage = function () {\n        if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {\n            this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);\n        }\n    };\n    VirtualContentRenderer.prototype.setVirtualPageQuery = function (args) {\n        var visiblePage = [];\n        if (this.prevInfo && this.prevInfo.blockIndexes) {\n            visiblePage = getVisiblePage(this.prevInfo.blockIndexes);\n        }\n        if ((this.requestType === 'sorting' || this.requestType === 'delete') && visiblePage.length && checkIsVirtual(this.parent)) {\n            args.query.skip(this.parent.pageSettings.pageSize * (visiblePage[0] - 1));\n            args.query.take(this.parent.pageSettings.pageSize * visiblePage.length);\n            args.skipPage = true;\n            return;\n        }\n        var row = this.parent.getContent().querySelector('.e-row');\n        if (this.requestType === 'virtualscroll' && this.vgenerator.currentInfo.blockIndexes) {\n            this.vgenerator.currentInfo = {};\n        }\n        if (row && this.parent.isManualRefresh && this.currentInfo.blockIndexes\n            && (this.currentInfo.blockIndexes.length === 3 || visiblePage.length > 1)) {\n            this.vgenerator.startIndex = parseInt(row.getAttribute('aria-rowindex'), 10) - 1;\n            this.vgenerator.currentInfo = extend({}, this.currentInfo);\n            this.vgenerator.currentInfo.blockIndexes = this.currentInfo.blockIndexes.slice();\n            var includePrevPage = this.vgenerator.includePrevPage = this.currentInfo.blockIndexes[0] % 2 === 0;\n            if (includePrevPage) {\n                this.vgenerator.startIndex = this.vgenerator.startIndex - this.getBlockSize();\n                this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0] - 1);\n            }\n            else {\n                this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length - 1] + 1);\n            }\n            var skip = (this.vgenerator.currentInfo.blockIndexes[0] - 1) * this.getBlockSize();\n            var take = this.vgenerator.currentInfo.blockIndexes.length * this.getBlockSize();\n            args.query.skip(skip);\n            args.query.take(take);\n            args.skipPage = true;\n        }\n    };\n    VirtualContentRenderer.prototype.eventListener = function (action) {\n        var _this = this;\n        this.parent[\"\" + action](dataReady, this.onDataReady, this);\n        this.parent.addEventListener(events.dataBound, this.dataBound.bind(this));\n        this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n        this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n        this.parent.addEventListener(events.rowSelected, this.rowSelected.bind(this));\n        this.parent[\"\" + action](refreshVirtualBlock, this.refreshContentRows, this);\n        this.parent[\"\" + action](events.refreshVirtualLazyLoadCache, this.refreshVirtualLazyLoadCache, this);\n        this.parent[\"\" + action](events.selectVirtualRow, this.selectVirtualRow, this);\n        this.parent[\"\" + action](events.virtaulCellFocus, this.virtualCellFocus, this);\n        this.parent[\"\" + action](events.virtualScrollEditActionBegin, this.editActionBegin, this);\n        this.parent[\"\" + action](events.virtualScrollAddActionBegin, this.addActionBegin, this);\n        this.parent[\"\" + action](events.virtualScrollEdit, this.restoreEdit, this);\n        this.parent[\"\" + action](events.virtualScrollEditSuccess, this.editSuccess, this);\n        this.parent[\"\" + action](events.refreshVirtualCache, this.refreshCache, this);\n        this.parent[\"\" + action](events.editReset, this.resetIsedit, this);\n        this.parent[\"\" + action](events.getVirtualData, this.getVirtualData, this);\n        this.parent[\"\" + action](events.virtualScrollEditCancel, this.editCancel, this);\n        this.parent[\"\" + action](events.refreshVirtualMaxPage, this.refreshMaxPage, this);\n        this.parent[\"\" + action](events.setVirtualPageQuery, this.setVirtualPageQuery, this);\n        this.parent[\"\" + action](events.selectRowOnContextOpen, this.selectRowOnContextOpen, this);\n        this.parent[\"\" + action](events.resetVirtualFocus, this.resetVirtualFocus, this);\n        this.parent[\"\" + action](events.refreshVirtualEditFormCells, this.refreshCells, this);\n        this.parent[\"\" + action](events.scrollToEdit, this.scrollToEdit, this);\n        var event = this.actions;\n        for (var i = 0; i < event.length; i++) {\n            this.parent[\"\" + action](event[parseInt(i.toString(), 10)] + \"-begin\", this.onActionBegin, this);\n        }\n        var fn = function () {\n            _this.observer.observe(function (scrollArgs) { return _this.scrollListener(scrollArgs); }, _this.onEntered());\n            var gObj = _this.parent;\n            if (gObj.enablePersistence && gObj.scrollPosition) {\n                if (gObj.scrollPosition.top > 0) {\n                    _this.content.scrollTop = gObj.scrollPosition.top;\n                    var scrollValues = { direction: 'down', sentinel: _this.observer.sentinelInfo.down,\n                        offset: gObj.scrollPosition, focusElement: gObj.element };\n                    _this.scrollListener(scrollValues);\n                }\n                if (gObj.enableColumnVirtualization) {\n                    _this.content.scrollLeft = gObj.scrollPosition.left;\n                }\n            }\n            _this.parent.off(contentReady, fn);\n        };\n        this.parent.on(contentReady, fn, this);\n    };\n    VirtualContentRenderer.prototype.refreshVirtualLazyLoadCache = function (e) {\n        var blockIndex = this.currentInfo.blockIndexes;\n        if (isNullOrUndefined(this.currentInfo.blockIndexes)) {\n            blockIndex = [1, 2];\n        }\n        var block;\n        var index;\n        var cache;\n        for (var i = 0; i < blockIndex.length; i++) {\n            var rows = this.vgenerator.cache[blockIndex[parseInt(i.toString(), 10)]];\n            for (var j = 0; j < rows.length; j++) {\n                if (rows[parseInt(j.toString(), 10)].uid === e.uid) {\n                    block = blockIndex[parseInt(i.toString(), 10)];\n                    index = j;\n                    cache = rows;\n                    break;\n                }\n            }\n        }\n        if (e.count) {\n            this.vgenerator.cache[parseInt(block.toString(), 10)].splice(index + 1, e.count);\n        }\n        else if (e.rows && e.rows.length) {\n            this.vgenerator.cache[parseInt(block.toString(), 10)] = ([].slice.call(cache.slice(0, index + 1)).concat([].slice.call(e.rows))).concat([].slice.call(cache.slice(index + 1, cache.length)));\n        }\n        this.refreshOffsets();\n    };\n    VirtualContentRenderer.prototype.scrollToEdit = function (col) {\n        var allowScroll = true;\n        this.validationCheck = true;\n        if (this.isAdd && this.content.scrollTop > 0) {\n            allowScroll = false;\n            var keys = Object.keys(this.offsets);\n            this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[keys.length - 1];\n        }\n        var row = this.parent.getRowByIndex(this.editedRowIndex);\n        if (!row && !isNullOrUndefined(this.editedRowIndex)) {\n            if (!row || !this.isRowInView(row)) {\n                var rowIndex = this.parent.getRowHeight();\n                var scrollTop = this.editedRowIndex * rowIndex;\n                if (!isNullOrUndefined(scrollTop)) {\n                    allowScroll = false;\n                    this.content.scrollTop = scrollTop;\n                }\n            }\n        }\n        if (col && allowScroll) {\n            var offset = this.vgenerator.cOffsets[(col.index - this.parent.getVisibleFrozenColumns()) - 1];\n            if (!this.parent.enableColumnVirtualization) {\n                var header = this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid=\"' + col.uid + '\"]');\n                offset = header.parentElement.offsetLeft;\n            }\n            if (this.parent.enableColumnVirtualization && this.parent.getVisibleFrozenLeftCount()) {\n                offset -= this.parent.leftrightColumnWidth('left');\n            }\n            this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n        }\n        if (col && !allowScroll) {\n            this.validationCol = col;\n        }\n    };\n    VirtualContentRenderer.prototype.refreshCells = function (rowObj) {\n        rowObj.cells = this.vgenerator.generateCells(rowObj.foreignKeyData);\n    };\n    VirtualContentRenderer.prototype.resetVirtualFocus = function (e) {\n        this.isCancel = e.isCancel;\n    };\n    /**\n     * @param {Object} data - specifies the data\n     * @param {Object} data.virtualData -specifies the data\n     * @param {boolean} data.isAdd - specifies isAdd\n     * @param {boolean} data.isCancel - specifies boolean in cancel\n     * @param {boolean} data.isScroll - specifies boolean for scroll\n     * @returns {void}\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getVirtualData = function (data) {\n        if (this.isNormaledit) {\n            var error = this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])');\n            var keys = Object.keys(this.virtualData);\n            data.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n            if (error) {\n                return;\n            }\n            this.virtualData = keys.length ? this.virtualData : data.virtualData;\n            this.getVirtualEditedData(this.virtualData);\n            data.virtualData = this.virtualData;\n            data.isAdd = this.isAdd || this.parent.editSettings.showAddNewRow;\n            data.isCancel = this.isCancel;\n        }\n    };\n    VirtualContentRenderer.prototype.selectRowOnContextOpen = function (args) {\n        this.isContextMenuOpen = args.isOpen;\n    };\n    VirtualContentRenderer.prototype.editCancel = function (args) {\n        var dataIndex = getEditedDataIndex(this.parent, args.data);\n        if (!isNullOrUndefined(dataIndex)) {\n            args.data = this.parent.getCurrentViewRecords()[parseInt(dataIndex.toString(), 10)];\n        }\n    };\n    VirtualContentRenderer.prototype.editSuccess = function (args) {\n        if (this.isNormaledit) {\n            if (!this.isAdd && args.data) {\n                this.updateCurrentViewData(args.data);\n            }\n            this.isAdd = false;\n        }\n    };\n    VirtualContentRenderer.prototype.updateCurrentViewData = function (data) {\n        var dataIndex = getEditedDataIndex(this.parent, data);\n        if (!isNullOrUndefined(dataIndex)) {\n            this.parent.getCurrentViewRecords()[parseInt(dataIndex.toString(), 10)] = data;\n        }\n    };\n    VirtualContentRenderer.prototype.actionBegin = function (args) {\n        if (args.requestType !== 'virtualscroll') {\n            this.requestType = args.requestType;\n        }\n        if (!args.cancel) {\n            this.parent.notify(events.refreshVirtualFrozenRows, args);\n        }\n    };\n    VirtualContentRenderer.prototype.virtualCellFocus = function (e) {\n        // To decide the action (select or scroll), when using arrow keys for cell focus\n        var ele = document.activeElement;\n        if (!ele.classList.contains(literals.rowCell) && (ele instanceof HTMLInputElement\n            || !isNullOrUndefined(ele.closest('.e-templatecell')))) {\n            ele = ele.closest('.e-rowcell');\n        }\n        if (this.parent.allowGrouping && this.parent.groupSettings.columns.length\n            && ele && (ele.classList.contains(literals.rowCell) || !isNullOrUndefined(parentsUntil(ele, literals.groupCaptionRow)))\n            && e && (e.action === 'shiftEnter' || e.action === 'upArrow' || e.action === 'downArrow')) {\n            var scrollEle = this.parent.getContent().firstElementChild;\n            var scrollEleInfo = scrollEle.getBoundingClientRect();\n            var row = closest(ele, 'tr');\n            var nextFocusRow = e.action === 'downArrow' ? row.nextElementSibling : row.previousElementSibling;\n            var nextFocusRowInfo = !isNullOrUndefined(nextFocusRow) ? nextFocusRow.getBoundingClientRect()\n                : undefined;\n            if (isNullOrUndefined(nextFocusRow) || (e.action === 'downArrow' && nextFocusRowInfo.bottom > scrollEleInfo.bottom)\n                || ((e.action === 'upArrow' || e.action === 'shiftEnter') && nextFocusRowInfo.top < scrollEleInfo.top)) {\n                this.activeKey = e.action;\n                this.parent.focusModule.virtualSelectionInfo = { isPending: isNullOrUndefined(nextFocusRow),\n                    direction: e.action, event: e };\n                var viewDifference = isNullOrUndefined(nextFocusRow) ? this.parent.getRowHeight()\n                    : e.action === 'downArrow' ? nextFocusRowInfo.bottom - scrollEleInfo.bottom\n                        : scrollEleInfo.top - nextFocusRowInfo.top;\n                scrollEle.scrollTop = e.action === 'downArrow' ? scrollEle.scrollTop + viewDifference\n                    : scrollEle.scrollTop - viewDifference;\n            }\n            else {\n                this.activeKey = this.empty;\n            }\n            return;\n        }\n        if (ele && ele.classList.contains(literals.rowCell)\n            && e && (e.action === 'upArrow' || e.action === 'downArrow' || e.action === 'shiftEnter')) {\n            var rowIndex = parseInt(ele.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n            if (e && (e.action === 'upArrow' || e.action === 'shiftEnter' || e.action === 'downArrow')) {\n                var scrollEle = this.parent.getContent().firstElementChild;\n                if (e.action === 'downArrow') {\n                    rowIndex += 1;\n                }\n                else {\n                    rowIndex -= 1;\n                }\n                this.rowIndex = rowIndex;\n                this.cellIndex = parseInt(ele.getAttribute(literals.ariaColIndex), 10) - 1;\n                var row = this.parent.getRowByIndex(rowIndex);\n                var page = this.parent.pageSettings.currentPage;\n                var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n                var emptyRow = false;\n                if (isNullOrUndefined(row)) {\n                    emptyRow = true;\n                    if ((e.action === 'downArrow' && page === this.maxPage - 1) || ((e.action === 'upArrow' || e.action === 'shiftEnter') && page === 1)) {\n                        emptyRow = false;\n                    }\n                }\n                if (emptyRow || (ensureLastRow(row, this.parent) && e.action === 'downArrow')\n                    || (ensureFirstRow(row, this.parent.getRowHeight() * 2) && (e.action === 'upArrow' || e.action === 'shiftEnter'))) {\n                    this.activeKey = e.action;\n                    scrollEle.scrollTop = e.action === 'downArrow' ?\n                        (rowIndex - visibleRowCount) * this.parent.getRowHeight() : rowIndex * this.parent.getRowHeight();\n                }\n                else {\n                    this.activeKey = this.empty;\n                }\n                if (!this.parent.selectionSettings.checkboxOnly) {\n                    this.parent.selectRow(rowIndex);\n                }\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.editActionBegin = function (e) {\n        this.editedRowIndex = e.index;\n        var rowData = (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) ?\n            extend({}, this.parent.getCurrentViewRecords()[e.index]) : extend({}, this.getRowObjectByIndex(e.index));\n        var keys = Object.keys(this.virtualData);\n        e.data = keys.length && !this.parent.editSettings.showAddNewRow ? this.virtualData : this.isInfiniteColumnvirtualization() ?\n            e.data : rowData;\n        if (this.enableCacheOnInfiniteColumnVirtual()) {\n            this.virtualInfiniteData = e.data;\n        }\n        e.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n    };\n    VirtualContentRenderer.prototype.getEditedRowObject = function () {\n        var rowObjects = this.parent.vcRows;\n        var editedrow;\n        for (var i = 0; i < rowObjects.length; i++) {\n            if (rowObjects[parseInt(i.toString(), 10)].index === this.editedRowIndex) {\n                editedrow = rowObjects[parseInt(i.toString(), 10)];\n            }\n        }\n        return editedrow;\n    };\n    VirtualContentRenderer.prototype.refreshCache = function (args) {\n        if (this.isInfiniteColumnvirtualization()) {\n            return;\n        }\n        var block = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());\n        if (this.parent.allowPaging && this.parent.enableColumnVirtualization) {\n            block = Math.ceil((this.editedRowIndex + 1 + ((this.parent.pageSettings.currentPage - 1) *\n                this.parent.pageSettings.pageSize)) / this.getBlockSize());\n        }\n        var index = (this.parent.allowPaging && this.parent.enableColumnVirtualization) ?\n            this.editedRowIndex % this.getBlockSize() : this.editedRowIndex - ((block - 1) * this.getBlockSize());\n        if (this.parent.groupSettings.columns.length) {\n            var editRowObject = this.getEditedRowObject();\n            if (editRowObject) {\n                editRowObject.data = args.data;\n            }\n        }\n        else {\n            this.vgenerator.cache[parseInt(block.toString(), 10)][parseInt(index.toString(), 10)].data = args.data;\n        }\n    };\n    VirtualContentRenderer.prototype.actionComplete = function (args) {\n        if (!(this.parent.enableVirtualization || this.parent.enableColumnVirtualization)) {\n            return;\n        }\n        var editRequestTypes = ['delete', 'save', 'cancel'];\n        var dataActionRequestTypes = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];\n        if (editRequestTypes.some(function (value) { return value === args.requestType; })) {\n            this.refreshOffsets();\n            this.refreshVirtualElement();\n        }\n        if (this.isNormaledit && (dataActionRequestTypes.some(function (value) { return value === args.requestType; })\n            || editRequestTypes.some(function (value) { return value === args.requestType; }))) {\n            this.isCancel = true;\n            this.isAdd = false || this.parent.editSettings.showAddNewRow;\n            this.editedRowIndex = this.empty;\n            this.virtualData = {};\n            this.virtualInfiniteData = {};\n            if (this.parent.editModule) {\n                this.parent.editModule.editModule.previousData = undefined;\n            }\n        }\n        if (this.parent.enableColumnVirtualization && args.requestType === 'filterAfterOpen'\n            && this.currentInfo.columnIndexes && this.currentInfo.columnIndexes[0] > 0) {\n            this.parent.resetFilterDlgPosition(args.columnName);\n        }\n    };\n    VirtualContentRenderer.prototype.resetIsedit = function () {\n        if (this.parent.enableVirtualization && this.isNormaledit) {\n            if ((this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length)\n                || (this.parent.editSettings.allowAdding && this.isAdd)) {\n                this.parent.isEdit = true;\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.scrollAfterEdit = function () {\n        if (this.parent.editModule && this.parent.editSettings.allowEditing && this.isNormaledit) {\n            if (this.parent.element.querySelector('.e-gridform')) {\n                var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n                var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n                if (editForm || addForm) {\n                    var rowData = editForm ? extend({}, this.getRowObjectByIndex(this.editedRowIndex))\n                        : extend({}, this.emptyRowData);\n                    var keys = Object.keys(this.virtualData);\n                    this.virtualData = keys.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(rowData);\n                }\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.createEmptyRowdata = function () {\n        var _this = this;\n        this.parent.columnModel.filter(function (e) {\n            _this.emptyRowData[e.field] = _this.empty;\n        });\n    };\n    VirtualContentRenderer.prototype.addActionBegin = function (args) {\n        if (this.isNormaledit) {\n            if (!Object.keys(this.emptyRowData).length) {\n                this.createEmptyRowdata();\n            }\n            this.isAdd = true;\n            var page = this.parent.pageSettings.currentPage;\n            if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {\n                this.isAdd = true;\n                this.onActionBegin();\n                args.startEdit = false;\n                this.content.scrollTop = 0;\n            }\n            if (page < this.maxPage - 1 && this.parent.editSettings.newRowPosition === 'Bottom') {\n                this.isAdd = true;\n                this.parent.setProperties({ pageSettings: { currentPage: this.maxPage - 1 } }, true);\n                args.startEdit = false;\n                this.content.scrollTop = this.offsets[this.offsetKeys.length];\n            }\n        }\n    };\n    /**\n     * @param {number} index - specifies the index\n     * @returns {Object} returns the object\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getRowObjectByIndex = function (index) {\n        var data = this.getRowCollection(index, true);\n        return data;\n    };\n    VirtualContentRenderer.prototype.getBlockSize = function () {\n        return this.parent.pageSettings.pageSize >> 1;\n    };\n    VirtualContentRenderer.prototype.getBlockHeight = function () {\n        return this.getBlockSize() * this.parent.getRowHeight();\n    };\n    VirtualContentRenderer.prototype.isEndBlock = function (index) {\n        var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        return index >= totalBlocks || index === totalBlocks - 1;\n    };\n    VirtualContentRenderer.prototype.isOddPageSize = function () {\n        return this.parent.pageSettings.pageSize % 2 !== 0;\n    };\n    VirtualContentRenderer.prototype.getOddBlockSize = function () {\n        return this.isOddPageSize() ? this.parent.pageSettings.pageSize / 2 : this.getBlockSize();\n    };\n    VirtualContentRenderer.prototype.getGroupedTotalBlocks = function () {\n        var rows = this.parent.vcRows;\n        return Math.floor((rows.length / this.getOddBlockSize()) < 1 ? 1 : rows.length / this.getOddBlockSize());\n    };\n    VirtualContentRenderer.prototype.getTotalBlocks = function () {\n        return Math.ceil(this.count / this.getOddBlockSize());\n    };\n    VirtualContentRenderer.prototype.getColumnOffset = function (block) {\n        return this.vgenerator.cOffsets[parseInt(block.toString(), 10)] | 0;\n    };\n    VirtualContentRenderer.prototype.getModelGenerator = function () {\n        return new VirtualRowModelGenerator(this.parent);\n    };\n    VirtualContentRenderer.prototype.resetScrollPosition = function (action) {\n        if (this.actions.some(function (value) { return value === action; })) {\n            this.preventEvent = this.content.scrollTop !== 0;\n            this.content.scrollTop = 0;\n        }\n        if (action !== 'virtualscroll') {\n            this.isAdd = false;\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.onActionBegin = function (e) {\n        //Update property silently..\n        this.parent.setProperties({ pageSettings: { currentPage: 1 } }, true);\n    };\n    VirtualContentRenderer.prototype.getRows = function () {\n        return this.isInfiniteColumnvirtualization() ? this.getInfiniteRows() : this.vgenerator.getRows();\n    };\n    VirtualContentRenderer.prototype.getRowByIndex = function (index) {\n        var row;\n        if (isGroupAdaptive(this.parent)) {\n            if (!isNullOrUndefined(index) && this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n                for (var i = 0; i < this.parent.getDataRows().length; i++) {\n                    if (parseInt(this.parent.getDataRows()[parseInt(i.toString(), 10)].getAttribute(literals.ariaRowIndex), 10) - 1 ===\n                        index) {\n                        row = this.parent.getDataRows()[parseInt(i.toString(), 10)];\n                    }\n                }\n            }\n            else {\n                row = !isNullOrUndefined(index) ? this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n            }\n        }\n        else if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n            row = !isNullOrUndefined(index) ? this.enableCacheOnInfiniteColumnVirtual() ? this.parent.getDataRows()\n                .find(function (element) { return parseInt(element.getAttribute(literals.ariaRowIndex), 10) - 1 === index; }) :\n                this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n        }\n        else if (this.prevInfo) {\n            row = this.getRowCollection(index, false);\n        }\n        return row;\n    };\n    VirtualContentRenderer.prototype.getMovableVirtualRowByIndex = function (index) {\n        return this.getRowCollection(index, false);\n    };\n    VirtualContentRenderer.prototype.getFrozenRightVirtualRowByIndex = function (index) {\n        return this.getRowCollection(index, false);\n    };\n    VirtualContentRenderer.prototype.getRowCollection = function (index, isRowObject) {\n        var prev = this.prevInfo.blockIndexes;\n        var startIdx = (prev[0] - 1) * this.getBlockSize();\n        if (this.parent.pageSettings.pageSize % 2 !== 0) {\n            startIdx += Math.floor((startIdx / this.getBlockSize()) / 2);\n        }\n        var rowCollection = this.parent.getDataRows();\n        var collection = isRowObject ? this.parent.getCurrentViewRecords() : rowCollection;\n        if (isRowObject && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n            startIdx = parseInt(this.parent.getRows()[0].getAttribute(literals.ariaRowIndex), 10) - 1;\n            collection = collection.filter(function (m) { return isNullOrUndefined(m.items); });\n        }\n        if (!isRowObject && this.parent.allowGrouping && this.parent.groupSettings.columns.length && rowCollection.length) {\n            startIdx = parseInt(rowCollection[0].getAttribute(literals.ariaRowIndex), 10) - 1;\n        }\n        var selectedRow = collection[index - startIdx];\n        if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n            if (!isRowObject) {\n                selectedRow = index <= this.parent.frozenRows ? rowCollection[parseInt(index.toString(), 10)]\n                    : rowCollection[(index - startIdx) + this.parent.frozenRows];\n            }\n            else {\n                selectedRow = index <= this.parent.frozenRows ? this.parent.getRowsObject()[parseInt(index.toString(), 10)].data\n                    : selectedRow;\n            }\n        }\n        return selectedRow;\n    };\n    VirtualContentRenderer.prototype.getVirtualRowIndex = function (index) {\n        var prev = this.prevInfo.blockIndexes;\n        var startIdx = (prev[0] - 1) * this.getBlockSize();\n        if (this.parent.enableVirtualization && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n            var vGroupedRows = this.vgenerator.cache[prev[0]];\n            for (var i = 0; i < vGroupedRows.length; i++) {\n                if (vGroupedRows[\"\" + i].isDataRow) {\n                    startIdx = vGroupedRows[\"\" + i].index;\n                    break;\n                }\n            }\n        }\n        return startIdx + index;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    VirtualContentRenderer.prototype.refreshOffsets = function () {\n        var gObj = this.parent;\n        var row = 0;\n        var blockSize = this.getBlockSize();\n        var oddBlockSize = this.getOddBlockSize();\n        var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        this.prevHeight = this.offsets[parseInt(total.toString(), 10)];\n        this.maxBlock = total % 2 === 0 ? total - 2 : total - 1;\n        this.offsets = {};\n        //Row offset update\n        // eslint-disable-next-line prefer-spread\n        var blocks = Array.apply(null, Array(total)).map(function () { return ++row; });\n        for (var i = 0; i < blocks.length; i++) {\n            var tmp = (this.vgenerator.cache[blocks[parseInt(i.toString(), 10)]] || []).length;\n            var rem = !isGroupAdaptive(this.parent) ? this.isOddPageSize() ?\n                Math.ceil(this.count % oddBlockSize) : this.count % blockSize : this.isOddPageSize() ?\n                Math.ceil(gObj.vcRows.length % oddBlockSize) : (gObj.vcRows.length % blockSize);\n            var size = !isGroupAdaptive(this.parent) && blocks[parseInt(i.toString(), 10)] in this.vgenerator.cache ?\n                tmp * this.parent.getRowHeight() : rem && blocks[parseInt(i.toString(), 10)] === total ? rem * this.parent.getRowHeight() :\n                this.getBlockHeight();\n            if (this.isOddPageSize() && !(blocks[parseInt(i.toString(), 10)] in this.vgenerator.cache)\n                && !(rem && blocks[parseInt(i.toString(), 10)] === total)) {\n                size = (blocks[parseInt(i.toString(), 10)] % 2 !== 0 ? Math.floor(oddBlockSize)\n                    : Math.ceil(oddBlockSize)) * this.parent.getRowHeight();\n            }\n            // let size: number = this.parent.groupSettings.columns.length && block in this.vgenerator.cache ?\n            // tmp * getRowHeight() : this.getBlockHeight();\n            this.offsets[blocks[parseInt(i.toString(), 10)]] = (this.offsets[blocks[parseInt(i.toString(), 10)] - 1] | 0) + size;\n            this.tmpOffsets[blocks[parseInt(i.toString(), 10)]] = this.offsets[blocks[parseInt(i.toString(), 10)] - 1] | 0;\n        }\n        this.offsetKeys = Object.keys(this.offsets);\n        if (isGroupAdaptive(this.parent)) {\n            this.parent.vGroupOffsets = this.offsets;\n        }\n        //Column offset update\n        if (this.parent.enableColumnVirtualization) {\n            this.vgenerator.refreshColOffsets();\n        }\n    };\n    VirtualContentRenderer.prototype.refreshVirtualElement = function () {\n        this.vgenerator.refreshColOffsets();\n        this.setVirtualHeight();\n    };\n    VirtualContentRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var rows = [];\n        rows = this.getRows();\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var isRefresh = true;\n        if (!gObj.groupSettings.columns.length && testRow) {\n            isRefresh = false;\n        }\n        var tr = gObj.getDataRows();\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[parseInt(c.toString(), 10)];\n            var idx = gObj.getNormalizedColumnIndex(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            var colGrp = this.getColGroup().children;\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                setStyleAttribute(colGrp[parseInt(idx.toString(), 10)], { 'display': displayVal });\n            }\n            if (!isRefresh) {\n                var width = void 0;\n                if (column.width) {\n                    if (column.visible) {\n                        width = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n                    }\n                    else {\n                        width = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n                    }\n                }\n                if (width > gObj.width) {\n                    this.setDisplayNone(tr, idx, displayVal, rows);\n                    if (this.parent.enableColumnVirtualization) {\n                        this.virtualEle.setWrapperWidth(width + '');\n                    }\n                    this.refreshVirtualElement();\n                }\n                else {\n                    isRefresh = true;\n                }\n            }\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n        if (isRefresh) {\n            this.refreshContentRows({ requestType: 'refresh' });\n        }\n        else {\n            this.parent.notify(events.partialRefresh, { rows: rows, args: { isFrozen: false, rows: rows } });\n        }\n    };\n    VirtualContentRenderer.prototype.selectVirtualRow = function (args) {\n        var _this = this;\n        var count = isGroupAdaptive(this.parent) ? this.vgenerator.recordsCount : this.count;\n        args.isAvailable = args.selectedIndex < count;\n        if (args.isAvailable && !this.isContextMenuOpen && this.activeKey !== 'upArrow'\n            && this.activeKey !== 'downArrow' && !this.isSelection && !this.requestTypes.some(function (value) { return value === _this.requestType; })\n            && !this.parent.selectionModule.isInteracted) {\n            var selectedRow = this.parent.getRowByIndex(args.selectedIndex);\n            var rowHeight = this.parent.getRowHeight();\n            if (!selectedRow || !this.isRowInView(selectedRow)) {\n                this.isSelection = true;\n                this.selectedRowIndex = args.selectedIndex;\n                var scrollTop = args.selectedIndex * rowHeight;\n                if (isGroupAdaptive(this.parent)) {\n                    var selectedRowObjectIndex = this.parent.vcRows\n                        .findIndex(function (row) { return row.index === args.selectedIndex; });\n                    scrollTop = selectedRowObjectIndex !== -1 ? selectedRowObjectIndex * rowHeight : undefined;\n                    this.isSelection = selectedRowObjectIndex !== -1 ? this.isSelection : false;\n                }\n                else if (this.parent.groupSettings.columns.length && this.parent.getDataModule().isRemote()) {\n                    var page = Math.ceil((args.selectedIndex + 1) / this.parent.pageSettings.pageSize);\n                    var blockIndexes = this.vgenerator.getBlockIndexes(page);\n                    scrollTop = this.offsets[blockIndexes[0]];\n                }\n                if (!isNullOrUndefined(scrollTop)) {\n                    var direction = this.content.scrollTop < scrollTop ? 'down' : 'up';\n                    this.selectRowIndex = args.selectedIndex;\n                    this.content.scrollTop = scrollTop;\n                    this.isSelectionScroll = this.observer.check(direction);\n                }\n            }\n        }\n        this.requestType = this.empty;\n    };\n    VirtualContentRenderer.prototype.isRowInView = function (row) {\n        var top = row.getBoundingClientRect().top;\n        var bottom = row.getBoundingClientRect().bottom;\n        return (top >= this.content.getBoundingClientRect().top && bottom <= this.content.getBoundingClientRect().bottom);\n    };\n    return VirtualContentRenderer;\n}(ContentRender));\nexport { VirtualContentRenderer };\n/**\n * @hidden\n */\nvar VirtualHeaderRenderer = /** @class */ (function (_super) {\n    __extends(VirtualHeaderRenderer, _super);\n    function VirtualHeaderRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.virtualEle = new VirtualElementHandler();\n        _this.isMovable = false;\n        _this.gen = new VirtualRowModelGenerator(_this.parent);\n        _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n        _this.parent.on(refreshVirtualBlock, function (e) { return e.virtualInfo.sentinelInfo.axis === 'X' ? _this.refreshUI() : null; }, _this);\n        return _this;\n    }\n    VirtualHeaderRenderer.prototype.renderTable = function () {\n        this.gen.refreshColOffsets();\n        this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n        _super.prototype.renderTable.call(this);\n        this.virtualEle.table = this.getTable();\n        this.virtualEle.content = this.getPanel().querySelector('.' + literals.headerContent);\n        this.virtualEle.content.style.position = 'relative';\n        this.virtualEle.renderWrapper();\n        // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n        (!(this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.parent.enableColumnVirtualization) ?\n            this.virtualEle.renderPlaceHolder() : this.virtualEle.renderPlaceHolder('absolute');\n    };\n    VirtualHeaderRenderer.prototype.appendContent = function (table) {\n        this.virtualEle.wrapper.appendChild(table);\n    };\n    VirtualHeaderRenderer.prototype.refreshUI = function () {\n        this.gen.refreshColOffsets();\n        this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n        _super.prototype.refreshUI.call(this);\n    };\n    VirtualHeaderRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var displayVal;\n        var idx;\n        var needFullRefresh;\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[parseInt(c.toString(), 10)];\n            idx = gObj.getNormalizedColumnIndex(column.uid);\n            displayVal = column.visible ? '' : 'none';\n            var colGrp = this.getColGroup().children;\n            if (gObj.getColumnByField(column.field)) {\n                setStyleAttribute(colGrp[parseInt(idx.toString(), 10)], { 'display': displayVal });\n            }\n            if (gObj.enableColumnVirtualization && !gObj.groupSettings.columns.length) {\n                var tablewidth = void 0;\n                if (column.visible) {\n                    tablewidth = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n                }\n                else {\n                    tablewidth = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n                }\n                if (tablewidth > gObj.width) {\n                    this.setDisplayNone(column, displayVal);\n                    this.virtualEle.setWrapperWidth(tablewidth + '');\n                    this.gen.refreshColOffsets();\n                }\n                else {\n                    needFullRefresh = true;\n                }\n            }\n            else {\n                needFullRefresh = true;\n            }\n            if (needFullRefresh) {\n                this.refreshUI();\n            }\n        }\n    };\n    VirtualHeaderRenderer.prototype.setDisplayNone = function (col, displayVal) {\n        var table = this.getTable();\n        for (var _i = 0, _a = [].slice.apply(table.querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n            var ele = _a[_i];\n            if (ele.querySelector('[e-mappinguid]') &&\n                ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === col.uid) {\n                setStyleAttribute(ele, { 'display': displayVal });\n                if (displayVal === '') {\n                    removeClass([ele], 'e-hide');\n                }\n                break;\n            }\n        }\n    };\n    return VirtualHeaderRenderer;\n}(HeaderRender));\nexport { VirtualHeaderRenderer };\n/**\n * @hidden\n */\nvar VirtualElementHandler = /** @class */ (function () {\n    function VirtualElementHandler() {\n    }\n    VirtualElementHandler.prototype.renderWrapper = function (height) {\n        this.wrapper = createElement('div', { className: 'e-virtualtable' });\n        this.wrapper.style.minHeight = formatUnit(height);\n        this.wrapper.appendChild(this.table);\n        this.content.appendChild(this.wrapper);\n    };\n    VirtualElementHandler.prototype.renderPlaceHolder = function (position) {\n        if (position === void 0) { position = 'relative'; }\n        this.placeholder = createElement('div', { className: 'e-virtualtrack' });\n        this.placeholder.style.position = position;\n        this.content.appendChild(this.placeholder);\n    };\n    VirtualElementHandler.prototype.renderFrozenWrapper = function (height) {\n        this.wrapper = createElement('div', { className: 'e-virtualtable' });\n        this.wrapper.style.cssText = \"min-height:\" + formatUnit(height) + \"; display: flex;\";\n        this.content.appendChild(this.wrapper);\n    };\n    VirtualElementHandler.prototype.renderFrozenPlaceHolder = function () {\n        this.placeholder = createElement('div', { className: 'e-virtualtrack' });\n        this.content.appendChild(this.placeholder);\n    };\n    VirtualElementHandler.prototype.adjustTable = function (xValue, yValue) {\n        this.wrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n    };\n    VirtualElementHandler.prototype.setWrapperWidth = function (width, full) {\n        if (width && width.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(width, 10))) {\n            width = undefined;\n            full = true;\n        }\n        this.wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    VirtualElementHandler.prototype.setVirtualHeight = function (height, width) {\n        this.placeholder.style.height = !isNullOrUndefined(height) ? height + \"px\" : '0px';\n        if (width && width.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(width, 10))) {\n            width = '100%';\n        }\n        this.placeholder.style.width = width;\n    };\n    VirtualElementHandler.prototype.setFreezeWrapperWidth = function (wrapper, width, full) {\n        wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    return VirtualElementHandler;\n}());\nexport { VirtualElementHandler };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}