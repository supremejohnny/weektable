{"ast":null,"code":"import { closest, addClass, select, updateCSSText } from '@syncfusion/ej2-base';\nimport { extend, getValue } from '@syncfusion/ej2-base';\nimport { remove } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { EditRender } from '../renderer/edit-renderer';\nimport { BooleanEditCell } from '../renderer/boolean-edit-cell';\nimport { DropDownEditCell } from '../renderer/dropdown-edit-cell';\nimport { NumericEditCell } from '../renderer/numeric-edit-cell';\nimport { DefaultEditCell } from '../renderer/default-edit-cell';\nimport { InlineEdit } from './inline-edit';\nimport { BatchEdit } from './batch-edit';\nimport { DialogEdit } from './dialog-edit';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport { parentsUntil, getComplexFieldID, getParsedFieldID, setComplexFieldID, getScrollBarWidth, setValidationRuels } from '../base/util';\nimport { FormValidator } from '@syncfusion/ej2-inputs';\nimport { DatePickerEditCell } from '../renderer/datepicker-edit-cell';\nimport { calculateRelativeBasedPosition } from '@syncfusion/ej2-popups';\nimport { TemplateEditCell } from '../renderer/template-edit-cell';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport { addRemoveEventListener, padZero, getParentIns } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * The `Edit` module is used to handle editing actions.\n */\nvar Edit = /** @class */function () {\n  /**\n   * Constructor for the Grid editing module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {ServiceLocator} serviceLocator - specifies the servicelocator\n   * @hidden\n   */\n  function Edit(parent, serviceLocator) {\n    /** @hidden */\n    this.isShowAddedRowValidate = false;\n    this.editType = {\n      'Inline': InlineEdit,\n      'Normal': InlineEdit,\n      'Batch': BatchEdit,\n      'Dialog': DialogEdit\n    };\n    this.fieldname = '';\n    this.data = {};\n    /* @hidden */\n    this.editCellDialogClose = false;\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.l10n = this.serviceLocator.getService('localization');\n    this.addEventListener();\n    this.updateEditObj();\n    this.createAlertDlg();\n    this.createConfirmDlg();\n  }\n  Edit.prototype.updateColTypeObj = function () {\n    var cols = this.parent.columnModel;\n    for (var i = 0; i < cols.length; i++) {\n      if (this.parent.editSettings.template || cols[parseInt(i.toString(), 10)].editTemplate) {\n        var templteCell = 'templateedit';\n        cols[parseInt(i.toString(), 10)].edit = extend(new Edit.editCellType[\"\" + templteCell](this.parent), cols[parseInt(i.toString(), 10)].edit || {});\n      } else {\n        cols[parseInt(i.toString(), 10)].edit = extend(new Edit.editCellType[cols[parseInt(i.toString(), 10)].editType && Edit.editCellType[cols[parseInt(i.toString(), 10)].editType] ? cols[parseInt(i.toString(), 10)].editType : 'defaultedit'](this.parent, this.serviceLocator), cols[parseInt(i.toString(), 10)].edit || {});\n      }\n    }\n    this.parent.log('primary_column_missing');\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} returns the module name\n   * @private\n   */\n  Edit.prototype.getModuleName = function () {\n    return 'edit';\n  };\n  /**\n   * @param {NotifyArgs} e - specifies the notifyargs\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n    var gObj = this.parent;\n    for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n      var prop = _a[_i];\n      switch (prop) {\n        case 'allowAdding':\n        case 'allowDeleting':\n        case 'allowEditing':\n          if (gObj.editSettings.allowAdding || gObj.editSettings.allowEditing || gObj.editSettings.allowDeleting) {\n            this.initialEnd();\n          }\n          break;\n        case 'mode':\n          this.updateEditObj();\n          gObj.isEdit = gObj.editSettings.showAddNewRow ? true : false;\n          gObj.refresh();\n          break;\n      }\n    }\n  };\n  Edit.prototype.updateEditObj = function () {\n    if (this.editModule) {\n      this.editModule.destroy();\n    }\n    this.renderer = new EditRender(this.parent, this.serviceLocator);\n    this.editModule = new this.editType[this.parent.editSettings.mode](this.parent, this.serviceLocator, this.renderer);\n  };\n  Edit.prototype.initialEnd = function () {\n    this.updateColTypeObj();\n  };\n  /**\n   * Edits any bound record in the Grid by TR element.\n   *\n   * @param {HTMLTableRowElement} tr - Defines the table row to be edited.\n   * @returns {void}\n   */\n  Edit.prototype.startEdit = function (tr) {\n    var gObj = this.parent;\n    if (!gObj.editSettings.allowEditing || gObj.isEdit && (!gObj.editSettings.showAddNewRow || gObj.editSettings.showAddNewRow && !isNullOrUndefined(gObj.element.querySelector('.' + literals.editedRow))) || gObj.editSettings.mode === 'Batch') {\n      return;\n    }\n    this.parent.element.classList.add('e-editing');\n    if (!gObj.getSelectedRows().length || isNullOrUndefined(this.parent.getRowByIndex(parseInt(this.parent.getSelectedRows()[0].getAttribute('aria-rowindex'), 10) - 1))) {\n      if (!tr) {\n        this.showDialog('EditOperationAlert', this.alertDObj);\n        return;\n      }\n    } else if (!tr) {\n      tr = gObj.getSelectedRows()[0];\n    }\n    if (this.parent.enableVirtualization && this.parent.editSettings.mode === 'Normal') {\n      var idx = parseInt(tr.getAttribute('aria-rowindex'), 10) - 1;\n      tr = this.parent.getRowByIndex(idx);\n    }\n    var lastTr = gObj.getContent().querySelector('tr:last-child');\n    var hdrTbody = gObj.getHeaderContent().querySelector('tbody');\n    if (gObj.frozenRows && isNullOrUndefined(lastTr) && hdrTbody && hdrTbody.querySelector('tr:last-child')) {\n      this.isLastRow = tr.rowIndex === parseInt(gObj.getHeaderContent().querySelector('tbody').querySelector('tr:last-child').getAttribute('aria-rowindex'), 10) - 1;\n    } else if (lastTr) {\n      this.isLastRow = tr.rowIndex === lastTr.rowIndex;\n    }\n    if (tr.style.display === 'none') {\n      return;\n    }\n    this.editModule.startEdit(tr);\n    this.refreshToolbar();\n    gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n    this.parent.notify('start-edit', {});\n    if (gObj.editSettings.showAddNewRow) {\n      this.destroyToolTip();\n    }\n  };\n  /**\n   * @param {Element} tr - specifies the tr element\n   * @param {object} args - specifies the object\n   * @param {Element} args.row -specfifes the row\n   * @param {string} args.requestType - specifies the request type\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.checkLastRow = function (tr, args) {\n    var checkLastRow = this.isLastRow;\n    if (this.parent.height !== 'auto' && this.parent.editSettings.newRowPosition === 'Bottom' && args && args.requestType === 'add' && this.parent.getContent().firstElementChild.offsetHeight > this.parent.getContentTable().scrollHeight) {\n      addClass([].slice.call(tr.getElementsByClassName(literals.rowCell)), 'e-lastrowadded');\n    } else if (checkLastRow && tr && tr.classList) {\n      addClass([].slice.call(tr.getElementsByClassName(literals.rowCell)), 'e-lastrowcell');\n    }\n  };\n  /**\n   * Cancels edited state.\n   *\n   * @returns {void}\n   */\n  Edit.prototype.closeEdit = function () {\n    if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.showConfirmDialog && this.parent.element.getElementsByClassName('e-updatedtd').length) {\n      this.showDialog('CancelEdit', this.dialogObj);\n      return;\n    }\n    this.parent.element.classList.remove('e-editing');\n    this.editModule.closeEdit();\n    this.refreshToolbar();\n    this.parent.notify(events.closeEdit, {\n      requestType: 'cancel'\n    });\n    if (this.parent.editSettings.showAddNewRow) {\n      this.destroyToolTip();\n    }\n  };\n  Edit.prototype.refreshToolbar = function () {\n    this.parent.notify(events.toolbarRefresh, {});\n  };\n  /**\n   * To adds a new row at the top with the given data. When data is not passed, it will add empty rows.\n   * > `editSettings.allowEditing` should be true.\n   *\n   * @param {Object} data - Defines the new add record data.\n   * @param {number} index - Defines the row index to be added\n   * @returns {void}\n   */\n  Edit.prototype.addRecord = function (data, index) {\n    if (!this.parent.editSettings.allowAdding) {\n      return;\n    }\n    var args = {\n      startEdit: true\n    };\n    if (!data) {\n      this.parent.notify(events.virtualScrollAddActionBegin, args);\n    }\n    if (args.startEdit) {\n      this.parent.element.classList.add('e-editing');\n      this.editModule.addRecord(data, index);\n      this.refreshToolbar();\n      this.parent.notify('start-add', {});\n    }\n  };\n  /**\n   * Deletes a record with the given options. If fieldname and data are not given, the Grid will delete the selected record.\n   * > `editSettings.allowDeleting` should be true.\n   *\n   * @param {string} fieldname - Defines the primary key field name of the column.\n   * @param {Object} data - Defines the JSON data record to be deleted.\n   * @returns {void}\n   */\n  Edit.prototype.deleteRecord = function (fieldname, data) {\n    var gObj = this.parent;\n    if (!gObj.editSettings.allowDeleting) {\n      return;\n    }\n    if (!data) {\n      if (!gObj.getSelectedRecords().length && isNullOrUndefined(gObj.commandDelIndex)) {\n        this.showDialog('DeleteOperationAlert', this.alertDObj);\n        return;\n      }\n    }\n    if (gObj.editSettings.showDeleteConfirmDialog) {\n      this.fieldname = fieldname;\n      this.data = data;\n      this.showDialog('ConfirmDelete', this.dialogObj);\n      return;\n    }\n    this.editModule.deleteRecord(fieldname, data);\n  };\n  /**\n   * Deletes a visible row by TR element.\n   *\n   * @param {HTMLTableRowElement} tr - Defines the table row element.\n   * @returns {void}\n   */\n  Edit.prototype.deleteRow = function (tr) {\n    this.deleteRowUid = tr.getAttribute('data-uid');\n    var rowObj = this.parent.getRowObjectFromUID(this.deleteRowUid);\n    if (!isNullOrUndefined(rowObj)) {\n      this.deleteRecord(null, rowObj.data);\n    }\n  };\n  /**\n   * If Grid is in editable state, you can save a record by invoking endEdit.\n   *\n   * @returns {void}\n   */\n  Edit.prototype.endEdit = function () {\n    if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.showConfirmDialog && (isNullOrUndefined(this.formObj) || this.formObj.validate())) {\n      this.parent.editModule.saveCell();\n      this.parent.notify(events.editNextValCell, {});\n      if (isNullOrUndefined(this.formObj) || this.formObj.validate()) {\n        this.showDialog('BatchSaveConfirm', this.dialogObj);\n        return;\n      }\n    }\n    this.endEditing();\n  };\n  /**\n   * To update the specified cell by given value without changing into edited state.\n   *\n   * @param {number} rowIndex Defines the row index.\n   * @param {string} field Defines the column field.\n   * @param {string | number | boolean | Date} value - Defines the value to be changed.\n   * @returns {void}\n   */\n  Edit.prototype.updateCell = function (rowIndex, field, value) {\n    this.editModule.updateCell(rowIndex, field, value);\n  };\n  /**\n   * To update the specified row by given values without changing into edited state.\n   *\n   * @param {number} index Defines the row index.\n   * @param {Object} data Defines the data object to be updated.\n   * @returns {void}\n   */\n  Edit.prototype.updateRow = function (index, data) {\n    this.editModule.updateRow(index, data);\n  };\n  /**\n   * Resets added, edited, and deleted records in the batch mode.\n   *\n   * @returns {void}\n   */\n  Edit.prototype.batchCancel = function () {\n    this.closeEdit();\n  };\n  /**\n   * Bulk saves added, edited, and deleted records in the batch mode.\n   *\n   * @returns {void}\n   */\n  Edit.prototype.batchSave = function () {\n    this.endEdit();\n  };\n  /**\n   * Changes a particular cell into edited state based on the row index and field name provided in the `batch` mode.\n   *\n   * @param {number} index - Defines row index to edit a particular cell.\n   * @param {string} field - Defines the field name of the column to perform batch edit.\n   * @returns {void}\n   */\n  Edit.prototype.editCell = function (index, field) {\n    this.editModule.editCell(index, field);\n  };\n  /**\n   * Checks the status of validation at the time of editing. If validation is passed, it returns true.\n   *\n   * @returns {boolean} returns whether the form is validated\n   */\n  Edit.prototype.editFormValidate = function () {\n    return this.formObj ? this.formObj.validate() : true;\n  };\n  /**\n   * Gets the added, edited,and deleted data before bulk save to the DataSource in batch mode.\n   *\n   * @returns {Object} returns the Object\n   */\n  Edit.prototype.getBatchChanges = function () {\n    return this.editModule.getBatchChanges ? this.editModule.getBatchChanges() : {};\n  };\n  /**\n   * Gets the current value of the edited component.\n   *\n   * @returns {Object} returns the Object\n   */\n  Edit.prototype.getCurrentEditCellData = function () {\n    var obj = this.getCurrentEditedData(this.formObj.element, {});\n    return obj[Object.keys(obj)[0]];\n  };\n  /**\n   * Saves the cell that is currently edited. It does not save the value to the DataSource.\n   *\n   * @returns {void}\n   */\n  Edit.prototype.saveCell = function () {\n    this.editModule.saveCell();\n  };\n  Edit.prototype.endEditing = function () {\n    if (!this.parent.editSettings.showAddNewRow) {\n      this.parent.element.classList.remove('e-editing');\n    }\n    this.editModule.endEdit();\n    this.isShowAddedRowValidate = false;\n    this.refreshToolbar();\n  };\n  Edit.prototype.showDialog = function (content, obj) {\n    obj.content = '<div>' + this.l10n.getConstant(content) + '</div>';\n    obj.dataBind();\n    obj.show();\n    if (this.parent.enableRtl) {\n      obj.refresh();\n    }\n  };\n  Edit.prototype.getValueFromType = function (col, value) {\n    var val = value;\n    switch (col.type) {\n      case 'number':\n        val = !isNaN(parseFloat(value)) ? parseFloat(value) : null;\n        break;\n      case 'boolean':\n        if (col.editType !== 'booleanedit') {\n          val = value === this.l10n.getConstant('True') || value === true ? true : false;\n        }\n        break;\n      case 'date':\n      case 'datetime':\n        if (col.editType !== 'datepickeredit' && col.editType !== 'datetimepickeredit' && value && value.length) {\n          val = new Date(value);\n        } else if (value === '') {\n          val = null;\n        }\n        break;\n      case 'dateonly':\n        // eslint-disable-next-line no-cond-assign\n        val = value && (value = new Date(value)) ? value.getFullYear() + '-' + padZero(value.getMonth() + 1) + '-' + padZero(value.getDate()) : null;\n        break;\n    }\n    return val;\n  };\n  Edit.prototype.destroyToolTip = function () {\n    var elements = [].slice.call(this.parent.element.getElementsByClassName('e-griderror'));\n    for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n      var elem = elements_1[_i];\n      remove(elem);\n    }\n    this.parent.getContent().firstElementChild.style.position = 'relative';\n    if (this.parent.isFrozenGrid()) {\n      if (this.parent.element.querySelector('.e-gridheader')) {\n        this.parent.element.querySelector('.e-gridheader').style.position = '';\n      }\n      this.parent.element.querySelector('.e-gridcontent').style.position = '';\n    }\n  };\n  Edit.prototype.createConfirmDlg = function () {\n    this.dialogObj = this.dlgWidget([{\n      click: this.dlgOk.bind(this),\n      buttonModel: {\n        content: this.l10n.getConstant('OKButton'),\n        cssClass: this.parent.cssClass ? 'e-primary' + ' ' + this.parent.cssClass : 'e-primary',\n        isPrimary: true\n      }\n    }, {\n      click: this.dlgCancel.bind(this),\n      buttonModel: {\n        cssClass: this.parent.cssClass ? 'e-flat' + ' ' + this.parent.cssClass : 'e-flat',\n        content: this.l10n.getConstant('CancelButton')\n      }\n    }], 'EditConfirm');\n  };\n  Edit.prototype.createAlertDlg = function () {\n    this.alertDObj = this.dlgWidget([{\n      click: this.alertClick.bind(this),\n      buttonModel: {\n        content: this.l10n.getConstant('OKButton'),\n        cssClass: this.parent.cssClass ? 'e-flat' + ' ' + this.parent.cssClass : 'e-flat',\n        isPrimary: true\n      }\n    }], 'EditAlert');\n  };\n  Edit.prototype.alertClick = function () {\n    this.alertDObj.hide();\n  };\n  Edit.prototype.dlgWidget = function (btnOptions, name) {\n    var div = this.parent.createElement('div', {\n      id: this.parent.element.id + name\n    });\n    this.parent.element.appendChild(div);\n    var options = {\n      showCloseIcon: false,\n      isModal: true,\n      visible: false,\n      closeOnEscape: true,\n      target: this.parent.element,\n      width: '320px',\n      animationSettings: {\n        effect: 'None'\n      },\n      cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n    };\n    options.buttons = btnOptions;\n    var obj = new Dialog(options);\n    var isStringTemplate = 'isStringTemplate';\n    obj[\"\" + isStringTemplate] = true;\n    obj.appendTo(div);\n    return obj;\n  };\n  Edit.prototype.dlgCancel = function () {\n    if (this.parent.pagerModule) {\n      this.parent.pagerModule.isForceCancel = false;\n    }\n    this.parent.focusModule.clearIndicator();\n    this.dialogObj.hide();\n    this.parent.focusModule.restoreFocus({\n      requestType: 'cancel'\n    });\n    this.parent.notify('cancelcnfrmDlg', {});\n  };\n  Edit.prototype.dlgOk = function () {\n    switch (this.dialogObj.element.querySelector('.e-dlg-content').firstElementChild.innerText) {\n      case this.l10n.getConstant('ConfirmDelete'):\n        this.editModule.deleteRecord(this.fieldname, this.data);\n        if (this.parent.editSettings.showDeleteConfirmDialog && !this.parent.allowSelection) {\n          this.parent.commandDelIndex = undefined;\n        }\n        break;\n      case this.l10n.getConstant('CancelEdit'):\n        this.editModule.closeEdit();\n        break;\n      case this.l10n.getConstant('BatchSaveConfirm'):\n        this.endEditing();\n        break;\n      case this.l10n.getConstant('BatchSaveLostChanges'):\n        if (this.parent.editSettings.mode === 'Batch') {\n          this.editModule.addCancelWhilePaging();\n        }\n        if (this.parent.pagerModule) {\n          this.parent.pagerModule.isForceCancel = false;\n        }\n        this.executeAction();\n        break;\n    }\n    this.dlgCancel();\n  };\n  Edit.prototype.destroyEditComponents = function () {\n    if (this.parent.isEdit) {\n      this.destroyWidgets();\n      this.destroyForm();\n    }\n    this.destroy();\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.eventDetails = [{\n      event: events.inBoundModelChanged,\n      handler: this.onPropertyChanged\n    }, {\n      event: events.initialEnd,\n      handler: this.initialEnd\n    }, {\n      event: events.keyPressed,\n      handler: this.keyPressHandler\n    }, {\n      event: events.autoCol,\n      handler: this.updateColTypeObj\n    }, {\n      event: events.tooltipDestroy,\n      handler: this.destroyToolTip\n    }, {\n      event: events.preventBatch,\n      handler: this.preventBatch\n    }, {\n      event: events.destroyForm,\n      handler: this.destroyForm\n    }, {\n      event: events.destroy,\n      handler: this.destroyEditComponents\n    }];\n    addRemoveEventListener(this.parent, this.eventDetails, true, this);\n    this.actionBeginFunction = this.onActionBegin.bind(this);\n    this.actionCompleteFunction = this.actionComplete.bind(this);\n    this.parent.on(events.destroyEditForm, this.actionBeginFunction);\n    this.parent.addEventListener(events.actionComplete, this.actionCompleteFunction);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    addRemoveEventListener(this.parent, this.eventDetails, false);\n    this.parent.removeEventListener(events.actionComplete, this.actionCompleteFunction);\n    this.parent.off(events.destroyEditForm, this.actionBeginFunction);\n  };\n  Edit.prototype.actionComplete = function (e) {\n    var actions = ['add', 'beginEdit', 'save', 'delete', 'cancel', 'filterAfterOpen', 'filterchoicerequest'];\n    if (actions.indexOf(e.requestType) < 0) {\n      this.parent.isEdit = this.parent.editSettings.showAddNewRow ? true : false;\n    }\n    if (e.requestType === 'batchsave') {\n      this.parent.focusModule.restoreFocus({\n        requestType: 'save'\n      });\n    }\n    this.refreshToolbar();\n  };\n  /**\n   * @param {Element} form - specifies the element\n   * @param {Object} editedData - specifies the edited data\n   * @returns {Object} returns the object\n   * @hidden\n   */\n  Edit.prototype.getCurrentEditedData = function (form, editedData) {\n    var gObj = this.parent;\n    if (gObj.editSettings.template) {\n      var elements = [].slice.call(form.elements);\n      for (var k = 0; k < elements.length; k++) {\n        if ((elements[parseInt(k.toString(), 10)].hasAttribute('name') && elements[parseInt(k.toString(), 10)].className !== 'e-multi-hidden' || elements[parseInt(k.toString(), 10)].classList.contains('e-multiselect')) && !(elements[parseInt(k.toString(), 10)].type === 'hidden' && (parentsUntil(elements[parseInt(k.toString(), 10)], 'e-switch-wrapper') || parentsUntil(elements[parseInt(k.toString(), 10)], 'e-checkbox-wrapper')))) {\n          var field = elements[parseInt(k.toString(), 10)].hasAttribute('name') ? setComplexFieldID(elements[parseInt(k.toString(), 10)].getAttribute('name')) : setComplexFieldID(elements[parseInt(k.toString(), 10)].getAttribute('id'));\n          var column = gObj.getColumnByField(field) || {\n            field: field,\n            type: elements[parseInt(k.toString(), 10)].getAttribute('type')\n          };\n          var value = void 0;\n          if (column.type === 'checkbox' || column.type === 'boolean') {\n            value = elements[parseInt(k.toString(), 10)].checked;\n          } else if (elements[parseInt(k.toString(), 10)].value) {\n            value = elements[parseInt(k.toString(), 10)].value;\n            if (elements[parseInt(k.toString(), 10)].ej2_instances && elements[parseInt(k.toString(), 10)].ej2_instances.length && !isNullOrUndefined(elements[parseInt(k.toString(), 10)].ej2_instances[0].value)) {\n              elements[parseInt(k.toString(), 10)].blur();\n              value = elements[parseInt(k.toString(), 10)].ej2_instances[0].value;\n            }\n          } else if (elements[parseInt(k.toString(), 10)].ej2_instances) {\n            value = elements[parseInt(k.toString(), 10)].ej2_instances[0].value;\n          }\n          if (column.edit && typeof column.edit.read === 'string') {\n            value = getValue(column.edit.read, window)(elements[parseInt(k.toString(), 10)], value);\n          } else if (column.edit && column.edit.read) {\n            value = column.edit.read(elements[parseInt(k.toString(), 10)], value);\n          }\n          value = gObj.editModule.getValueFromType(column, value);\n          if (elements[parseInt(k.toString(), 10)].type === 'radio') {\n            if (elements[parseInt(k.toString(), 10)].checked) {\n              DataUtil.setValue(column.field, value, editedData);\n            }\n          } else {\n            if (typeof value === 'string') {\n              this.parent.sanitize(value);\n            }\n            DataUtil.setValue(column.field, value, editedData);\n          }\n        }\n      }\n      return editedData;\n    }\n    var col = gObj.columnModel.filter(function (col) {\n      return col.editTemplate;\n    });\n    for (var j = 0; j < col.length; j++) {\n      if (form[getComplexFieldID(col[parseInt(j.toString(), 10)].field)]) {\n        var inputElements = [].slice.call(form[getComplexFieldID(col[parseInt(j.toString(), 10)].field)]).filter(function (element) {\n          return element.tagName.toLowerCase() === 'input';\n        });\n        inputElements = inputElements.length ? inputElements : [form[getComplexFieldID(col[parseInt(j.toString(), 10)].field)]];\n        var temp = inputElements.filter(function (e) {\n          return !isNullOrUndefined(e.ej2_instances);\n        });\n        if (temp.length === 0) {\n          temp = inputElements.filter(function (e) {\n            return e.hasAttribute('name');\n          });\n        }\n        for (var k = 0; k < temp.length; k++) {\n          var value = this.getValue(col[parseInt(j.toString(), 10)], temp[parseInt(k.toString(), 10)], editedData);\n          if (col[parseInt(j.toString(), 10)].type === 'string') {\n            value = this.parent.sanitize(value);\n          }\n          DataUtil.setValue(col[parseInt(j.toString(), 10)].field, value, editedData);\n        }\n      }\n    }\n    var inputs = [].slice.call(form.getElementsByClassName('e-field'));\n    for (var i = 0, len = inputs.length; i < len; i++) {\n      var col_1 = gObj.getColumnByUid(inputs[parseInt(i.toString(), 10)].getAttribute('e-mappinguid'));\n      if (col_1 && col_1.field) {\n        var value = this.getValue(col_1, inputs[parseInt(i.toString(), 10)], editedData);\n        if (col_1.type === 'string' && !(col_1.isForeignColumn() && typeof value !== 'string')) {\n          value = this.parent.sanitize(value);\n        }\n        DataUtil.setValue(col_1.field, value, editedData);\n      }\n    }\n    return editedData;\n  };\n  Edit.prototype.getValue = function (col, input, editedData) {\n    var value = input.ej2_instances ? input.ej2_instances[0].value : input.value;\n    var gObj = this.parent;\n    var temp = col.edit.read;\n    if (col.type === 'checkbox' || col.type === 'boolean') {\n      value = input.checked;\n    }\n    if (typeof temp === 'string') {\n      temp = getValue(temp, window);\n      value = gObj.editModule.getValueFromType(col, temp(input, value));\n    } else {\n      value = gObj.editModule.getValueFromType(col, col.edit.read(input, value));\n    }\n    if (isNullOrUndefined(editedData[col.field]) && value === '') {\n      value = editedData[col.field];\n    }\n    return value;\n  };\n  /**\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.onActionBegin = function (e) {\n    if ((e.requestType === 'columnstate' || this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache && e.requestType === 'sorting') && this.parent.isEdit && this.parent.editSettings.mode !== 'Batch') {\n      this.closeEdit();\n    } else {\n      var editRow = this.parent.element.querySelector('.' + literals.editedRow);\n      var addRow = this.parent.element.querySelector('.' + literals.addedRow);\n      if (editRow && this.parent.frozenRows && e.requestType === 'virtualscroll' && parseInt(parentsUntil(editRow, literals.row).getAttribute(literals.ariaRowIndex), 10) - 1 < this.parent.frozenRows) {\n        return;\n      }\n      var restrictedRequestTypes = ['filterAfterOpen', 'filterBeforeOpen', 'filterchoicerequest', 'filterSearchBegin', 'save', 'infiniteScroll', 'virtualscroll'];\n      var isRestrict = restrictedRequestTypes.indexOf(e.requestType) === -1;\n      var isAddRows = !this.parent.editSettings.showAddNewRow || this.parent.editSettings.showAddNewRow && !isNullOrUndefined(this.parent.element.querySelector('.e-editedrow'));\n      var isDestroyVirtualForm = (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.formObj && isAddRows && !this.formObj.isDestroyed && (editRow || addRow || e.requestType === 'cancel') && isRestrict;\n      if (!this.parent.enableVirtualization && isAddRows && this.parent.editSettings.mode !== 'Batch' && this.formObj && !this.formObj.isDestroyed && isRestrict && !e.cancel || isDestroyVirtualForm) {\n        this.destroyWidgets();\n        this.destroyForm();\n      }\n    }\n  };\n  /**\n   * @param {Column[]} cols - specfies the column\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.destroyWidgets = function (cols) {\n    var gObj = this.parent;\n    gObj.isWidgetsDestroyed = true;\n    if (gObj.editSettings.template) {\n      var parentIns = getParentIns(this.parent);\n      parentIns = parentIns.isReact ? parentIns : this.parent;\n      parentIns.destroyTemplate(['editSettingsTemplate']);\n      if (this.parent.isReact) {\n        this.parent.renderTemplates();\n      }\n    }\n    if (this.parent.editSettings.mode === 'Dialog' && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n      cols = [];\n      var allColumns = this.parent.getColumns();\n      for (var i = 0; i < allColumns.length; i++) {\n        var column = allColumns[parseInt(i.toString(), 10)];\n        if (column.visible || this.parent.groupSettings.columns.indexOf(column.field) > -1) {\n          cols.push(column);\n        }\n      }\n    } else {\n      cols = cols ? cols : this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization);\n    }\n    if (cols.some(function (column) {\n      return !isNullOrUndefined(column.editTemplate);\n    })) {\n      this.parent.destroyTemplate(['editTemplate']);\n      if (this.parent.isReact) {\n        this.parent.renderTemplates();\n      }\n    }\n    for (var _i = 0, cols_1 = cols; _i < cols_1.length; _i++) {\n      var col = cols_1[_i];\n      var temp = col.edit.destroy;\n      if (col.edit.destroy) {\n        if (typeof temp === 'string') {\n          temp = getValue(temp, window);\n          temp();\n        } else {\n          col.edit.destroy();\n        }\n      }\n    }\n    var elements = [].slice.call(this.formObj.element.elements);\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[parseInt(i.toString(), 10)];\n      if (element.hasAttribute('name')) {\n        var instanceElement = isNullOrUndefined(element.parentElement) ? null : element.parentElement.classList.contains('e-ddl') ? element.parentElement.querySelector('input') : element;\n        if (instanceElement && instanceElement.ej2_instances && instanceElement.ej2_instances.length && !instanceElement.ej2_instances[0].isDestroyed) {\n          instanceElement.ej2_instances[0].destroy();\n          instanceElement.remove();\n        }\n      }\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.destroyForm = function () {\n    this.destroyToolTip();\n    var formObjects = [this.formObj, this.virtualFormObj];\n    var col = this.parent.columnModel.filter(function (col) {\n      return col.editTemplate;\n    });\n    for (var i = 0; i < formObjects.length; i++) {\n      if (formObjects[parseInt(i.toString(), 10)] && formObjects[parseInt(i.toString(), 10)].element && !formObjects[parseInt(i.toString(), 10)].isDestroyed) {\n        formObjects[parseInt(i.toString(), 10)].destroy();\n        var parentIns = getParentIns(this.parent);\n        if (parentIns.isReact && this.parent.editSettings.mode === 'Dialog' && (!isNullOrUndefined(this.parent.editSettings.template) || col.length)) {\n          formObjects[parseInt(i.toString(), 10)].element.remove();\n        }\n      }\n    }\n    this.destroyToolTip();\n  };\n  /**\n   * To destroy the editing.\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n    if (!gridElement) {\n      return;\n    }\n    var hasGridChild = gridElement.querySelector('.' + literals.gridHeader) && gridElement.querySelector('.' + literals.gridContent) ? true : false;\n    if (hasGridChild) {\n      this.destroyForm();\n    }\n    this.removeEventListener();\n    var elem = this.dialogObj.element;\n    if (elem.childElementCount > 0) {\n      this.dialogObj.destroy();\n      remove(elem);\n    }\n    elem = this.alertDObj.element;\n    if (elem.childElementCount > 0) {\n      this.alertDObj.destroy();\n      remove(elem);\n    }\n    if (!hasGridChild) {\n      return;\n    }\n    if (this.editModule) {\n      this.editModule.destroy();\n    }\n  };\n  Edit.prototype.keyPressHandler = function (e) {\n    var isMacLike = /(Mac)/i.test(navigator.platform);\n    if (isMacLike && e.metaKey && e.action === 'ctrlEnter') {\n      e.action = 'insert';\n    }\n    switch (e.action) {\n      case 'insert':\n        this.addRecord();\n        break;\n      case 'delete':\n        if ((e.target.tagName !== 'INPUT' || e.target.classList.contains('e-checkselect')) && !document.querySelector('.e-popup-open.e-edit-dialog')) {\n          this.deleteRecord();\n        }\n        break;\n      case 'f2':\n        this.startEdit();\n        break;\n      case 'enter':\n        if (!parentsUntil(e.target, 'e-unboundcelldiv') && this.parent.editSettings.mode !== 'Batch' && (parentsUntil(e.target, literals.gridContent) || (this.parent.frozenRows || this.parent.editSettings.showAddNewRow && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) && parentsUntil(e.target, literals.headerContent)) && (!document.getElementsByClassName('e-popup-open').length || document.querySelectorAll('.e-popup-open .e-editcell').length && !document.querySelectorAll('.e-popup-open:not(.e-dialog)').length)) {\n          e.preventDefault();\n          if (this.parent.isEdit) {\n            this.parent.isFocusFirstCell = true;\n          }\n          this.endEdit();\n        }\n        break;\n      case 'escape':\n        if (this.parent.isEdit && !this.editCellDialogClose) {\n          if (this.parent.editSettings.mode === 'Batch') {\n            this.editModule.escapeCellEdit();\n          } else {\n            this.curretRowFocus(e);\n          }\n        }\n        if (this.editCellDialogClose) {\n          this.editCellDialogClose = false;\n        }\n        break;\n      case 'tab':\n      case 'shiftTab':\n        this.curretRowFocus(e);\n        break;\n    }\n  };\n  Edit.prototype.curretRowFocus = function (e) {\n    if (this.parent.isEdit && this.parent.editSettings.mode !== 'Batch') {\n      this.parent.isWidgetsDestroyed = false;\n      var editedRow = parentsUntil(e.target, 'e-editedrow') || parentsUntil(e.target, 'e-addedrow');\n      if (editedRow) {\n        var focusableEditCells = [].slice.call(editedRow.querySelectorAll('.e-input:not(.e-disabled)'));\n        var commandColCell = [].slice.call(editedRow.querySelectorAll('.e-unboundcell'));\n        if (commandColCell && commandColCell.length) {\n          for (var i = 0; i < commandColCell.length; i++) {\n            focusableEditCells = focusableEditCells.concat([].slice.call(commandColCell[parseInt(i.toString(), 10)].querySelectorAll('.e-btn:not(.e-hide)')));\n          }\n        }\n        var rowCell = parentsUntil(e.target, 'e-rowcell');\n        rowCell = rowCell && rowCell.classList.contains('e-unboundcell') ? e.target : rowCell;\n        var lastCell = parentsUntil(focusableEditCells[focusableEditCells.length - 1], 'e-rowcell');\n        lastCell = lastCell && lastCell.classList.contains('e-unboundcell') ? focusableEditCells[focusableEditCells.length - 1] : lastCell;\n        if (rowCell === lastCell && e.action === 'tab' || e.action === 'escape' || rowCell === parentsUntil(focusableEditCells[0], 'e-rowcell') && e.action === 'shiftTab' && !this.parent.editSettings.showAddNewRow) {\n          var uid = editedRow.getAttribute('data-uid');\n          var rows = this.parent.allowGrouping ? !isNullOrUndefined(this.parent.getContent()) ? [].slice.call(this.parent.getContent().querySelectorAll('tr')) : [] : this.parent.getRows();\n          var rowIndex = rows.map(function (m) {\n            return m.getAttribute('data-uid');\n          }).indexOf(uid);\n          if (this.parent.frozenRows) {\n            if (parentsUntil(editedRow, 'e-gridheader')) {\n              rowIndex = editedRow.rowIndex;\n            } else if (parentsUntil(editedRow, 'e-gridcontent')) {\n              rowIndex = rowIndex - this.parent.frozenRows;\n            }\n          }\n          if (editedRow.classList.contains('e-addedrow')) {\n            rowIndex = 0;\n          }\n          if (e.action === 'escape') {\n            this.parent.isFocusFirstCell = true;\n            this.closeEdit();\n          } else {\n            this.isShowAddedRowValidate = true;\n            this.parent.selectionModule.preventFocus = false;\n            this.parent.isFocusFirstCell = true;\n            this.endEdit();\n            this.isShowAddedRowValidate = false;\n          }\n          if (this.parent.focusModule.active && (!this.parent.editSettings.showAddNewRow || editedRow.classList.contains('e-editedrow') || this.parent.editSettings.showAddNewRow && editedRow.classList.contains('e-addedrow') && isNullOrUndefined(this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])')))) {\n            var firstCellIndex = 0;\n            var matrix = this.parent.focusModule.active.matrix;\n            if (matrix && matrix.matrix.length && matrix.matrix[parseInt(rowIndex.toString(), 10)]) {\n              var rowMatrix = matrix.matrix[parseInt(rowIndex.toString(), 10)];\n              for (var i = 0; i < rowMatrix.length; i++) {\n                if (rowMatrix[parseInt(i.toString(), 10)] > 0) {\n                  firstCellIndex = i;\n                  break;\n                }\n              }\n            }\n            var firstCell = getValue(rowIndex + \".cells.\" + firstCellIndex, this.parent.focusModule.active.matrix.getRowsFromIndex(rowIndex, this.parent.focusModule.active));\n            if (firstCell && firstCell.getBoundingClientRect().width === 0) {\n              var firstContentCellIndex = this.parent.focusModule.active.matrix.nextVisibleCellFocus(rowIndex, firstCellIndex, e.action, this.parent.focusModule.active.keyActions[e.action], this.parent.focusModule.active, this.parent.focusModule.active.matrix.current[1]);\n              firstCellIndex = firstContentCellIndex[1];\n            }\n            this.parent.focusModule.active.matrix.current = [rowIndex, firstCellIndex];\n          }\n        }\n        if (this.parent.editSettings.showAddNewRow && e.action === 'tab' && parentsUntil(e.target, 'e-addedrow')) {\n          this.isShowAddedRowValidate = true;\n        }\n      }\n    }\n  };\n  Edit.prototype.preventBatch = function (args) {\n    this.preventObj = args;\n    this.showDialog('BatchSaveLostChanges', this.dialogObj);\n  };\n  Edit.prototype.executeAction = function () {\n    this.preventObj.handler.call(this.preventObj.instance, this.preventObj.arg1, this.preventObj.arg2, this.preventObj.arg3, this.preventObj.arg4, this.preventObj.arg5, this.preventObj.arg6, this.preventObj.arg7, this.preventObj.arg8);\n  };\n  /**\n   * @param {Column[]} cols - specifies the column\n   * @param {Object} newRule - specifies the new rule object\n   * @returns {void}\n   * @hidden\n   */\n  Edit.prototype.applyFormValidation = function (cols, newRule) {\n    var gObj = this.parent;\n    var idx = 0;\n    var form = this.parent.editSettings.mode !== 'Dialog' ? gObj.editSettings.showAddNewRow && gObj.element.querySelector('.' + literals.editedRow) ? gObj.element.querySelector('.' + literals.editedRow).getElementsByClassName('e-gridform')[parseInt(idx.toString(), 10)] : gObj.element.getElementsByClassName('e-gridform')[parseInt(idx.toString(), 10)] : select('#' + gObj.element.id + '_dialogEdit_wrapper .e-gridform', document);\n    var index = 1;\n    var rules = {};\n    var mRules = {};\n    var frRules = {};\n    cols = cols ? cols : gObj.getColumns();\n    for (var i = 0; i < cols.length; i++) {\n      if (!cols[parseInt(i.toString(), 10)].visible && (gObj.editSettings.mode !== 'Dialog' || gObj.groupSettings.columns.indexOf(cols[parseInt(i.toString(), 10)].field) === -1 && gObj.editSettings.mode === 'Dialog')) {\n        continue;\n      }\n      if (cols[parseInt(i.toString(), 10)].validationRules && isNullOrUndefined(newRule)) {\n        setValidationRuels(cols[parseInt(i.toString(), 10)], index, rules, mRules, frRules, cols.length);\n      }\n    }\n    rules = extend(rules, mRules, frRules);\n    this.parent.editModule.formObj = this.createFormObj(form, newRule ? newRule : rules);\n  };\n  /**\n   * @param {HTMLFormElement} form - Defined Form element\n   * @param {Object} rules - Defines form rules\n   * @returns {FormValidator} Returns formvalidator instance\n   * @hidden\n   */\n  Edit.prototype.createFormObj = function (form, rules) {\n    var _this = this;\n    return new FormValidator(form, {\n      rules: rules,\n      locale: this.parent.locale,\n      validationComplete: function (args) {\n        _this.validationComplete(args);\n      },\n      customPlacement: function (inputElement, error) {\n        var uid = inputElement.getAttribute('e-mappinguid');\n        var args = {\n          column: _this.parent.getColumnByUid(uid),\n          error: error,\n          inputElement: inputElement,\n          value: inputElement.value\n        };\n        if (!(event && event['relatedTarget'] && event['relatedTarget'].classList.contains('e-cancelbutton')) && !_this.parent.editSettings.showAddNewRow || _this.parent.editSettings.showAddNewRow && event && event.target && (parentsUntil(event.target, _this.parent.element.id + '_update', true) || parentsUntil(event.target, 'e-grid-menu') && (event.target.classList.contains('e-save') || event.target.querySelector('.e-save')) || _this.isShowAddedRowValidate || parentsUntil(event.target, 'e-unboundcell') && parentsUntil(event.target, 'e-update') || event['action'] === 'enter' && (parentsUntil(event.target, 'e-content') || parentsUntil(event.target, 'e-addedrow'))) || _this.parent.editSettings.showAddNewRow && !isNullOrUndefined(_this.parent.element.querySelector('.' + literals.editedRow))) {\n          _this.valErrorPlacement(inputElement, error);\n        }\n        _this.isShowAddedRowValidate = false;\n        _this.parent.notify(events.valCustomPlacement, args);\n      }\n    });\n  };\n  Edit.prototype.valErrorPlacement = function (inputElement, error) {\n    if (this.parent.isEdit) {\n      var id = error.getAttribute('for');\n      var elem = this.getElemTable(inputElement).querySelector('#' + getParsedFieldID(id) + '_Error');\n      if (!elem) {\n        this.createTooltip(inputElement, error, id, '');\n      } else {\n        elem.querySelector('.e-tip-content').innerHTML = error.outerHTML;\n      }\n    }\n  };\n  Edit.prototype.getElemTable = function (inputElement) {\n    var isFrozenHdr;\n    var gObj = this.parent;\n    var table;\n    if (gObj.editSettings.mode !== 'Dialog') {\n      isFrozenHdr = gObj.frozenRows && closest(inputElement, '.' + literals.row) && gObj.frozenRows > (parseInt(closest(inputElement, '.' + literals.row).getAttribute(literals.ariaRowIndex), 10) - 1 || 0);\n      table = this.parent.isFrozenGrid() ? gObj.element : isFrozenHdr || gObj.editSettings.showAddNewRow && (gObj.enableVirtualization || gObj.enableInfiniteScrolling) ? gObj.getHeaderTable() : gObj.getContentTable();\n    } else {\n      table = select('#' + gObj.element.id + '_dialogEdit_wrapper', document);\n    }\n    return table;\n  };\n  Edit.prototype.resetElemPosition = function (elem, args) {\n    var td = parentsUntil(args.element, literals.rowCell);\n    if (td) {\n      var tdRight = td.getBoundingClientRect().right;\n      var elemRight = elem.getBoundingClientRect().right;\n      if (elemRight > tdRight) {\n        var offSet = elemRight - tdRight;\n        elem.style.left = elem.offsetLeft - offSet + 'px';\n      }\n    }\n  };\n  Edit.prototype.validationComplete = function (args) {\n    if (this.parent.isEdit) {\n      var elem = this.getElemTable(args.element).querySelector('#' + getParsedFieldID(args.inputName) + '_Error');\n      if (this.parent.editSettings.showAddNewRow && !elem && args.element) {\n        var error = parentsUntil(args.element, 'e-rowcell').querySelector('.e-error');\n        if (error) {\n          error.classList.remove('e-error');\n        }\n      }\n      if (elem) {\n        if (args.status === 'failure') {\n          elem.style.display = '';\n          this.resetElemPosition(elem, args);\n        } else {\n          elem.style.display = 'none';\n        }\n      }\n    }\n  };\n  Edit.prototype.createTooltip = function (element, error, name, display) {\n    var formObj = this.formObj.element;\n    var customForm = parentsUntil(element, 'e-virtual-validation');\n    if (customForm) {\n      formObj = this.virtualFormObj.element;\n    }\n    var gcontent = this.parent.getContent().firstElementChild;\n    var isScroll = gcontent.scrollHeight > gcontent.clientHeight || gcontent.scrollWidth > gcontent.clientWidth;\n    var isInline = this.parent.editSettings.mode !== 'Dialog';\n    var td = closest(element, '.' + literals.rowCell);\n    var row = closest(element, '.' + literals.row);\n    var isFHdr;\n    var isFHdrLastRow = false;\n    var validationForBottomRowPos;\n    var isBatchModeLastRow = false;\n    var isAddNewRow = this.parent.editSettings.showAddNewRow && !isNullOrUndefined(parentsUntil(element, literals.addedRow)) && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling);\n    var viewPortRowCount = Math.round(this.parent.getContent().clientHeight / this.parent.getRowHeight()) - 1;\n    var rows = [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n    if (this.parent.editSettings.mode === 'Batch') {\n      rows = [].slice.call(this.parent.getContent().querySelectorAll('.e-row:not(.e-hiddenrow)'));\n      if (viewPortRowCount > 1 && rows.length > viewPortRowCount && parseInt(rows[rows.length - 1].getAttribute(literals.ariaRowIndex), 10) - 1 === parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1) {\n        isBatchModeLastRow = true;\n      }\n    }\n    if (isInline) {\n      if (this.parent.frozenRows || isAddNewRow) {\n        var headerRows = this.parent.editSettings.showAddNewRow ? '.e-row:not(.e-hiddenrow.e-addedrow)' : '.e-row:not(.e-hiddenrow)';\n        var fHearderRows = [].slice.call(this.parent.getHeaderTable().querySelector(literals.tbody).querySelectorAll(headerRows));\n        isFHdr = fHearderRows.length > (parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1 || 0);\n        isFHdrLastRow = isFHdr && parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1 === fHearderRows.length - 1;\n        var insertRow = [].slice.call(this.parent.getHeaderTable().querySelector(literals.tbody).querySelectorAll('.e-row:not(.e-hiddenrow)'));\n        if (insertRow.length === 1 && (insertRow[0].classList.contains('e-addedrow') || insertRow[0].classList.contains('e-insertedrow'))) {\n          isFHdrLastRow = true;\n        }\n      }\n      if (isFHdrLastRow || viewPortRowCount > 1 && rows.length > viewPortRowCount && (this.parent.editSettings.newRowPosition === 'Bottom' && this.editModule.args && this.editModule.args.requestType === 'add' || td.classList.contains('e-lastrowcell') && !row.classList.contains(literals.addedRow)) || isBatchModeLastRow) {\n        validationForBottomRowPos = true;\n      }\n    }\n    var table = isInline ? isFHdr ? this.parent.getHeaderTable() : this.parent.getContentTable() : select('#' + this.parent.element.id + '_dialogEdit_wrapper .e-dlg-content', document);\n    var client = table.getBoundingClientRect();\n    var left = isInline ? this.parent.element.getBoundingClientRect().left : client.left;\n    var input = closest(element, 'td');\n    var inputClient = input ? input.getBoundingClientRect() : element.parentElement.getBoundingClientRect();\n    var div = this.parent.createElement('div', {\n      className: 'e-tooltip-wrap e-lib e-control e-popup e-griderror',\n      id: name + '_Error'\n    });\n    var divStyles = 'display:' + display + ';top:' + ((isFHdr ? inputClient.top + inputClient.height : inputClient.bottom - client.top) + table.scrollTop + 9) + 'px;left:' + (inputClient.left - left + table.scrollLeft + inputClient.width / 2) + 'px;' + 'max-width:' + inputClient.width + 'px;text-align:center;';\n    updateCSSText(div, divStyles);\n    if (this.parent.cssClass) {\n      div.classList.add(this.parent.cssClass);\n    }\n    if (isInline && client.left < left) {\n      div.style.left = parseInt(div.style.left, 10) - client.left + left + 'px';\n    }\n    var content = this.parent.createElement('div', {\n      className: 'e-tip-content'\n    });\n    content.appendChild(error);\n    var arrow;\n    if (validationForBottomRowPos) {\n      arrow = this.parent.createElement('div', {\n        className: 'e-arrow-tip e-tip-bottom'\n      });\n      arrow.appendChild(this.parent.createElement('div', {\n        className: 'e-arrow-tip-outer e-tip-bottom'\n      }));\n      arrow.appendChild(this.parent.createElement('div', {\n        className: 'e-arrow-tip-inner e-tip-bottom'\n      }));\n    } else {\n      arrow = this.parent.createElement('div', {\n        className: 'e-arrow-tip e-tip-top'\n      });\n      arrow.appendChild(this.parent.createElement('div', {\n        className: 'e-arrow-tip-outer e-tip-top'\n      }));\n      arrow.appendChild(this.parent.createElement('div', {\n        className: 'e-arrow-tip-inner e-tip-top'\n      }));\n    }\n    div.appendChild(content);\n    div.appendChild(arrow);\n    if (!customForm && (this.parent.frozenRows || isAddNewRow) && this.parent.editSettings.mode !== 'Dialog') {\n      var getEditCell = this.parent.editSettings.mode === 'Normal' ? closest(element, '.e-editcell') : closest(element, '.' + literals.table);\n      getEditCell.style.position = 'relative';\n      div.style.position = 'absolute';\n      if (this.parent.editSettings.mode === 'Batch' || closest(element, '.' + literals.frozenContent) || closest(element, '.' + literals.frozenHeader) || this.parent.frozenRows || isAddNewRow) {\n        if (this.parent.isFrozenGrid()) {\n          if (td.classList.contains('e-unfreeze')) {\n            addClass([div], 'e-unfreeze');\n            formObj.appendChild(div);\n          } else {\n            var elem = closest(td, '.e-gridheader') ? this.parent.element.querySelector('.e-gridheader') : rows.length === 1 ? this.parent.element.querySelector('.e-gridcontent').querySelector('.e-content') : this.parent.element.querySelector('.e-gridcontent');\n            elem.appendChild(div);\n            elem.style.position = 'relative';\n          }\n        } else {\n          formObj.appendChild(div);\n        }\n      }\n    } else {\n      if (customForm) {\n        this.virtualFormObj.element.appendChild(div);\n      } else {\n        if (this.parent.editSettings.mode !== 'Dialog' && this.parent.isFrozenGrid()) {\n          if (td.classList.contains('e-unfreeze')) {\n            addClass([div], 'e-unfreeze');\n            this.formObj.element.appendChild(div);\n          } else {\n            var elem = closest(td, '.e-gridheader') ? this.parent.element.querySelector('.e-gridheader') : rows.length === 1 ? this.parent.element.querySelector('.e-gridcontent').querySelector('.e-content') : this.parent.element.querySelector('.e-gridcontent');\n            elem.appendChild(div);\n            elem.style.position = 'relative';\n          }\n        } else {\n          this.formObj.element.appendChild(div);\n        }\n      }\n    }\n    if (!isNullOrUndefined(td)) {\n      if (td.classList.contains('e-fixedfreeze')) {\n        div.classList.add('e-fixederror');\n      } else if (td.classList.contains('e-leftfreeze') || td.classList.contains('e-rightfreeze')) {\n        div.classList.add('e-freezeerror');\n      }\n    }\n    if (!validationForBottomRowPos && isInline && gcontent.getBoundingClientRect().bottom < inputClient.bottom + inputClient.height) {\n      var contentDiv = this.parent.getContent().querySelector('.e-content');\n      if (this.parent.currentViewData.length === 0 && contentDiv.scrollTop === 0) {\n        contentDiv.scrollTop = div.offsetHeight + arrow.scrollHeight;\n      } else {\n        gcontent.scrollTop = gcontent.scrollTop + div.offsetHeight + arrow.scrollHeight;\n      }\n    }\n    var lineHeight = parseInt(document.defaultView.getComputedStyle(div, null).getPropertyValue('font-size'), 10);\n    if ((this.parent.frozenRows || isAddNewRow) && this.parent.editSettings.mode !== 'Dialog') {\n      div.style.left = input.offsetLeft + (input.offsetWidth / 2 - div.offsetWidth / 2) + 'px';\n    } else {\n      div.style.left = parseInt(div.style.left, 10) - div.offsetWidth / 2 + 'px';\n    }\n    if (div.getBoundingClientRect().width < inputClient.width && div.querySelector('label').getBoundingClientRect().height / (lineHeight * 1.2) >= 2) {\n      div.style.width = div.style.maxWidth;\n    }\n    if (isInline && !isScroll && !this.parent.allowPaging || this.parent.frozenRows || isAddNewRow) {\n      // gcontent.style.position = 'static';\n      var pos = calculateRelativeBasedPosition(input, div);\n      div.style.top = pos.top + inputClient.height + 9 + 'px';\n    }\n    if (validationForBottomRowPos) {\n      if (isScroll && this.parent.height !== 'auto' && (!this.parent.frozenRows || !isAddNewRow) && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling && !(div.classList.contains('e-freezeerror') && div.classList.contains('e-fixederror'))) {\n        var scrollWidth = gcontent.scrollWidth > gcontent.offsetWidth ? getScrollBarWidth() : 0;\n        var gHeight = this.parent.height.toString().indexOf('%') === -1 ? parseInt(this.parent.height, 10) : gcontent.offsetHeight;\n        div.style.bottom = gHeight - gcontent.querySelector('table').offsetHeight - scrollWidth + inputClient.height + 9 + 'px';\n      } else {\n        div.style.bottom = inputClient.height + 9 + 'px';\n      }\n      if (rows.length < viewPortRowCount && this.parent.editSettings.newRowPosition === 'Bottom' && this.editModule.args && this.editModule.args.requestType === 'add') {\n        var rowsCount = this.parent.frozenRows ? (isAddNewRow ? this.parent.frozenRows + 1 : this.parent.frozenRows) + (rows.length - 1) : rows.length - 1;\n        var rowsHeight = rowsCount * this.parent.getRowHeight();\n        var position = this.parent.getContent().clientHeight - rowsHeight;\n        div.style.bottom = position + 9 + 'px';\n      }\n      div.style.top = null;\n    }\n  };\n  /**\n   * @param {Column} col - specfies the column\n   * @returns {boolean} returns the whether column is grouped\n   * @hidden\n   */\n  Edit.prototype.checkColumnIsGrouped = function (col) {\n    return !col.visible && !(this.parent.groupSettings.columns.indexOf(col.field) > -1);\n  };\n  /**\n   * @param {object} editors -specfies the editors\n   * @returns {void}\n   * @hidden\n   */\n  Edit.AddEditors = function (editors) {\n    Edit.editCellType = extend(Edit.editCellType, editors);\n  };\n  Edit.editCellType = {\n    'dropdownedit': DropDownEditCell,\n    'numericedit': NumericEditCell,\n    'datepickeredit': DatePickerEditCell,\n    'datetimepickeredit': DatePickerEditCell,\n    'booleanedit': BooleanEditCell,\n    'defaultedit': DefaultEditCell,\n    'templateedit': TemplateEditCell\n  };\n  return Edit;\n}();\nexport { Edit };","map":{"version":3,"names":["closest","addClass","select","updateCSSText","extend","getValue","remove","isNullOrUndefined","events","EditRender","BooleanEditCell","DropDownEditCell","NumericEditCell","DefaultEditCell","InlineEdit","BatchEdit","DialogEdit","Dialog","parentsUntil","getComplexFieldID","getParsedFieldID","setComplexFieldID","getScrollBarWidth","setValidationRuels","FormValidator","DatePickerEditCell","calculateRelativeBasedPosition","TemplateEditCell","DataUtil","addRemoveEventListener","padZero","getParentIns","literals","Edit","parent","serviceLocator","isShowAddedRowValidate","editType","fieldname","data","editCellDialogClose","l10n","getService","addEventListener","updateEditObj","createAlertDlg","createConfirmDlg","prototype","updateColTypeObj","cols","columnModel","i","length","editSettings","template","parseInt","toString","editTemplate","templteCell","edit","editCellType","log","getModuleName","onPropertyChanged","e","module","gObj","_i","_a","Object","keys","properties","prop","allowAdding","allowEditing","allowDeleting","initialEnd","isEdit","showAddNewRow","refresh","editModule","destroy","renderer","mode","startEdit","tr","element","querySelector","editedRow","classList","add","getSelectedRows","getRowByIndex","getAttribute","showDialog","alertDObj","enableVirtualization","idx","lastTr","getContent","hdrTbody","getHeaderContent","frozenRows","isLastRow","rowIndex","style","display","refreshToolbar","notify","destroyToolTip","checkLastRow","args","height","newRowPosition","requestType","firstElementChild","offsetHeight","getContentTable","scrollHeight","slice","call","getElementsByClassName","rowCell","closeEdit","showConfirmDialog","dialogObj","toolbarRefresh","addRecord","index","virtualScrollAddActionBegin","deleteRecord","getSelectedRecords","commandDelIndex","showDeleteConfirmDialog","deleteRow","deleteRowUid","rowObj","getRowObjectFromUID","endEdit","formObj","validate","saveCell","editNextValCell","endEditing","updateCell","field","value","updateRow","batchCancel","batchSave","editCell","editFormValidate","getBatchChanges","getCurrentEditCellData","obj","getCurrentEditedData","content","getConstant","dataBind","show","enableRtl","getValueFromType","col","val","type","isNaN","parseFloat","Date","getFullYear","getMonth","getDate","elements","elements_1","elem","position","isFrozenGrid","dlgWidget","click","dlgOk","bind","buttonModel","cssClass","isPrimary","dlgCancel","alertClick","hide","btnOptions","name","div","createElement","id","appendChild","options","showCloseIcon","isModal","visible","closeOnEscape","target","width","animationSettings","effect","buttons","isStringTemplate","appendTo","pagerModule","isForceCancel","focusModule","clearIndicator","restoreFocus","innerText","allowSelection","undefined","addCancelWhilePaging","executeAction","destroyEditComponents","destroyWidgets","destroyForm","isDestroyed","eventDetails","event","inBoundModelChanged","handler","keyPressed","keyPressHandler","autoCol","tooltipDestroy","preventBatch","actionBeginFunction","onActionBegin","actionCompleteFunction","actionComplete","on","destroyEditForm","removeEventListener","off","actions","indexOf","form","editedData","k","hasAttribute","className","contains","column","getColumnByField","checked","ej2_instances","blur","read","window","setValue","sanitize","filter","j","inputElements","tagName","toLowerCase","temp","inputs","len","col_1","getColumnByUid","isForeignColumn","input","enableInfiniteScrolling","infiniteScrollSettings","enableCache","editRow","addRow","addedRow","row","ariaRowIndex","restrictedRequestTypes","isRestrict","isAddRows","isDestroyVirtualForm","cancel","isWidgetsDestroyed","parentIns","isReact","destroyTemplate","renderTemplates","allowGrouping","groupSettings","columns","allColumns","getColumns","push","getCurrentVisibleColumns","enableColumnVirtualization","some","cols_1","instanceElement","parentElement","formObjects","virtualFormObj","gridElement","hasGridChild","gridHeader","gridContent","childElementCount","isMacLike","test","navigator","platform","metaKey","action","document","headerContent","querySelectorAll","preventDefault","isFocusFirstCell","escapeCellEdit","curretRowFocus","focusableEditCells","commandColCell","concat","lastCell","uid","rows","getRows","map","m","selectionModule","preventFocus","active","firstCellIndex","matrix","rowMatrix","firstCell","getRowsFromIndex","getBoundingClientRect","firstContentCellIndex","nextVisibleCellFocus","keyActions","current","preventObj","instance","arg1","arg2","arg3","arg4","arg5","arg6","arg7","arg8","applyFormValidation","newRule","rules","mRules","frRules","validationRules","createFormObj","_this","locale","validationComplete","customPlacement","inputElement","error","valErrorPlacement","valCustomPlacement","getElemTable","createTooltip","innerHTML","outerHTML","isFrozenHdr","table","getHeaderTable","resetElemPosition","td","tdRight","right","elemRight","offSet","left","offsetLeft","inputName","status","customForm","gcontent","isScroll","clientHeight","scrollWidth","clientWidth","isInline","isFHdr","isFHdrLastRow","validationForBottomRowPos","isBatchModeLastRow","isAddNewRow","viewPortRowCount","Math","round","getRowHeight","headerRows","fHearderRows","tbody","insertRow","client","inputClient","divStyles","top","bottom","scrollTop","scrollLeft","arrow","getEditCell","frozenContent","frozenHeader","contentDiv","currentViewData","lineHeight","defaultView","getComputedStyle","getPropertyValue","offsetWidth","maxWidth","allowPaging","pos","gHeight","rowsCount","rowsHeight","checkColumnIsGrouped","AddEditors","editors"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-grids/src/grid/actions/edit.js"],"sourcesContent":["import { closest, addClass, select, updateCSSText } from '@syncfusion/ej2-base';\nimport { extend, getValue } from '@syncfusion/ej2-base';\nimport { remove } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { EditRender } from '../renderer/edit-renderer';\nimport { BooleanEditCell } from '../renderer/boolean-edit-cell';\nimport { DropDownEditCell } from '../renderer/dropdown-edit-cell';\nimport { NumericEditCell } from '../renderer/numeric-edit-cell';\nimport { DefaultEditCell } from '../renderer/default-edit-cell';\nimport { InlineEdit } from './inline-edit';\nimport { BatchEdit } from './batch-edit';\nimport { DialogEdit } from './dialog-edit';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport { parentsUntil, getComplexFieldID, getParsedFieldID, setComplexFieldID, getScrollBarWidth, setValidationRuels } from '../base/util';\nimport { FormValidator } from '@syncfusion/ej2-inputs';\nimport { DatePickerEditCell } from '../renderer/datepicker-edit-cell';\nimport { calculateRelativeBasedPosition } from '@syncfusion/ej2-popups';\nimport { TemplateEditCell } from '../renderer/template-edit-cell';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport { addRemoveEventListener, padZero, getParentIns } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * The `Edit` module is used to handle editing actions.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for the Grid editing module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} serviceLocator - specifies the servicelocator\n     * @hidden\n     */\n    function Edit(parent, serviceLocator) {\n        /** @hidden */\n        this.isShowAddedRowValidate = false;\n        this.editType = { 'Inline': InlineEdit, 'Normal': InlineEdit, 'Batch': BatchEdit, 'Dialog': DialogEdit };\n        this.fieldname = '';\n        this.data = {};\n        /* @hidden */\n        this.editCellDialogClose = false;\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.l10n = this.serviceLocator.getService('localization');\n        this.addEventListener();\n        this.updateEditObj();\n        this.createAlertDlg();\n        this.createConfirmDlg();\n    }\n    Edit.prototype.updateColTypeObj = function () {\n        var cols = this.parent.columnModel;\n        for (var i = 0; i < cols.length; i++) {\n            if (this.parent.editSettings.template || cols[parseInt(i.toString(), 10)].editTemplate) {\n                var templteCell = 'templateedit';\n                cols[parseInt(i.toString(), 10)].edit = extend(new Edit.editCellType[\"\" + templteCell](this.parent), cols[parseInt(i.toString(), 10)].edit || {});\n            }\n            else {\n                cols[parseInt(i.toString(), 10)].edit = extend(new Edit.editCellType[cols[parseInt(i.toString(), 10)].editType\n                    && Edit.editCellType[cols[parseInt(i.toString(), 10)].editType] ?\n                    cols[parseInt(i.toString(), 10)].editType : 'defaultedit'](this.parent, this.serviceLocator), cols[parseInt(i.toString(), 10)].edit || {});\n            }\n        }\n        this.parent.log('primary_column_missing');\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    /**\n     * @param {NotifyArgs} e - specifies the notifyargs\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        var gObj = this.parent;\n        for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'allowAdding':\n                case 'allowDeleting':\n                case 'allowEditing':\n                    if (gObj.editSettings.allowAdding || gObj.editSettings.allowEditing || gObj.editSettings.allowDeleting) {\n                        this.initialEnd();\n                    }\n                    break;\n                case 'mode':\n                    this.updateEditObj();\n                    gObj.isEdit = gObj.editSettings.showAddNewRow ? true : false;\n                    gObj.refresh();\n                    break;\n            }\n        }\n    };\n    Edit.prototype.updateEditObj = function () {\n        if (this.editModule) {\n            this.editModule.destroy();\n        }\n        this.renderer = new EditRender(this.parent, this.serviceLocator);\n        this.editModule = new this.editType[this.parent.editSettings.mode](this.parent, this.serviceLocator, this.renderer);\n    };\n    Edit.prototype.initialEnd = function () {\n        this.updateColTypeObj();\n    };\n    /**\n     * Edits any bound record in the Grid by TR element.\n     *\n     * @param {HTMLTableRowElement} tr - Defines the table row to be edited.\n     * @returns {void}\n     */\n    Edit.prototype.startEdit = function (tr) {\n        var gObj = this.parent;\n        if (!gObj.editSettings.allowEditing || (gObj.isEdit && (!gObj.editSettings.showAddNewRow ||\n            (gObj.editSettings.showAddNewRow && !isNullOrUndefined(gObj.element.querySelector('.' + literals.editedRow)))))\n            || gObj.editSettings.mode === 'Batch') {\n            return;\n        }\n        this.parent.element.classList.add('e-editing');\n        if (!gObj.getSelectedRows().length || isNullOrUndefined(this.parent.getRowByIndex(parseInt(this.parent.getSelectedRows()[0].getAttribute('aria-rowindex'), 10) - 1))) {\n            if (!tr) {\n                this.showDialog('EditOperationAlert', this.alertDObj);\n                return;\n            }\n        }\n        else if (!tr) {\n            tr = gObj.getSelectedRows()[0];\n        }\n        if (this.parent.enableVirtualization && this.parent.editSettings.mode === 'Normal') {\n            var idx = parseInt(tr.getAttribute('aria-rowindex'), 10) - 1;\n            tr = this.parent.getRowByIndex(idx);\n        }\n        var lastTr = gObj.getContent().querySelector('tr:last-child');\n        var hdrTbody = gObj.getHeaderContent().querySelector('tbody');\n        if (gObj.frozenRows && isNullOrUndefined(lastTr) && hdrTbody && hdrTbody.querySelector('tr:last-child')) {\n            this.isLastRow = tr.rowIndex === parseInt(gObj.getHeaderContent().querySelector('tbody').querySelector('tr:last-child').getAttribute('aria-rowindex'), 10) - 1;\n        }\n        else if (lastTr) {\n            this.isLastRow = tr.rowIndex === lastTr.rowIndex;\n        }\n        if (tr.style.display === 'none') {\n            return;\n        }\n        this.editModule.startEdit(tr);\n        this.refreshToolbar();\n        gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n        this.parent.notify('start-edit', {});\n        if (gObj.editSettings.showAddNewRow) {\n            this.destroyToolTip();\n        }\n    };\n    /**\n     * @param {Element} tr - specifies the tr element\n     * @param {object} args - specifies the object\n     * @param {Element} args.row -specfifes the row\n     * @param {string} args.requestType - specifies the request type\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.checkLastRow = function (tr, args) {\n        var checkLastRow = this.isLastRow;\n        if (this.parent.height !== 'auto' && this.parent.editSettings.newRowPosition === 'Bottom' && args && args.requestType === 'add' &&\n            this.parent.getContent().firstElementChild.offsetHeight > this.parent.getContentTable().scrollHeight) {\n            addClass([].slice.call(tr.getElementsByClassName(literals.rowCell)), 'e-lastrowadded');\n        }\n        else if (checkLastRow && tr && tr.classList) {\n            addClass([].slice.call(tr.getElementsByClassName(literals.rowCell)), 'e-lastrowcell');\n        }\n    };\n    /**\n     * Cancels edited state.\n     *\n     * @returns {void}\n     */\n    Edit.prototype.closeEdit = function () {\n        if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.showConfirmDialog\n            && this.parent.element.getElementsByClassName('e-updatedtd').length) {\n            this.showDialog('CancelEdit', this.dialogObj);\n            return;\n        }\n        this.parent.element.classList.remove('e-editing');\n        this.editModule.closeEdit();\n        this.refreshToolbar();\n        this.parent.notify(events.closeEdit, { requestType: 'cancel' });\n        if (this.parent.editSettings.showAddNewRow) {\n            this.destroyToolTip();\n        }\n    };\n    Edit.prototype.refreshToolbar = function () {\n        this.parent.notify(events.toolbarRefresh, {});\n    };\n    /**\n     * To adds a new row at the top with the given data. When data is not passed, it will add empty rows.\n     * > `editSettings.allowEditing` should be true.\n     *\n     * @param {Object} data - Defines the new add record data.\n     * @param {number} index - Defines the row index to be added\n     * @returns {void}\n     */\n    Edit.prototype.addRecord = function (data, index) {\n        if (!this.parent.editSettings.allowAdding) {\n            return;\n        }\n        var args = { startEdit: true };\n        if (!data) {\n            this.parent.notify(events.virtualScrollAddActionBegin, args);\n        }\n        if (args.startEdit) {\n            this.parent.element.classList.add('e-editing');\n            this.editModule.addRecord(data, index);\n            this.refreshToolbar();\n            this.parent.notify('start-add', {});\n        }\n    };\n    /**\n     * Deletes a record with the given options. If fieldname and data are not given, the Grid will delete the selected record.\n     * > `editSettings.allowDeleting` should be true.\n     *\n     * @param {string} fieldname - Defines the primary key field name of the column.\n     * @param {Object} data - Defines the JSON data record to be deleted.\n     * @returns {void}\n     */\n    Edit.prototype.deleteRecord = function (fieldname, data) {\n        var gObj = this.parent;\n        if (!gObj.editSettings.allowDeleting) {\n            return;\n        }\n        if (!data) {\n            if (!gObj.getSelectedRecords().length && isNullOrUndefined(gObj.commandDelIndex)) {\n                this.showDialog('DeleteOperationAlert', this.alertDObj);\n                return;\n            }\n        }\n        if (gObj.editSettings.showDeleteConfirmDialog) {\n            this.fieldname = fieldname;\n            this.data = data;\n            this.showDialog('ConfirmDelete', this.dialogObj);\n            return;\n        }\n        this.editModule.deleteRecord(fieldname, data);\n    };\n    /**\n     * Deletes a visible row by TR element.\n     *\n     * @param {HTMLTableRowElement} tr - Defines the table row element.\n     * @returns {void}\n     */\n    Edit.prototype.deleteRow = function (tr) {\n        this.deleteRowUid = tr.getAttribute('data-uid');\n        var rowObj = this.parent.getRowObjectFromUID(this.deleteRowUid);\n        if (!isNullOrUndefined(rowObj)) {\n            this.deleteRecord(null, rowObj.data);\n        }\n    };\n    /**\n     * If Grid is in editable state, you can save a record by invoking endEdit.\n     *\n     * @returns {void}\n     */\n    Edit.prototype.endEdit = function () {\n        if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.showConfirmDialog &&\n            (isNullOrUndefined(this.formObj) || this.formObj.validate())) {\n            this.parent.editModule.saveCell();\n            this.parent.notify(events.editNextValCell, {});\n            if (isNullOrUndefined(this.formObj) || this.formObj.validate()) {\n                this.showDialog('BatchSaveConfirm', this.dialogObj);\n                return;\n            }\n        }\n        this.endEditing();\n    };\n    /**\n     * To update the specified cell by given value without changing into edited state.\n     *\n     * @param {number} rowIndex Defines the row index.\n     * @param {string} field Defines the column field.\n     * @param {string | number | boolean | Date} value - Defines the value to be changed.\n     * @returns {void}\n     */\n    Edit.prototype.updateCell = function (rowIndex, field, value) {\n        this.editModule.updateCell(rowIndex, field, value);\n    };\n    /**\n     * To update the specified row by given values without changing into edited state.\n     *\n     * @param {number} index Defines the row index.\n     * @param {Object} data Defines the data object to be updated.\n     * @returns {void}\n     */\n    Edit.prototype.updateRow = function (index, data) {\n        this.editModule.updateRow(index, data);\n    };\n    /**\n     * Resets added, edited, and deleted records in the batch mode.\n     *\n     * @returns {void}\n     */\n    Edit.prototype.batchCancel = function () {\n        this.closeEdit();\n    };\n    /**\n     * Bulk saves added, edited, and deleted records in the batch mode.\n     *\n     * @returns {void}\n     */\n    Edit.prototype.batchSave = function () {\n        this.endEdit();\n    };\n    /**\n     * Changes a particular cell into edited state based on the row index and field name provided in the `batch` mode.\n     *\n     * @param {number} index - Defines row index to edit a particular cell.\n     * @param {string} field - Defines the field name of the column to perform batch edit.\n     * @returns {void}\n     */\n    Edit.prototype.editCell = function (index, field) {\n        this.editModule.editCell(index, field);\n    };\n    /**\n     * Checks the status of validation at the time of editing. If validation is passed, it returns true.\n     *\n     * @returns {boolean} returns whether the form is validated\n     */\n    Edit.prototype.editFormValidate = function () {\n        return this.formObj ? this.formObj.validate() : true;\n    };\n    /**\n     * Gets the added, edited,and deleted data before bulk save to the DataSource in batch mode.\n     *\n     * @returns {Object} returns the Object\n     */\n    Edit.prototype.getBatchChanges = function () {\n        return this.editModule.getBatchChanges ? this.editModule.getBatchChanges() : {};\n    };\n    /**\n     * Gets the current value of the edited component.\n     *\n     * @returns {Object} returns the Object\n     */\n    Edit.prototype.getCurrentEditCellData = function () {\n        var obj = this.getCurrentEditedData(this.formObj.element, {});\n        return obj[Object.keys(obj)[0]];\n    };\n    /**\n     * Saves the cell that is currently edited. It does not save the value to the DataSource.\n     *\n     * @returns {void}\n     */\n    Edit.prototype.saveCell = function () {\n        this.editModule.saveCell();\n    };\n    Edit.prototype.endEditing = function () {\n        if (!this.parent.editSettings.showAddNewRow) {\n            this.parent.element.classList.remove('e-editing');\n        }\n        this.editModule.endEdit();\n        this.isShowAddedRowValidate = false;\n        this.refreshToolbar();\n    };\n    Edit.prototype.showDialog = function (content, obj) {\n        obj.content = '<div>' + this.l10n.getConstant(content) + '</div>';\n        obj.dataBind();\n        obj.show();\n        if (this.parent.enableRtl) {\n            obj.refresh();\n        }\n    };\n    Edit.prototype.getValueFromType = function (col, value) {\n        var val = value;\n        switch (col.type) {\n            case 'number':\n                val = !isNaN(parseFloat(value)) ? parseFloat(value) : null;\n                break;\n            case 'boolean':\n                if (col.editType !== 'booleanedit') {\n                    val = value === this.l10n.getConstant('True') || value === true ? true : false;\n                }\n                break;\n            case 'date':\n            case 'datetime':\n                if (col.editType !== 'datepickeredit' && col.editType !== 'datetimepickeredit'\n                    && value && value.length) {\n                    val = new Date(value);\n                }\n                else if (value === '') {\n                    val = null;\n                }\n                break;\n            case 'dateonly':\n                // eslint-disable-next-line no-cond-assign\n                val = value && (value = new Date(value)) ?\n                    value.getFullYear() + '-' + padZero(value.getMonth() + 1) + '-' + padZero(value.getDate()) : null;\n                break;\n        }\n        return val;\n    };\n    Edit.prototype.destroyToolTip = function () {\n        var elements = [].slice.call(this.parent.element.getElementsByClassName('e-griderror'));\n        for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n            var elem = elements_1[_i];\n            remove(elem);\n        }\n        this.parent.getContent().firstElementChild.style.position = 'relative';\n        if (this.parent.isFrozenGrid()) {\n            if (this.parent.element.querySelector('.e-gridheader')) {\n                this.parent.element.querySelector('.e-gridheader').style.position = '';\n            }\n            this.parent.element.querySelector('.e-gridcontent').style.position = '';\n        }\n    };\n    Edit.prototype.createConfirmDlg = function () {\n        this.dialogObj = this.dlgWidget([\n            {\n                click: this.dlgOk.bind(this),\n                buttonModel: { content: this.l10n.getConstant('OKButton'),\n                    cssClass: this.parent.cssClass ? 'e-primary' + ' ' + this.parent.cssClass : 'e-primary',\n                    isPrimary: true }\n            },\n            {\n                click: this.dlgCancel.bind(this),\n                buttonModel: { cssClass: this.parent.cssClass ? 'e-flat' + ' ' + this.parent.cssClass : 'e-flat',\n                    content: this.l10n.getConstant('CancelButton') }\n            }\n        ], 'EditConfirm');\n    };\n    Edit.prototype.createAlertDlg = function () {\n        this.alertDObj = this.dlgWidget([\n            {\n                click: this.alertClick.bind(this),\n                buttonModel: { content: this.l10n.getConstant('OKButton'),\n                    cssClass: this.parent.cssClass ? 'e-flat' + ' ' + this.parent.cssClass : 'e-flat',\n                    isPrimary: true }\n            }\n        ], 'EditAlert');\n    };\n    Edit.prototype.alertClick = function () {\n        this.alertDObj.hide();\n    };\n    Edit.prototype.dlgWidget = function (btnOptions, name) {\n        var div = this.parent.createElement('div', { id: this.parent.element.id + name });\n        this.parent.element.appendChild(div);\n        var options = {\n            showCloseIcon: false,\n            isModal: true,\n            visible: false,\n            closeOnEscape: true,\n            target: this.parent.element,\n            width: '320px',\n            animationSettings: { effect: 'None' },\n            cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n        };\n        options.buttons = btnOptions;\n        var obj = new Dialog(options);\n        var isStringTemplate = 'isStringTemplate';\n        obj[\"\" + isStringTemplate] = true;\n        obj.appendTo(div);\n        return obj;\n    };\n    Edit.prototype.dlgCancel = function () {\n        if (this.parent.pagerModule) {\n            this.parent.pagerModule.isForceCancel = false;\n        }\n        this.parent.focusModule.clearIndicator();\n        this.dialogObj.hide();\n        this.parent.focusModule.restoreFocus({ requestType: 'cancel' });\n        this.parent.notify('cancelcnfrmDlg', {});\n    };\n    Edit.prototype.dlgOk = function () {\n        switch (this.dialogObj.element.querySelector('.e-dlg-content').firstElementChild.innerText) {\n            case this.l10n.getConstant('ConfirmDelete'):\n                this.editModule.deleteRecord(this.fieldname, this.data);\n                if (this.parent.editSettings.showDeleteConfirmDialog && !this.parent.allowSelection) {\n                    this.parent.commandDelIndex = undefined;\n                }\n                break;\n            case this.l10n.getConstant('CancelEdit'):\n                this.editModule.closeEdit();\n                break;\n            case this.l10n.getConstant('BatchSaveConfirm'):\n                this.endEditing();\n                break;\n            case this.l10n.getConstant('BatchSaveLostChanges'):\n                if (this.parent.editSettings.mode === 'Batch') {\n                    this.editModule.addCancelWhilePaging();\n                }\n                if (this.parent.pagerModule) {\n                    this.parent.pagerModule.isForceCancel = false;\n                }\n                this.executeAction();\n                break;\n        }\n        this.dlgCancel();\n    };\n    Edit.prototype.destroyEditComponents = function () {\n        if (this.parent.isEdit) {\n            this.destroyWidgets();\n            this.destroyForm();\n        }\n        this.destroy();\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.eventDetails = [{ event: events.inBoundModelChanged, handler: this.onPropertyChanged },\n            { event: events.initialEnd, handler: this.initialEnd },\n            { event: events.keyPressed, handler: this.keyPressHandler },\n            { event: events.autoCol, handler: this.updateColTypeObj },\n            { event: events.tooltipDestroy, handler: this.destroyToolTip },\n            { event: events.preventBatch, handler: this.preventBatch },\n            { event: events.destroyForm, handler: this.destroyForm },\n            { event: events.destroy, handler: this.destroyEditComponents }];\n        addRemoveEventListener(this.parent, this.eventDetails, true, this);\n        this.actionBeginFunction = this.onActionBegin.bind(this);\n        this.actionCompleteFunction = this.actionComplete.bind(this);\n        this.parent.on(events.destroyEditForm, this.actionBeginFunction);\n        this.parent.addEventListener(events.actionComplete, this.actionCompleteFunction);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        addRemoveEventListener(this.parent, this.eventDetails, false);\n        this.parent.removeEventListener(events.actionComplete, this.actionCompleteFunction);\n        this.parent.off(events.destroyEditForm, this.actionBeginFunction);\n    };\n    Edit.prototype.actionComplete = function (e) {\n        var actions = ['add', 'beginEdit', 'save', 'delete', 'cancel', 'filterAfterOpen', 'filterchoicerequest'];\n        if (actions.indexOf(e.requestType) < 0) {\n            this.parent.isEdit = this.parent.editSettings.showAddNewRow ? true : false;\n        }\n        if (e.requestType === 'batchsave') {\n            this.parent.focusModule.restoreFocus({ requestType: 'save' });\n        }\n        this.refreshToolbar();\n    };\n    /**\n     * @param {Element} form - specifies the element\n     * @param {Object} editedData - specifies the edited data\n     * @returns {Object} returns the object\n     * @hidden\n     */\n    Edit.prototype.getCurrentEditedData = function (form, editedData) {\n        var gObj = this.parent;\n        if (gObj.editSettings.template) {\n            var elements = [].slice.call(form.elements);\n            for (var k = 0; k < elements.length; k++) {\n                if (((elements[parseInt(k.toString(), 10)].hasAttribute('name') && (elements[parseInt(k.toString(), 10)].className !== 'e-multi-hidden')) ||\n                    elements[parseInt(k.toString(), 10)].classList.contains('e-multiselect')) && !(elements[parseInt(k.toString(), 10)].type === 'hidden' &&\n                    (parentsUntil(elements[parseInt(k.toString(), 10)], 'e-switch-wrapper') || parentsUntil(elements[parseInt(k.toString(), 10)], 'e-checkbox-wrapper')))) {\n                    var field = (elements[parseInt(k.toString(), 10)].hasAttribute('name')) ? setComplexFieldID(elements[parseInt(k.toString(), 10)].getAttribute('name')) :\n                        setComplexFieldID(elements[parseInt(k.toString(), 10)].getAttribute('id'));\n                    var column = gObj.getColumnByField(field) || { field: field, type: elements[parseInt(k.toString(), 10)].getAttribute('type') };\n                    var value = void 0;\n                    if (column.type === 'checkbox' || column.type === 'boolean') {\n                        value = elements[parseInt(k.toString(), 10)].checked;\n                    }\n                    else if (elements[parseInt(k.toString(), 10)].value) {\n                        value = elements[parseInt(k.toString(), 10)].value;\n                        if (elements[parseInt(k.toString(), 10)].ej2_instances &&\n                            elements[parseInt(k.toString(), 10)].ej2_instances.length &&\n                            !isNullOrUndefined(elements[parseInt(k.toString(), 10)].ej2_instances[0].value)) {\n                            elements[parseInt(k.toString(), 10)].blur();\n                            value = elements[parseInt(k.toString(), 10)]\n                                .ej2_instances[0].value;\n                        }\n                    }\n                    else if (elements[parseInt(k.toString(), 10)].ej2_instances) {\n                        value = elements[parseInt(k.toString(), 10)]\n                            .ej2_instances[0].value;\n                    }\n                    if (column.edit && typeof column.edit.read === 'string') {\n                        value = getValue(column.edit.read, window)(elements[parseInt(k.toString(), 10)], value);\n                    }\n                    else if (column.edit && column.edit.read) {\n                        value = column.edit.read(elements[parseInt(k.toString(), 10)], value);\n                    }\n                    value = gObj.editModule.getValueFromType(column, value);\n                    if (elements[parseInt(k.toString(), 10)].type === 'radio') {\n                        if (elements[parseInt(k.toString(), 10)].checked) {\n                            DataUtil.setValue(column.field, value, editedData);\n                        }\n                    }\n                    else {\n                        if (typeof value === 'string') {\n                            this.parent.sanitize(value);\n                        }\n                        DataUtil.setValue(column.field, value, editedData);\n                    }\n                }\n            }\n            return editedData;\n        }\n        var col = gObj.columnModel.filter(function (col) { return col.editTemplate; });\n        for (var j = 0; j < col.length; j++) {\n            if (form[getComplexFieldID(col[parseInt(j.toString(), 10)].field)]) {\n                var inputElements = [].slice.call(form[getComplexFieldID(col[parseInt(j.toString(), 10)].field)])\n                    .filter(function (element) { return element.tagName.toLowerCase() === 'input'; });\n                inputElements = inputElements.length ? inputElements : [form[getComplexFieldID(col[parseInt(j.toString(), 10)].field)]];\n                var temp = inputElements.filter(function (e) {\n                    return !isNullOrUndefined((e.ej2_instances));\n                });\n                if (temp.length === 0) {\n                    temp = inputElements.filter(function (e) { return e.hasAttribute('name'); });\n                }\n                for (var k = 0; k < temp.length; k++) {\n                    var value = this.getValue(col[parseInt(j.toString(), 10)], temp[parseInt(k.toString(), 10)], editedData);\n                    if (col[parseInt(j.toString(), 10)].type === 'string') {\n                        value = this.parent.sanitize(value);\n                    }\n                    DataUtil.setValue(col[parseInt(j.toString(), 10)].field, value, editedData);\n                }\n            }\n        }\n        var inputs = [].slice.call(form.getElementsByClassName('e-field'));\n        for (var i = 0, len = inputs.length; i < len; i++) {\n            var col_1 = gObj.getColumnByUid(inputs[parseInt(i.toString(), 10)].getAttribute('e-mappinguid'));\n            if (col_1 && col_1.field) {\n                var value = this.getValue(col_1, inputs[parseInt(i.toString(), 10)], editedData);\n                if (col_1.type === 'string' && !(col_1.isForeignColumn() && typeof value !== 'string')) {\n                    value = this.parent.sanitize(value);\n                }\n                DataUtil.setValue(col_1.field, value, editedData);\n            }\n        }\n        return editedData;\n    };\n    Edit.prototype.getValue = function (col, input, editedData) {\n        var value = input.ej2_instances ?\n            input.ej2_instances[0].value : input.value;\n        var gObj = this.parent;\n        var temp = col.edit.read;\n        if (col.type === 'checkbox' || col.type === 'boolean') {\n            value = input.checked;\n        }\n        if (typeof temp === 'string') {\n            temp = getValue(temp, window);\n            value = gObj.editModule.getValueFromType(col, (temp)(input, value));\n        }\n        else {\n            value = gObj.editModule.getValueFromType(col, col.edit.read(input, value));\n        }\n        if (isNullOrUndefined(editedData[col.field]) && value === '') {\n            value = editedData[col.field];\n        }\n        return value;\n    };\n    /**\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.onActionBegin = function (e) {\n        if ((e.requestType === 'columnstate' || (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache\n            && e.requestType === 'sorting')) && this.parent.isEdit && this.parent.editSettings.mode !== 'Batch') {\n            this.closeEdit();\n        }\n        else {\n            var editRow = this.parent.element.querySelector('.' + literals.editedRow);\n            var addRow = this.parent.element.querySelector('.' + literals.addedRow);\n            if (editRow && this.parent.frozenRows && e.requestType === 'virtualscroll'\n                && parseInt(parentsUntil(editRow, literals.row).getAttribute(literals.ariaRowIndex), 10) - 1 < this.parent.frozenRows) {\n                return;\n            }\n            var restrictedRequestTypes = ['filterAfterOpen', 'filterBeforeOpen', 'filterchoicerequest', 'filterSearchBegin', 'save', 'infiniteScroll', 'virtualscroll'];\n            var isRestrict = restrictedRequestTypes.indexOf(e.requestType) === -1;\n            var isAddRows = !this.parent.editSettings.showAddNewRow || (this.parent.editSettings.showAddNewRow &&\n                !isNullOrUndefined(this.parent.element.querySelector('.e-editedrow')));\n            var isDestroyVirtualForm = (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.formObj\n                && isAddRows && !this.formObj.isDestroyed && (editRow || addRow || e.requestType === 'cancel') && isRestrict;\n            if ((!this.parent.enableVirtualization && isAddRows && this.parent.editSettings.mode !== 'Batch' && this.formObj && !this.formObj.isDestroyed\n                && isRestrict && !e.cancel) || isDestroyVirtualForm) {\n                this.destroyWidgets();\n                this.destroyForm();\n            }\n        }\n    };\n    /**\n     * @param {Column[]} cols - specfies the column\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.destroyWidgets = function (cols) {\n        var gObj = this.parent;\n        gObj.isWidgetsDestroyed = true;\n        if (gObj.editSettings.template) {\n            var parentIns = getParentIns(this.parent);\n            parentIns = parentIns.isReact ? parentIns : this.parent;\n            parentIns.destroyTemplate(['editSettingsTemplate']);\n            if (this.parent.isReact) {\n                this.parent.renderTemplates();\n            }\n        }\n        if (this.parent.editSettings.mode === 'Dialog' && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n            cols = [];\n            var allColumns = this.parent.getColumns();\n            for (var i = 0; i < allColumns.length; i++) {\n                var column = allColumns[parseInt(i.toString(), 10)];\n                if (column.visible || (this.parent.groupSettings.columns.indexOf(column.field) > -1)) {\n                    cols.push(column);\n                }\n            }\n        }\n        else {\n            cols = cols ? cols : this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization);\n        }\n        if (cols.some(function (column) { return !isNullOrUndefined(column.editTemplate); })) {\n            this.parent.destroyTemplate(['editTemplate']);\n            if (this.parent.isReact) {\n                this.parent.renderTemplates();\n            }\n        }\n        for (var _i = 0, cols_1 = cols; _i < cols_1.length; _i++) {\n            var col = cols_1[_i];\n            var temp = col.edit.destroy;\n            if (col.edit.destroy) {\n                if (typeof temp === 'string') {\n                    temp = getValue(temp, window);\n                    temp();\n                }\n                else {\n                    col.edit.destroy();\n                }\n            }\n        }\n        var elements = [].slice.call(this.formObj.element.elements);\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[parseInt(i.toString(), 10)];\n            if (element.hasAttribute('name')) {\n                var instanceElement = isNullOrUndefined(element.parentElement) ? null : element.parentElement.classList.contains('e-ddl') ?\n                    element.parentElement.querySelector('input') : element;\n                if (instanceElement && instanceElement.ej2_instances &&\n                    instanceElement.ej2_instances.length &&\n                    !instanceElement.ej2_instances[0].isDestroyed) {\n                    instanceElement.ej2_instances[0].destroy();\n                    instanceElement.remove();\n                }\n            }\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.destroyForm = function () {\n        this.destroyToolTip();\n        var formObjects = [this.formObj, this.virtualFormObj];\n        var col = this.parent.columnModel.filter(function (col) { return col.editTemplate; });\n        for (var i = 0; i < formObjects.length; i++) {\n            if (formObjects[parseInt(i.toString(), 10)] && formObjects[parseInt(i.toString(), 10)].element\n                && !formObjects[parseInt(i.toString(), 10)].isDestroyed) {\n                formObjects[parseInt(i.toString(), 10)].destroy();\n                var parentIns = getParentIns(this.parent);\n                if (parentIns.isReact && this.parent.editSettings.mode === 'Dialog'\n                    && (!isNullOrUndefined(this.parent.editSettings.template) || col.length)) {\n                    formObjects[parseInt(i.toString(), 10)].element.remove();\n                }\n            }\n        }\n        this.destroyToolTip();\n    };\n    /**\n     * To destroy the editing.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement) {\n            return;\n        }\n        var hasGridChild = gridElement.querySelector('.' + literals.gridHeader) &&\n            gridElement.querySelector('.' + literals.gridContent) ? true : false;\n        if (hasGridChild) {\n            this.destroyForm();\n        }\n        this.removeEventListener();\n        var elem = this.dialogObj.element;\n        if (elem.childElementCount > 0) {\n            this.dialogObj.destroy();\n            remove(elem);\n        }\n        elem = this.alertDObj.element;\n        if (elem.childElementCount > 0) {\n            this.alertDObj.destroy();\n            remove(elem);\n        }\n        if (!hasGridChild) {\n            return;\n        }\n        if (this.editModule) {\n            this.editModule.destroy();\n        }\n    };\n    Edit.prototype.keyPressHandler = function (e) {\n        var isMacLike = /(Mac)/i.test(navigator.platform);\n        if (isMacLike && e.metaKey && e.action === 'ctrlEnter') {\n            e.action = 'insert';\n        }\n        switch (e.action) {\n            case 'insert':\n                this.addRecord();\n                break;\n            case 'delete':\n                if ((e.target.tagName !== 'INPUT' || e.target.classList.contains('e-checkselect'))\n                    && !document.querySelector('.e-popup-open.e-edit-dialog')) {\n                    this.deleteRecord();\n                }\n                break;\n            case 'f2':\n                this.startEdit();\n                break;\n            case 'enter':\n                if (!parentsUntil(e.target, 'e-unboundcelldiv') && this.parent.editSettings.mode !== 'Batch' &&\n                    (parentsUntil(e.target, literals.gridContent) || ((this.parent.frozenRows ||\n                        (this.parent.editSettings.showAddNewRow && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)))\n                        && parentsUntil(e.target, literals.headerContent)))\n                    && (!document.getElementsByClassName('e-popup-open').length || (document.querySelectorAll('.e-popup-open .e-editcell').length &&\n                        !document.querySelectorAll('.e-popup-open:not(.e-dialog)').length))) {\n                    e.preventDefault();\n                    if (this.parent.isEdit) {\n                        this.parent.isFocusFirstCell = true;\n                    }\n                    this.endEdit();\n                }\n                break;\n            case 'escape':\n                if (this.parent.isEdit && !this.editCellDialogClose) {\n                    if (this.parent.editSettings.mode === 'Batch') {\n                        this.editModule.escapeCellEdit();\n                    }\n                    else {\n                        this.curretRowFocus(e);\n                    }\n                }\n                if (this.editCellDialogClose) {\n                    this.editCellDialogClose = false;\n                }\n                break;\n            case 'tab':\n            case 'shiftTab':\n                this.curretRowFocus(e);\n                break;\n        }\n    };\n    Edit.prototype.curretRowFocus = function (e) {\n        if (this.parent.isEdit && this.parent.editSettings.mode !== 'Batch') {\n            this.parent.isWidgetsDestroyed = false;\n            var editedRow = parentsUntil(e.target, 'e-editedrow') || parentsUntil(e.target, 'e-addedrow');\n            if (editedRow) {\n                var focusableEditCells = [].slice.call(editedRow.querySelectorAll('.e-input:not(.e-disabled)'));\n                var commandColCell = [].slice.call(editedRow.querySelectorAll('.e-unboundcell'));\n                if (commandColCell && commandColCell.length) {\n                    for (var i = 0; i < commandColCell.length; i++) {\n                        focusableEditCells = focusableEditCells.concat([].slice\n                            .call(commandColCell[parseInt(i.toString(), 10)].querySelectorAll('.e-btn:not(.e-hide)')));\n                    }\n                }\n                var rowCell = parentsUntil(e.target, 'e-rowcell');\n                rowCell = rowCell && rowCell.classList.contains('e-unboundcell') ? e.target : rowCell;\n                var lastCell = parentsUntil(focusableEditCells[focusableEditCells.length - 1], 'e-rowcell');\n                lastCell = lastCell && lastCell.classList.contains('e-unboundcell') ?\n                    focusableEditCells[focusableEditCells.length - 1] : lastCell;\n                if ((rowCell === lastCell && e.action === 'tab') || e.action === 'escape' ||\n                    (rowCell === parentsUntil(focusableEditCells[0], 'e-rowcell') && e.action === 'shiftTab' &&\n                        !this.parent.editSettings.showAddNewRow)) {\n                    var uid = editedRow.getAttribute('data-uid');\n                    var rows = this.parent.allowGrouping ? (!isNullOrUndefined(this.parent.getContent()) ?\n                        [].slice.call(this.parent.getContent().querySelectorAll('tr')) : []) : this.parent.getRows();\n                    var rowIndex = rows.map(function (m) { return m.getAttribute('data-uid'); }).indexOf(uid);\n                    if (this.parent.frozenRows) {\n                        if (parentsUntil(editedRow, 'e-gridheader')) {\n                            rowIndex = editedRow.rowIndex;\n                        }\n                        else if (parentsUntil(editedRow, 'e-gridcontent')) {\n                            rowIndex = rowIndex - this.parent.frozenRows;\n                        }\n                    }\n                    if (editedRow.classList.contains('e-addedrow')) {\n                        rowIndex = 0;\n                    }\n                    if (e.action === 'escape') {\n                        this.parent.isFocusFirstCell = true;\n                        this.closeEdit();\n                    }\n                    else {\n                        this.isShowAddedRowValidate = true;\n                        this.parent.selectionModule.preventFocus = false;\n                        this.parent.isFocusFirstCell = true;\n                        this.endEdit();\n                        this.isShowAddedRowValidate = false;\n                    }\n                    if (this.parent.focusModule.active && (!this.parent.editSettings.showAddNewRow ||\n                        editedRow.classList.contains('e-editedrow') || (this.parent.editSettings.showAddNewRow &&\n                        (editedRow.classList.contains('e-addedrow') && isNullOrUndefined(this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])')))))) {\n                        var firstCellIndex = 0;\n                        var matrix = this.parent.focusModule.active.matrix;\n                        if (matrix && matrix.matrix.length && matrix.matrix[parseInt(rowIndex.toString(), 10)]) {\n                            var rowMatrix = matrix.matrix[parseInt(rowIndex.toString(), 10)];\n                            for (var i = 0; i < rowMatrix.length; i++) {\n                                if (rowMatrix[parseInt(i.toString(), 10)] > 0) {\n                                    firstCellIndex = i;\n                                    break;\n                                }\n                            }\n                        }\n                        var firstCell = getValue(rowIndex + \".cells.\" + firstCellIndex, this.parent.focusModule.active.matrix.getRowsFromIndex(rowIndex, this.parent.focusModule.active));\n                        if (firstCell && firstCell.getBoundingClientRect().width === 0) {\n                            var firstContentCellIndex = this.parent.focusModule.active.matrix.nextVisibleCellFocus(rowIndex, firstCellIndex, e.action, this.parent.focusModule.active.keyActions[e.action], this.parent.focusModule.active, this.parent.focusModule.active.matrix.current[1]);\n                            firstCellIndex = firstContentCellIndex[1];\n                        }\n                        this.parent.focusModule.active.matrix.current = [rowIndex, firstCellIndex];\n                    }\n                }\n                if (this.parent.editSettings.showAddNewRow && e.action === 'tab' && parentsUntil(e.target, 'e-addedrow')) {\n                    this.isShowAddedRowValidate = true;\n                }\n            }\n        }\n    };\n    Edit.prototype.preventBatch = function (args) {\n        this.preventObj = args;\n        this.showDialog('BatchSaveLostChanges', this.dialogObj);\n    };\n    Edit.prototype.executeAction = function () {\n        this.preventObj.handler.call(this.preventObj.instance, this.preventObj.arg1, this.preventObj.arg2, this.preventObj.arg3, this.preventObj.arg4, this.preventObj.arg5, this.preventObj.arg6, this.preventObj.arg7, this.preventObj.arg8);\n    };\n    /**\n     * @param {Column[]} cols - specifies the column\n     * @param {Object} newRule - specifies the new rule object\n     * @returns {void}\n     * @hidden\n     */\n    Edit.prototype.applyFormValidation = function (cols, newRule) {\n        var gObj = this.parent;\n        var idx = 0;\n        var form = this.parent.editSettings.mode !== 'Dialog' ?\n            gObj.editSettings.showAddNewRow && gObj.element.querySelector('.' + literals.editedRow) ?\n                gObj.element.querySelector('.' + literals.editedRow).getElementsByClassName('e-gridform')[parseInt(idx.toString(), 10)] :\n                gObj.element.getElementsByClassName('e-gridform')[parseInt(idx.toString(), 10)] :\n            select('#' + gObj.element.id + '_dialogEdit_wrapper .e-gridform', document);\n        var index = 1;\n        var rules = {};\n        var mRules = {};\n        var frRules = {};\n        cols = cols ? cols : gObj.getColumns();\n        for (var i = 0; i < cols.length; i++) {\n            if (!cols[parseInt(i.toString(), 10)].visible && (gObj.editSettings.mode !== 'Dialog' || (gObj.groupSettings.columns.indexOf(cols[parseInt(i.toString(), 10)].field) === -1\n                && gObj.editSettings.mode === 'Dialog'))) {\n                continue;\n            }\n            if (cols[parseInt(i.toString(), 10)].validationRules && isNullOrUndefined(newRule)) {\n                setValidationRuels(cols[parseInt(i.toString(), 10)], index, rules, mRules, frRules, cols.length);\n            }\n        }\n        rules = extend(rules, mRules, frRules);\n        this.parent.editModule.formObj = this.createFormObj(form, newRule ? newRule : rules);\n    };\n    /**\n     * @param {HTMLFormElement} form - Defined Form element\n     * @param {Object} rules - Defines form rules\n     * @returns {FormValidator} Returns formvalidator instance\n     * @hidden\n     */\n    Edit.prototype.createFormObj = function (form, rules) {\n        var _this = this;\n        return new FormValidator(form, {\n            rules: rules,\n            locale: this.parent.locale,\n            validationComplete: function (args) {\n                _this.validationComplete(args);\n            },\n            customPlacement: function (inputElement, error) {\n                var uid = inputElement.getAttribute('e-mappinguid');\n                var args = {\n                    column: _this.parent.getColumnByUid(uid),\n                    error: error,\n                    inputElement: inputElement,\n                    value: inputElement.value\n                };\n                if ((!(event && event['relatedTarget'] && event['relatedTarget'].classList.contains('e-cancelbutton')) &&\n                    !_this.parent.editSettings.showAddNewRow) || (_this.parent.editSettings.showAddNewRow && event && event.target &&\n                    (parentsUntil(event.target, _this.parent.element.id + '_update', true) ||\n                        (parentsUntil(event.target, 'e-grid-menu') && (event.target.classList.contains('e-save') ||\n                            event.target.querySelector('.e-save'))) || _this.isShowAddedRowValidate ||\n                        (parentsUntil(event.target, 'e-unboundcell') && parentsUntil(event.target, 'e-update')) ||\n                        (event['action'] === 'enter' && (parentsUntil(event.target, 'e-content') || parentsUntil(event.target, 'e-addedrow'))))) ||\n                    (_this.parent.editSettings.showAddNewRow && !isNullOrUndefined(_this.parent.element.querySelector('.' + literals.editedRow)))) {\n                    _this.valErrorPlacement(inputElement, error);\n                }\n                _this.isShowAddedRowValidate = false;\n                _this.parent.notify(events.valCustomPlacement, args);\n            }\n        });\n    };\n    Edit.prototype.valErrorPlacement = function (inputElement, error) {\n        if (this.parent.isEdit) {\n            var id = error.getAttribute('for');\n            var elem = this.getElemTable(inputElement).querySelector('#' + getParsedFieldID(id) + '_Error');\n            if (!elem) {\n                this.createTooltip(inputElement, error, id, '');\n            }\n            else {\n                elem.querySelector('.e-tip-content').innerHTML = error.outerHTML;\n            }\n        }\n    };\n    Edit.prototype.getElemTable = function (inputElement) {\n        var isFrozenHdr;\n        var gObj = this.parent;\n        var table;\n        if (gObj.editSettings.mode !== 'Dialog') {\n            isFrozenHdr = (gObj.frozenRows && closest(inputElement, '.' + literals.row) && gObj.frozenRows\n                > (parseInt(closest(inputElement, '.' + literals.row).getAttribute(literals.ariaRowIndex), 10) - 1 || 0));\n            table = this.parent.isFrozenGrid() ? gObj.element : isFrozenHdr || (gObj.editSettings.showAddNewRow &&\n                (gObj.enableVirtualization || gObj.enableInfiniteScrolling)) ? gObj.getHeaderTable() : gObj.getContentTable();\n        }\n        else {\n            table = select('#' + gObj.element.id + '_dialogEdit_wrapper', document);\n        }\n        return table;\n    };\n    Edit.prototype.resetElemPosition = function (elem, args) {\n        var td = parentsUntil(args.element, literals.rowCell);\n        if (td) {\n            var tdRight = td.getBoundingClientRect().right;\n            var elemRight = elem.getBoundingClientRect().right;\n            if (elemRight > tdRight) {\n                var offSet = elemRight - tdRight;\n                elem.style.left = (elem.offsetLeft - offSet) + 'px';\n            }\n        }\n    };\n    Edit.prototype.validationComplete = function (args) {\n        if (this.parent.isEdit) {\n            var elem = this.getElemTable(args.element).querySelector('#' + getParsedFieldID(args.inputName) + '_Error');\n            if (this.parent.editSettings.showAddNewRow && !elem && args.element) {\n                var error = parentsUntil(args.element, 'e-rowcell').querySelector('.e-error');\n                if (error) {\n                    error.classList.remove('e-error');\n                }\n            }\n            if (elem) {\n                if (args.status === 'failure') {\n                    elem.style.display = '';\n                    this.resetElemPosition(elem, args);\n                }\n                else {\n                    elem.style.display = 'none';\n                }\n            }\n        }\n    };\n    Edit.prototype.createTooltip = function (element, error, name, display) {\n        var formObj = this.formObj.element;\n        var customForm = parentsUntil(element, 'e-virtual-validation');\n        if (customForm) {\n            formObj = this.virtualFormObj.element;\n        }\n        var gcontent = this.parent.getContent().firstElementChild;\n        var isScroll = gcontent.scrollHeight > gcontent.clientHeight || gcontent.scrollWidth > gcontent.clientWidth;\n        var isInline = this.parent.editSettings.mode !== 'Dialog';\n        var td = closest(element, '.' + literals.rowCell);\n        var row = closest(element, '.' + literals.row);\n        var isFHdr;\n        var isFHdrLastRow = false;\n        var validationForBottomRowPos;\n        var isBatchModeLastRow = false;\n        var isAddNewRow = this.parent.editSettings.showAddNewRow && !isNullOrUndefined(parentsUntil(element, literals.addedRow))\n            && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling);\n        var viewPortRowCount = Math.round(this.parent.getContent().clientHeight / this.parent.getRowHeight()) - 1;\n        var rows = [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n        if (this.parent.editSettings.mode === 'Batch') {\n            rows = [].slice.call(this.parent.getContent().querySelectorAll('.e-row:not(.e-hiddenrow)'));\n            if (viewPortRowCount > 1 && rows.length > viewPortRowCount && parseInt(rows[rows.length - 1].\n                getAttribute(literals.ariaRowIndex), 10) - 1 === parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1) {\n                isBatchModeLastRow = true;\n            }\n        }\n        if (isInline) {\n            if (this.parent.frozenRows || isAddNewRow) {\n                var headerRows = this.parent.editSettings.showAddNewRow ? '.e-row:not(.e-hiddenrow.e-addedrow)' :\n                    '.e-row:not(.e-hiddenrow)';\n                var fHearderRows = [].slice.call(this.parent.getHeaderTable().querySelector(literals.tbody).querySelectorAll(headerRows));\n                isFHdr = fHearderRows.length > (parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1 || 0);\n                isFHdrLastRow = isFHdr && parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1 === fHearderRows.length - 1;\n                var insertRow = [].slice.call(this.parent.getHeaderTable().querySelector(literals.tbody).querySelectorAll('.e-row:not(.e-hiddenrow)'));\n                if (insertRow.length === 1 && (insertRow[0].classList.contains('e-addedrow') || insertRow[0].classList.contains('e-insertedrow'))) {\n                    isFHdrLastRow = true;\n                }\n            }\n            if (isFHdrLastRow || (viewPortRowCount > 1 && rows.length > viewPortRowCount\n                && ((this.parent.editSettings.newRowPosition === 'Bottom' && (this.editModule.args\n                    && this.editModule.args.requestType === 'add')) || (td.classList.contains('e-lastrowcell')\n                    && !row.classList.contains(literals.addedRow)))) || isBatchModeLastRow) {\n                validationForBottomRowPos = true;\n            }\n        }\n        var table = isInline ?\n            (isFHdr ? this.parent.getHeaderTable() : this.parent.getContentTable()) :\n            select('#' + this.parent.element.id + '_dialogEdit_wrapper .e-dlg-content', document);\n        var client = table.getBoundingClientRect();\n        var left = isInline ?\n            this.parent.element.getBoundingClientRect().left : client.left;\n        var input = closest(element, 'td');\n        var inputClient = input ? input.getBoundingClientRect() : element.parentElement.getBoundingClientRect();\n        var div = this.parent.createElement('div', {\n            className: 'e-tooltip-wrap e-lib e-control e-popup e-griderror',\n            id: name + '_Error'\n        });\n        var divStyles = 'display:' + display + ';top:' +\n            ((isFHdr ? inputClient.top + inputClient.height : inputClient.bottom - client.top) + table.scrollTop + 9) + 'px;left:' +\n            (inputClient.left - left + table.scrollLeft + inputClient.width / 2) + 'px;' +\n            'max-width:' + inputClient.width + 'px;text-align:center;';\n        updateCSSText(div, divStyles);\n        if (this.parent.cssClass) {\n            div.classList.add(this.parent.cssClass);\n        }\n        if (isInline && client.left < left) {\n            div.style.left = parseInt(div.style.left, 10) - client.left + left + 'px';\n        }\n        var content = this.parent.createElement('div', { className: 'e-tip-content' });\n        content.appendChild(error);\n        var arrow;\n        if (validationForBottomRowPos) {\n            arrow = this.parent.createElement('div', { className: 'e-arrow-tip e-tip-bottom' });\n            arrow.appendChild(this.parent.createElement('div', { className: 'e-arrow-tip-outer e-tip-bottom' }));\n            arrow.appendChild(this.parent.createElement('div', { className: 'e-arrow-tip-inner e-tip-bottom' }));\n        }\n        else {\n            arrow = this.parent.createElement('div', { className: 'e-arrow-tip e-tip-top' });\n            arrow.appendChild(this.parent.createElement('div', { className: 'e-arrow-tip-outer e-tip-top' }));\n            arrow.appendChild(this.parent.createElement('div', { className: 'e-arrow-tip-inner e-tip-top' }));\n        }\n        div.appendChild(content);\n        div.appendChild(arrow);\n        if (!customForm && (this.parent.frozenRows || isAddNewRow) && this.parent.editSettings.mode !== 'Dialog') {\n            var getEditCell = this.parent.editSettings.mode === 'Normal' ?\n                closest(element, '.e-editcell') : closest(element, '.' + literals.table);\n            getEditCell.style.position = 'relative';\n            div.style.position = 'absolute';\n            if (this.parent.editSettings.mode === 'Batch' ||\n                (closest(element, '.' + literals.frozenContent) || closest(element, '.' + literals.frozenHeader))\n                || (this.parent.frozenRows || isAddNewRow)) {\n                if (this.parent.isFrozenGrid()) {\n                    if (td.classList.contains('e-unfreeze')) {\n                        addClass([div], 'e-unfreeze');\n                        formObj.appendChild(div);\n                    }\n                    else {\n                        var elem = closest(td, '.e-gridheader') ? this.parent.element.querySelector('.e-gridheader') :\n                            rows.length === 1 ? this.parent.element.querySelector('.e-gridcontent').querySelector('.e-content') :\n                                this.parent.element.querySelector('.e-gridcontent');\n                        elem.appendChild(div);\n                        elem.style.position = 'relative';\n                    }\n                }\n                else {\n                    formObj.appendChild(div);\n                }\n            }\n        }\n        else {\n            if (customForm) {\n                this.virtualFormObj.element.appendChild(div);\n            }\n            else {\n                if (this.parent.editSettings.mode !== 'Dialog' && this.parent.isFrozenGrid()) {\n                    if (td.classList.contains('e-unfreeze')) {\n                        addClass([div], 'e-unfreeze');\n                        this.formObj.element.appendChild(div);\n                    }\n                    else {\n                        var elem = closest(td, '.e-gridheader') ? this.parent.element.querySelector('.e-gridheader') :\n                            rows.length === 1 ? this.parent.element.querySelector('.e-gridcontent').querySelector('.e-content') :\n                                this.parent.element.querySelector('.e-gridcontent');\n                        elem.appendChild(div);\n                        elem.style.position = 'relative';\n                    }\n                }\n                else {\n                    this.formObj.element.appendChild(div);\n                }\n            }\n        }\n        if (!isNullOrUndefined(td)) {\n            if (td.classList.contains('e-fixedfreeze')) {\n                div.classList.add('e-fixederror');\n            }\n            else if (td.classList.contains('e-leftfreeze') || td.classList.contains('e-rightfreeze')) {\n                div.classList.add('e-freezeerror');\n            }\n        }\n        if (!validationForBottomRowPos && isInline && gcontent.getBoundingClientRect().bottom < inputClient.bottom + inputClient.height) {\n            var contentDiv = this.parent.getContent().querySelector('.e-content');\n            if (this.parent.currentViewData.length === 0 && contentDiv.scrollTop === 0) {\n                contentDiv.scrollTop = div.offsetHeight + arrow.scrollHeight;\n            }\n            else {\n                gcontent.scrollTop = gcontent.scrollTop + div.offsetHeight + arrow.scrollHeight;\n            }\n        }\n        var lineHeight = parseInt(document.defaultView.getComputedStyle(div, null).getPropertyValue('font-size'), 10);\n        if ((this.parent.frozenRows || isAddNewRow) && this.parent.editSettings.mode !== 'Dialog') {\n            div.style.left = input.offsetLeft + (input.offsetWidth / 2 - div.offsetWidth / 2) + 'px';\n        }\n        else {\n            div.style.left = (parseInt(div.style.left, 10) - div.offsetWidth / 2) + 'px';\n        }\n        if (div.getBoundingClientRect().width < inputClient.width &&\n            div.querySelector('label').getBoundingClientRect().height / (lineHeight * 1.2) >= 2) {\n            div.style.width = div.style.maxWidth;\n        }\n        if (isInline && !isScroll && !this.parent.allowPaging || (this.parent.frozenRows || isAddNewRow)) {\n            // gcontent.style.position = 'static';\n            var pos = calculateRelativeBasedPosition(input, div);\n            div.style.top = pos.top + inputClient.height + 9 + 'px';\n        }\n        if (validationForBottomRowPos) {\n            if (isScroll && this.parent.height !== 'auto' && (!this.parent.frozenRows || !isAddNewRow)\n                && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling && !(div.classList.contains('e-freezeerror')\n                && div.classList.contains('e-fixederror'))) {\n                var scrollWidth = gcontent.scrollWidth > gcontent.offsetWidth ? getScrollBarWidth() : 0;\n                var gHeight = this.parent.height.toString().indexOf('%') === -1 ?\n                    parseInt(this.parent.height, 10) : gcontent.offsetHeight;\n                div.style.bottom = (gHeight - gcontent.querySelector('table').offsetHeight\n                    - scrollWidth) + inputClient.height + 9 + 'px';\n            }\n            else {\n                div.style.bottom = inputClient.height + 9 + 'px';\n            }\n            if (rows.length < viewPortRowCount && this.parent.editSettings.newRowPosition === 'Bottom' && (this.editModule.args\n                && this.editModule.args.requestType === 'add')) {\n                var rowsCount = this.parent.frozenRows ? (isAddNewRow ? this.parent.frozenRows + 1 : this.parent.frozenRows) +\n                    (rows.length - 1) : rows.length - 1;\n                var rowsHeight = rowsCount * this.parent.getRowHeight();\n                var position = this.parent.getContent().clientHeight - rowsHeight;\n                div.style.bottom = position + 9 + 'px';\n            }\n            div.style.top = null;\n        }\n    };\n    /**\n     * @param {Column} col - specfies the column\n     * @returns {boolean} returns the whether column is grouped\n     * @hidden\n     */\n    Edit.prototype.checkColumnIsGrouped = function (col) {\n        return !col.visible && !(this.parent.groupSettings.columns.indexOf(col.field) > -1);\n    };\n    /**\n     * @param {object} editors -specfies the editors\n     * @returns {void}\n     * @hidden\n     */\n    Edit.AddEditors = function (editors) {\n        Edit.editCellType = extend(Edit.editCellType, editors);\n    };\n    Edit.editCellType = {\n        'dropdownedit': DropDownEditCell, 'numericedit': NumericEditCell,\n        'datepickeredit': DatePickerEditCell, 'datetimepickeredit': DatePickerEditCell,\n        'booleanedit': BooleanEditCell, 'defaultedit': DefaultEditCell,\n        'templateedit': TemplateEditCell\n    };\n    return Edit;\n}());\nexport { Edit };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}