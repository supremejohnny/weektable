{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nimport { EventHandler, getValue, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, extend, Browser } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport * as event from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowModelGenerator } from './row-model-generator';\nimport { parentsUntil, addRemoveEventListener, findCellIndex } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * FocusStrategy class\n *\n * @hidden\n */\nvar FocusStrategy = /** @class */function () {\n  function FocusStrategy(parent) {\n    this.currentInfo = {};\n    this.oneTime = true;\n    this.swap = {};\n    /** @hidden */\n    this.isInfiniteScroll = false;\n    /** @hidden */\n    this.virtualSelectionInfo = {};\n    this.forget = false;\n    this.skipFocus = true;\n    this.focusByClick = false;\n    this.firstHeaderCellClick = false;\n    /** @hidden */\n    this.prevIndexes = {};\n    this.refMatrix = this.refreshMatrix(true);\n    this.actions = ['downArrow', 'upArrow'];\n    this.isVirtualScroll = false;\n    this.groupedFrozenRow = 0;\n    this.parent = parent;\n    this.rowModelGen = new RowModelGenerator(this.parent);\n    this.addEventListener();\n  }\n  FocusStrategy.prototype.focusCheck = function (e) {\n    var target = e.target;\n    this.focusByClick = true;\n    this.firstHeaderCellClick = true;\n    this.skipFocus = target.classList.contains('e-grid');\n  };\n  FocusStrategy.prototype.onFocus = function (e) {\n    if (this.parent.isDestroyed || Browser.isDevice || this.parent.enableVirtualization || this.parent.element.querySelector('.e-masked-table') || !this.parent.isInitialLoad && e && e.target === this.parent.element && this.parent.element.querySelector('.e-spin-show')) {\n      return;\n    }\n    this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0);\n    if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length && (this.parent.editSettings.mode !== 'Batch' || this.parent.editSettings.mode === 'Batch' && this.parent.editModule && !this.parent.editModule.getBatchChanges()[literals.addedRecords].length)) {\n      this.getContent().matrix.generate(this.rowModelGen.generateRows({\n        rows: [new Row({\n          isDataRow: true\n        })]\n      }), this.getContent().selector, false);\n    }\n    var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator(), this.active);\n    this.getContent().matrix.select(current[0], current[1]);\n    if (this.skipFocus && !(e && e.target === this.parent.element)) {\n      this.focus(e);\n      this.skipFocus = false;\n    }\n  };\n  FocusStrategy.prototype.passiveFocus = function (e) {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    var firstHeaderCell = this.parent.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n    if (e.target === firstHeaderCell && e.relatedTarget && !parentsUntil(e.relatedTarget, 'e-grid') && !this.firstHeaderCellClick) {\n      var firstHeaderCellIndex = [0, 0];\n      if (this.active.matrix.matrix[firstHeaderCellIndex[0]][firstHeaderCellIndex[1]] === 0) {\n        firstHeaderCellIndex = findCellIndex(this.active.matrix.matrix, firstHeaderCellIndex, true);\n      }\n      this.active.matrix.current = firstHeaderCellIndex;\n      this.currentInfo.element = e.target;\n      this.currentInfo.elementToFocus = e.target;\n      if (this.currentInfo.element.querySelector('.e-checkselectall')) {\n        this.removeFocus();\n        this.addFocus(this.getContent().getFocusInfo(), e);\n      } else {\n        addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n      }\n    }\n    this.firstHeaderCellClick = false;\n    if (e.target && e.target.classList.contains('e-detailcell')) {\n      this.currentInfo.skipAction = false;\n      addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n    }\n  };\n  FocusStrategy.prototype.onBlur = function (e) {\n    if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n      this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').removeAttribute('aria-hidden');\n    }\n    // The below boolean condition for gantt team focus fix.\n    var isGantt = parentsUntil(e.target, 'e-gantt') && e.target.classList.contains('e-rowcell') && !isNullOrUndefined(e.target.nextElementSibling) && e.target.nextElementSibling.classList.contains('e-rowcell') ? true : false;\n    if ((this.parent.isEdit || e && (!e.relatedTarget || closest(e.relatedTarget, '.e-grid') || closest(e.relatedTarget, '.e-grid-popup')) && !(this.parent.element.classList.contains('e-childgrid') && !this.parent.element.matches(':focus-within'))) && !(!isGantt && isNullOrUndefined(e.relatedTarget) && parseInt(e.target.getAttribute('aria-colindex'), 10) - 1 === 0 && parseInt(e.target.getAttribute('index'), 10) === 0) && !(!isGantt && isNullOrUndefined(e.relatedTarget) && !closest(document.activeElement, '.e-grid') && !isNullOrUndefined(e['sourceCapabilities']))) {\n      return;\n    }\n    this.removeFocus();\n    this.skipFocus = true;\n    this.currentInfo.skipAction = false;\n    this.setLastContentCellTabIndex();\n    this.setFirstFocusableTabIndex();\n    this.firstHeaderCellClick = false;\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n  FocusStrategy.prototype.setFirstFocusableTabIndex = function () {\n    var gObj = this.parent;\n    gObj.element.tabIndex = -1;\n    if (gObj.allowGrouping && gObj.groupSettings.showDropArea) {\n      var groupModule = gObj.groupModule;\n      var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n      if (focusableGroupedItems.length > 0) {\n        groupModule.element.tabIndex = -1;\n        focusableGroupedItems[0].tabIndex = 0;\n      } else {\n        groupModule.element.tabIndex = 0;\n      }\n      return;\n    }\n    if (gObj.toolbar || gObj.toolbarTemplate) {\n      var toolbarElement = gObj.toolbarModule.element;\n      var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n      if (focusableToolbarItems.length > 0 && focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input')) {\n        toolbarElement.tabIndex = -1;\n        focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').tabIndex = 0;\n      } else {\n        toolbarElement.tabIndex = 0;\n      }\n      return;\n    }\n    if (gObj.getColumns().length) {\n      var firstHeaderCell = gObj.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n      firstHeaderCell.tabIndex = 0;\n      this.setActive(false);\n      if (!isNullOrUndefined(this.active) && (isNullOrUndefined(this.active.target) || !this.active.target.classList.contains('e-columnmenu'))) {\n        var firstHeaderCellIndex = [0, 0];\n        if (this.active.matrix.matrix[firstHeaderCellIndex[0]][firstHeaderCellIndex[1]] === 0) {\n          firstHeaderCellIndex = findCellIndex(this.active.matrix.matrix, firstHeaderCellIndex, true);\n        }\n        this.active.matrix.current = firstHeaderCellIndex;\n      }\n      return;\n    }\n  };\n  FocusStrategy.prototype.setLastContentCellTabIndex = function () {\n    var contentTable = this.parent.getContentTable();\n    if (contentTable.rows[contentTable.rows.length - 1]) {\n      var lastCell = contentTable.rows[contentTable.rows.length - 1].lastElementChild;\n      lastCell.tabIndex = 0;\n    }\n  };\n  FocusStrategy.prototype.onClick = function (e, force, isFocusFirstCell) {\n    if (parentsUntil(e.target, 'e-filterbarcell') && (parentsUntil(e.target, 'e-multiselect') || e.target.classList.contains('e-input-group-icon'))) {\n      return;\n    }\n    var isContent = !isNullOrUndefined(closest(e.target, '.' + literals.gridContent));\n    var isHeader = !isNullOrUndefined(closest(e.target, '.' + literals.gridHeader));\n    isContent = isContent && isHeader ? !isContent : isContent;\n    if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader)) || e.target.classList.contains(literals.content) || e.target.classList.contains(literals.headerContent) || !isNullOrUndefined(closest(e.target, '.e-unboundcell')) && !force) {\n      return;\n    }\n    this.setActive(isContent);\n    var beforeArgs = {\n      cancel: false,\n      byKey: false,\n      byClick: !isNullOrUndefined(e.target),\n      clickArgs: e\n    };\n    this.parent.notify(event.beforeCellFocused, beforeArgs);\n    if (beforeArgs.cancel || closest(e.target, '.e-inline-edit') && !this.parent.editSettings.showAddNewRow && this.parent.editSettings.showAddNewRow && !this.parent.element.querySelector('.e-editedrow')) {\n      return;\n    }\n    this.setActive(isContent);\n    if (this.getContent()) {\n      var returnVal = this.getContent().onClick(e, force);\n      if (returnVal === false) {\n        return;\n      }\n      this.focus();\n      if (this.currentInfo.element.classList.contains('e-rowcell') && e.type && e.type === 'click' && !isFocusFirstCell) {\n        addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n      }\n      if (isFocusFirstCell && e && e.target) {\n        addClass([e.target], ['e-focused', 'e-focus']);\n      }\n    }\n  };\n  FocusStrategy.prototype.handleFilterNavigation = function (e, inputSelector, buttonSelector) {\n    if (e.target === document.querySelector(inputSelector) && e.key === 'Tab' && e.shiftKey) {\n      e.preventDefault();\n      document.querySelector(buttonSelector).focus();\n    } else if (e.target === document.querySelector(buttonSelector) && e.key === 'Tab' && !e.shiftKey && document.activeElement === document.querySelector(buttonSelector)) {\n      e.preventDefault();\n      document.querySelector(inputSelector).focus();\n    }\n  };\n  FocusStrategy.prototype.onKeyPress = function (e) {\n    if (this.content && this.content.target) {\n      this.content.target = null;\n    }\n    if (this.parent.allowPaging) {\n      var pagerElement = this.parent.pagerModule.pagerObj.element;\n      var focusablePagerElements = this.parent.pagerModule.pagerObj.getFocusablePagerElements(pagerElement, []);\n      if (this.parent.childGrid && !parentsUntil(e.target, 'e-gridpager') && this.allowToPaging(e) && focusablePagerElements.length) {\n        focusablePagerElements[0].tabIndex = 0;\n      }\n      if (this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n        if (e.action === 'shiftTab' && focusablePagerElements.length && focusablePagerElements[0] === e.target) {\n          this.setActive(true);\n          var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1, this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n          if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n            lastHeaderCellIndex = findCellIndex(this.active.matrix.matrix, lastHeaderCellIndex, false);\n          }\n          this.active.matrix.current = this.parent.editSettings.mode === 'Batch' ? this.isValidBatchEditCell(lastHeaderCellIndex) ? lastHeaderCellIndex : this.findBatchEditCell(lastHeaderCellIndex, false) : lastHeaderCellIndex;\n          e.preventDefault();\n          this.focus(e);\n          return;\n        }\n        if (!(e.action === 'tab' && this.parent.element.classList.contains('e-childgrid') && (!this.parent.pageSettings.pageSizes && focusablePagerElements.length && focusablePagerElements[focusablePagerElements.length - 1] === e.target || this.parent.pagerModule.pagerObj.getDropDownPage() === e.target))) {\n          this.parent.pagerModule.pagerObj.changePagerFocus(e);\n          return;\n        } else {\n          var parentCell = parentsUntil(this.parent.element, 'e-detailcell');\n          removeClass([this.parent.element], ['e-focus']);\n          removeClass([parentCell], ['e-focused']);\n          parentCell.tabIndex = -1;\n        }\n      }\n      if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && (e.keyCode === 38 || e.shiftKey && e.keyCode === 9)) {\n        e.preventDefault();\n        this.focus(e);\n        return;\n      } else if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && e.keyCode === 9) {\n        e.preventDefault();\n        this.parent.pagerModule.pagerObj.setPagerFocus();\n        return;\n      }\n      if (this.parent.pagerModule.pagerObj.checkFirstPagerFocus()) {\n        var lastRow = this.getContent().matrix.rows;\n        var lastColumn = this.getContent().matrix.columns;\n        this.getContent().matrix.current = [lastRow, lastColumn];\n      }\n    }\n    if (this.parent.filterSettings.type === 'Excel') {\n      this.handleFilterNavigation(e, '.e-excelfilter .e-menu-item:not(.e-disabled)', '.e-excelfilter .e-footer-content button:nth-child(2)');\n    }\n    if (this.parent.filterSettings.type === 'CheckBox') {\n      var focusedColumn = this.parent.getColumnByUid(this.focusedColumnUid);\n      var focusTarget = focusedColumn && focusedColumn.filter && focusedColumn.filter.hideSearchbox ? '.e-chk-hidden' : '.e-searchinput.e-input';\n      this.handleFilterNavigation(e, focusTarget, '.e-checkboxfilter .e-footer-content button:nth-child(2)');\n    }\n    if (this.parent.filterSettings.type === 'Menu') {\n      this.handleFilterNavigation(e, '.e-flmenu .e-input-group.e-popup-flmenu', '.e-flmenu .e-footer-content button:nth-child(2)');\n    }\n    if (this.parent.showColumnChooser) {\n      this.handleFilterNavigation(e, '.e-ccdlg .e-ccsearch.e-cc.e-input', '.e-ccdlg .e-footer-content button:nth-child(2)');\n    }\n    if (this.skipOn(e)) {\n      return;\n    }\n    if (e.target && parentsUntil(e.target, 'e-gridcontent')) {\n      var rows = [].slice.call(this.parent.getContentTable().rows);\n      var lastCell = rows[rows.length - 1].lastElementChild;\n      if (e.target === lastCell) {\n        this.setActive(true);\n        this.setLastContentCellActive();\n      }\n    }\n    if (e.action === 'shiftTab' && e.target && (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar') || parentsUntil(e.target, 'e-groupdroparea'))) {\n      if (e.target === this.parent.element) {\n        if (this.parent.element.classList.contains('e-childgrid')) {\n          this.focusOutFromChildGrid(e);\n        }\n        return;\n      }\n      if (parentsUntil(e.target, 'e-groupdroparea')) {\n        if (this.parent.element.classList.contains('e-childgrid')) {\n          e.preventDefault();\n          this.parent.element.focus();\n        }\n        return;\n      }\n      if (parentsUntil(e.target, 'e-toolbar')) {\n        if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea) {\n          var groupModule = this.parent.groupModule;\n          var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n          e.preventDefault();\n          if (focusableGroupedItems.length > 0) {\n            focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n          } else {\n            groupModule.element.focus();\n          }\n        } else if (this.parent.element.classList.contains('e-childgrid')) {\n          e.preventDefault();\n          this.parent.element.focus();\n        }\n        return;\n      }\n    }\n    var focusFirstHeaderCell = false;\n    if (e.action === 'tab' && e.target && (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar') || parentsUntil(e.target, 'e-groupdroparea'))) {\n      if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea && (e.target === this.parent.element || e.target.classList.contains('e-groupdroparea'))) {\n        var groupModule = this.parent.groupModule;\n        var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n        if (focusableGroupedItems.length > 0) {\n          e.preventDefault();\n          focusableGroupedItems[0].focus();\n          return;\n        }\n        if (!e.target.classList.contains('e-groupdroparea')) {\n          e.preventDefault();\n          groupModule.element.focus();\n          return;\n        }\n      }\n      if ((this.parent.toolbar || this.parent.toolbarTemplate) && (e.target === this.parent.element || parentsUntil(e.target, 'e-groupdroparea') || e.target.classList.contains('e-toolbar'))) {\n        var toolbarElement = this.parent.toolbarModule.element;\n        var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n        if (focusableToolbarItems.length > 0) {\n          e.preventDefault();\n          focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').focus();\n          return;\n        }\n        if (!e.target.classList.contains('e-toolbar')) {\n          e.preventDefault();\n          toolbarElement.focus();\n          return;\n        }\n      }\n      if (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar') || parentsUntil(e.target, 'e-groupdroparea')) {\n        focusFirstHeaderCell = true;\n      }\n    }\n    if (focusFirstHeaderCell) {\n      if (this.parent.allowGrouping && !isNullOrUndefined(this.parent.groupSettings.columns) && this.parent.groupSettings.columns.length === this.parent.columns.length) {\n        this.setActive(true);\n      } else {\n        this.setActive(false);\n      }\n      this.active.matrix.current = [0, -1];\n    }\n    this.activeKey = e.action;\n    var beforeArgs = {\n      cancel: false,\n      byKey: true,\n      byClick: false,\n      keyArgs: e\n    };\n    this.parent.notify(event.beforeCellFocused, beforeArgs);\n    if (beforeArgs.cancel) {\n      return;\n    }\n    var bValue = this.getContent().matrix.current;\n    var prevBatchValue = this.active && this.active.matrix.current ? [this.active.matrix.current[0], this.active.matrix.current[1]] : undefined;\n    this.currentInfo.outline = true;\n    var swapInfo = this.getContent().jump(e.action, bValue);\n    this.swap = swapInfo;\n    if (swapInfo.swap && !(this.parent.editSettings.mode === 'Batch' && (e.action === 'tab' || e.action === 'shiftTab'))) {\n      this.setActive(!swapInfo.toHeader);\n      this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n      this.prevIndexes = {};\n    }\n    this.setActiveByKey(e.action, this.getContent());\n    var returnVal = this.content.lastIdxCell ? false : this.getContent().onKeyPress(e);\n    if (e.target && parentsUntil(e.target, 'e-gridheader')) {\n      if (e.action === 'tab' && bValue.toString() === this.active.matrix.current.toString()) {\n        var nextHeaderCellIndex = findCellIndex(this.active.matrix.matrix, this.active.matrix.current, true);\n        var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1, this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n        if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n          lastHeaderCellIndex = findCellIndex(this.active.matrix.matrix, lastHeaderCellIndex, false);\n        }\n        var nextCell = getValue(nextHeaderCellIndex[0] + \".cells.\" + nextHeaderCellIndex[1], this.active.matrix.getRowsFromIndex(nextHeaderCellIndex[0], this.active));\n        if (nextCell && nextCell.getBoundingClientRect().width === 0 && this.active.matrix.matrix.length - 1 === nextHeaderCellIndex[0]) {\n          lastHeaderCellIndex = this.active.matrix.nextVisibleCellFocus(nextHeaderCellIndex[0], nextHeaderCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n        }\n        if (this.active.matrix.current.toString() === lastHeaderCellIndex.toString() && this.content.matrix.matrix.length) {\n          returnVal = true;\n          this.setActive(true);\n          var firstContentCellIndex = [0, 0];\n          if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n            this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').setAttribute('aria-hidden', 'true');\n          }\n          if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n            firstContentCellIndex = findCellIndex(this.active.matrix.matrix, [0, 0], true);\n          }\n          var firstCell = getValue(firstContentCellIndex[0] + \".cells.\" + firstContentCellIndex[1], this.active.matrix.getRowsFromIndex(firstContentCellIndex[0], this.active));\n          if (firstCell && firstCell.getBoundingClientRect().width === 0) {\n            firstContentCellIndex = this.active.matrix.nextVisibleCellFocus(firstContentCellIndex[0], firstContentCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n          }\n          this.active.matrix.current = this.parent.editSettings.mode === 'Batch' ? this.isValidBatchEditCell(firstContentCellIndex) ? firstContentCellIndex : this.findBatchEditCell(firstContentCellIndex, true) : firstContentCellIndex;\n          if (this.parent.enableVirtualization && !this.parent.enableColumnVirtualization && this.parent.contentModule.prevInfo.blockIndexes[0] !== 1) {\n            e.preventDefault();\n            this.removeFocus();\n            var virtual = this.parent.contentModule;\n            virtual.firstCellFocus = true;\n            virtual.content.scrollTop = 0;\n            return;\n          }\n        } else if (this.active.matrix.current.toString() !== nextHeaderCellIndex.toString()) {\n          this.active.matrix.current = nextHeaderCellIndex;\n        }\n      }\n      if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n        var previousCellIndex = findCellIndex(this.active.matrix.matrix, this.active.matrix.current, false);\n        var prevCell = getValue(previousCellIndex[0] + \".cells.\" + previousCellIndex[1], this.active.matrix.getRowsFromIndex(previousCellIndex[0], this.active));\n        if (prevCell && prevCell.getBoundingClientRect().width === 0 && previousCellIndex[0] === 0) {\n          previousCellIndex = this.active.matrix.nextVisibleCellFocus(previousCellIndex[0], previousCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n        }\n        if (previousCellIndex.toString() === this.active.matrix.current.toString()) {\n          this.focusOutFromHeader(e);\n          return;\n        }\n        if (this.active.matrix.current.toString() !== previousCellIndex.toString() && !returnVal) {\n          returnVal = true;\n          var prevCell_1 = getValue(previousCellIndex[0] + \".cells.\" + previousCellIndex[1], this.active.matrix.getRowsFromIndex(previousCellIndex[0], this.active));\n          if (prevCell_1 && prevCell_1.getBoundingClientRect().width === 0 && previousCellIndex[0] === 0) {\n            previousCellIndex = this.active.matrix.nextVisibleCellFocus(previousCellIndex[0], previousCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n          }\n          this.active.matrix.current = previousCellIndex;\n        }\n      }\n    }\n    if (e.target && parentsUntil(e.target, 'e-gridcontent')) {\n      if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n        this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').removeAttribute('aria-hidden');\n      }\n      if (this.parent.editSettings.mode === 'Batch' && (e.action === 'tab' || e.action === 'shiftTab')) {\n        this.active.matrix.current = this.findBatchEditCell(prevBatchValue, e.action === 'tab' ? true : false);\n        if (e.action === 'tab' && prevBatchValue.toString() === this.active.matrix.current.toString()) {\n          this.parent.editModule.editModule.addBatchRow = true;\n        }\n      }\n      if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n        if (this.parent.allowGrouping && !isNullOrUndefined(this.parent.groupSettings.columns) && this.parent.groupSettings.columns.length === this.parent.columns.length) {\n          this.focusOutFromHeader(e);\n          return;\n        }\n        var firstContentCellIndex = [0, 0];\n        if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n          firstContentCellIndex = findCellIndex(this.active.matrix.matrix, [0, 0], true);\n        }\n        var firstCell = getValue(firstContentCellIndex[0] + \".cells.\" + firstContentCellIndex[1], this.active.matrix.getRowsFromIndex(firstContentCellIndex[0], this.active));\n        if (firstCell && firstCell.getBoundingClientRect().width === 0) {\n          firstContentCellIndex = this.active.matrix.nextVisibleCellFocus(firstContentCellIndex[0], firstContentCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n        }\n        if (!returnVal && (firstContentCellIndex.toString() === this.active.matrix.current.toString() || this.parent.editSettings.mode === 'Batch' && prevBatchValue.toString() === this.active.matrix.current.toString())) {\n          returnVal = true;\n          this.setActive(false);\n          this.setLastContentCellActive();\n        }\n      }\n    }\n    if (returnVal === false) {\n      this.clearIndicator();\n      if (e.action === 'shiftTab' && bValue.toString() === [0, 0].toString()) {\n        this.parent.element.tabIndex = -1;\n      }\n      if (this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus() && this.allowToPaging(e) && bValue.toString() !== [0, 0].toString()) {\n        e.preventDefault();\n        if (e.keyCode === 40) {\n          this.parent.pagerModule.pagerObj.setPagerContainerFocus();\n          return;\n        } else if (e.keyCode === 9) {\n          this.parent.pagerModule.pagerObj.setPagerFocus();\n          return;\n        }\n      }\n      if (this.parent.element.classList.contains('e-childgrid')) {\n        this.focusOutFromChildGrid(e);\n      }\n      return;\n    }\n    this.header.action = e.action;\n    this.header.currentTarget = null;\n    this.header.focusType = 'key';\n    if (e.target && parentsUntil(e.target, 'e-fltrtemp') && (e.action === 'tab' || e.action === 'shiftTab')) {\n      var target = e.target;\n      var focusElement = [].slice.call(closest(target, 'th').querySelectorAll('.e-fltrtemp-focus'));\n      if (focusElement.length) {\n        var elementIndex = focusElement.indexOf(target);\n        var resetActive = e.action === 'tab' && elementIndex < focusElement.length - 1 || e.action === 'shiftTab' && elementIndex > 0 ? true : false;\n        if (resetActive) {\n          this.setActive(false);\n          this.active.matrix.current = bValue;\n          this.active.currentTarget = target;\n        }\n      }\n    }\n    if (focusFirstHeaderCell && parentsUntil(this.active.getTable(), 'e-gridheader') && e.target && e.target.id === this.parent.element.id + '_searchbar') {\n      this.parent.searchModule.headerFocus = true;\n    }\n    e.preventDefault();\n    this.focus(e);\n  };\n  FocusStrategy.prototype.isValidBatchEditCell = function (cellIndex) {\n    var cell = this.active.getTable().rows[cellIndex[0]].cells[cellIndex[1]];\n    var tr = closest(cell, 'tr');\n    var cellColIndex = parseInt(cell.getAttribute('aria-colindex'), 10) - 1;\n    var cellCol = this.parent.getColumns()[parseInt(cellColIndex.toString(), 10)];\n    if (this.active.matrix.matrix[cellIndex[0]][cellIndex[1]] === 1 && (!tr.classList.contains('e-row') || (tr.classList.contains('e-insertedrow') || !cellCol.isPrimaryKey) && cellCol.allowEditing)) {\n      return true;\n    }\n    return false;\n  };\n  FocusStrategy.prototype.findBatchEditCell = function (currentCellIndex, next, limitRow) {\n    var cellIndex = currentCellIndex;\n    var tempCellIndex = currentCellIndex;\n    var cellIndexObtain = false;\n    while (!cellIndexObtain) {\n      var prevTempCellIndex = tempCellIndex;\n      tempCellIndex = findCellIndex(this.active.matrix.matrix, tempCellIndex, next);\n      var tempCell = getValue(tempCellIndex[0] + \".cells.\" + tempCellIndex[1], this.active.getTable().rows);\n      if (tempCell && tempCell.getBoundingClientRect().width === 0) {\n        tempCellIndex = this.active.matrix.nextVisibleCellFocus(tempCellIndex[0], tempCellIndex[1], this.activeKey, this.active.keyActions[this.activeKey], this.active, this.active.matrix.current[1]);\n      }\n      if (prevTempCellIndex.toString() === tempCellIndex.toString() || limitRow && prevTempCellIndex[0] !== tempCellIndex[0]) {\n        cellIndexObtain = true;\n        continue;\n      }\n      if (this.isValidBatchEditCell(tempCellIndex)) {\n        cellIndex = tempCellIndex;\n        cellIndexObtain = true;\n      }\n    }\n    return cellIndex;\n  };\n  FocusStrategy.prototype.setLastContentCellActive = function () {\n    var lastContentCellIndex = [this.active.matrix.matrix.length - 1, this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n    if (this.active.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n      lastContentCellIndex = findCellIndex(this.active.matrix.matrix, lastContentCellIndex, false);\n    }\n    var lastCell = getValue(lastContentCellIndex[0] + \".cells.\" + lastContentCellIndex[1], this.active.matrix.getRowsFromIndex(lastContentCellIndex[0], this.active));\n    if (lastCell && lastCell.getBoundingClientRect().width === 0) {\n      lastContentCellIndex = this.active.matrix.nextVisibleCellFocus(lastContentCellIndex[0], lastContentCellIndex[1], this.activeKey, this.active.keyActions[this.activeKey], this.active, this.active.matrix.current[1]);\n    }\n    this.active.matrix.current = lastContentCellIndex;\n  };\n  FocusStrategy.prototype.focusOutFromChildGrid = function (e) {\n    var parentTable = parentsUntil(this.parent.element, 'e-table');\n    var parentGrid = parentsUntil(parentTable, 'e-grid').ej2_instances[0];\n    var parentCell = parentsUntil(this.parent.element, 'e-detailcell');\n    var uid = parentsUntil(this.parent.element, 'e-detailrow').getAttribute('data-uid');\n    var parentRows = [].slice.call(parentGrid.getContentTable().rows);\n    var parentRowIndex = parentRows.map(function (m) {\n      return m.getAttribute('data-uid');\n    }).indexOf(uid);\n    if (e.action === 'tab' && parentRowIndex >= parentRows.length - 1) {\n      return;\n    }\n    removeClass([this.parent.element], ['e-focus']);\n    removeClass([parentCell], ['e-focused']);\n    parentCell.tabIndex = -1;\n    e.preventDefault();\n    var nextFocusCell;\n    parentGrid.focusModule.removeFocus();\n    if (e.action === 'shiftTab') {\n      var previousRow = parentRows[parentRowIndex - 1];\n      var rowCells = previousRow.cells;\n      for (var i = rowCells.length - 1; i >= 0; i--) {\n        nextFocusCell = rowCells[parseInt(i.toString(), 10)];\n        if (!nextFocusCell.classList.contains('e-hide')) {\n          parentGrid.focusModule.active.matrix.current = [parentRowIndex - 1, i];\n          break;\n        }\n      }\n    } else {\n      nextFocusCell = parentRows[parentRowIndex + 1].cells[0];\n      parentGrid.focusModule.active.matrix.current = [parentRowIndex + 1, 0];\n    }\n    parentGrid.focusModule.currentInfo.element = nextFocusCell;\n    parentGrid.focusModule.currentInfo.elementToFocus = nextFocusCell;\n    addClass([nextFocusCell], ['e-focused', 'e-focus']);\n    nextFocusCell.tabIndex = 0;\n    nextFocusCell.focus();\n  };\n  FocusStrategy.prototype.focusOutFromHeader = function (e) {\n    this.removeFocus();\n    if (this.parent.toolbar || this.parent.toolbarTemplate) {\n      var toolbarElement = this.parent.toolbarModule.element;\n      var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n      e.preventDefault();\n      if (focusableToolbarItems.length > 0) {\n        focusableToolbarItems[focusableToolbarItems.length - 1].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').focus();\n      } else {\n        toolbarElement.focus();\n      }\n      return;\n    }\n    if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea) {\n      var groupModule = this.parent.groupModule;\n      var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n      e.preventDefault();\n      if (focusableGroupedItems.length > 0) {\n        focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n      } else {\n        groupModule.element.focus();\n      }\n      return;\n    }\n    if (this.parent.element.classList.contains('e-childgrid')) {\n      e.preventDefault();\n      this.parent.element.focus();\n    }\n  };\n  FocusStrategy.prototype.allowToPaging = function (e) {\n    if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.allowAdding && e.keyCode !== 40) {\n      return false;\n    }\n    return true;\n  };\n  FocusStrategy.prototype.skipOn = function (e) {\n    var target = e.target;\n    if (!target) {\n      return false;\n    }\n    if (!this.parent.isEdit && target && target.closest('.e-unboundcell') && this.currentInfo.skipAction && (e.action === 'shiftTab' && this.commandColumnFocusElement(target.closest('.e-unboundcell'), false) === target || e.action === 'tab' && this.commandColumnFocusElement(target.closest('.e-unboundcell'), true) === target)) {\n      return this.currentInfo.skipAction = false;\n    }\n    if (this.currentInfo.skipAction) {\n      this.clearIndicator();\n      return true;\n    }\n    if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n      this.clearIndicator();\n      return true;\n    }\n    if (this.parent.allowGrouping) {\n      var focusableGroupedItems = this.parent.groupModule.getFocusableGroupedItems();\n      if (parentsUntil(e.target, 'e-groupheadercell') && !(e.target === focusableGroupedItems[0] && e.action === 'shiftTab' || e.target === focusableGroupedItems[focusableGroupedItems.length - 1] && e.action === 'tab')) {\n        return true;\n      }\n    }\n    if (this.parent.toolbar || this.parent.toolbarTemplate) {\n      var toolbarElement = this.parent.toolbarModule.element;\n      var focusableToolbarItems = toolbarElement.querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n      if (parentsUntil(e.target, 'e-toolbar-item') && !(focusableToolbarItems.length > 0 && (parentsUntil(e.target, 'e-toolbar-item') === focusableToolbarItems[0] && e.action === 'shiftTab' || parentsUntil(e.target, 'e-toolbar-item') === focusableToolbarItems[focusableToolbarItems.length - 1] && e.action === 'tab'))) {\n        return true;\n      }\n    }\n    var th = closest(target, 'th') && !closest(target, 'th').tabIndex;\n    if (e.target.classList.contains('e-filterbaroperator') && (e.keyCode === 13 || e.keyCode === 27)) {\n      var inputTarget = closest(e.target, '.e-filterbarcell');\n      inputTarget.querySelector('input').focus();\n    }\n    var addNewRow = this.parent.editSettings.showAddNewRow && closest(document.activeElement, '.e-addedrow') !== null;\n    if (th && closest(document.activeElement, '.e-filterbarcell') !== null || addNewRow) {\n      this.removeFocus();\n    }\n    var filterCell = closest(document.activeElement, '.e-filterbarcell') !== null;\n    if (this.parent.enableHeaderFocus && filterCell) {\n      var matrix = this.active.matrix;\n      var current = matrix.current;\n      filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n    }\n    if (this.parent.isEdit && (e.action === 'tab' || e.action === 'shiftTab') && this.parent.editSettings.mode === 'Normal' && !this.parent.editSettings.showAddNewRow && !isNullOrUndefined(parentsUntil(target, 'e-addedrow'))) {\n      var inputElements = this.parent.editModule.formObj.element.querySelectorAll('input:not([type=\"hidden\"],.e-numeric-hidden,.e-disabled), select:not([aria-hidden=\"true\"]), button:not(.e-hide), textarea:not(.e-hide,.e-disabled,[disabled])');\n      var inputTarget = target.classList.contains('e-ddl') ? target.querySelector('input') : target;\n      var firstEditCell = e.action === 'tab' && inputTarget === inputElements[inputElements.length - 1];\n      var lastEditCell = e.action === 'shiftTab' && inputTarget === inputElements[0];\n      if (firstEditCell || lastEditCell) {\n        e.preventDefault();\n        var focusElement = inputElements[firstEditCell ? 0 : inputElements.length - 1];\n        focusElement = focusElement.parentElement.classList.contains('e-ddl') ? focusElement.parentElement : focusElement;\n        focusElement.focus();\n      }\n    }\n    return e.action === 'delete' || this.parent.editSettings.mode !== 'Batch' && (this.parent.isEdit && (!this.parent.editSettings.showAddNewRow || this.parent.editSettings.showAddNewRow && (!isNullOrUndefined(this.parent.element.querySelector('.e-editedrow')) || !isNullOrUndefined(parentsUntil(target, 'e-addedrow')) && !isNullOrUndefined(closest(e.target, 'input')) && !isNullOrUndefined(document.querySelector('.e-popup-open')) || !isNullOrUndefined(parentsUntil(target, 'e-addedrow')) && target && !target.querySelector('.e-cancel-icon') && !isNullOrUndefined(parentsUntil(target, 'e-unboundcell')))) || ['insert', 'f2'].indexOf(e.action) > -1) || filterCell && this.parent.enableHeaderFocus || (filterCell || addNewRow) && e.action !== 'tab' && e.action !== 'shiftTab' || closest(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null && ['enter', 'leftArrow', 'rightArrow', 'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1 || closest(target, '.' + literals.gridContent) === null && closest(target, '.' + literals.gridHeader) === null && !(e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar') || parentsUntil(e.target, 'e-groupdroparea')) || e.action === 'space' && !target.classList.contains(literals.gridChkBox) && closest(target, '.' + literals.gridChkBox) === null && closest(target, '.e-headerchkcelldiv') === null || closest(target, '.e-filter-popup') !== null;\n  };\n  FocusStrategy.prototype.focusVirtualElement = function (e) {\n    var _this = this;\n    if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n      var data = {\n        virtualData: {},\n        isAdd: false,\n        isCancel: false\n      };\n      this.parent.notify(event.getVirtualData, data);\n      var isKeyFocus = this.actions.some(function (value) {\n        return value === _this.activeKey;\n      });\n      var isSelected = this.parent.contentModule ? this.parent.contentModule.selectedRowIndex > -1 : false;\n      if (data.isAdd || Object.keys(data.virtualData).length || isKeyFocus || data.isCancel || isSelected) {\n        this.parent.notify(event.resetVirtualFocus, {\n          isCancel: false\n        });\n        data.isCancel = false;\n        if (this.parent.enableVirtualization && !this.parent.selectVirtualRowOnAdd && (!e || e && e.action !== 'ctrlHome' && e.action !== 'ctrlEnd') || !this.parent.enableVirtualization) {\n          this.parent.contentModule.selectedRowIndex = -1;\n        }\n        this.parent.selectVirtualRowOnAdd = false;\n        if (isKeyFocus) {\n          this.activeKey = this.empty;\n          this.parent.notify('virtaul-key-handler', e);\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        this.currentInfo.elementToFocus.focus({\n          preventScroll: true\n        });\n      } else {\n        if (this.isVirtualScroll || this.isInfiniteScroll) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          this.currentInfo.elementToFocus.focus({\n            preventScroll: true\n          });\n        } else {\n          this.currentInfo.elementToFocus.focus();\n        }\n      }\n    }\n    this.isVirtualScroll = this.isInfiniteScroll = false;\n  };\n  FocusStrategy.prototype.getFocusedElement = function () {\n    return this.currentInfo.elementToFocus;\n  };\n  FocusStrategy.prototype.getContent = function () {\n    return this.active || this.content;\n  };\n  FocusStrategy.prototype.setActive = function (content) {\n    this.active = content ? this.content : this.header;\n  };\n  FocusStrategy.prototype.setFocusedElement = function (element, e) {\n    var _this = this;\n    this.currentInfo.elementToFocus = element;\n    setTimeout(function () {\n      if (!isNullOrUndefined(_this.currentInfo.elementToFocus)) {\n        var filterMenuElement = isNullOrUndefined(_this.parent.element.querySelector('.e-flmenu')) ? document.querySelector('.e-grid-popup .e-flmenu') : _this.parent.element.querySelector('.e-flmenu');\n        if ((_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) && isNullOrUndefined(filterMenuElement)) {\n          _this.focusVirtualElement(e);\n        } else if (isNullOrUndefined(filterMenuElement) || parentsUntil(document.activeElement, 'e-flmenu-valuediv') !== filterMenuElement.querySelector('.e-flmenu-valuediv')) {\n          _this.currentInfo.elementToFocus.focus();\n        }\n      }\n    }, 0);\n  };\n  FocusStrategy.prototype.focus = function (e) {\n    this.parent.notify(event.virtaulCellFocus, e);\n    this.removeFocus();\n    this.addFocus(this.getContent().getFocusInfo(), e);\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  FocusStrategy.prototype.removeFocus = function (e) {\n    if (!this.currentInfo.element) {\n      return;\n    }\n    if (this.parent.isReact && !this.parent.isEdit && this.currentInfo.element.classList.contains('e-rowcell') && !this.currentInfo.element.parentElement && !(this.parent.allowGrouping && !isNullOrUndefined(this.parent.groupSettings.columns) && this.parent.groupSettings.columns.length) && this.parent.getRowByIndex(this.prevIndexes.rowIndex)) {\n      var cellElem = this.parent.getCellFromIndex(this.prevIndexes.rowIndex, this.prevIndexes.cellIndex);\n      this.currentInfo.element = cellElem ? cellElem : this.currentInfo.element;\n    }\n    removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n    this.currentInfo.element.tabIndex = -1;\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n  FocusStrategy.prototype.addOutline = function () {\n    var info = this.getContent().getFocusInfo();\n    if (info.element) {\n      addClass([info.element], ['e-focused']);\n      addClass([info.elementToFocus], ['e-focus']);\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n  FocusStrategy.prototype.focusHeader = function () {\n    this.setActive(false);\n    this.resetFocus();\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n  FocusStrategy.prototype.focusContent = function () {\n    this.setActive(true);\n    this.resetFocus();\n  };\n  FocusStrategy.prototype.resetFocus = function () {\n    var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n    this.getContent().matrix.select(current[0], current[1]);\n    this.focus();\n  };\n  FocusStrategy.prototype.addFocus = function (info, e) {\n    this.currentInfo = info;\n    this.currentInfo.outline = info.outline && (!isNullOrUndefined(e) || this.isVirtualScroll);\n    if (this.isInfiniteScroll) {\n      this.currentInfo.outline = true;\n    }\n    if (!info.element) {\n      return;\n    }\n    var isFocused = info.elementToFocus.classList.contains('e-focus');\n    if (isFocused) {\n      return;\n    }\n    if (this.currentInfo.outline) {\n      addClass([info.element], ['e-focused']);\n    }\n    addClass([info.elementToFocus], ['e-focus']);\n    info.element.tabIndex = 0;\n    if (!isFocused) {\n      this.setFocusedElement(info.elementToFocus, e);\n    }\n    this.parent.notify(event.cellFocused, {\n      element: info.elementToFocus,\n      parent: info.element,\n      indexes: this.getContent().matrix.current,\n      byKey: !isNullOrUndefined(e),\n      byClick: isNullOrUndefined(e),\n      keyArgs: e,\n      isJump: this.swap.swap,\n      container: this.getContent().getInfo(e),\n      outline: !isNullOrUndefined(e),\n      swapInfo: this.swap\n    });\n    var _a = this.getContent().matrix.current,\n      rowIndex = _a[0],\n      cellIndex = _a[1];\n    this.prevIndexes = {\n      rowIndex: rowIndex,\n      cellIndex: cellIndex\n    };\n    this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n    this.focusByClick = false;\n  };\n  FocusStrategy.prototype.refreshMatrix = function (content) {\n    var _this = this;\n    return function (e) {\n      if (content && !_this.content) {\n        _this.content = new ContentFocus(_this.parent);\n      }\n      if (!content && !_this.header) {\n        _this.header = new HeaderFocus(_this.parent);\n      }\n      var cFocus = content ? _this.content : _this.header;\n      var frozenRow = _this.parent.frozenRows;\n      var batchLen = 0;\n      if (frozenRow && _this.parent.editSettings.mode === 'Batch') {\n        batchLen = _this.parent.getHeaderContent().querySelectorAll('.e-insertedrow').length + _this.parent.getHeaderContent().querySelectorAll('.e-hiddenrow').length;\n      }\n      if (!isNullOrUndefined(_this.parent.groupSettings.columns) && _this.parent.groupSettings.columns.length && frozenRow && content) {\n        frozenRow = 0;\n        for (var i = 0; i < e.rows.length; i++) {\n          frozenRow++;\n          if (e.rows[parseInt(i.toString(), 10)].index + 1 === _this.parent.frozenRows) {\n            break;\n          }\n        }\n        _this.groupedFrozenRow = frozenRow;\n      }\n      var rows = content ? e.rows.slice(frozenRow + batchLen) : e.rows;\n      var updateRow = content ? e.rows.slice(0, frozenRow + batchLen) : e.rows;\n      if (_this.parent.isCollapseStateEnabled() && content) {\n        rows = rows.filter(function (x) {\n          return x.visible !== false;\n        });\n      }\n      var isRowTemplate = !isNullOrUndefined(_this.parent.rowTemplate);\n      if (frozenRow && (_this.parent.editSettings.mode === 'Batch' && content && (e.name === 'batchDelete' || e.name === 'batchAdd' || e.name === 'batchCancel' || e.args && e.args.requestType === 'batchsave') || e.args && (e.args.requestType === 'delete' || e.args.requestType === 'save'))) {\n        var matrixcs = _this.header.matrix.matrix;\n        var hdrLen = _this.parent.headerModule.rows.length;\n        matrixcs.splice(hdrLen, matrixcs.length - hdrLen);\n      }\n      var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n      cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n      var isScroll = _this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling;\n      if (_this.parent.editSettings.showAddNewRow && content && _this.header && _this.header.matrix && (!isScroll || isScroll && _this.parent.isAddNewRow)) {\n        var tempMatrix = _this.header.matrix.matrix;\n        var lastRowHeaderIdx = _this.parent.allowFiltering && _this.parent.filterSettings.type === 'FilterBar' ? 2 : 1;\n        cFocus.matrix.rows = _this.parent.frozenRows && _this.parent.editSettings.newRowPosition === 'Top' ? cFocus.matrix.rows : ++cFocus.matrix.rows;\n        if (_this.parent.editSettings.newRowPosition === 'Top') {\n          (_this.parent.frozenRows || isScroll ? matrix : cFocus.matrix.matrix).unshift(_this.refreshAddNewRowMatrix(tempMatrix[tempMatrix.length - lastRowHeaderIdx]));\n        } else {\n          cFocus.matrix.matrix.push(_this.refreshAddNewRowMatrix(tempMatrix[tempMatrix.length - lastRowHeaderIdx]));\n        }\n        _this.parent.isAddNewRow = false;\n      }\n      if (!(_this.parent.isFrozenGrid() && e.args && (e.args.requestType === 'sorting' || e.args.requestType === 'batchsave' || e.args.requestType === 'paging')) || frozenRow && _this.parent.editSettings.mode === 'Batch' && content && (e.name === 'batchDelete' || e.name === 'batchAdd' || e.name === 'batchCancel' || e.args.requestType === 'batchsave')) {\n        cFocus.generateRows(updateRow, {\n          matrix: matrix,\n          handlerInstance: _this.header\n        });\n      }\n      if (!Browser.isDevice && e && e.args) {\n        if (!_this.focusByClick && e.args.requestType === 'paging' && !_this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n          _this.skipFocus = false;\n          _this.parent.element.focus();\n        }\n        if (e.args.requestType === 'grouping') {\n          _this.skipFocus = true;\n        }\n      }\n      if (e && e.args && e.args.requestType === 'virtualscroll') {\n        if (_this.currentInfo.uid) {\n          var index_1;\n          var bool = e.rows.some(function (row, i) {\n            index_1 = i;\n            return row.uid === _this.currentInfo.uid;\n          });\n          if (bool) {\n            _this.content.matrix.current[0] = index_1;\n            _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n            var frzLeftCount = _this.parent.getVisibleFrozenLeftCount();\n            var frzRightCount = _this.parent.getVisibleFrozenRightCount();\n            if (_this.parent.enableColumnVirtualization && !(frzLeftCount && frzRightCount) && _this.parent.isFrozenGrid() && e.args.virtualInfo.direction === 'right') {\n              _this.content.matrix.current[1] = _this.content.matrix.current[1] - (frzLeftCount + (frzRightCount ? frzRightCount + 1 : 0));\n            }\n            var isGroup = _this.parent.allowGrouping && _this.parent.groupSettings.columns.length ? true : false;\n            if (isGroup) {\n              _this.content.matrix.current[1] = _this.prevIndexes.cellIndex;\n              if (_this.virtualSelectionInfo.isPending) {\n                _this.content.matrix.current[0] = _this.virtualSelectionInfo.direction === 'downArrow' ? _this.content.matrix.current[0] + 1 : _this.content.matrix.current[0] - 1;\n              }\n            }\n            var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n            if (focusElement) {\n              var cellPosition = focusElement.getBoundingClientRect();\n              var gridPosition = _this.parent.element.getBoundingClientRect();\n              var freezeLeftColWidth = 0;\n              var freezeRightColWidth = 0;\n              if (_this.parent.enableColumnVirtualization && !(frzLeftCount && frzRightCount) && _this.parent.isFrozenGrid() && e.args.virtualInfo.direction === 'right') {\n                if (frzLeftCount) {\n                  freezeLeftColWidth = _this.parent.leftrightColumnWidth('left');\n                } else {\n                  freezeRightColWidth = _this.parent.leftrightColumnWidth('right');\n                }\n              }\n              if (cellPosition.top >= 0 && cellPosition.left >= 0 && cellPosition.right - freezeLeftColWidth - freezeRightColWidth <= Math.min(gridPosition.right, window.innerWidth || document.documentElement.clientWidth) + freezeRightColWidth && cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight || document.documentElement.clientHeight) || isGroup) {\n                _this.isVirtualScroll = true;\n                _this.focus(isGroup && _this.virtualSelectionInfo.isPending ? _this.virtualSelectionInfo.event : undefined);\n              }\n            }\n          }\n        } else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n          var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n          if (focusElement) {\n            focusElement.focus();\n          }\n        }\n        _this.virtualSelectionInfo = {};\n      }\n      if (e && e.args && e.args.requestType === 'infiniteScroll') {\n        _this.isInfiniteScroll = true;\n      }\n    };\n  };\n  FocusStrategy.prototype.refreshAddNewRowMatrix = function (matrix) {\n    var cols = this.parent.getColumns();\n    var indent = this.parent.getIndentCount();\n    for (var i = indent; i < matrix.length - 1; i++) {\n      if (cols[i - indent] && cols[i - indent].visible && cols[i - indent].allowEditing) {\n        matrix[parseInt(i.toString(), 10)] = 1;\n      } else {\n        matrix[parseInt(i.toString(), 10)] = 0;\n      }\n    }\n    return matrix;\n  };\n  FocusStrategy.prototype.addEventListener = function () {\n    var _this = this;\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n    EventHandler.add(this.parent.element, 'touchstart', this.focusCheck, this);\n    EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n    this.parent.element.addEventListener('focus', this.passiveHandler = function (e) {\n      return _this.passiveFocus(e);\n    }, true);\n    EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n    this.evtHandlers = [{\n      event: event.keyPressed,\n      handler: this.onKeyPress\n    }, {\n      event: event.click,\n      handler: this.onClick\n    }, {\n      event: event.contentReady,\n      handler: this.refMatrix\n    }, {\n      event: event.partialRefresh,\n      handler: this.refMatrix\n    }, {\n      event: event.refreshExpandandCollapse,\n      handler: this.refMatrix\n    }, {\n      event: event.showAddNewRowFocus,\n      handler: this.showAddNewRowFocus\n    }, {\n      event: event.headerRefreshed,\n      handler: this.refreshMatrix()\n    }, {\n      event: event.closeEdit,\n      handler: this.restoreFocus\n    }, {\n      event: event.restoreFocus,\n      handler: this.restoreFocus\n    }, {\n      event: 'start-edit',\n      handler: this.clearIndicator\n    }, {\n      event: 'start-add',\n      handler: this.clearIndicator\n    }, {\n      event: 'sorting-complete',\n      handler: this.restoreFocus\n    }, {\n      event: 'filtering-complete',\n      handler: this.filterfocus\n    }, {\n      event: 'custom-filter-close',\n      handler: this.filterfocus\n    }, {\n      event: 'grouping-complete',\n      handler: this.restoreFocusWithAction\n    }, {\n      event: 'ungrouping-complete',\n      handler: this.restoreFocusWithAction\n    }, {\n      event: event.batchAdd,\n      handler: this.refMatrix\n    }, {\n      event: event.batchCancel,\n      handler: this.refMatrix\n    }, {\n      event: event.batchDelete,\n      handler: this.refMatrix\n    }, {\n      event: event.detailDataBound,\n      handler: this.refMatrix\n    }, {\n      event: event.onEmpty,\n      handler: this.refMatrix\n    }, {\n      event: event.cellFocused,\n      handler: this.internalCellFocus\n    }];\n    addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n  };\n  FocusStrategy.prototype.showAddNewRowFocus = function () {\n    if (this.parent.editSettings.showAddNewRow) {\n      var startIdx = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.content.matrix.matrix.length - 1;\n      var startCellIdx = this.parent.getIndentCount();\n      if (this.parent.editSettings.newRowPosition === 'Top' && (this.parent.frozenRows || this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n        var headrIdx = this.header.matrix.matrix.length - (this.groupedFrozenRow ? this.groupedFrozenRow : this.parent.frozenRows);\n        startCellIdx = this.findNextCellFocus(this.header.matrix.matrix[headrIdx - 1], startCellIdx);\n        this.header.matrix.current = [headrIdx - 1, startCellIdx];\n        this.active = this.header;\n      } else {\n        startCellIdx = this.findNextCellFocus(this.content.matrix.matrix[parseInt(startIdx.toString(), 10)], startCellIdx);\n        this.content.matrix.current = [startIdx, startCellIdx];\n        this.active = this.content;\n      }\n      var addedrow = this.parent.element.querySelector('.e-addedrow');\n      if (addedrow && addedrow.querySelectorAll('tr') && addedrow.querySelector('tr').cells[parseInt(startCellIdx.toString(), 10)].querySelector('input')) {\n        addedrow.querySelector('tr').cells[parseInt(startCellIdx.toString(), 10)].querySelector('input').select();\n      }\n    }\n  };\n  FocusStrategy.prototype.findNextCellFocus = function (matrix, cellIndex) {\n    for (var i = cellIndex; i < matrix.length; i++) {\n      if (matrix[parseInt(i.toString(), 10)] === 1) {\n        return i;\n      }\n    }\n    return cellIndex;\n  };\n  FocusStrategy.prototype.filterfocus = function () {\n    if (this.parent.filterSettings.type !== 'FilterBar') {\n      this.removeFocus();\n      this.restoreFocus();\n    }\n  };\n  FocusStrategy.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n    EventHandler.remove(this.parent.element, 'touchstart', this.focusCheck);\n    EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n    EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n    this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n    addRemoveEventListener(this.parent, this.evtHandlers, false);\n  };\n  FocusStrategy.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n  FocusStrategy.prototype.restoreFocus = function (arg) {\n    if (arg && arg.requestType === 'sorting' && isNullOrUndefined(arg.target)) {\n      return;\n    }\n    var groupModule = this.parent.groupModule;\n    if (this.parent.allowGrouping && groupModule && (groupModule.groupSortFocus || groupModule.groupTextFocus)) {\n      groupModule.groupSortFocus = false;\n      groupModule.groupTextFocus = false;\n      return;\n    }\n    this.firstHeaderCellClick = true;\n    this.addFocus(this.getContent().getFocusInfo());\n    var requestTypes = ['add', 'save', 'delete', 'cancel', 'batchsave', 'batchDelete', 'batchCancel'];\n    var focusInfo = this.getContent().getFocusInfo();\n    if (arg && requestTypes.indexOf(arg.requestType) > -1 && focusInfo && focusInfo.elementToFocus && focusInfo.elementToFocus.matches('.e-rowcell.e-focus')) {\n      addClass([focusInfo.elementToFocus], ['e-focused', 'e-focus']);\n    }\n  };\n  FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n    if (!this.parent.enableInfiniteScrolling && !(this.parent.groupModule && this.parent.groupModule.preventFocusOnGroup)) {\n      var matrix = this.getContent().matrix;\n      var current = matrix.current;\n      switch (e.requestType) {\n        case 'grouping':\n        case 'ungrouping':\n          current[1] = current.length && !this.parent.groupSettings.showGroupedColumn && !isNullOrUndefined(matrix.matrix[current[0]]) ? matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n          break;\n      }\n      this.getContent().matrix.current = current;\n      this.prevIndexes = {\n        rowIndex: current[0],\n        cellIndex: current[1]\n      };\n      var groupModule = this.parent.groupModule;\n      if (this.parent.allowGrouping && groupModule && groupModule.groupCancelFocus) {\n        var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n        if (focusableGroupedItems.length) {\n          if (focusableGroupedItems[0].parentElement.getAttribute('ej-mappingname') === e.columnName) {\n            focusableGroupedItems[3].focus();\n          } else {\n            focusableGroupedItems[0].focus();\n          }\n        } else {\n          groupModule.element.focus();\n        }\n        groupModule.groupCancelFocus = false;\n        return;\n      }\n      this.addFocus(this.getContent().getFocusInfo());\n    }\n  };\n  FocusStrategy.prototype.clearIndicator = function () {\n    if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n      return;\n    }\n    removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n  };\n  FocusStrategy.prototype.getPrevIndexes = function () {\n    var forget = this.forget;\n    this.forget = false;\n    return forget || !Object.keys(this.prevIndexes).length ? {\n      rowIndex: null,\n      cellIndex: null\n    } : this.prevIndexes;\n  };\n  FocusStrategy.prototype.forgetPrevious = function () {\n    this.forget = true;\n  };\n  FocusStrategy.prototype.setActiveByKey = function (action, active) {\n    if (this.parent.frozenRows === 0) {\n      return;\n    }\n    // eslint-disable-next-line prefer-const\n    var info;\n    var actions = {\n      'home': function () {\n        return {\n          toHeader: !info.isContent,\n          toFrozen: true\n        };\n      },\n      'end': function () {\n        return {\n          toHeader: !info.isContent,\n          toFrozen: false\n        };\n      },\n      'ctrlHome': function () {\n        return {\n          toHeader: true,\n          toFrozen: false\n        };\n      },\n      'ctrlEnd': function () {\n        return {\n          toHeader: false,\n          toFrozen: false\n        };\n      }\n    };\n    if (!(action in actions)) {\n      return;\n    }\n    info = active.getInfo();\n    var swap = actions[\"\" + action]();\n    this.setActive(!swap.toHeader);\n    this.getContent().matrix.current = active.matrix.current;\n  };\n  FocusStrategy.prototype.internalCellFocus = function (e) {\n    if (!(e.byKey && e.container.isContent && (e.keyArgs.action === 'enter' && e.parent.classList.contains('e-detailcell') || (e.keyArgs.action === 'tab' || e.keyArgs.action === 'shiftTab') && e.parent.classList.contains('e-unboundcell')))) {\n      return;\n    }\n    this.clearIndicator();\n    var focusEle;\n    if (e.parent && e.parent.closest('.e-unboundcell') && e.keyArgs.action === 'shiftTab') {\n      focusEle = this.commandColumnFocusElement(e.parent, true);\n    } else {\n      focusEle = this.getContent().getFocusable(this.getFocusedElement());\n    }\n    this.setFocusedElement(focusEle);\n    this.currentInfo.skipAction = true;\n  };\n  FocusStrategy.prototype.commandColumnFocusElement = function (cell, isLast) {\n    var commandButtons = cell.querySelectorAll('button:not(.e-hide)');\n    return isLast ? commandButtons[commandButtons.length - 1] : commandButtons[0];\n  };\n  return FocusStrategy;\n}();\nexport { FocusStrategy };\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n *\n * @hidden\n */\nvar Matrix = /** @class */function () {\n  function Matrix() {\n    this.matrix = [];\n    this.current = [];\n  }\n  Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n    rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n    columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n    this.matrix[parseInt(rowIndex.toString(), 10)] = this.matrix[parseInt(rowIndex.toString(), 10)] || [];\n    this.matrix[parseInt(rowIndex.toString(), 10)][parseInt(columnIndex.toString(), 10)] = allow ? 1 : 0;\n  };\n  Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator, active) {\n    var tmp = columnIndex;\n    if (rowIndex + navigator[0] < 0) {\n      return [rowIndex, columnIndex];\n    }\n    rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n    var emptyTable = true;\n    if (isNullOrUndefined(this.matrix[parseInt(rowIndex.toString(), 10)])) {\n      return null;\n    }\n    columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[parseInt(rowIndex.toString(), 10)].length - 1));\n    if (tmp + navigator[1] > this.matrix[parseInt(rowIndex.toString(), 10)].length - 1 && validator(rowIndex, columnIndex, action)) {\n      return [rowIndex, tmp];\n    }\n    var first = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n    columnIndex = first === null ? tmp : first;\n    var val = getValue(rowIndex + \".\" + columnIndex, this.matrix);\n    if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n      navigator[0] = -1;\n    }\n    var cell;\n    if (active) {\n      var rows = this.getRowsFromIndex(rowIndex, active);\n      cell = getValue(rowIndex + \".cells.\" + columnIndex, rows);\n    }\n    if (cell && cell.getBoundingClientRect().width === 0) {\n      var current = this.nextVisibleCellFocus(rowIndex, columnIndex, action, navigator, active, tmp);\n      rowIndex = current[0];\n      columnIndex = current[1];\n    }\n    if (first === null) {\n      for (var i = 0; i < this.rows; i++) {\n        if (this.matrix[parseInt(i.toString(), 10)].some(function (v) {\n          return v === 1;\n        })) {\n          emptyTable = false;\n          break;\n        }\n      }\n      if (emptyTable) {\n        rowIndex = this.current.length ? this.current[0] : 0;\n        return [rowIndex, columnIndex];\n      }\n    }\n    return this.inValid(val) || !validator(rowIndex, columnIndex, action) ? this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n  };\n  Matrix.prototype.getRowsFromIndex = function (rowIndex, active) {\n    return active.getTable().rows[parseInt(rowIndex.toString(), 10)].classList.contains('e-addedrow') ? active.getTable().rows[parseInt(rowIndex.toString(), 10)].querySelector('table').rows : active.getTable().rows;\n  };\n  Matrix.prototype.nextVisibleCellFocus = function (rowIndex, columnIndex, action, navigator, active, tmp) {\n    var rows = this.getRowsFromIndex(rowIndex, active);\n    var cell = getValue(rowIndex + \".cells.\" + columnIndex, rows);\n    var rowMatrix = active.matrix.matrix;\n    var maxRow = rowMatrix.length - 1;\n    var isTab = action === 'tab';\n    var isShiftTab = action === 'shiftTab';\n    var skipAction = action === 'enter' || action === 'shiftEnter' || action === 'downArrow' || action === 'upArrow';\n    if (skipAction) {\n      return [rowIndex, columnIndex];\n    }\n    while (cell && cell.getBoundingClientRect().width === 0) {\n      if (isTab && rowIndex === maxRow && columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1) || isShiftTab && rowIndex === 0 && columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1)) {\n        columnIndex = tmp;\n        return [rowIndex, columnIndex];\n      }\n      if (isTab) {\n        if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1)) {\n          rowIndex++;\n          columnIndex = rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1);\n          columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n          rows = this.getRowsFromIndex(rowIndex, active);\n        } else {\n          columnIndex++;\n          columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n        }\n      } else if (isShiftTab) {\n        if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1)) {\n          rowIndex--;\n          columnIndex = rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1);\n          columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n          rows = this.getRowsFromIndex(rowIndex, active);\n        } else {\n          columnIndex--;\n          columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n        }\n      } else if (action === 'rightArrow' || action === 'shiftRight') {\n        if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1)) {\n          columnIndex = tmp;\n        } else {\n          columnIndex++;\n          columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n        }\n      } else if (action === 'leftArrow' || action === 'shiftLeft') {\n        if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1)) {\n          columnIndex = tmp;\n        } else {\n          columnIndex--;\n          columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n        }\n      } else if (action === null) {\n        columnIndex++;\n        columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n      }\n      cell = getValue(rowIndex + \".cells.\" + columnIndex, rows);\n    }\n    return [rowIndex, columnIndex];\n  };\n  Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n    if ((index < 0 || index === vector.length) && this.inValid(vector[parseInt(index.toString(), 10)]) && action !== 'upArrow' && action !== 'downArrow' || !vector.some(function (v) {\n      return v === 1;\n    })) {\n      return null;\n    }\n    return !this.inValid(vector[parseInt(index.toString(), 10)]) ? index : this.first(vector, ['upArrow', 'downArrow', 'shiftUp', 'shiftDown', 'enter', 'shiftEnter'].indexOf(action) !== -1 ? moveTo ? 0 : ++index : index + navigator[1], navigator, false, action);\n  };\n  Matrix.prototype.select = function (rowIndex, columnIndex) {\n    rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n    columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[parseInt(rowIndex.toString(), 10)].length - 1));\n    this.current = [rowIndex, columnIndex];\n  };\n  Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n    this.rows = rows.length - 1;\n    this.matrix = [];\n    for (var i = 0; i < rows.length; i++) {\n      var cells = rows[parseInt(i.toString(), 10)].cells.filter(function (c) {\n        return c.isSpanned !== true;\n      });\n      this.columns = Math.max(cells.length - 1, this.columns | 0);\n      var incrementNumber = 0;\n      for (var j = 0; j < cells.length; j++) {\n        if (cells[parseInt(j.toString(), 10)].column && cells[parseInt(j.toString(), 10)].column.columns) {\n          incrementNumber = this.columnsCount(cells[parseInt(j.toString(), 10)].column.columns, incrementNumber);\n        } else {\n          incrementNumber++;\n        }\n        this.set(i, j, rows[parseInt(i.toString(), 10)].visible === false ? false : selector(rows[parseInt(i.toString(), 10)], cells[parseInt(j.toString(), 10)], isRowTemplate));\n      }\n      this.columns = Math.max(incrementNumber - 1, this.columns | 0);\n    }\n    return this.matrix;\n  };\n  Matrix.prototype.columnsCount = function (rowColumns, currentColumnCount) {\n    var columns = rowColumns;\n    var incrementNumber = currentColumnCount;\n    for (var i = 0; i < columns.length; i++) {\n      if (columns[parseInt(i.toString(), 10)].columns) {\n        incrementNumber = this.columnsCount(columns[parseInt(i.toString(), 10)].columns, incrementNumber);\n      } else {\n        incrementNumber++;\n      }\n    }\n    return incrementNumber;\n  };\n  Matrix.prototype.inValid = function (value) {\n    return value === 0 || value === undefined;\n  };\n  return Matrix;\n}();\nexport { Matrix };\n/**\n * @hidden\n */\nvar ContentFocus = /** @class */function () {\n  function ContentFocus(parent) {\n    var _this = this;\n    this.matrix = new Matrix();\n    this.lastIdxCell = false;\n    this.parent = parent;\n    this.keyActions = {\n      'rightArrow': [0, 1],\n      'tab': [0, 1],\n      'leftArrow': [0, -1],\n      'shiftTab': [0, -1],\n      'upArrow': [-1, 0],\n      'downArrow': [1, 0],\n      'shiftUp': [-1, 0],\n      'shiftDown': [1, 0],\n      'shiftRight': [0, 1],\n      'shiftLeft': [0, -1],\n      'enter': [1, 0],\n      'shiftEnter': [-1, 0]\n    };\n    this.indexesByKey = function (action) {\n      var opt = {\n        'home': [_this.matrix.current[0], -1, 0, 1],\n        'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n        'ctrlHome': [0, -1, 0, 1],\n        'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n      };\n      return opt[\"\" + action] || null;\n    };\n  }\n  ContentFocus.prototype.getTable = function () {\n    return this.parent.getContentTable();\n  };\n  ContentFocus.prototype.onKeyPress = function (e) {\n    var isMacLike = /(Mac)/i.test(navigator.platform);\n    if (isMacLike && e.metaKey) {\n      if (e.action === 'home') {\n        e.action = 'ctrlHome';\n      } else if (e.action === 'end') {\n        e.action = 'ctrlEnd';\n      } else if (['downArrow', 'upArrow', 'leftArrow', 'rightArrow'].indexOf(e.action) !== -1) {\n        return;\n      }\n    }\n    var navigators = this.keyActions[e.action];\n    var current = this.getCurrentFromAction(e.action, navigators, e.action in this.keyActions, e);\n    if (!current) {\n      return;\n    }\n    if ((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString() || this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus() && this.matrix.current[0] === this.matrix.rows && (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.allowAdding && e.keyCode === 40 || e.keyCode === 40)) {\n      if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() || current.toString() === [0, 0].toString() || this.matrix.current[0] === this.matrix.rows && this.matrix.current.toString() === current.toString() || this.parent.allowGrouping && this.parent.infiniteScrollSettings.enableCache && current.toString() === [0, 1].toString()) {\n        return false;\n      } else {\n        current = this.editNextRow(current[0], current[1], e.action);\n      }\n    }\n    this.matrix.select(current[0], current[1]);\n  };\n  ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n    var gObj = this.parent;\n    var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n    var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n    var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n    var cell = gObj.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ? row.querySelectorAll('td:not(.e-editcell)')[parseInt(cellIndex.toString(), 10)] : row.cells[parseInt(cellIndex.toString(), 10)];\n    if (action === 'tab' && editNextRow) {\n      rowIndex++;\n      var index = this.getTable().rows[parseInt(rowIndex.toString(), 10)].getElementsByClassName('e-indentcell').length + this.getTable().rows[parseInt(rowIndex.toString(), 10)].getElementsByClassName('e-detailrowcollapse').length;\n      cellIndex = visibleIndex + index;\n    }\n    if (action === 'shiftTab' && editNextRow) {\n      rowIndex--;\n      cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n    }\n    return !cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-headercell') && !cell.classList.contains('e-groupcaption') && !cell.classList.contains('e-filterbarcell') ? this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n  };\n  ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n    if (navigator === void 0) {\n      navigator = [0, 0];\n    }\n    if (!isPresent && !this.indexesByKey(action) || this.matrix.current.length === 0) {\n      return null;\n    }\n    if (!this.shouldFocusChange(e)) {\n      return this.matrix.current;\n    }\n    // eslint-disable-next-line\n    var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator),\n      rowIndex = _a[0],\n      cellIndex = _a[1],\n      rN = _a[2],\n      cN = _a[3];\n    if (this.parent.allowGrouping && !isNullOrUndefined(this.parent.groupSettings.columns) && this.parent.groupSettings.columns.length && this.parent.aggregates.length && action === 'enter') {\n      for (var i = rowIndex; i < this.matrix.matrix.length; i++) {\n        var row = this.getTable().rows[i + 1];\n        if (row && row.cells[parseInt(cellIndex.toString(), 10)] && row.cells[parseInt(cellIndex.toString(), 10)].classList.contains('e-rowcell')) {\n          return [i + 1, cellIndex];\n        }\n        if (i === this.matrix.matrix.length - 1) {\n          return [rowIndex, cellIndex];\n        }\n      }\n    }\n    if (action === 'ctrlEnd' || action === 'end') {\n      var lastContentCellIndex = [this.matrix.matrix.length - 1, this.matrix.matrix[this.matrix.matrix.length - 1].length - 1];\n      if (action === 'end') {\n        lastContentCellIndex = [rowIndex, this.matrix.matrix[parseInt(rowIndex.toString(), 10)].length - 1];\n      }\n      if (this.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n        lastContentCellIndex = findCellIndex(this.matrix.matrix, lastContentCellIndex, false);\n      }\n      rowIndex = lastContentCellIndex[0];\n      cellIndex = lastContentCellIndex[1] + 1;\n    }\n    var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator(), this);\n    return current;\n  };\n  ContentFocus.prototype.checkRowCellFocus = function (target) {\n    return target.classList.contains(literals.rowCell) ? target.classList.contains('e-focused') : true;\n  };\n  ContentFocus.prototype.onClick = function (e, force) {\n    var target = e.target;\n    this.target = target;\n    target = target.classList.contains(literals.rowCell) ? target : closest(target, 'td');\n    target = target ? target : closest(e.target, 'td.e-detailrowcollapse') || closest(e.target, 'td.e-detailrowexpand');\n    target = closest(e.target, 'td.e-detailcell') ? isNullOrUndefined(closest(closest(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n    target = target && closest(target, 'table').classList.contains(literals.table) ? target : null;\n    if (!target) {\n      return false;\n    }\n    var rowIdx = target.parentElement.rowIndex;\n    if (this.parent.editSettings.showAddNewRow && parentsUntil(target, 'e-addedrow')) {\n      rowIdx = parentsUntil(target, 'e-addedrow').rowIndex;\n    }\n    var _a = [rowIdx, target.cellIndex],\n      rowIndex = _a[0],\n      cellIndex = _a[1];\n    var _b = this.matrix.current,\n      oRowIndex = _b[0],\n      oCellIndex = _b[1];\n    var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n    if (this.matrix.inValid(val) || !force && oRowIndex === rowIndex && oCellIndex === cellIndex && this.checkRowCellFocus(target) || !parentsUntil(e.target, literals.rowCell) && !parentsUntil(e.target, 'e-groupcaption') && !parentsUntil(e.target, 'e-recordpluscollapse') && !parentsUntil(e.target, 'e-recordplusexpand') && !parentsUntil(e.target, 'e-detailrowcollapse') && !parentsUntil(e.target, 'e-detailrowexpand') && !parentsUntil(e.target, 'e-templatecell')) {\n      return false;\n    }\n    this.matrix.select(rowIndex, cellIndex);\n  };\n  ContentFocus.prototype.getFocusInfo = function () {\n    var info = {};\n    var _a = this.matrix.current,\n      _b = _a[0],\n      rowIndex = _b === void 0 ? 0 : _b,\n      _c = _a[1],\n      cellIndex = _c === void 0 ? 0 : _c;\n    this.matrix.current = [rowIndex, cellIndex];\n    var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n    info.element = !isNullOrUndefined(row) ? this.parent.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ? row.querySelectorAll('td:not(.e-editcell)')[parseInt(cellIndex.toString(), 10)] : row.cells[parseInt(cellIndex.toString(), 10)] : null;\n    if (!info.element) {\n      return info;\n    }\n    info.elementToFocus = (!info.element.classList.contains('e-unboundcell') || this.parent.editSettings.showAddNewRow && info.element.classList.contains('e-unboundcell') && parentsUntil(info.element, 'e-addedrow')) && !info.element.classList.contains('e-detailcell') ? this.getFocusable(info.element) : info.element;\n    info.elementToFocus = info.element.classList.contains('e-detailcell') && info.element.querySelector('.e-childgrid') ? info.element.querySelector('.e-childgrid') : info.elementToFocus;\n    if (this.parent.editSettings.mode === 'Batch' && this.parent.isEdit && info.elementToFocus.tagName.toLowerCase() === 'input' && info.elementToFocus.classList.contains('e-dropdownlist')) {\n      info.elementToFocus = info.elementToFocus.parentElement;\n    }\n    info.outline = true;\n    info.uid = info.element.parentElement.getAttribute('data-uid');\n    return info;\n  };\n  ContentFocus.prototype.getFocusable = function (element) {\n    var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n    var isTemplate = !isNullOrUndefined(closest(element, '.e-templatecell'));\n    if (this.parent.isEdit) {\n      var commandCellQuery = this.parent.editSettings.showAddNewRow && parentsUntil(element, 'e-addedrow') ? ', button:not(.e-hide)' : '';\n      query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea' + commandCellQuery;\n    }\n    var child = [].slice.call(element.querySelectorAll(query));\n    if (element.classList.contains('e-fltrtemp')) {\n      var focusElement = [].slice.call(element.querySelectorAll('.e-fltrtemp-focus'));\n      if (this.focusType === 'click' && this.target && this.target.classList.contains('e-fltrtemp-focus')) {\n        return this.target;\n      } else if (this.focusType === 'key' && focusElement.length && (this.action === 'tab' || this.action === 'shiftTab')) {\n        var elementIndex = focusElement.indexOf(this.currentTarget);\n        return elementIndex === -1 ? focusElement[this.action === 'tab' ? 0 : focusElement.length - 1] : focusElement[this.action === 'tab' ? elementIndex + 1 : elementIndex - 1];\n      }\n    }\n    /* Select the first focusable child element\n     * if no child found then select the cell itself.\n     * if Grid is in editable state, check for editable control inside child.\n     */\n    return child.length ? isTemplate && child.length > 1 && !(this.parent.editSettings.mode === 'Batch' && this.parent.isEdit && this.target) ? this.target ? this.target : element : child[0] : element;\n  };\n  ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n    var types = [CellType.Expand, CellType.GroupCaption, CellType.CaptionSummary, CellType.GroupSummary];\n    return (row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate) || row.isDataRow && cell.cellType === CellType.DetailExpand && isNullOrUndefined(cell.visible) || !row.isDataRow && types.indexOf(cell.cellType) > -1 && !((cell.cellType === CellType.GroupSummary || cell.cellType === CellType.CaptionSummary) && !(cell.isDataCell && cell.visible)) || cell.column && cell.visible && cell.column.type === 'checkbox' || cell.cellType === CellType.CommandColumn || row.isDataRow && isRowTemplate) && !(row.edit === 'delete' && row.isDirty);\n  };\n  ContentFocus.prototype.nextRowFocusValidate = function (index) {\n    var lastIndex = index;\n    for (var i = index, len = this.matrix.rows; i <= len; i++) {\n      if (this.matrix.matrix[parseInt(index.toString(), 10)].indexOf(1) === -1) {\n        index = index + 1;\n      } else {\n        return index;\n      }\n    }\n    this.lastIdxCell = true;\n    return lastIndex;\n  };\n  ContentFocus.prototype.previousRowFocusValidate = function (index) {\n    var firstIndex = index;\n    for (var i = index, len = 0; i >= len; i--) {\n      if (this.matrix.matrix[parseInt(index.toString(), 10)].indexOf(1) === -1) {\n        index = index - 1;\n        if (index < 0) {\n          this.lastIdxCell = true;\n          return firstIndex;\n        }\n      } else {\n        return index;\n      }\n    }\n    return firstIndex;\n  };\n  ContentFocus.prototype.jump = function (action, current) {\n    this.lastIdxCell = false;\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n    var headerSwap = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n    if (this.matrix.matrix[current[0]]) {\n      if (action === 'tab' && this.matrix.matrix.length && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n        this.matrix.current[0] = this.nextRowFocusValidate(this.matrix.current[0] + 1);\n        this.matrix.current[1] = -1;\n      }\n    }\n    if (action === 'shiftTab' && current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n      this.matrix.current[0] = this.previousRowFocusValidate(this.matrix.current[0] - 1);\n      this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n    }\n    var isHeaderFocus = false;\n    var row = parentsUntil(document.activeElement, 'e-addedrow') && this.parent.editSettings.showAddNewRow ? parentsUntil(document.activeElement, 'e-addedrow') : document.activeElement.parentElement;\n    if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache) && !isNullOrUndefined(row) && row.classList.contains(literals.row)) {\n      var rowIndex = parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1;\n      isHeaderFocus = rowIndex > 0;\n    }\n    var info = {\n      swap: !isHeaderFocus ? (action === 'upArrow' || enterFrozen) && current[0] === 0 : false,\n      toHeader: headerSwap\n    };\n    return info;\n  };\n  ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n    var current = [];\n    if (action === 'rightArrow' || action === 'tab') {\n      current[0] = previous[0];\n      current[1] = -1;\n    }\n    if (action === 'downArrow' || action === 'enter') {\n      current[0] = -1;\n      current[1] = previous[1];\n    }\n    return current;\n  };\n  ContentFocus.prototype.generateRows = function (rows, optionals) {\n    var _a;\n    var matrix = optionals.matrix,\n      handlerInstance = optionals.handlerInstance;\n    var len = handlerInstance.matrix.matrix.length;\n    var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n    handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n    handlerInstance.matrix.rows = defaultLen;\n    (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n    handlerInstance.matrix.rows += matrix.length;\n  };\n  ContentFocus.prototype.getInfo = function (e) {\n    var info = this.getFocusInfo();\n    var _a = this.matrix.current,\n      rIndex = _a[0],\n      cIndex = _a[1];\n    var isData = info.element.classList.contains(literals.rowCell);\n    var isSelectable = isData || e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse') || info.element.classList.contains('e-detailrowexpand'));\n    // eslint-disable-next-line\n    var _b = [Math.min(parseInt(info.element.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1, rIndex), Math.min(parseInt(info.element.getAttribute(literals.ariaColIndex), 10) - 1, cIndex)],\n      rowIndex = _b[0],\n      cellIndex = _b[1];\n    if (this.parent.allowGrouping && this.parent.groupSettings.enableLazyLoading && isData) {\n      rowIndex = this.parent.getDataRows().indexOf(info.element.parentElement);\n    }\n    if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n      rowIndex = rIndex;\n      cellIndex = cIndex;\n    }\n    if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling && e && e.action === 'downArrow') {\n      rowIndex++;\n    }\n    return {\n      isContent: true,\n      isDataCell: isData,\n      indexes: [rowIndex, cellIndex],\n      isSelectable: isSelectable\n    };\n  };\n  ContentFocus.prototype.validator = function () {\n    var table = this.getTable();\n    return function (rowIndex, cellIndex, action) {\n      if (!isNullOrUndefined(table.rows[parseInt(rowIndex.toString(), 10)])) {\n        var cell = void 0;\n        cellIndex = table.querySelector('.e-emptyrow') ? 0 : cellIndex;\n        if (table.rows[parseInt(rowIndex.toString(), 10)].cells[0].classList.contains('e-editcell')) {\n          cell = table.rows[parseInt(rowIndex.toString(), 10)].cells[0].querySelectorAll('td')[parseInt(cellIndex.toString(), 10)];\n        } else {\n          cell = table.rows[parseInt(rowIndex.toString(), 10)].cells[parseInt(cellIndex.toString(), 10)];\n        }\n        var isCellWidth = cell.getBoundingClientRect().width !== 0;\n        if (action === 'enter' || action === 'shiftEnter') {\n          return isCellWidth && cell.classList.contains(literals.rowCell);\n        }\n        if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains(literals.rowCell)) {\n          return isCellWidth;\n        } else if (action !== 'shiftUp' && action !== 'shiftDown') {\n          return isCellWidth;\n        }\n      }\n      return false;\n    };\n  };\n  ContentFocus.prototype.shouldFocusChange = function (e) {\n    var _a = this.matrix.current,\n      _b = _a[0],\n      rIndex = _b === void 0 ? -1 : _b,\n      _c = _a[1],\n      cIndex = _c === void 0 ? -1 : _c;\n    if (rIndex < 0 || cIndex < 0) {\n      return true;\n    }\n    var cell = getValue(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n    if (!cell) {\n      return true;\n    }\n    return e.action === 'enter' || e.action === 'shiftEnter' ? cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-unboundcell') || cell.classList.contains('e-editedbatchcell') && !cell.classList.contains('e-detailcell') : true;\n  };\n  ContentFocus.prototype.getGridSeletion = function () {\n    return this.parent.allowSelection && this.parent.selectionSettings.allowColumnSelection;\n  };\n  return ContentFocus;\n}();\nexport { ContentFocus };\n/**\n * @hidden\n */\nvar HeaderFocus = /** @class */function (_super) {\n  __extends(HeaderFocus, _super);\n  function HeaderFocus(parent) {\n    return _super.call(this, parent) || this;\n  }\n  HeaderFocus.prototype.getTable = function () {\n    return this.parent.getHeaderTable();\n  };\n  HeaderFocus.prototype.onClick = function (e) {\n    this.focusType = 'click';\n    var target = e.target;\n    this.target = target;\n    target = target.classList.contains('e-headercell') ? target : closest(target, 'th');\n    if (!target && (this.parent.frozenRows !== 0 || (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.parent.editSettings.showAddNewRow)) {\n      target = e.target.classList.contains(literals.rowCell) ? e.target : closest(e.target, 'td');\n    }\n    if (e.target.classList.contains('e-columnheader') || e.target.querySelector('.e-stackedheadercell')) {\n      return false;\n    }\n    if (!target) {\n      return;\n    }\n    var rowIdx = target.parentElement.rowIndex;\n    if (this.parent.editSettings.showAddNewRow && parentsUntil(target, 'e-addedrow')) {\n      rowIdx = parentsUntil(target, 'e-addedrow').rowIndex;\n    }\n    var _a = [rowIdx, target.cellIndex],\n      rowIndex = _a[0],\n      cellIndex = _a[1];\n    var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n    if (this.matrix.inValid(val)) {\n      return false;\n    }\n    this.matrix.select(rowIdx, target.cellIndex);\n  };\n  HeaderFocus.prototype.getFocusInfo = function () {\n    var info = {};\n    var _a = this.matrix.current,\n      _b = _a[0],\n      rowIndex = _b === void 0 ? 0 : _b,\n      _c = _a[1],\n      cellIndex = _c === void 0 ? 0 : _c;\n    var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n    info.element = !isNullOrUndefined(row) ? this.parent.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ? row.querySelectorAll('td:not(.e-editcell)')[parseInt(cellIndex.toString(), 10)] : row.cells[parseInt(cellIndex.toString(), 10)] : null;\n    if (!isNullOrUndefined(info.element)) {\n      info.elementToFocus = this.getFocusable(info.element);\n      info.outline = !info.element.classList.contains('e-filterbarcell');\n    }\n    return info;\n  };\n  HeaderFocus.prototype.selector = function (row, cell) {\n    return cell.visible && (cell.column.field !== undefined || cell.isTemplate || !isNullOrUndefined(cell.column.template) || !isNullOrUndefined(cell.column.commands) || cell.column.type === 'checkbox') || cell.cellType === CellType.StackedHeader;\n  };\n  HeaderFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    var isLastCell;\n    var lastRow;\n    if (this.parent.enableHeaderFocus && action === 'tab') {\n      lastRow = this.matrix.matrix.length - 1 === current[0];\n      isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n      if (isLastCell) {\n        if (!lastRow) {\n          this.matrix.current[0] = this.matrix.current[0] + 1;\n        } else {\n          this.matrix.current[0] = 0;\n        }\n        this.matrix.current[1] = -1;\n      }\n    }\n    return {\n      swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || action === 'tab' && lastRow && isLastCell\n    };\n  };\n  HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n    var current1 = [];\n    if (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') {\n      current1[0] = previous[0];\n      current1[1] = -1;\n    }\n    if (action === 'upArrow' || action === 'shiftEnter') {\n      current1[0] = this.matrix.matrix.length;\n      current1[1] = previous[1];\n    }\n    return current1;\n  };\n  HeaderFocus.prototype.generateRows = function (rows) {\n    var length = this.matrix.matrix.length;\n    if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n      this.matrix.rows = ++this.matrix.rows;\n      var cells = rows[0].cells;\n      var incrementNumber = 0;\n      for (var i = 0; i < cells.length; i++) {\n        if (cells[parseInt(i.toString(), 10)].column && cells[parseInt(i.toString(), 10)].column.columns) {\n          incrementNumber = this.checkFilterColumn(cells[parseInt(i.toString(), 10)].column.columns, length, incrementNumber);\n        } else {\n          this.matrix.set(length, incrementNumber, cells[parseInt(i.toString(), 10)].visible && cells[parseInt(i.toString(), 10)].column.allowFiltering !== false);\n          incrementNumber++;\n        }\n      }\n    }\n  };\n  HeaderFocus.prototype.checkFilterColumn = function (rowColumns, rowIndex, columnIndex) {\n    var columns = rowColumns;\n    var incrementNumber = columnIndex;\n    for (var i = 0; i < columns.length; i++) {\n      if (columns[parseInt(i.toString(), 10)].columns) {\n        incrementNumber = this.checkFilterColumn(columns[parseInt(i.toString(), 10)].columns, rowIndex, incrementNumber);\n      } else {\n        this.matrix.set(rowIndex, incrementNumber, columns[parseInt(i.toString(), 10)].visible && columns[parseInt(i.toString(), 10)].allowFiltering !== false);\n        incrementNumber++;\n      }\n    }\n    return incrementNumber;\n  };\n  HeaderFocus.prototype.getInfo = function (e) {\n    return extend(_super.prototype.getInfo.call(this, e), {\n      isContent: false,\n      isHeader: true\n    });\n  };\n  HeaderFocus.prototype.validator = function () {\n    return function () {\n      return true;\n    };\n  };\n  HeaderFocus.prototype.shouldFocusChange = function (e) {\n    var _a = this.matrix.current,\n      rowIndex = _a[0],\n      columnIndex = _a[1];\n    if (rowIndex < 0 || columnIndex < 0) {\n      return true;\n    }\n    var cell = getValue(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n    if (!cell) {\n      return true;\n    }\n    return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n  };\n  HeaderFocus.prototype.getHeaderType = function () {\n    return 'HeaderFocus';\n  };\n  return HeaderFocus;\n}(ContentFocus);\nexport { HeaderFocus };\n/** @hidden */\nvar SearchBox = /** @class */function () {\n  function SearchBox(searchBox, serviceLocator) {\n    this.searchBox = searchBox;\n    this.serviceLocator = serviceLocator;\n    this.l10n = this.serviceLocator.getService('localization');\n  }\n  SearchBox.prototype.searchFocus = function (args) {\n    args.target.parentElement.classList.add('e-input-focus');\n    if (args.target.classList.contains('e-input') && args.target.classList.contains('e-search') && args.target.value) {\n      var sIcon = args.target.parentElement.querySelector('.e-sicon');\n      sIcon.classList.add('e-clear-icon');\n      sIcon.setAttribute('title', this.l10n.getConstant('Clear'));\n      sIcon.style.cursor = 'pointer';\n    }\n  };\n  SearchBox.prototype.searchBlur = function (args) {\n    var relatedTarget = args.relatedTarget ? args.relatedTarget : null;\n    if (relatedTarget && relatedTarget.classList.contains('e-sicon')) {\n      if (relatedTarget.classList.contains('e-clear-icon')) {\n        args.target.parentElement.classList.remove('e-input-focus');\n      }\n    } else {\n      args.target.parentElement.classList.remove('e-input-focus');\n    }\n    if (args.target.classList.contains('e-search') && (relatedTarget && !relatedTarget.classList.contains('e-sicon e-clear-icon') && !relatedTarget.classList.contains('e-sicon') || isNullOrUndefined(relatedTarget))) {\n      var sIcon = args.target.parentElement.querySelector('.e-sicon');\n      sIcon.classList.remove('e-clear-icon');\n      sIcon.removeAttribute('title');\n      sIcon.style.cursor = 'default';\n    }\n  };\n  SearchBox.prototype.wireEvent = function () {\n    if (this.searchBox) {\n      EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n      EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n    }\n  };\n  SearchBox.prototype.unWireEvent = function () {\n    if (this.searchBox) {\n      EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n      EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n    }\n  };\n  return SearchBox;\n}();\nexport { SearchBox };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","EventHandler","getValue","closest","isNullOrUndefined","addClass","removeClass","extend","Browser","CellType","event","Row","RowModelGenerator","parentsUntil","addRemoveEventListener","findCellIndex","literals","FocusStrategy","parent","currentInfo","oneTime","swap","isInfiniteScroll","virtualSelectionInfo","forget","skipFocus","focusByClick","firstHeaderCellClick","prevIndexes","refMatrix","refreshMatrix","actions","isVirtualScroll","groupedFrozenRow","rowModelGen","addEventListener","focusCheck","e","target","classList","contains","onFocus","isDestroyed","isDevice","enableVirtualization","element","querySelector","isInitialLoad","setActive","enableHeaderFocus","frozenRows","getCurrentViewRecords","length","editSettings","mode","editModule","getBatchChanges","addedRecords","getContent","matrix","generate","generateRows","rows","isDataRow","selector","current","get","validator","active","select","focus","passiveFocus","firstHeaderCell","getHeaderContent","relatedTarget","firstHeaderCellIndex","elementToFocus","removeFocus","addFocus","getFocusInfo","skipAction","onBlur","allowPaging","pagerModule","pagerObj","removeAttribute","isGantt","nextElementSibling","isEdit","matches","parseInt","getAttribute","document","activeElement","setLastContentCellTabIndex","setFirstFocusableTabIndex","gObj","tabIndex","allowGrouping","groupSettings","showDropArea","groupModule","focusableGroupedItems","getFocusableGroupedItems","toolbar","toolbarTemplate","toolbarElement","toolbarModule","focusableToolbarItems","getFocusableToolbarItems","getColumns","contentTable","getContentTable","lastCell","lastElementChild","onClick","force","isFocusFirstCell","isContent","gridContent","isHeader","gridHeader","content","headerContent","beforeArgs","cancel","byKey","byClick","clickArgs","notify","beforeCellFocused","showAddNewRow","returnVal","type","handleFilterNavigation","inputSelector","buttonSelector","key","shiftKey","preventDefault","onKeyPress","pagerElement","focusablePagerElements","getFocusablePagerElements","childGrid","allowToPaging","checkPagerHasFocus","action","lastHeaderCellIndex","isValidBatchEditCell","findBatchEditCell","pageSettings","pageSizes","getDropDownPage","changePagerFocus","parentCell","keyCode","setPagerFocus","checkFirstPagerFocus","lastRow","lastColumn","columns","filterSettings","focusedColumn","getColumnByUid","focusedColumnUid","focusTarget","filter","hideSearchbox","showColumnChooser","skipOn","slice","call","setLastContentCellActive","focusOutFromChildGrid","focusFirstHeaderCell","activeKey","keyArgs","bValue","prevBatchValue","undefined","outline","swapInfo","jump","toHeader","getNextCurrent","setActiveByKey","lastIdxCell","toString","nextHeaderCellIndex","nextCell","getRowsFromIndex","getBoundingClientRect","width","nextVisibleCellFocus","keyActions","firstContentCellIndex","setAttribute","firstCell","enableColumnVirtualization","contentModule","prevInfo","blockIndexes","virtual","firstCellFocus","scrollTop","previousCellIndex","prevCell","focusOutFromHeader","prevCell_1","addBatchRow","clearIndicator","setPagerContainerFocus","header","currentTarget","focusType","focusElement","querySelectorAll","elementIndex","indexOf","resetActive","getTable","id","searchModule","headerFocus","cellIndex","cell","cells","tr","cellColIndex","cellCol","isPrimaryKey","allowEditing","currentCellIndex","next","limitRow","tempCellIndex","cellIndexObtain","prevTempCellIndex","tempCell","lastContentCellIndex","parentTable","parentGrid","ej2_instances","uid","parentRows","parentRowIndex","map","m","nextFocusCell","focusModule","previousRow","rowCells","i","allowAdding","commandColumnFocusElement","th","inputTarget","addNewRow","filterCell","lastIndexOf","inputElements","formObj","firstEditCell","lastEditCell","parentElement","gridChkBox","focusVirtualElement","_this","enableInfiniteScrolling","data","virtualData","isAdd","isCancel","getVirtualData","isKeyFocus","some","value","isSelected","selectedRowIndex","keys","resetVirtualFocus","selectVirtualRowOnAdd","empty","preventScroll","getFocusedElement","setFocusedElement","setTimeout","filterMenuElement","virtaulCellFocus","isReact","getRowByIndex","rowIndex","cellElem","getCellFromIndex","addOutline","info","focusHeader","resetFocus","focusContent","isFocused","cellFocused","indexes","isJump","container","getInfo","_a","getColumnByIndex","ContentFocus","HeaderFocus","cFocus","frozenRow","batchLen","index","updateRow","isCollapseStateEnabled","x","visible","isRowTemplate","rowTemplate","name","args","requestType","matrixcs","hdrLen","headerModule","splice","isScroll","isAddNewRow","tempMatrix","lastRowHeaderIdx","allowFiltering","newRowPosition","unshift","refreshAddNewRowMatrix","push","isFrozenGrid","handlerInstance","index_1","bool","row","getColumnIndexByUid","frzLeftCount","getVisibleFrozenLeftCount","frzRightCount","getVisibleFrozenRightCount","virtualInfo","direction","isGroup","isPending","cellPosition","gridPosition","freezeLeftColWidth","freezeRightColWidth","leftrightColumnWidth","top","left","right","Math","min","window","innerWidth","documentElement","clientWidth","bottom","innerHeight","clientHeight","cols","indent","getIndentCount","add","passiveHandler","evtHandlers","keyPressed","handler","click","contentReady","partialRefresh","refreshExpandandCollapse","showAddNewRowFocus","headerRefreshed","closeEdit","restoreFocus","filterfocus","restoreFocusWithAction","batchAdd","batchCancel","batchDelete","detailDataBound","onEmpty","internalCellFocus","startIdx","startCellIdx","headrIdx","findNextCellFocus","addedrow","removeEventListener","remove","destroy","arg","groupSortFocus","groupTextFocus","requestTypes","focusInfo","preventFocusOnGroup","showGroupedColumn","groupCancelFocus","columnName","getPrevIndexes","forgetPrevious","home","toFrozen","end","ctrlHome","ctrlEnd","focusEle","getFocusable","isLast","commandButtons","Matrix","set","columnIndex","allow","max","navigator","tmp","emptyTable","first","val","v","inValid","rowMatrix","maxRow","isTab","isShiftTab","vector","moveTo","c","isSpanned","incrementNumber","j","column","columnsCount","rowColumns","currentColumnCount","indexesByKey","opt","isMacLike","test","platform","metaKey","navigators","getCurrentFromAction","infiniteScrollSettings","enableCache","editNextRow","allowNextRowEdit","isLastCellPrimaryKey","visibleIndex","getColumnIndexByField","getVisibleColumns","field","getElementsByClassName","rowCell","isPresent","shouldFocusChange","concat","rN","cN","aggregates","checkRowCellFocus","table","rowIdx","_b","oRowIndex","oCellIndex","_c","tagName","toLowerCase","query","isTemplate","commandCellQuery","child","types","Expand","GroupCaption","CaptionSummary","GroupSummary","isDataCell","cellType","DetailExpand","CommandColumn","edit","isDirty","nextRowFocusValidate","lastIndex","len","previousRowFocusValidate","firstIndex","enterFrozen","headerSwap","isHeaderFocus","ariaRowIndex","previous","optionals","defaultLen","apply","rIndex","cIndex","isData","isSelectable","ariaColIndex","enableLazyLoading","getDataRows","isCellWidth","getGridSeletion","allowSelection","selectionSettings","allowColumnSelection","_super","getHeaderTable","template","commands","StackedHeader","isLastCell","current1","checkFilterColumn","getHeaderType","SearchBox","searchBox","serviceLocator","l10n","getService","searchFocus","sIcon","getConstant","style","cursor","searchBlur","wireEvent","unWireEvent"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-grids/src/grid/services/focus-strategy.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { EventHandler, getValue, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, extend, Browser } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport * as event from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowModelGenerator } from './row-model-generator';\nimport { parentsUntil, addRemoveEventListener, findCellIndex } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * FocusStrategy class\n *\n * @hidden\n */\nvar FocusStrategy = /** @class */ (function () {\n    function FocusStrategy(parent) {\n        this.currentInfo = {};\n        this.oneTime = true;\n        this.swap = {};\n        /** @hidden */\n        this.isInfiniteScroll = false;\n        /** @hidden */\n        this.virtualSelectionInfo = {};\n        this.forget = false;\n        this.skipFocus = true;\n        this.focusByClick = false;\n        this.firstHeaderCellClick = false;\n        /** @hidden */\n        this.prevIndexes = {};\n        this.refMatrix = this.refreshMatrix(true);\n        this.actions = ['downArrow', 'upArrow'];\n        this.isVirtualScroll = false;\n        this.groupedFrozenRow = 0;\n        this.parent = parent;\n        this.rowModelGen = new RowModelGenerator(this.parent);\n        this.addEventListener();\n    }\n    FocusStrategy.prototype.focusCheck = function (e) {\n        var target = e.target;\n        this.focusByClick = true;\n        this.firstHeaderCellClick = true;\n        this.skipFocus = target.classList.contains('e-grid');\n    };\n    FocusStrategy.prototype.onFocus = function (e) {\n        if (this.parent.isDestroyed || Browser.isDevice || this.parent.enableVirtualization\n            || this.parent.element.querySelector('.e-masked-table') || (!this.parent.isInitialLoad && e\n            && e.target === this.parent.element && this.parent.element.querySelector('.e-spin-show'))) {\n            return;\n        }\n        this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0);\n        if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length && ((this.parent.editSettings.mode !== 'Batch')\n            || (this.parent.editSettings.mode === 'Batch' && this.parent.editModule && !this.parent.editModule.getBatchChanges()[literals.addedRecords].length))) {\n            this.getContent().matrix.\n                generate(this.rowModelGen.generateRows({ rows: [new Row({ isDataRow: true })] }), this.getContent().selector, false);\n        }\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator(), this.active);\n        this.getContent().matrix.select(current[0], current[1]);\n        if (this.skipFocus && !(e && e.target === this.parent.element)) {\n            this.focus(e);\n            this.skipFocus = false;\n        }\n    };\n    FocusStrategy.prototype.passiveFocus = function (e) {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        var firstHeaderCell = this.parent.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n        if (e.target === firstHeaderCell && e.relatedTarget && !parentsUntil(e.relatedTarget, 'e-grid')\n            && !this.firstHeaderCellClick) {\n            var firstHeaderCellIndex = [0, 0];\n            if (this.active.matrix.matrix[firstHeaderCellIndex[0]][firstHeaderCellIndex[1]] === 0) {\n                firstHeaderCellIndex = findCellIndex(this.active.matrix.matrix, firstHeaderCellIndex, true);\n            }\n            this.active.matrix.current = firstHeaderCellIndex;\n            this.currentInfo.element = e.target;\n            this.currentInfo.elementToFocus = e.target;\n            if (this.currentInfo.element.querySelector('.e-checkselectall')) {\n                this.removeFocus();\n                this.addFocus(this.getContent().getFocusInfo(), e);\n            }\n            else {\n                addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n            }\n        }\n        this.firstHeaderCellClick = false;\n        if (e.target && e.target.classList.contains('e-detailcell')) {\n            this.currentInfo.skipAction = false;\n            addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n        }\n    };\n    FocusStrategy.prototype.onBlur = function (e) {\n        if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n            this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').removeAttribute('aria-hidden');\n        }\n        // The below boolean condition for gantt team focus fix.\n        var isGantt = parentsUntil(e.target, 'e-gantt') && e.target.classList.contains('e-rowcell')\n            && (!isNullOrUndefined(e.target.nextElementSibling)\n                && e.target.nextElementSibling.classList.contains('e-rowcell')) ? true : false;\n        if ((this.parent.isEdit || e && (!e.relatedTarget || closest(e.relatedTarget, '.e-grid') || closest(e.relatedTarget, '.e-grid-popup'))\n            && !(this.parent.element.classList.contains('e-childgrid') && !this.parent.element.matches(':focus-within')))\n            && !(!isGantt && isNullOrUndefined(e.relatedTarget) && parseInt(e.target.getAttribute('aria-colindex'), 10) - 1 === 0\n                && parseInt(e.target.getAttribute('index'), 10) === 0) && !(!isGantt && isNullOrUndefined(e.relatedTarget)\n            && !closest(document.activeElement, '.e-grid') && !isNullOrUndefined(e['sourceCapabilities']))) {\n            return;\n        }\n        this.removeFocus();\n        this.skipFocus = true;\n        this.currentInfo.skipAction = false;\n        this.setLastContentCellTabIndex();\n        this.setFirstFocusableTabIndex();\n        this.firstHeaderCellClick = false;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.setFirstFocusableTabIndex = function () {\n        var gObj = this.parent;\n        gObj.element.tabIndex = -1;\n        if (gObj.allowGrouping && gObj.groupSettings.showDropArea) {\n            var groupModule = gObj.groupModule;\n            var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n            if (focusableGroupedItems.length > 0) {\n                groupModule.element.tabIndex = -1;\n                focusableGroupedItems[0].tabIndex = 0;\n            }\n            else {\n                groupModule.element.tabIndex = 0;\n            }\n            return;\n        }\n        if (gObj.toolbar || gObj.toolbarTemplate) {\n            var toolbarElement = gObj.toolbarModule.element;\n            var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n            if (focusableToolbarItems.length > 0 && focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input')) {\n                toolbarElement.tabIndex = -1;\n                focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').tabIndex = 0;\n            }\n            else {\n                toolbarElement.tabIndex = 0;\n            }\n            return;\n        }\n        if (gObj.getColumns().length) {\n            var firstHeaderCell = gObj.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n            firstHeaderCell.tabIndex = 0;\n            this.setActive(false);\n            if (!isNullOrUndefined(this.active) && (isNullOrUndefined(this.active.target) || !this.active.target.classList.contains('e-columnmenu'))) {\n                var firstHeaderCellIndex = [0, 0];\n                if (this.active.matrix.matrix[firstHeaderCellIndex[0]][firstHeaderCellIndex[1]] === 0) {\n                    firstHeaderCellIndex = findCellIndex(this.active.matrix.matrix, firstHeaderCellIndex, true);\n                }\n                this.active.matrix.current = firstHeaderCellIndex;\n            }\n            return;\n        }\n    };\n    FocusStrategy.prototype.setLastContentCellTabIndex = function () {\n        var contentTable = this.parent.getContentTable();\n        if (contentTable.rows[contentTable.rows.length - 1]) {\n            var lastCell = contentTable.rows[contentTable.rows.length - 1].lastElementChild;\n            lastCell.tabIndex = 0;\n        }\n    };\n    FocusStrategy.prototype.onClick = function (e, force, isFocusFirstCell) {\n        if (parentsUntil(e.target, 'e-filterbarcell') && (parentsUntil(e.target, 'e-multiselect') ||\n            e.target.classList.contains('e-input-group-icon'))) {\n            return;\n        }\n        var isContent = !isNullOrUndefined(closest(e.target, '.' + literals.gridContent));\n        var isHeader = !isNullOrUndefined(closest(e.target, '.' + literals.gridHeader));\n        isContent = isContent && isHeader ? !isContent : isContent;\n        if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader)) ||\n            e.target.classList.contains(literals.content) || e.target.classList.contains(literals.headerContent) ||\n            (!isNullOrUndefined(closest(e.target, '.e-unboundcell')) && !force)) {\n            return;\n        }\n        this.setActive(isContent);\n        var beforeArgs = { cancel: false, byKey: false, byClick: !isNullOrUndefined(e.target), clickArgs: e };\n        this.parent.notify(event.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel || (closest(e.target, '.e-inline-edit') && (!this.parent.editSettings.showAddNewRow &&\n            (this.parent.editSettings.showAddNewRow && !this.parent.element.querySelector('.e-editedrow'))))) {\n            return;\n        }\n        this.setActive(isContent);\n        if (this.getContent()) {\n            var returnVal = this.getContent().onClick(e, force);\n            if (returnVal === false) {\n                return;\n            }\n            this.focus();\n            if (this.currentInfo.element.classList.contains('e-rowcell') && e.type && e.type === 'click' && !isFocusFirstCell) {\n                addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n            }\n            if (isFocusFirstCell && e && e.target) {\n                addClass([e.target], ['e-focused', 'e-focus']);\n            }\n        }\n    };\n    FocusStrategy.prototype.handleFilterNavigation = function (e, inputSelector, buttonSelector) {\n        if (e.target === document.querySelector(inputSelector) && e.key === 'Tab' && e.shiftKey) {\n            e.preventDefault();\n            document.querySelector(buttonSelector).focus();\n        }\n        else if (e.target === document.querySelector(buttonSelector) && e.key === 'Tab' && !e.shiftKey &&\n            document.activeElement === document.querySelector(buttonSelector)) {\n            e.preventDefault();\n            document.querySelector(inputSelector).focus();\n        }\n    };\n    FocusStrategy.prototype.onKeyPress = function (e) {\n        if (this.content && this.content.target) {\n            this.content.target = null;\n        }\n        if (this.parent.allowPaging) {\n            var pagerElement = this.parent.pagerModule.pagerObj.element;\n            var focusablePagerElements = this.parent.pagerModule.pagerObj.getFocusablePagerElements(pagerElement, []);\n            if (this.parent.childGrid && !parentsUntil(e.target, 'e-gridpager') && this.allowToPaging(e) && focusablePagerElements.length) {\n                focusablePagerElements[0].tabIndex = 0;\n            }\n            if (this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n                if (e.action === 'shiftTab' && focusablePagerElements.length && focusablePagerElements[0] === e.target) {\n                    this.setActive(true);\n                    var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1,\n                        this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n                    if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n                        lastHeaderCellIndex = findCellIndex(this.active.matrix.matrix, lastHeaderCellIndex, false);\n                    }\n                    this.active.matrix.current = this.parent.editSettings.mode === 'Batch' ?\n                        this.isValidBatchEditCell(lastHeaderCellIndex) ? lastHeaderCellIndex :\n                            this.findBatchEditCell(lastHeaderCellIndex, false) : lastHeaderCellIndex;\n                    e.preventDefault();\n                    this.focus(e);\n                    return;\n                }\n                if (!(e.action === 'tab' && this.parent.element.classList.contains('e-childgrid')\n                    && ((!this.parent.pageSettings.pageSizes && focusablePagerElements.length\n                        && focusablePagerElements[focusablePagerElements.length - 1] === e.target)\n                        || (this.parent.pagerModule.pagerObj.getDropDownPage() === e.target)))) {\n                    this.parent.pagerModule.pagerObj.changePagerFocus(e);\n                    return;\n                }\n                else {\n                    var parentCell = parentsUntil(this.parent.element, 'e-detailcell');\n                    removeClass([this.parent.element], ['e-focus']);\n                    removeClass([parentCell], ['e-focused']);\n                    parentCell.tabIndex = -1;\n                }\n            }\n            if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && (e.keyCode === 38 || (e.shiftKey && e.keyCode === 9))) {\n                e.preventDefault();\n                this.focus(e);\n                return;\n            }\n            else if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && e.keyCode === 9) {\n                e.preventDefault();\n                this.parent.pagerModule.pagerObj.setPagerFocus();\n                return;\n            }\n            if (this.parent.pagerModule.pagerObj.checkFirstPagerFocus()) {\n                var lastRow = this.getContent().matrix.rows;\n                var lastColumn = this.getContent().matrix.columns;\n                this.getContent().matrix.current = [lastRow, lastColumn];\n            }\n        }\n        if (this.parent.filterSettings.type === 'Excel') {\n            this.handleFilterNavigation(e, '.e-excelfilter .e-menu-item:not(.e-disabled)', '.e-excelfilter .e-footer-content button:nth-child(2)');\n        }\n        if (this.parent.filterSettings.type === 'CheckBox') {\n            var focusedColumn = this.parent.getColumnByUid(this.focusedColumnUid);\n            var focusTarget = focusedColumn && focusedColumn.filter && focusedColumn.filter.hideSearchbox ? '.e-chk-hidden' : '.e-searchinput.e-input';\n            this.handleFilterNavigation(e, focusTarget, '.e-checkboxfilter .e-footer-content button:nth-child(2)');\n        }\n        if (this.parent.filterSettings.type === 'Menu') {\n            this.handleFilterNavigation(e, '.e-flmenu .e-input-group.e-popup-flmenu', '.e-flmenu .e-footer-content button:nth-child(2)');\n        }\n        if (this.parent.showColumnChooser) {\n            this.handleFilterNavigation(e, '.e-ccdlg .e-ccsearch.e-cc.e-input', '.e-ccdlg .e-footer-content button:nth-child(2)');\n        }\n        if (this.skipOn(e)) {\n            return;\n        }\n        if (e.target && parentsUntil(e.target, 'e-gridcontent')) {\n            var rows = [].slice.call(this.parent.getContentTable().rows);\n            var lastCell = rows[rows.length - 1].lastElementChild;\n            if (e.target === lastCell) {\n                this.setActive(true);\n                this.setLastContentCellActive();\n            }\n        }\n        if (e.action === 'shiftTab' && e.target && (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar')\n            || parentsUntil(e.target, 'e-groupdroparea'))) {\n            if (e.target === this.parent.element) {\n                if (this.parent.element.classList.contains('e-childgrid')) {\n                    this.focusOutFromChildGrid(e);\n                }\n                return;\n            }\n            if (parentsUntil(e.target, 'e-groupdroparea')) {\n                if (this.parent.element.classList.contains('e-childgrid')) {\n                    e.preventDefault();\n                    this.parent.element.focus();\n                }\n                return;\n            }\n            if (parentsUntil(e.target, 'e-toolbar')) {\n                if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea) {\n                    var groupModule = this.parent.groupModule;\n                    var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                    e.preventDefault();\n                    if (focusableGroupedItems.length > 0) {\n                        focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n                    }\n                    else {\n                        groupModule.element.focus();\n                    }\n                }\n                else if (this.parent.element.classList.contains('e-childgrid')) {\n                    e.preventDefault();\n                    this.parent.element.focus();\n                }\n                return;\n            }\n        }\n        var focusFirstHeaderCell = false;\n        if (e.action === 'tab' && e.target && (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar')\n            || parentsUntil(e.target, 'e-groupdroparea'))) {\n            if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea\n                && (e.target === this.parent.element || e.target.classList.contains('e-groupdroparea'))) {\n                var groupModule = this.parent.groupModule;\n                var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                if (focusableGroupedItems.length > 0) {\n                    e.preventDefault();\n                    focusableGroupedItems[0].focus();\n                    return;\n                }\n                if (!e.target.classList.contains('e-groupdroparea')) {\n                    e.preventDefault();\n                    groupModule.element.focus();\n                    return;\n                }\n            }\n            if ((this.parent.toolbar || this.parent.toolbarTemplate) && (e.target === this.parent.element\n                || parentsUntil(e.target, 'e-groupdroparea')\n                || e.target.classList.contains('e-toolbar'))) {\n                var toolbarElement = this.parent.toolbarModule.element;\n                var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n                if (focusableToolbarItems.length > 0) {\n                    e.preventDefault();\n                    focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').focus();\n                    return;\n                }\n                if (!e.target.classList.contains('e-toolbar')) {\n                    e.preventDefault();\n                    toolbarElement.focus();\n                    return;\n                }\n            }\n            if (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar')\n                || parentsUntil(e.target, 'e-groupdroparea')) {\n                focusFirstHeaderCell = true;\n            }\n        }\n        if (focusFirstHeaderCell) {\n            if (this.parent.allowGrouping && !isNullOrUndefined(this.parent.groupSettings.columns)\n                && this.parent.groupSettings.columns.length === this.parent.columns.length) {\n                this.setActive(true);\n            }\n            else {\n                this.setActive(false);\n            }\n            this.active.matrix.current = [0, -1];\n        }\n        this.activeKey = e.action;\n        var beforeArgs = { cancel: false, byKey: true, byClick: false, keyArgs: e };\n        this.parent.notify(event.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        var bValue = this.getContent().matrix.current;\n        var prevBatchValue = this.active && this.active.matrix.current ?\n            [this.active.matrix.current[0], this.active.matrix.current[1]] : undefined;\n        this.currentInfo.outline = true;\n        var swapInfo = this.getContent().jump(e.action, bValue);\n        this.swap = swapInfo;\n        if (swapInfo.swap && !(this.parent.editSettings.mode === 'Batch'\n            && (e.action === 'tab' || e.action === 'shiftTab'))) {\n            this.setActive(!swapInfo.toHeader);\n            this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n            this.prevIndexes = {};\n        }\n        this.setActiveByKey(e.action, this.getContent());\n        var returnVal = this.content.lastIdxCell ? false : this.getContent().onKeyPress(e);\n        if (e.target && parentsUntil(e.target, 'e-gridheader')) {\n            if (e.action === 'tab' && bValue.toString() === this.active.matrix.current.toString()) {\n                var nextHeaderCellIndex = findCellIndex(this.active.matrix.matrix, this.active.matrix.current, true);\n                var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1,\n                    this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n                if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n                    lastHeaderCellIndex = findCellIndex(this.active.matrix.matrix, lastHeaderCellIndex, false);\n                }\n                var nextCell = getValue(nextHeaderCellIndex[0] + \".cells.\" + nextHeaderCellIndex[1], this.active.matrix.getRowsFromIndex(nextHeaderCellIndex[0], this.active));\n                if (nextCell && nextCell.getBoundingClientRect().width === 0\n                    && this.active.matrix.matrix.length - 1 === nextHeaderCellIndex[0]) {\n                    lastHeaderCellIndex = this.active.matrix.nextVisibleCellFocus(nextHeaderCellIndex[0], nextHeaderCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                }\n                if (this.active.matrix.current.toString() === lastHeaderCellIndex.toString() && this.content.matrix.matrix.length) {\n                    returnVal = true;\n                    this.setActive(true);\n                    var firstContentCellIndex = [0, 0];\n                    if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n                        this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').setAttribute('aria-hidden', 'true');\n                    }\n                    if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n                        firstContentCellIndex = findCellIndex(this.active.matrix.matrix, [0, 0], true);\n                    }\n                    var firstCell = getValue(firstContentCellIndex[0] + \".cells.\" + firstContentCellIndex[1], this.active.matrix.getRowsFromIndex(firstContentCellIndex[0], this.active));\n                    if (firstCell && firstCell.getBoundingClientRect().width === 0) {\n                        firstContentCellIndex = this.active.matrix.nextVisibleCellFocus(firstContentCellIndex[0], firstContentCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                    }\n                    this.active.matrix.current = this.parent.editSettings.mode === 'Batch' ?\n                        this.isValidBatchEditCell(firstContentCellIndex) ? firstContentCellIndex :\n                            this.findBatchEditCell(firstContentCellIndex, true) : firstContentCellIndex;\n                    if (this.parent.enableVirtualization && !this.parent.enableColumnVirtualization\n                        && this.parent.contentModule.prevInfo.blockIndexes[0] !== 1) {\n                        e.preventDefault();\n                        this.removeFocus();\n                        var virtual = this.parent.contentModule;\n                        virtual.firstCellFocus = true;\n                        virtual.content.scrollTop = 0;\n                        return;\n                    }\n                }\n                else if (this.active.matrix.current.toString() !== nextHeaderCellIndex.toString()) {\n                    this.active.matrix.current = nextHeaderCellIndex;\n                }\n            }\n            if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n                var previousCellIndex = findCellIndex(this.active.matrix.matrix, this.active.matrix.current, false);\n                var prevCell = getValue(previousCellIndex[0] + \".cells.\" + previousCellIndex[1], this.active.matrix.getRowsFromIndex(previousCellIndex[0], this.active));\n                if (prevCell && prevCell.getBoundingClientRect().width === 0 && previousCellIndex[0] === 0) {\n                    previousCellIndex = this.active.matrix.nextVisibleCellFocus(previousCellIndex[0], previousCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                }\n                if (previousCellIndex.toString() === this.active.matrix.current.toString()) {\n                    this.focusOutFromHeader(e);\n                    return;\n                }\n                if (this.active.matrix.current.toString() !== previousCellIndex.toString() && !returnVal) {\n                    returnVal = true;\n                    var prevCell_1 = getValue(previousCellIndex[0] + \".cells.\" + previousCellIndex[1], this.active.matrix.getRowsFromIndex(previousCellIndex[0], this.active));\n                    if (prevCell_1 && prevCell_1.getBoundingClientRect().width === 0 && previousCellIndex[0] === 0) {\n                        previousCellIndex = this.active.matrix.nextVisibleCellFocus(previousCellIndex[0], previousCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                    }\n                    this.active.matrix.current = previousCellIndex;\n                }\n            }\n        }\n        if (e.target && parentsUntil(e.target, 'e-gridcontent')) {\n            if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n                this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').removeAttribute('aria-hidden');\n            }\n            if (this.parent.editSettings.mode === 'Batch' && (e.action === 'tab' || e.action === 'shiftTab')) {\n                this.active.matrix.current = this.findBatchEditCell(prevBatchValue, e.action === 'tab' ? true : false);\n                if (e.action === 'tab' && prevBatchValue.toString() === this.active.matrix.current.toString()) {\n                    this.parent.editModule.editModule.addBatchRow = true;\n                }\n            }\n            if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n                if (this.parent.allowGrouping && !isNullOrUndefined(this.parent.groupSettings.columns)\n                    && this.parent.groupSettings.columns.length === this.parent.columns.length) {\n                    this.focusOutFromHeader(e);\n                    return;\n                }\n                var firstContentCellIndex = [0, 0];\n                if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n                    firstContentCellIndex = findCellIndex(this.active.matrix.matrix, [0, 0], true);\n                }\n                var firstCell = getValue(firstContentCellIndex[0] + \".cells.\" + firstContentCellIndex[1], this.active.matrix.getRowsFromIndex(firstContentCellIndex[0], this.active));\n                if (firstCell && firstCell.getBoundingClientRect().width === 0) {\n                    firstContentCellIndex = this.active.matrix.nextVisibleCellFocus(firstContentCellIndex[0], firstContentCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                }\n                if (!returnVal && (firstContentCellIndex.toString() === this.active.matrix.current.toString()\n                    || (this.parent.editSettings.mode === 'Batch'\n                        && prevBatchValue.toString() === this.active.matrix.current.toString()))) {\n                    returnVal = true;\n                    this.setActive(false);\n                    this.setLastContentCellActive();\n                }\n            }\n        }\n        if (returnVal === false) {\n            this.clearIndicator();\n            if (e.action === 'shiftTab' && bValue.toString() === [0, 0].toString()) {\n                this.parent.element.tabIndex = -1;\n            }\n            if (this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus() && this.allowToPaging(e)\n                && bValue.toString() !== [0, 0].toString()) {\n                e.preventDefault();\n                if (e.keyCode === 40) {\n                    this.parent.pagerModule.pagerObj.setPagerContainerFocus();\n                    return;\n                }\n                else if (e.keyCode === 9) {\n                    this.parent.pagerModule.pagerObj.setPagerFocus();\n                    return;\n                }\n            }\n            if (this.parent.element.classList.contains('e-childgrid')) {\n                this.focusOutFromChildGrid(e);\n            }\n            return;\n        }\n        this.header.action = e.action;\n        this.header.currentTarget = null;\n        this.header.focusType = 'key';\n        if (e.target && parentsUntil(e.target, 'e-fltrtemp') && (e.action === 'tab' || e.action === 'shiftTab')) {\n            var target = e.target;\n            var focusElement = [].slice.call(closest(target, 'th').querySelectorAll('.e-fltrtemp-focus'));\n            if (focusElement.length) {\n                var elementIndex = focusElement.indexOf(target);\n                var resetActive = ((e.action === 'tab' && elementIndex < focusElement.length - 1)\n                    || (e.action === 'shiftTab' && elementIndex > 0)) ? true : false;\n                if (resetActive) {\n                    this.setActive(false);\n                    this.active.matrix.current = bValue;\n                    this.active.currentTarget = target;\n                }\n            }\n        }\n        if (focusFirstHeaderCell && parentsUntil(this.active.getTable(), 'e-gridheader')\n            && e.target && e.target.id === this.parent.element.id + '_searchbar') {\n            this.parent.searchModule.headerFocus = true;\n        }\n        e.preventDefault();\n        this.focus(e);\n    };\n    FocusStrategy.prototype.isValidBatchEditCell = function (cellIndex) {\n        var cell = this.active.getTable().rows[cellIndex[0]].cells[cellIndex[1]];\n        var tr = closest(cell, 'tr');\n        var cellColIndex = parseInt(cell.getAttribute('aria-colindex'), 10) - 1;\n        var cellCol = this.parent.getColumns()[parseInt(cellColIndex.toString(), 10)];\n        if (this.active.matrix.matrix[cellIndex[0]][cellIndex[1]] === 1\n            && (!tr.classList.contains('e-row') || (tr.classList.contains('e-insertedrow') || !cellCol.isPrimaryKey) && cellCol.allowEditing)) {\n            return true;\n        }\n        return false;\n    };\n    FocusStrategy.prototype.findBatchEditCell = function (currentCellIndex, next, limitRow) {\n        var cellIndex = currentCellIndex;\n        var tempCellIndex = currentCellIndex;\n        var cellIndexObtain = false;\n        while (!cellIndexObtain) {\n            var prevTempCellIndex = tempCellIndex;\n            tempCellIndex = findCellIndex(this.active.matrix.matrix, tempCellIndex, next);\n            var tempCell = getValue(tempCellIndex[0] + \".cells.\" + tempCellIndex[1], this.active.getTable().rows);\n            if (tempCell && tempCell.getBoundingClientRect().width === 0) {\n                tempCellIndex = this.active.matrix.nextVisibleCellFocus(tempCellIndex[0], tempCellIndex[1], this.activeKey, this.active.keyActions[this.activeKey], this.active, this.active.matrix.current[1]);\n            }\n            if ((prevTempCellIndex.toString() === tempCellIndex.toString())\n                || (limitRow && prevTempCellIndex[0] !== tempCellIndex[0])) {\n                cellIndexObtain = true;\n                continue;\n            }\n            if (this.isValidBatchEditCell(tempCellIndex)) {\n                cellIndex = tempCellIndex;\n                cellIndexObtain = true;\n            }\n        }\n        return cellIndex;\n    };\n    FocusStrategy.prototype.setLastContentCellActive = function () {\n        var lastContentCellIndex = [this.active.matrix.matrix.length - 1,\n            this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n        if (this.active.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n            lastContentCellIndex = findCellIndex(this.active.matrix.matrix, lastContentCellIndex, false);\n        }\n        var lastCell = getValue(lastContentCellIndex[0] + \".cells.\" + lastContentCellIndex[1], this.active.matrix.getRowsFromIndex(lastContentCellIndex[0], this.active));\n        if (lastCell && lastCell.getBoundingClientRect().width === 0) {\n            lastContentCellIndex = this.active.matrix.nextVisibleCellFocus(lastContentCellIndex[0], lastContentCellIndex[1], this.activeKey, this.active.keyActions[this.activeKey], this.active, this.active.matrix.current[1]);\n        }\n        this.active.matrix.current = lastContentCellIndex;\n    };\n    FocusStrategy.prototype.focusOutFromChildGrid = function (e) {\n        var parentTable = parentsUntil(this.parent.element, 'e-table');\n        var parentGrid = parentsUntil(parentTable, 'e-grid').ej2_instances[0];\n        var parentCell = parentsUntil(this.parent.element, 'e-detailcell');\n        var uid = parentsUntil(this.parent.element, 'e-detailrow').getAttribute('data-uid');\n        var parentRows = [].slice.call(parentGrid.getContentTable().rows);\n        var parentRowIndex = parentRows.map(function (m) { return m.getAttribute('data-uid'); }).indexOf(uid);\n        if (e.action === 'tab' && parentRowIndex >= parentRows.length - 1) {\n            return;\n        }\n        removeClass([this.parent.element], ['e-focus']);\n        removeClass([parentCell], ['e-focused']);\n        parentCell.tabIndex = -1;\n        e.preventDefault();\n        var nextFocusCell;\n        parentGrid.focusModule.removeFocus();\n        if (e.action === 'shiftTab') {\n            var previousRow = parentRows[parentRowIndex - 1];\n            var rowCells = previousRow.cells;\n            for (var i = rowCells.length - 1; i >= 0; i--) {\n                nextFocusCell = rowCells[parseInt(i.toString(), 10)];\n                if (!nextFocusCell.classList.contains('e-hide')) {\n                    parentGrid.focusModule.active.matrix.current = [parentRowIndex - 1, i];\n                    break;\n                }\n            }\n        }\n        else {\n            nextFocusCell = parentRows[parentRowIndex + 1].cells[0];\n            parentGrid.focusModule.active.matrix.current = [parentRowIndex + 1, 0];\n        }\n        parentGrid.focusModule.currentInfo.element = nextFocusCell;\n        parentGrid.focusModule.currentInfo.elementToFocus = nextFocusCell;\n        addClass([nextFocusCell], ['e-focused', 'e-focus']);\n        nextFocusCell.tabIndex = 0;\n        nextFocusCell.focus();\n    };\n    FocusStrategy.prototype.focusOutFromHeader = function (e) {\n        this.removeFocus();\n        if (this.parent.toolbar || this.parent.toolbarTemplate) {\n            var toolbarElement = this.parent.toolbarModule.element;\n            var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n            e.preventDefault();\n            if (focusableToolbarItems.length > 0) {\n                focusableToolbarItems[focusableToolbarItems.length - 1].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').focus();\n            }\n            else {\n                toolbarElement.focus();\n            }\n            return;\n        }\n        if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea) {\n            var groupModule = this.parent.groupModule;\n            var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n            e.preventDefault();\n            if (focusableGroupedItems.length > 0) {\n                focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n            }\n            else {\n                groupModule.element.focus();\n            }\n            return;\n        }\n        if (this.parent.element.classList.contains('e-childgrid')) {\n            e.preventDefault();\n            this.parent.element.focus();\n        }\n    };\n    FocusStrategy.prototype.allowToPaging = function (e) {\n        if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.allowAdding && e.keyCode !== 40) {\n            return false;\n        }\n        return true;\n    };\n    FocusStrategy.prototype.skipOn = function (e) {\n        var target = e.target;\n        if (!target) {\n            return false;\n        }\n        if (!this.parent.isEdit && target && target.closest('.e-unboundcell') && this.currentInfo.skipAction && ((e.action === 'shiftTab' &&\n            this.commandColumnFocusElement(target.closest('.e-unboundcell'), false) === target) ||\n            (e.action === 'tab' &&\n                this.commandColumnFocusElement(target.closest('.e-unboundcell'), true) === target))) {\n            return this.currentInfo.skipAction = false;\n        }\n        if (this.currentInfo.skipAction) {\n            this.clearIndicator();\n            return true;\n        }\n        if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n            this.clearIndicator();\n            return true;\n        }\n        if (this.parent.allowGrouping) {\n            var focusableGroupedItems = this.parent.groupModule.getFocusableGroupedItems();\n            if (parentsUntil(e.target, 'e-groupheadercell')\n                && !((e.target === focusableGroupedItems[0] && e.action === 'shiftTab')\n                    || (e.target === focusableGroupedItems[focusableGroupedItems.length - 1] && e.action === 'tab'))) {\n                return true;\n            }\n        }\n        if (this.parent.toolbar || this.parent.toolbarTemplate) {\n            var toolbarElement = this.parent.toolbarModule.element;\n            var focusableToolbarItems = toolbarElement\n                .querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n            if (parentsUntil(e.target, 'e-toolbar-item')\n                && !(focusableToolbarItems.length > 0 && ((parentsUntil(e.target, 'e-toolbar-item') === focusableToolbarItems[0] && e.action === 'shiftTab')\n                    || (parentsUntil(e.target, 'e-toolbar-item') === focusableToolbarItems[focusableToolbarItems.length - 1] && e.action === 'tab')))) {\n                return true;\n            }\n        }\n        var th = closest(target, 'th') && !closest(target, 'th').tabIndex;\n        if (e.target.classList.contains('e-filterbaroperator') && (e.keyCode === 13 || e.keyCode === 27)) {\n            var inputTarget = closest(e.target, '.e-filterbarcell');\n            inputTarget.querySelector('input').focus();\n        }\n        var addNewRow = this.parent.editSettings.showAddNewRow && closest(document.activeElement, '.e-addedrow') !== null;\n        if ((th && closest(document.activeElement, '.e-filterbarcell') !== null) || addNewRow) {\n            this.removeFocus();\n        }\n        var filterCell = closest(document.activeElement, '.e-filterbarcell') !== null;\n        if (this.parent.enableHeaderFocus && filterCell) {\n            var matrix = this.active.matrix;\n            var current = matrix.current;\n            filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n        }\n        if (this.parent.isEdit && (e.action === 'tab' || e.action === 'shiftTab') && this.parent.editSettings.mode === 'Normal'\n            && !this.parent.editSettings.showAddNewRow && !isNullOrUndefined(parentsUntil(target, 'e-addedrow'))) {\n            var inputElements = this.parent.editModule.formObj.element.querySelectorAll('input:not([type=\"hidden\"],.e-numeric-hidden,.e-disabled), select:not([aria-hidden=\"true\"]), button:not(.e-hide), textarea:not(.e-hide,.e-disabled,[disabled])');\n            var inputTarget = target.classList.contains('e-ddl') ? target.querySelector('input') : target;\n            var firstEditCell = e.action === 'tab' && inputTarget === inputElements[inputElements.length - 1];\n            var lastEditCell = e.action === 'shiftTab' && inputTarget === inputElements[0];\n            if (firstEditCell || lastEditCell) {\n                e.preventDefault();\n                var focusElement = inputElements[firstEditCell ? 0 : inputElements.length - 1];\n                focusElement = focusElement.parentElement.classList.contains('e-ddl') ? focusElement.parentElement : focusElement;\n                focusElement.focus();\n            }\n        }\n        return (e.action === 'delete'\n            || (this.parent.editSettings.mode !== 'Batch' && ((this.parent.isEdit && (!this.parent.editSettings.showAddNewRow ||\n                (this.parent.editSettings.showAddNewRow && ((!isNullOrUndefined(this.parent.element.querySelector('.e-editedrow')) ||\n                    (!isNullOrUndefined(parentsUntil(target, 'e-addedrow')) && !isNullOrUndefined(closest(e.target, 'input')) && !isNullOrUndefined(document.querySelector('.e-popup-open'))) ||\n                    (!isNullOrUndefined(parentsUntil(target, 'e-addedrow')) && (target && !target.querySelector('.e-cancel-icon')) &&\n                        !isNullOrUndefined(parentsUntil(target, 'e-unboundcell')))))))) || ['insert', 'f2'].indexOf(e.action) > -1))\n            || ((filterCell && this.parent.enableHeaderFocus) || ((filterCell || addNewRow) && e.action !== 'tab' && e.action !== 'shiftTab') ||\n                closest(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null\n                    && ['enter', 'leftArrow', 'rightArrow',\n                        'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1)\n            || (closest(target, '.' + literals.gridContent) === null && closest(target, '.' + literals.gridHeader) === null\n                && !(e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar')\n                    || parentsUntil(e.target, 'e-groupdroparea')))\n            || (e.action === 'space' && (!target.classList.contains(literals.gridChkBox) && closest(target, '.' + literals.gridChkBox) === null\n                && closest(target, '.e-headerchkcelldiv') === null))) || closest(target, '.e-filter-popup') !== null;\n    };\n    FocusStrategy.prototype.focusVirtualElement = function (e) {\n        var _this = this;\n        if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n            var data = { virtualData: {}, isAdd: false, isCancel: false };\n            this.parent.notify(event.getVirtualData, data);\n            var isKeyFocus = this.actions.some(function (value) { return value === _this.activeKey; });\n            var isSelected = this.parent.contentModule ?\n                this.parent.contentModule.selectedRowIndex > -1 : false;\n            if (data.isAdd || Object.keys(data.virtualData).length || isKeyFocus || data.isCancel || isSelected) {\n                this.parent.notify(event.resetVirtualFocus, { isCancel: false });\n                data.isCancel = false;\n                if (((this.parent.enableVirtualization && !this.parent.selectVirtualRowOnAdd) && (!e || (e && e.action !== 'ctrlHome' && e.action !== 'ctrlEnd'))) ||\n                    !this.parent.enableVirtualization) {\n                    this.parent.contentModule.selectedRowIndex = -1;\n                }\n                this.parent.selectVirtualRowOnAdd = false;\n                if (isKeyFocus) {\n                    this.activeKey = this.empty;\n                    this.parent.notify('virtaul-key-handler', e);\n                }\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                this.currentInfo.elementToFocus.focus({ preventScroll: true });\n            }\n            else {\n                if (this.isVirtualScroll || this.isInfiniteScroll) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    this.currentInfo.elementToFocus.focus({ preventScroll: true });\n                }\n                else {\n                    this.currentInfo.elementToFocus.focus();\n                }\n            }\n        }\n        this.isVirtualScroll = this.isInfiniteScroll = false;\n    };\n    FocusStrategy.prototype.getFocusedElement = function () {\n        return this.currentInfo.elementToFocus;\n    };\n    FocusStrategy.prototype.getContent = function () {\n        return this.active || this.content;\n    };\n    FocusStrategy.prototype.setActive = function (content) {\n        this.active = content ? this.content : this.header;\n    };\n    FocusStrategy.prototype.setFocusedElement = function (element, e) {\n        var _this = this;\n        this.currentInfo.elementToFocus = element;\n        setTimeout(function () {\n            if (!isNullOrUndefined(_this.currentInfo.elementToFocus)) {\n                var filterMenuElement = isNullOrUndefined(_this.parent.element.querySelector('.e-flmenu')) ?\n                    document.querySelector('.e-grid-popup .e-flmenu') : _this.parent.element.querySelector('.e-flmenu');\n                if ((_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) && isNullOrUndefined(filterMenuElement)) {\n                    _this.focusVirtualElement(e);\n                }\n                else if (isNullOrUndefined(filterMenuElement) ||\n                    parentsUntil(document.activeElement, 'e-flmenu-valuediv') !== filterMenuElement.querySelector('.e-flmenu-valuediv')) {\n                    _this.currentInfo.elementToFocus.focus();\n                }\n            }\n        }, 0);\n    };\n    FocusStrategy.prototype.focus = function (e) {\n        this.parent.notify(event.virtaulCellFocus, e);\n        this.removeFocus();\n        this.addFocus(this.getContent().getFocusInfo(), e);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    FocusStrategy.prototype.removeFocus = function (e) {\n        if (!this.currentInfo.element) {\n            return;\n        }\n        if (this.parent.isReact && !this.parent.isEdit && this.currentInfo.element.classList.contains('e-rowcell')\n            && !this.currentInfo.element.parentElement && !(this.parent.allowGrouping\n            && !isNullOrUndefined(this.parent.groupSettings.columns) && this.parent.groupSettings.columns.length) &&\n            this.parent.getRowByIndex(this.prevIndexes.rowIndex)) {\n            var cellElem = this.parent.getCellFromIndex(this.prevIndexes.rowIndex, this.prevIndexes\n                .cellIndex);\n            this.currentInfo.element = cellElem ? cellElem : this.currentInfo.element;\n        }\n        removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n        this.currentInfo.element.tabIndex = -1;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.addOutline = function () {\n        var info = this.getContent().getFocusInfo();\n        if (info.element) {\n            addClass([info.element], ['e-focused']);\n            addClass([info.elementToFocus], ['e-focus']);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.focusHeader = function () {\n        this.setActive(false);\n        this.resetFocus();\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.focusContent = function () {\n        this.setActive(true);\n        this.resetFocus();\n    };\n    FocusStrategy.prototype.resetFocus = function () {\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n        this.getContent().matrix.select(current[0], current[1]);\n        this.focus();\n    };\n    FocusStrategy.prototype.addFocus = function (info, e) {\n        this.currentInfo = info;\n        this.currentInfo.outline = info.outline && (!isNullOrUndefined(e) || this.isVirtualScroll);\n        if (this.isInfiniteScroll) {\n            this.currentInfo.outline = true;\n        }\n        if (!info.element) {\n            return;\n        }\n        var isFocused = info.elementToFocus.classList.contains('e-focus');\n        if (isFocused) {\n            return;\n        }\n        if (this.currentInfo.outline) {\n            addClass([info.element], ['e-focused']);\n        }\n        addClass([info.elementToFocus], ['e-focus']);\n        info.element.tabIndex = 0;\n        if (!isFocused) {\n            this.setFocusedElement(info.elementToFocus, e);\n        }\n        this.parent.notify(event.cellFocused, {\n            element: info.elementToFocus,\n            parent: info.element,\n            indexes: this.getContent().matrix.current,\n            byKey: !isNullOrUndefined(e),\n            byClick: isNullOrUndefined(e),\n            keyArgs: e,\n            isJump: this.swap.swap,\n            container: this.getContent().getInfo(e),\n            outline: !isNullOrUndefined(e),\n            swapInfo: this.swap\n        });\n        var _a = this.getContent().matrix.current, rowIndex = _a[0], cellIndex = _a[1];\n        this.prevIndexes = { rowIndex: rowIndex, cellIndex: cellIndex };\n        this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n        this.focusByClick = false;\n    };\n    FocusStrategy.prototype.refreshMatrix = function (content) {\n        var _this = this;\n        return function (e) {\n            if (content && !_this.content) {\n                _this.content = new ContentFocus(_this.parent);\n            }\n            if (!content && !_this.header) {\n                _this.header = new HeaderFocus(_this.parent);\n            }\n            var cFocus = content ? _this.content : _this.header;\n            var frozenRow = _this.parent.frozenRows;\n            var batchLen = 0;\n            if (frozenRow && _this.parent.editSettings.mode === 'Batch') {\n                batchLen = _this.parent.getHeaderContent().querySelectorAll('.e-insertedrow').length +\n                    _this.parent.getHeaderContent().querySelectorAll('.e-hiddenrow').length;\n            }\n            if (!isNullOrUndefined(_this.parent.groupSettings.columns) && _this.parent.groupSettings.columns.length && frozenRow && content) {\n                frozenRow = 0;\n                for (var i = 0; i < e.rows.length; i++) {\n                    frozenRow++;\n                    if (e.rows[parseInt(i.toString(), 10)].index + 1 === _this.parent.frozenRows) {\n                        break;\n                    }\n                }\n                _this.groupedFrozenRow = frozenRow;\n            }\n            var rows = content ? e.rows.slice(frozenRow + batchLen) : e.rows;\n            var updateRow = content ? e.rows.slice(0, frozenRow + batchLen) : e.rows;\n            if (_this.parent.isCollapseStateEnabled() && content) {\n                rows = rows.filter(function (x) { return x.visible !== false; });\n            }\n            var isRowTemplate = !isNullOrUndefined(_this.parent.rowTemplate);\n            if (frozenRow && ((_this.parent.editSettings.mode === 'Batch' && content && (e.name === 'batchDelete' || e.name === 'batchAdd' ||\n                e.name === 'batchCancel' || (e.args && (e.args.requestType === 'batchsave')))) ||\n                (e.args && (e.args.requestType === 'delete' || e.args.requestType === 'save')))) {\n                var matrixcs = _this.header.matrix.matrix;\n                var hdrLen = _this.parent.headerModule.rows.length;\n                matrixcs.splice(hdrLen, matrixcs.length - hdrLen);\n            }\n            var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n            cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n            var isScroll = _this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling;\n            if ((_this.parent.editSettings.showAddNewRow && content && _this.header && _this.header.matrix) &&\n                (!isScroll || (isScroll && _this.parent.isAddNewRow))) {\n                var tempMatrix = _this.header.matrix.matrix;\n                var lastRowHeaderIdx = _this.parent.allowFiltering && _this.parent.filterSettings.type === 'FilterBar' ? 2 : 1;\n                cFocus.matrix.rows = _this.parent.frozenRows && _this.parent.editSettings.newRowPosition === 'Top' ?\n                    cFocus.matrix.rows : ++cFocus.matrix.rows;\n                if (_this.parent.editSettings.newRowPosition === 'Top') {\n                    (_this.parent.frozenRows || isScroll ?\n                        matrix : cFocus.matrix.matrix).unshift(_this.refreshAddNewRowMatrix(tempMatrix[tempMatrix.length -\n                        lastRowHeaderIdx]));\n                }\n                else {\n                    cFocus.matrix.matrix.push(_this.refreshAddNewRowMatrix(tempMatrix[tempMatrix.length - lastRowHeaderIdx]));\n                }\n                _this.parent.isAddNewRow = false;\n            }\n            if (!(_this.parent.isFrozenGrid() && (e.args && (e.args.requestType === 'sorting'\n                || e.args.requestType === 'batchsave' || e.args.requestType === 'paging'))) ||\n                (frozenRow && _this.parent.editSettings.mode === 'Batch' && content && (e.name === 'batchDelete' || e.name === 'batchAdd' ||\n                    e.name === 'batchCancel' || e.args.requestType === 'batchsave'))) {\n                cFocus.generateRows(updateRow, {\n                    matrix: matrix, handlerInstance: _this.header\n                });\n            }\n            if (!Browser.isDevice && e && e.args) {\n                if (!_this.focusByClick && e.args.requestType === 'paging' && !_this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n                    _this.skipFocus = false;\n                    _this.parent.element.focus();\n                }\n                if (e.args.requestType === 'grouping') {\n                    _this.skipFocus = true;\n                }\n            }\n            if (e && e.args && e.args.requestType === 'virtualscroll') {\n                if (_this.currentInfo.uid) {\n                    var index_1;\n                    var bool = e.rows.some(function (row, i) {\n                        index_1 = i;\n                        return row.uid === _this.currentInfo.uid;\n                    });\n                    if (bool) {\n                        _this.content.matrix.current[0] = index_1;\n                        _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n                        var frzLeftCount = _this.parent.getVisibleFrozenLeftCount();\n                        var frzRightCount = _this.parent.getVisibleFrozenRightCount();\n                        if (_this.parent.enableColumnVirtualization && !(frzLeftCount && frzRightCount) && _this.parent.isFrozenGrid() &&\n                            e.args.virtualInfo.direction === 'right') {\n                            _this.content.matrix.current[1] = _this.content.matrix.current[1] - (frzLeftCount + (frzRightCount ? frzRightCount + 1 : 0));\n                        }\n                        var isGroup = _this.parent.allowGrouping && _this.parent.groupSettings.columns.length ? true : false;\n                        if (isGroup) {\n                            _this.content.matrix.current[1] = _this.prevIndexes.cellIndex;\n                            if (_this.virtualSelectionInfo.isPending) {\n                                _this.content.matrix.current[0] = _this.virtualSelectionInfo.direction === 'downArrow' ? _this.content.matrix.current[0] + 1\n                                    : _this.content.matrix.current[0] - 1;\n                            }\n                        }\n                        var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n                        if (focusElement) {\n                            var cellPosition = focusElement.getBoundingClientRect();\n                            var gridPosition = _this.parent.element.getBoundingClientRect();\n                            var freezeLeftColWidth = 0;\n                            var freezeRightColWidth = 0;\n                            if (_this.parent.enableColumnVirtualization && !(frzLeftCount && frzRightCount) && _this.parent.isFrozenGrid() &&\n                                e.args.virtualInfo.direction === 'right') {\n                                if (frzLeftCount) {\n                                    freezeLeftColWidth = _this.parent.leftrightColumnWidth('left');\n                                }\n                                else {\n                                    freezeRightColWidth = _this.parent.leftrightColumnWidth('right');\n                                }\n                            }\n                            if ((cellPosition.top >= 0 && cellPosition.left >= 0 &&\n                                (cellPosition.right - freezeLeftColWidth - freezeRightColWidth) <= (Math.min(gridPosition.right, window.innerWidth || document.documentElement.clientWidth) + freezeRightColWidth)\n                                && cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight ||\n                                    document.documentElement.clientHeight)) || isGroup) {\n                                _this.isVirtualScroll = true;\n                                _this.focus(isGroup && _this.virtualSelectionInfo.isPending ?\n                                    _this.virtualSelectionInfo.event : undefined);\n                            }\n                        }\n                    }\n                }\n                else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n                    var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n                    if (focusElement) {\n                        focusElement.focus();\n                    }\n                }\n                _this.virtualSelectionInfo = {};\n            }\n            if (e && e.args && e.args.requestType === 'infiniteScroll') {\n                _this.isInfiniteScroll = true;\n            }\n        };\n    };\n    FocusStrategy.prototype.refreshAddNewRowMatrix = function (matrix) {\n        var cols = this.parent.getColumns();\n        var indent = this.parent.getIndentCount();\n        for (var i = indent; i < matrix.length - 1; i++) {\n            if (cols[i - indent] && cols[i - indent].visible && cols[i - indent].allowEditing) {\n                matrix[parseInt(i.toString(), 10)] = 1;\n            }\n            else {\n                matrix[parseInt(i.toString(), 10)] = 0;\n            }\n        }\n        return matrix;\n    };\n    FocusStrategy.prototype.addEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n        EventHandler.add(this.parent.element, 'touchstart', this.focusCheck, this);\n        EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n        this.parent.element.addEventListener('focus', this.passiveHandler = function (e) { return _this.passiveFocus(e); }, true);\n        EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n        this.evtHandlers = [{ event: event.keyPressed, handler: this.onKeyPress },\n            { event: event.click, handler: this.onClick },\n            { event: event.contentReady, handler: this.refMatrix },\n            { event: event.partialRefresh, handler: this.refMatrix },\n            { event: event.refreshExpandandCollapse, handler: this.refMatrix },\n            { event: event.showAddNewRowFocus, handler: this.showAddNewRowFocus },\n            { event: event.headerRefreshed, handler: this.refreshMatrix() },\n            { event: event.closeEdit, handler: this.restoreFocus },\n            { event: event.restoreFocus, handler: this.restoreFocus },\n            { event: 'start-edit', handler: this.clearIndicator },\n            { event: 'start-add', handler: this.clearIndicator },\n            { event: 'sorting-complete', handler: this.restoreFocus },\n            { event: 'filtering-complete', handler: this.filterfocus },\n            { event: 'custom-filter-close', handler: this.filterfocus },\n            { event: 'grouping-complete', handler: this.restoreFocusWithAction },\n            { event: 'ungrouping-complete', handler: this.restoreFocusWithAction },\n            { event: event.batchAdd, handler: this.refMatrix },\n            { event: event.batchCancel, handler: this.refMatrix },\n            { event: event.batchDelete, handler: this.refMatrix },\n            { event: event.detailDataBound, handler: this.refMatrix },\n            { event: event.onEmpty, handler: this.refMatrix },\n            { event: event.cellFocused, handler: this.internalCellFocus }];\n        addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n    };\n    FocusStrategy.prototype.showAddNewRowFocus = function () {\n        if (this.parent.editSettings.showAddNewRow) {\n            var startIdx = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.content.matrix.matrix.length - 1;\n            var startCellIdx = this.parent.getIndentCount();\n            if (this.parent.editSettings.newRowPosition === 'Top' && (this.parent.frozenRows ||\n                this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n                var headrIdx = this.header.matrix.matrix.length - (this.groupedFrozenRow ?\n                    this.groupedFrozenRow : this.parent.frozenRows);\n                startCellIdx = this.findNextCellFocus(this.header.matrix.matrix[headrIdx - 1], startCellIdx);\n                this.header.matrix.current = [headrIdx - 1, startCellIdx];\n                this.active = this.header;\n            }\n            else {\n                startCellIdx = this.findNextCellFocus(this.content.matrix.matrix[parseInt(startIdx.toString(), 10)], startCellIdx);\n                this.content.matrix.current = [startIdx, startCellIdx];\n                this.active = this.content;\n            }\n            var addedrow = this.parent.element.querySelector('.e-addedrow');\n            if (addedrow && addedrow.querySelectorAll('tr') &&\n                addedrow.querySelector('tr').cells[parseInt(startCellIdx.toString(), 10)].querySelector('input')) {\n                addedrow.querySelector('tr').cells[parseInt(startCellIdx.toString(), 10)].querySelector('input').select();\n            }\n        }\n    };\n    FocusStrategy.prototype.findNextCellFocus = function (matrix, cellIndex) {\n        for (var i = cellIndex; i < matrix.length; i++) {\n            if (matrix[parseInt(i.toString(), 10)] === 1) {\n                return i;\n            }\n        }\n        return cellIndex;\n    };\n    FocusStrategy.prototype.filterfocus = function () {\n        if (this.parent.filterSettings.type !== 'FilterBar') {\n            this.removeFocus();\n            this.restoreFocus();\n        }\n    };\n    FocusStrategy.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n        EventHandler.remove(this.parent.element, 'touchstart', this.focusCheck);\n        EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n        EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n        this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n        addRemoveEventListener(this.parent, this.evtHandlers, false);\n    };\n    FocusStrategy.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    FocusStrategy.prototype.restoreFocus = function (arg) {\n        if (arg && arg.requestType === 'sorting' && isNullOrUndefined(arg.target)) {\n            return;\n        }\n        var groupModule = this.parent.groupModule;\n        if (this.parent.allowGrouping && groupModule && (groupModule.groupSortFocus || groupModule.groupTextFocus)) {\n            groupModule.groupSortFocus = false;\n            groupModule.groupTextFocus = false;\n            return;\n        }\n        this.firstHeaderCellClick = true;\n        this.addFocus(this.getContent().getFocusInfo());\n        var requestTypes = ['add', 'save', 'delete', 'cancel', 'batchsave', 'batchDelete', 'batchCancel'];\n        var focusInfo = this.getContent().getFocusInfo();\n        if (arg && requestTypes.indexOf(arg.requestType) > -1 && focusInfo && focusInfo.elementToFocus && focusInfo.elementToFocus.matches('.e-rowcell.e-focus')) {\n            addClass([focusInfo.elementToFocus], ['e-focused', 'e-focus']);\n        }\n    };\n    FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n        if (!this.parent.enableInfiniteScrolling &&\n            !(this.parent.groupModule && this.parent.groupModule.preventFocusOnGroup)) {\n            var matrix = this.getContent().matrix;\n            var current = matrix.current;\n            switch (e.requestType) {\n                case 'grouping':\n                case 'ungrouping':\n                    current[1] = current.length &&\n                        !this.parent.groupSettings.showGroupedColumn && !isNullOrUndefined(matrix.matrix[current[0]]) ?\n                        matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n                    break;\n            }\n            this.getContent().matrix.current = current;\n            this.prevIndexes = { rowIndex: current[0], cellIndex: current[1] };\n            var groupModule = this.parent.groupModule;\n            if (this.parent.allowGrouping && groupModule && groupModule.groupCancelFocus) {\n                var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                if (focusableGroupedItems.length) {\n                    if (focusableGroupedItems[0].parentElement.getAttribute('ej-mappingname') === e.columnName) {\n                        focusableGroupedItems[3].focus();\n                    }\n                    else {\n                        focusableGroupedItems[0].focus();\n                    }\n                }\n                else {\n                    groupModule.element.focus();\n                }\n                groupModule.groupCancelFocus = false;\n                return;\n            }\n            this.addFocus(this.getContent().getFocusInfo());\n        }\n    };\n    FocusStrategy.prototype.clearIndicator = function () {\n        if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n            return;\n        }\n        removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n    };\n    FocusStrategy.prototype.getPrevIndexes = function () {\n        var forget = this.forget;\n        this.forget = false;\n        return forget || !Object.keys(this.prevIndexes).length ? { rowIndex: null, cellIndex: null } : this.prevIndexes;\n    };\n    FocusStrategy.prototype.forgetPrevious = function () {\n        this.forget = true;\n    };\n    FocusStrategy.prototype.setActiveByKey = function (action, active) {\n        if (this.parent.frozenRows === 0) {\n            return;\n        }\n        // eslint-disable-next-line prefer-const\n        var info;\n        var actions = {\n            'home': function () { return ({ toHeader: !info.isContent, toFrozen: true }); },\n            'end': function () { return ({ toHeader: !info.isContent, toFrozen: false }); },\n            'ctrlHome': function () { return ({ toHeader: true, toFrozen: false }); },\n            'ctrlEnd': function () { return ({ toHeader: false, toFrozen: false }); }\n        };\n        if (!(action in actions)) {\n            return;\n        }\n        info = active.getInfo();\n        var swap = actions[\"\" + action]();\n        this.setActive(!swap.toHeader);\n        this.getContent().matrix.current = active.matrix.current;\n    };\n    FocusStrategy.prototype.internalCellFocus = function (e) {\n        if (!(e.byKey && e.container.isContent && ((e.keyArgs.action === 'enter' && e.parent.classList.contains('e-detailcell')) ||\n            ((e.keyArgs.action === 'tab' || e.keyArgs.action === 'shiftTab') && e.parent.classList.contains('e-unboundcell'))))) {\n            return;\n        }\n        this.clearIndicator();\n        var focusEle;\n        if (e.parent && e.parent.closest('.e-unboundcell') && e.keyArgs.action === 'shiftTab') {\n            focusEle = this.commandColumnFocusElement(e.parent, true);\n        }\n        else {\n            focusEle = this.getContent().getFocusable(this.getFocusedElement());\n        }\n        this.setFocusedElement(focusEle);\n        this.currentInfo.skipAction = true;\n    };\n    FocusStrategy.prototype.commandColumnFocusElement = function (cell, isLast) {\n        var commandButtons = cell.querySelectorAll('button:not(.e-hide)');\n        return isLast ? commandButtons[commandButtons.length - 1] : commandButtons[0];\n    };\n    return FocusStrategy;\n}());\nexport { FocusStrategy };\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n *\n * @hidden\n */\nvar Matrix = /** @class */ (function () {\n    function Matrix() {\n        this.matrix = [];\n        this.current = [];\n    }\n    Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n        this.matrix[parseInt(rowIndex.toString(), 10)] = this.matrix[parseInt(rowIndex.toString(), 10)] || [];\n        this.matrix[parseInt(rowIndex.toString(), 10)][parseInt(columnIndex.toString(), 10)] = allow ? 1 : 0;\n    };\n    Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator, active) {\n        var tmp = columnIndex;\n        if (rowIndex + navigator[0] < 0) {\n            return [rowIndex, columnIndex];\n        }\n        rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n        var emptyTable = true;\n        if (isNullOrUndefined(this.matrix[parseInt(rowIndex.toString(), 10)])) {\n            return null;\n        }\n        columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[parseInt(rowIndex.toString(), 10)].length - 1));\n        if (tmp + navigator[1] > this.matrix[parseInt(rowIndex.toString(), 10)].length - 1\n            && validator(rowIndex, columnIndex, action)) {\n            return [rowIndex, tmp];\n        }\n        var first = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n        columnIndex = first === null ? tmp : first;\n        var val = getValue(rowIndex + \".\" + columnIndex, this.matrix);\n        if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n            navigator[0] = -1;\n        }\n        var cell;\n        if (active) {\n            var rows = this.getRowsFromIndex(rowIndex, active);\n            cell = getValue(rowIndex + \".cells.\" + columnIndex, rows);\n        }\n        if (cell && cell.getBoundingClientRect().width === 0) {\n            var current = this.nextVisibleCellFocus(rowIndex, columnIndex, action, navigator, active, tmp);\n            rowIndex = current[0];\n            columnIndex = current[1];\n        }\n        if (first === null) {\n            for (var i = 0; i < this.rows; i++) {\n                if (this.matrix[parseInt(i.toString(), 10)].some(function (v) { return v === 1; })) {\n                    emptyTable = false;\n                    break;\n                }\n            }\n            if (emptyTable) {\n                rowIndex = this.current.length ? this.current[0] : 0;\n                return [rowIndex, columnIndex];\n            }\n        }\n        return this.inValid(val) || !validator(rowIndex, columnIndex, action) ?\n            this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n    };\n    Matrix.prototype.getRowsFromIndex = function (rowIndex, active) {\n        return active.getTable().rows[parseInt(rowIndex.toString(), 10)].classList.contains('e-addedrow') ?\n            active.getTable().rows[parseInt(rowIndex.toString(), 10)].querySelector('table').rows : active.getTable().rows;\n    };\n    Matrix.prototype.nextVisibleCellFocus = function (rowIndex, columnIndex, action, navigator, active, tmp) {\n        var rows = this.getRowsFromIndex(rowIndex, active);\n        var cell = getValue(rowIndex + \".cells.\" + columnIndex, rows);\n        var rowMatrix = active.matrix.matrix;\n        var maxRow = rowMatrix.length - 1;\n        var isTab = action === 'tab';\n        var isShiftTab = action === 'shiftTab';\n        var skipAction = action === 'enter' || action === 'shiftEnter' || action === 'downArrow' || action === 'upArrow';\n        if (skipAction) {\n            return [rowIndex, columnIndex];\n        }\n        while (cell && cell.getBoundingClientRect().width === 0) {\n            if ((isTab && rowIndex === maxRow && columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1)) ||\n                (isShiftTab && rowIndex === 0 && columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1))) {\n                columnIndex = tmp;\n                return [rowIndex, columnIndex];\n            }\n            if (isTab) {\n                if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1)) {\n                    rowIndex++;\n                    columnIndex = rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1);\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                    rows = this.getRowsFromIndex(rowIndex, active);\n                }\n                else {\n                    columnIndex++;\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                }\n            }\n            else if (isShiftTab) {\n                if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1)) {\n                    rowIndex--;\n                    columnIndex = rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1);\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                    rows = this.getRowsFromIndex(rowIndex, active);\n                }\n                else {\n                    columnIndex--;\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                }\n            }\n            else if ((action === 'rightArrow' || action === 'shiftRight')) {\n                if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1)) {\n                    columnIndex = tmp;\n                }\n                else {\n                    columnIndex++;\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                }\n            }\n            else if ((action === 'leftArrow' || action === 'shiftLeft')) {\n                if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1)) {\n                    columnIndex = tmp;\n                }\n                else {\n                    columnIndex--;\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                }\n            }\n            else if (action === null) {\n                columnIndex++;\n                columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n            }\n            cell = getValue(rowIndex + \".cells.\" + columnIndex, rows);\n        }\n        return [rowIndex, columnIndex];\n    };\n    Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n        if (((index < 0 || index === vector.length) && this.inValid(vector[parseInt(index.toString(), 10)])\n            && (action !== 'upArrow' && action !== 'downArrow')) || !vector.some(function (v) { return v === 1; })) {\n            return null;\n        }\n        return !this.inValid(vector[parseInt(index.toString(), 10)]) ? index :\n            this.first(vector, (['upArrow', 'downArrow', 'shiftUp', 'shiftDown', 'enter', 'shiftEnter'].indexOf(action) !== -1) ? moveTo ? 0 : ++index :\n                index + navigator[1], navigator, false, action);\n    };\n    Matrix.prototype.select = function (rowIndex, columnIndex) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[parseInt(rowIndex.toString(), 10)].length - 1));\n        this.current = [rowIndex, columnIndex];\n    };\n    Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n        this.rows = rows.length - 1;\n        this.matrix = [];\n        for (var i = 0; i < rows.length; i++) {\n            var cells = rows[parseInt(i.toString(), 10)].cells.filter(function (c) { return c.isSpanned !== true; });\n            this.columns = Math.max(cells.length - 1, this.columns | 0);\n            var incrementNumber = 0;\n            for (var j = 0; j < cells.length; j++) {\n                if (cells[parseInt(j.toString(), 10)].column && cells[parseInt(j.toString(), 10)].column.columns) {\n                    incrementNumber = this.columnsCount(cells[parseInt(j.toString(), 10)].column.columns, incrementNumber);\n                }\n                else {\n                    incrementNumber++;\n                }\n                this.set(i, j, rows[parseInt(i.toString(), 10)].visible === false ?\n                    false : selector(rows[parseInt(i.toString(), 10)], cells[parseInt(j.toString(), 10)], isRowTemplate));\n            }\n            this.columns = Math.max(incrementNumber - 1, this.columns | 0);\n        }\n        return this.matrix;\n    };\n    Matrix.prototype.columnsCount = function (rowColumns, currentColumnCount) {\n        var columns = rowColumns;\n        var incrementNumber = currentColumnCount;\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                incrementNumber = this.columnsCount(columns[parseInt(i.toString(), 10)].columns, incrementNumber);\n            }\n            else {\n                incrementNumber++;\n            }\n        }\n        return incrementNumber;\n    };\n    Matrix.prototype.inValid = function (value) {\n        return value === 0 || value === undefined;\n    };\n    return Matrix;\n}());\nexport { Matrix };\n/**\n * @hidden\n */\nvar ContentFocus = /** @class */ (function () {\n    function ContentFocus(parent) {\n        var _this = this;\n        this.matrix = new Matrix();\n        this.lastIdxCell = false;\n        this.parent = parent;\n        this.keyActions = {\n            'rightArrow': [0, 1],\n            'tab': [0, 1],\n            'leftArrow': [0, -1],\n            'shiftTab': [0, -1],\n            'upArrow': [-1, 0],\n            'downArrow': [1, 0],\n            'shiftUp': [-1, 0],\n            'shiftDown': [1, 0],\n            'shiftRight': [0, 1],\n            'shiftLeft': [0, -1],\n            'enter': [1, 0],\n            'shiftEnter': [-1, 0]\n        };\n        this.indexesByKey = function (action) {\n            var opt = {\n                'home': [_this.matrix.current[0], -1, 0, 1],\n                'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n                'ctrlHome': [0, -1, 0, 1],\n                'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n            };\n            return opt[\"\" + action] || null;\n        };\n    }\n    ContentFocus.prototype.getTable = function () {\n        return (this.parent.getContentTable());\n    };\n    ContentFocus.prototype.onKeyPress = function (e) {\n        var isMacLike = /(Mac)/i.test(navigator.platform);\n        if (isMacLike && e.metaKey) {\n            if (e.action === 'home') {\n                e.action = 'ctrlHome';\n            }\n            else if (e.action === 'end') {\n                e.action = 'ctrlEnd';\n            }\n            else if (['downArrow', 'upArrow', 'leftArrow', 'rightArrow'].indexOf(e.action) !== -1) {\n                return;\n            }\n        }\n        var navigators = this.keyActions[e.action];\n        var current = this.getCurrentFromAction(e.action, navigators, e.action in this.keyActions, e);\n        if (!current) {\n            return;\n        }\n        if (((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString())\n            || (this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus()\n                && this.matrix.current[0] === this.matrix.rows && ((this.parent.editSettings.mode === 'Batch'\n                && this.parent.editSettings.allowAdding && e.keyCode === 40) || (e.keyCode === 40)))) {\n            if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() ||\n                current.toString() === [0, 0].toString() || (this.matrix.current[0] === this.matrix.rows &&\n                this.matrix.current.toString() === current.toString()) || (this.parent.allowGrouping &&\n                this.parent.infiniteScrollSettings.enableCache && current.toString() === [0, 1].toString())) {\n                return false;\n            }\n            else {\n                current = this.editNextRow(current[0], current[1], e.action);\n            }\n        }\n        this.matrix.select(current[0], current[1]);\n    };\n    ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n        var gObj = this.parent;\n        var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n        var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n        var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n        var cell = gObj.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ?\n            (row.querySelectorAll('td:not(.e-editcell)'))[parseInt(cellIndex.toString(), 10)]\n            : row.cells[parseInt(cellIndex.toString(), 10)];\n        if (action === 'tab' && editNextRow) {\n            rowIndex++;\n            var index = (this.getTable().rows[parseInt(rowIndex.toString(), 10)].getElementsByClassName('e-indentcell').length +\n                this.getTable().rows[parseInt(rowIndex.toString(), 10)].getElementsByClassName('e-detailrowcollapse').length);\n            cellIndex = visibleIndex + index;\n        }\n        if (action === 'shiftTab' && editNextRow) {\n            rowIndex--;\n            cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n        }\n        return !cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-headercell') &&\n            !cell.classList.contains('e-groupcaption') && !cell.classList.contains('e-filterbarcell') ?\n            this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n    };\n    ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n        if (navigator === void 0) { navigator = [0, 0]; }\n        if (!isPresent && !this.indexesByKey(action) || (this.matrix.current.length === 0)) {\n            return null;\n        }\n        if (!this.shouldFocusChange(e)) {\n            return this.matrix.current;\n        }\n        // eslint-disable-next-line\n        var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator), rowIndex = _a[0], cellIndex = _a[1], rN = _a[2], cN = _a[3];\n        if (this.parent.allowGrouping && !isNullOrUndefined(this.parent.groupSettings.columns) && this.parent.groupSettings.columns.length && this.parent.aggregates.length && action === 'enter') {\n            for (var i = rowIndex; i < this.matrix.matrix.length; i++) {\n                var row = this.getTable().rows[i + 1];\n                if (row && row.cells[parseInt(cellIndex.toString(), 10)] && row.cells[parseInt(cellIndex.toString(), 10)].classList.contains('e-rowcell')) {\n                    return [i + 1, cellIndex];\n                }\n                if (i === this.matrix.matrix.length - 1) {\n                    return [rowIndex, cellIndex];\n                }\n            }\n        }\n        if (action === 'ctrlEnd' || action === 'end') {\n            var lastContentCellIndex = [this.matrix.matrix.length - 1,\n                this.matrix.matrix[this.matrix.matrix.length - 1].length - 1];\n            if (action === 'end') {\n                lastContentCellIndex = [rowIndex, this.matrix.matrix[parseInt(rowIndex.toString(), 10)].length - 1];\n            }\n            if (this.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n                lastContentCellIndex = findCellIndex(this.matrix.matrix, lastContentCellIndex, false);\n            }\n            rowIndex = lastContentCellIndex[0];\n            cellIndex = lastContentCellIndex[1] + 1;\n        }\n        var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator(), this);\n        return current;\n    };\n    ContentFocus.prototype.checkRowCellFocus = function (target) {\n        return target.classList.contains(literals.rowCell) ? target.classList.contains('e-focused') : true;\n    };\n    ContentFocus.prototype.onClick = function (e, force) {\n        var target = e.target;\n        this.target = target;\n        target = (target.classList.contains(literals.rowCell) ? target : closest(target, 'td'));\n        target = target ? target : closest(e.target, 'td.e-detailrowcollapse')\n            || closest(e.target, 'td.e-detailrowexpand');\n        target = closest(e.target, 'td.e-detailcell') ?\n            isNullOrUndefined(closest(closest(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n        target = target && closest(target, 'table').classList.contains(literals.table) ? target : null;\n        if (!target) {\n            return false;\n        }\n        var rowIdx = target.parentElement.rowIndex;\n        if (this.parent.editSettings.showAddNewRow && parentsUntil(target, 'e-addedrow')) {\n            rowIdx = parentsUntil(target, 'e-addedrow').rowIndex;\n        }\n        var _a = [rowIdx, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var _b = this.matrix.current, oRowIndex = _b[0], oCellIndex = _b[1];\n        var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val) || (!force && oRowIndex === rowIndex && oCellIndex === cellIndex && this.checkRowCellFocus(target)) ||\n            (!parentsUntil(e.target, literals.rowCell) && !parentsUntil(e.target, 'e-groupcaption')\n                && !parentsUntil(e.target, 'e-recordpluscollapse') && !parentsUntil(e.target, 'e-recordplusexpand')\n                && !parentsUntil(e.target, 'e-detailrowcollapse') && !parentsUntil(e.target, 'e-detailrowexpand')\n                && !parentsUntil(e.target, 'e-templatecell'))) {\n            return false;\n        }\n        this.matrix.select(rowIndex, cellIndex);\n    };\n    ContentFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        this.matrix.current = [rowIndex, cellIndex];\n        var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n        info.element = !isNullOrUndefined(row) ? this.parent.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ?\n            (row.querySelectorAll('td:not(.e-editcell)'))[parseInt(cellIndex.toString(), 10)]\n            : row.cells[parseInt(cellIndex.toString(), 10)] : null;\n        if (!info.element) {\n            return info;\n        }\n        info.elementToFocus = (!info.element.classList.contains('e-unboundcell') || (this.parent.editSettings.showAddNewRow &&\n            info.element.classList.contains('e-unboundcell') && parentsUntil(info.element, 'e-addedrow'))) &&\n            !info.element.classList.contains('e-detailcell') ? this.getFocusable(info.element) : info.element;\n        info.elementToFocus = info.element.classList.contains('e-detailcell') && info.element.querySelector('.e-childgrid')\n            ? info.element.querySelector('.e-childgrid') : info.elementToFocus;\n        if (this.parent.editSettings.mode === 'Batch' && this.parent.isEdit && info.elementToFocus.tagName.toLowerCase() === 'input'\n            && info.elementToFocus.classList.contains('e-dropdownlist')) {\n            info.elementToFocus = info.elementToFocus.parentElement;\n        }\n        info.outline = true;\n        info.uid = info.element.parentElement.getAttribute('data-uid');\n        return info;\n    };\n    ContentFocus.prototype.getFocusable = function (element) {\n        var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n        var isTemplate = !isNullOrUndefined(closest(element, '.e-templatecell'));\n        if (this.parent.isEdit) {\n            var commandCellQuery = this.parent.editSettings.showAddNewRow && parentsUntil(element, 'e-addedrow') ?\n                ', button:not(.e-hide)' : '';\n            query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea' + commandCellQuery;\n        }\n        var child = [].slice.call(element.querySelectorAll(query));\n        if (element.classList.contains('e-fltrtemp')) {\n            var focusElement = [].slice.call(element.querySelectorAll('.e-fltrtemp-focus'));\n            if (this.focusType === 'click' && this.target && this.target.classList.contains('e-fltrtemp-focus')) {\n                return this.target;\n            }\n            else if (this.focusType === 'key' && focusElement.length && (this.action === 'tab' || this.action === 'shiftTab')) {\n                var elementIndex = focusElement.indexOf(this.currentTarget);\n                return elementIndex === -1 ? focusElement[this.action === 'tab' ? 0 : focusElement.length - 1]\n                    : focusElement[this.action === 'tab' ? elementIndex + 1 : elementIndex - 1];\n            }\n        }\n        /* Select the first focusable child element\n         * if no child found then select the cell itself.\n         * if Grid is in editable state, check for editable control inside child.\n         */\n        return child.length ? isTemplate && child.length > 1 && !(this.parent.editSettings.mode === 'Batch'\n            && this.parent.isEdit && this.target) ? this.target ? this.target : element : child[0] : element;\n    };\n    ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n        var types = [CellType.Expand, CellType.GroupCaption, CellType.CaptionSummary, CellType.GroupSummary];\n        return ((row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate))\n            || (row.isDataRow && cell.cellType === CellType.DetailExpand && isNullOrUndefined(cell.visible))\n            || (!row.isDataRow && types.indexOf(cell.cellType) > -1\n                && !((cell.cellType === CellType.GroupSummary || cell.cellType === CellType.CaptionSummary)\n                    && !(cell.isDataCell && cell.visible)))\n            || (cell.column && cell.visible && cell.column.type === 'checkbox')\n            || (cell.cellType === CellType.CommandColumn)\n            || (row.isDataRow && isRowTemplate))\n            && !(row.edit === 'delete' && row.isDirty);\n    };\n    ContentFocus.prototype.nextRowFocusValidate = function (index) {\n        var lastIndex = index;\n        for (var i = index, len = this.matrix.rows; i <= len; i++) {\n            if (this.matrix.matrix[parseInt(index.toString(), 10)].indexOf(1) === -1) {\n                index = index + 1;\n            }\n            else {\n                return index;\n            }\n        }\n        this.lastIdxCell = true;\n        return lastIndex;\n    };\n    ContentFocus.prototype.previousRowFocusValidate = function (index) {\n        var firstIndex = index;\n        for (var i = index, len = 0; i >= len; i--) {\n            if (this.matrix.matrix[parseInt(index.toString(), 10)].indexOf(1) === -1) {\n                index = index - 1;\n                if (index < 0) {\n                    this.lastIdxCell = true;\n                    return firstIndex;\n                }\n            }\n            else {\n                return index;\n            }\n        }\n        return firstIndex;\n    };\n    ContentFocus.prototype.jump = function (action, current) {\n        this.lastIdxCell = false;\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        var headerSwap = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n        if (this.matrix.matrix[current[0]]) {\n            if (action === 'tab' && this.matrix.matrix.length &&\n                current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n                this.matrix.current[0] = this.nextRowFocusValidate(this.matrix.current[0] + 1);\n                this.matrix.current[1] = -1;\n            }\n        }\n        if (action === 'shiftTab' &&\n            current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n            this.matrix.current[0] = this.previousRowFocusValidate(this.matrix.current[0] - 1);\n            this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n        }\n        var isHeaderFocus = false;\n        var row = parentsUntil(document.activeElement, 'e-addedrow') && this.parent.editSettings.showAddNewRow ?\n            parentsUntil(document.activeElement, 'e-addedrow') : document.activeElement.parentElement;\n        if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache)\n            && !isNullOrUndefined(row) && row.classList.contains(literals.row)) {\n            var rowIndex = parseInt(row.getAttribute(literals.ariaRowIndex), 10) - 1;\n            isHeaderFocus = rowIndex > 0;\n        }\n        var info = {\n            swap: !isHeaderFocus ? ((action === 'upArrow' || enterFrozen) && current[0] === 0) : false,\n            toHeader: headerSwap\n        };\n        return info;\n    };\n    ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current = [];\n        if (action === 'rightArrow' || action === 'tab') {\n            current[0] = previous[0];\n            current[1] = -1;\n        }\n        if (action === 'downArrow' || action === 'enter') {\n            current[0] = -1;\n            current[1] = previous[1];\n        }\n        return current;\n    };\n    ContentFocus.prototype.generateRows = function (rows, optionals) {\n        var _a;\n        var matrix = optionals.matrix, handlerInstance = optionals.handlerInstance;\n        var len = handlerInstance.matrix.matrix.length;\n        var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n        handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n        handlerInstance.matrix.rows = defaultLen;\n        (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n        handlerInstance.matrix.rows += matrix.length;\n    };\n    ContentFocus.prototype.getInfo = function (e) {\n        var info = this.getFocusInfo();\n        var _a = this.matrix.current, rIndex = _a[0], cIndex = _a[1];\n        var isData = info.element.classList.contains(literals.rowCell);\n        var isSelectable = isData || (e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse')\n            || info.element.classList.contains('e-detailrowexpand')));\n        // eslint-disable-next-line\n        var _b = [Math.min(parseInt(info.element.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1, rIndex),\n            Math.min(parseInt(info.element.getAttribute(literals.ariaColIndex), 10) - 1, cIndex)], rowIndex = _b[0], cellIndex = _b[1];\n        if (this.parent.allowGrouping && this.parent.groupSettings.enableLazyLoading && isData) {\n            rowIndex = this.parent.getDataRows().indexOf(info.element.parentElement);\n        }\n        if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n            rowIndex = rIndex;\n            cellIndex = cIndex;\n        }\n        if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' &&\n            !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling && e && e.action === 'downArrow') {\n            rowIndex++;\n        }\n        return { isContent: true, isDataCell: isData, indexes: [rowIndex, cellIndex], isSelectable: isSelectable };\n    };\n    ContentFocus.prototype.validator = function () {\n        var table = this.getTable();\n        return function (rowIndex, cellIndex, action) {\n            if (!isNullOrUndefined(table.rows[parseInt(rowIndex.toString(), 10)])) {\n                var cell = void 0;\n                cellIndex = table.querySelector('.e-emptyrow') ? 0 : cellIndex;\n                if (table.rows[parseInt(rowIndex.toString(), 10)].cells[0].classList.contains('e-editcell')) {\n                    cell = table.rows[parseInt(rowIndex.toString(), 10)].cells[0].querySelectorAll('td')[parseInt(cellIndex.toString(), 10)];\n                }\n                else {\n                    cell = table.rows[parseInt(rowIndex.toString(), 10)].cells[parseInt(cellIndex.toString(), 10)];\n                }\n                var isCellWidth = cell.getBoundingClientRect().width !== 0;\n                if (action === 'enter' || action === 'shiftEnter') {\n                    return isCellWidth && cell.classList.contains(literals.rowCell);\n                }\n                if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains(literals.rowCell)) {\n                    return isCellWidth;\n                }\n                else if (action !== 'shiftUp' && action !== 'shiftDown') {\n                    return isCellWidth;\n                }\n            }\n            return false;\n        };\n    };\n    ContentFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, _b = _a[0], rIndex = _b === void 0 ? -1 : _b, _c = _a[1], cIndex = _c === void 0 ? -1 : _c;\n        if (rIndex < 0 || cIndex < 0) {\n            return true;\n        }\n        var cell = getValue(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'shiftEnter' ?\n            cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-unboundcell')\n                || cell.classList.contains('e-editedbatchcell') && !cell.classList.contains('e-detailcell') : true;\n    };\n    ContentFocus.prototype.getGridSeletion = function () {\n        return this.parent.allowSelection && this.parent.selectionSettings.allowColumnSelection;\n    };\n    return ContentFocus;\n}());\nexport { ContentFocus };\n/**\n * @hidden\n */\nvar HeaderFocus = /** @class */ (function (_super) {\n    __extends(HeaderFocus, _super);\n    function HeaderFocus(parent) {\n        return _super.call(this, parent) || this;\n    }\n    HeaderFocus.prototype.getTable = function () {\n        return (this.parent.getHeaderTable());\n    };\n    HeaderFocus.prototype.onClick = function (e) {\n        this.focusType = 'click';\n        var target = e.target;\n        this.target = target;\n        target = (target.classList.contains('e-headercell') ? target : closest(target, 'th'));\n        if (!target && (this.parent.frozenRows !== 0 || ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) &&\n            this.parent.editSettings.showAddNewRow))) {\n            target = (e.target.classList.contains(literals.rowCell) ? e.target :\n                closest(e.target, 'td'));\n        }\n        if (e.target.classList.contains('e-columnheader') ||\n            e.target.querySelector('.e-stackedheadercell')) {\n            return false;\n        }\n        if (!target) {\n            return;\n        }\n        var rowIdx = target.parentElement.rowIndex;\n        if (this.parent.editSettings.showAddNewRow && parentsUntil(target, 'e-addedrow')) {\n            rowIdx = parentsUntil(target, 'e-addedrow').rowIndex;\n        }\n        var _a = [rowIdx, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val)) {\n            return false;\n        }\n        this.matrix.select(rowIdx, target.cellIndex);\n    };\n    HeaderFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n        info.element = !isNullOrUndefined(row) ? this.parent.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ?\n            (row.querySelectorAll('td:not(.e-editcell)'))[parseInt(cellIndex.toString(), 10)]\n            : row.cells[parseInt(cellIndex.toString(), 10)] : null;\n        if (!isNullOrUndefined(info.element)) {\n            info.elementToFocus = this.getFocusable(info.element);\n            info.outline = !info.element.classList.contains('e-filterbarcell');\n        }\n        return info;\n    };\n    HeaderFocus.prototype.selector = function (row, cell) {\n        return (cell.visible && (cell.column.field !== undefined || cell.isTemplate || !isNullOrUndefined(cell.column.template)\n            || !isNullOrUndefined(cell.column.commands) || cell.column.type === 'checkbox')) || cell.cellType === CellType.StackedHeader;\n    };\n    HeaderFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var isLastCell;\n        var lastRow;\n        if (this.parent.enableHeaderFocus && action === 'tab') {\n            lastRow = this.matrix.matrix.length - 1 === current[0];\n            isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n            if (isLastCell) {\n                if (!lastRow) {\n                    this.matrix.current[0] = this.matrix.current[0] + 1;\n                }\n                else {\n                    this.matrix.current[0] = 0;\n                }\n                this.matrix.current[1] = -1;\n            }\n        }\n        return {\n            swap: ((action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1) ||\n                (action === 'tab' && lastRow && isLastCell)\n        };\n    };\n    HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current1 = [];\n        if (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') {\n            current1[0] = previous[0];\n            current1[1] = -1;\n        }\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current1[0] = this.matrix.matrix.length;\n            current1[1] = previous[1];\n        }\n        return current1;\n    };\n    HeaderFocus.prototype.generateRows = function (rows) {\n        var length = this.matrix.matrix.length;\n        if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n            this.matrix.rows = ++this.matrix.rows;\n            var cells = rows[0].cells;\n            var incrementNumber = 0;\n            for (var i = 0; i < cells.length; i++) {\n                if (cells[parseInt(i.toString(), 10)].column && cells[parseInt(i.toString(), 10)].column.columns) {\n                    incrementNumber = this.checkFilterColumn(cells[parseInt(i.toString(), 10)].column.columns, length, incrementNumber);\n                }\n                else {\n                    this.matrix.set(length, incrementNumber, cells[parseInt(i.toString(), 10)].visible && cells[parseInt(i.toString(), 10)].column.allowFiltering !== false);\n                    incrementNumber++;\n                }\n            }\n        }\n    };\n    HeaderFocus.prototype.checkFilterColumn = function (rowColumns, rowIndex, columnIndex) {\n        var columns = rowColumns;\n        var incrementNumber = columnIndex;\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                incrementNumber = this.checkFilterColumn(columns[parseInt(i.toString(), 10)].columns, rowIndex, incrementNumber);\n            }\n            else {\n                this.matrix.set(rowIndex, incrementNumber, columns[parseInt(i.toString(), 10)].visible && columns[parseInt(i.toString(), 10)].allowFiltering !== false);\n                incrementNumber++;\n            }\n        }\n        return incrementNumber;\n    };\n    HeaderFocus.prototype.getInfo = function (e) {\n        return extend(_super.prototype.getInfo.call(this, e), { isContent: false, isHeader: true });\n    };\n    HeaderFocus.prototype.validator = function () {\n        return function () { return true; };\n    };\n    HeaderFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, rowIndex = _a[0], columnIndex = _a[1];\n        if (rowIndex < 0 || columnIndex < 0) {\n            return true;\n        }\n        var cell = getValue(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n    };\n    HeaderFocus.prototype.getHeaderType = function () {\n        return 'HeaderFocus';\n    };\n    return HeaderFocus;\n}(ContentFocus));\nexport { HeaderFocus };\n/** @hidden */\nvar SearchBox = /** @class */ (function () {\n    function SearchBox(searchBox, serviceLocator) {\n        this.searchBox = searchBox;\n        this.serviceLocator = serviceLocator;\n        this.l10n = this.serviceLocator.getService('localization');\n    }\n    SearchBox.prototype.searchFocus = function (args) {\n        args.target.parentElement.classList.add('e-input-focus');\n        if (args.target.classList.contains('e-input') && args.target.classList.contains('e-search') && args.target.value) {\n            var sIcon = args.target.parentElement.querySelector('.e-sicon');\n            sIcon.classList.add('e-clear-icon');\n            sIcon.setAttribute('title', this.l10n.getConstant('Clear'));\n            (sIcon).style.cursor = 'pointer';\n        }\n    };\n    SearchBox.prototype.searchBlur = function (args) {\n        var relatedTarget = args.relatedTarget ? args.relatedTarget : null;\n        if (relatedTarget && relatedTarget.classList.contains('e-sicon')) {\n            if (relatedTarget.classList.contains('e-clear-icon')) {\n                args.target.parentElement.classList.remove('e-input-focus');\n            }\n        }\n        else {\n            args.target.parentElement.classList.remove('e-input-focus');\n        }\n        if (args.target.classList.contains('e-search') && ((relatedTarget && !(relatedTarget.classList.contains('e-sicon e-clear-icon'))\n            && !(relatedTarget.classList.contains('e-sicon'))) || isNullOrUndefined(relatedTarget))) {\n            var sIcon = args.target.parentElement.querySelector('.e-sicon');\n            sIcon.classList.remove('e-clear-icon');\n            sIcon.removeAttribute('title');\n            sIcon.style.cursor = 'default';\n        }\n    };\n    SearchBox.prototype.wireEvent = function () {\n        if (this.searchBox) {\n            EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n            EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n        }\n    };\n    SearchBox.prototype.unWireEvent = function () {\n        if (this.searchBox) {\n            EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n            EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n        }\n    };\n    return SearchBox;\n}());\nexport { SearchBox };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}