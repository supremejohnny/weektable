{"ast":null,"code":"var _jsxFileName = \"D:\\\\weektable\\\\frontend\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\n\n// 引入两个子组件\nimport DailyTasks from './components/DailyTasks';\nimport AddTask from './components/AddTask';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [tasks, setTasks] = useState([]);\n  const [doneToday, setDoneToday] = useState([]);\n  const [weekly, setWeekly] = useState([]);\n  const [info, setInfo] = useState({\n    date: '',\n    lunar: '',\n    weather: '',\n    fortune: ''\n  });\n\n  // 加载所有数据\n  const loadData = async () => {\n    try {\n      const resInfo = await axios.get('http://localhost:5000/api/current_info');\n      const resTasks = await axios.get('http://localhost:5000/api/tasks');\n      const today = resInfo.data.date;\n      const resDaily = await axios.get(`http://localhost:5000/api/daily_records?date=${today}`);\n      const resWeek = await axios.get('http://localhost:5000/api/weekly_records');\n      setInfo(resInfo.data);\n      setTasks(resTasks.data.tasks);\n      setDoneToday(resDaily.data.done_tasks);\n      setWeekly(resWeek.data.weekly);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  // 在 DailyTasks 中调用：切换打卡\n  const toggleTask = async (taskId, done) => {\n    try {\n      await axios.post('http://localhost:5000/api/daily_records', {\n        date: info.date,\n        task_id: taskId,\n        done\n      });\n      // 本地更新\n      setDoneToday(dt => done ? [...dt, taskId] : dt.filter(id => id !== taskId));\n      // 重新拉一次周数据（简单粗暴）\n      const resWeek = await axios.get('http://localhost:5000/api/weekly_records');\n      setWeekly(resWeek.data.weekly);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  // 在 AddTask 中调用：添加新任务\n  const addTask = async name => {\n    try {\n      await axios.post('http://localhost:5000/api/tasks', {\n        name\n      });\n      const res = await axios.get('http://localhost:5000/api/tasks');\n      setTasks(res.data.tasks);\n      // 周表自动多了新列，重载周数据\n      const resWeek = await axios.get('http://localhost:5000/api/weekly_records');\n      setWeekly(resWeek.data.weekly);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: 800,\n      margin: '20px auto',\n      fontFamily: 'sans-serif'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u6BCF\\u65E5\\u4EFB\\u52A1\\u6253\\u5361 MVP\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '10px 0',\n        borderBottom: '1px solid #ccc'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"\\u65E5\\u671F\\uFF1A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 14\n        }, this), info.date]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"\\u519C\\u5386\\uFF1A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 14\n        }, this), info.lunar]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"\\u5929\\u6C14\\uFF1A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 14\n        }, this), info.weather]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"\\u8FD0\\u52BF\\uFF1A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 14\n        }, this), info.fortune]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AddTask, {\n      onTaskAdded: addTask\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DailyTasks, {\n      tasks: tasks,\n      doneToday: doneToday,\n      weekly: weekly,\n      onToggle: toggleTask\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"02zIWcsHvs1obx89AJkxq2omrG8=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","axios","DailyTasks","AddTask","jsxDEV","_jsxDEV","App","_s","tasks","setTasks","doneToday","setDoneToday","weekly","setWeekly","info","setInfo","date","lunar","weather","fortune","loadData","resInfo","get","resTasks","today","data","resDaily","resWeek","done_tasks","err","console","error","toggleTask","taskId","done","post","task_id","dt","filter","id","addTask","name","res","style","maxWidth","margin","fontFamily","children","fileName","_jsxFileName","lineNumber","columnNumber","padding","borderBottom","onTaskAdded","onToggle","_c","$RefreshReg$"],"sources":["D:/weektable/frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\n\n// 引入两个子组件\nimport DailyTasks from './components/DailyTasks';\nimport AddTask     from './components/AddTask';\n\nfunction App() {\n  const [tasks, setTasks] = useState([]);\n  const [doneToday, setDoneToday] = useState([]);\n  const [weekly, setWeekly] = useState([]);\n  const [info, setInfo] = useState({\n    date: '', lunar: '', weather: '', fortune: ''\n  });\n\n  // 加载所有数据\n  const loadData = async () => {\n    try {\n      const resInfo   = await axios.get('http://localhost:5000/api/current_info');\n      const resTasks  = await axios.get('http://localhost:5000/api/tasks');\n      const today     = resInfo.data.date;\n      const resDaily  = await axios.get(`http://localhost:5000/api/daily_records?date=${today}`);\n      const resWeek   = await axios.get('http://localhost:5000/api/weekly_records');\n\n      setInfo(resInfo.data);\n      setTasks(resTasks.data.tasks);\n      setDoneToday(resDaily.data.done_tasks);\n      setWeekly(resWeek.data.weekly);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  useEffect(() => { loadData(); }, []);\n\n  // 在 DailyTasks 中调用：切换打卡\n  const toggleTask = async (taskId, done) => {\n    try {\n      await axios.post('http://localhost:5000/api/daily_records', {\n        date: info.date,\n        task_id: taskId,\n        done\n      });\n      // 本地更新\n      setDoneToday(dt => done ? [...dt, taskId] : dt.filter(id => id !== taskId));\n      // 重新拉一次周数据（简单粗暴）\n      const resWeek = await axios.get('http://localhost:5000/api/weekly_records');\n      setWeekly(resWeek.data.weekly);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  // 在 AddTask 中调用：添加新任务\n  const addTask = async (name) => {\n    try {\n      await axios.post('http://localhost:5000/api/tasks', { name });\n      const res = await axios.get('http://localhost:5000/api/tasks');\n      setTasks(res.data.tasks);\n      // 周表自动多了新列，重载周数据\n      const resWeek = await axios.get('http://localhost:5000/api/weekly_records');\n      setWeekly(resWeek.data.weekly);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  return (\n    <div style={{ maxWidth: 800, margin: '20px auto', fontFamily: 'sans-serif' }}>\n      <h2>每日任务打卡 MVP</h2>\n      {/* 今日信息 */}\n      <div style={{ padding: '10px 0', borderBottom: '1px solid #ccc' }}>\n        <div><strong>日期：</strong>{info.date}</div>\n        <div><strong>农历：</strong>{info.lunar}</div>\n        <div><strong>天气：</strong>{info.weather}</div>\n        <div><strong>运势：</strong>{info.fortune}</div>\n      </div>\n\n      {/* 添加任务 */}\n      <AddTask onTaskAdded={addTask} />\n\n      {/* 每日打卡 */}\n      <DailyTasks\n        tasks={tasks}\n        doneToday={doneToday}\n        weekly={weekly}\n        onToggle={toggleTask}\n      />\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}