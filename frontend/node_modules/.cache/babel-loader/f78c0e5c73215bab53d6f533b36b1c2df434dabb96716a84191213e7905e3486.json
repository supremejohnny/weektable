{"ast":null,"code":"import { classNames } from './list-view';\nimport { EventHandler, append, isNullOrUndefined, detach, compile, formatUnit, select } from '@syncfusion/ej2-base';\nimport { ListBase } from '../common/list-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nvar listElementCount = 1.5;\nvar windowElementCount = 3;\nvar Virtualization = /** @class */function () {\n  function Virtualization(instance) {\n    this.elementDifference = 0;\n    this.listViewInstance = instance;\n  }\n  /**\n   * For internal use only.\n   *\n   * @private\n   */\n  Virtualization.prototype.isNgTemplate = function () {\n    return !isNullOrUndefined(this.listViewInstance.templateRef) && typeof this.listViewInstance.templateRef !== 'string';\n  };\n  /**\n   * Checks if the platform is a Vue and its template property is a function type.\n   *\n   * @returns {boolean} indicating the result of the check\n   */\n  Virtualization.prototype.isVueFunctionTemplate = function () {\n    return this.listViewInstance.isVue && typeof this.listViewInstance.template === 'function';\n  };\n  /**\n   * For internal use only.\n   *\n   * @private\n   */\n  Virtualization.prototype.uiVirtualization = function () {\n    this.wireScrollEvent(false);\n    var curViewDS = this.listViewInstance.curViewDS;\n    var isRendered = this.listViewInstance.isRendered;\n    var firstIndex = isRendered && !isNullOrUndefined(this.uiFirstIndex) && this.uiLastIndex <= Object.keys(curViewDS).length ? this.uiFirstIndex : 0;\n    var firstDs = curViewDS.slice(firstIndex, firstIndex + 1);\n    this.listViewInstance.ulElement = this.listViewInstance.curUL = ListBase.createList(this.listViewInstance.createElement, firstDs, this.listViewInstance.listBaseOption, null, this.listViewInstance);\n    this.listViewInstance.contentContainer = this.listViewInstance.createElement('div', {\n      className: classNames.container\n    });\n    this.listViewInstance.element.appendChild(this.listViewInstance.contentContainer);\n    this.listViewInstance.contentContainer.appendChild(this.listViewInstance.ulElement);\n    this.listItemHeight = this.listViewInstance.ulElement.firstElementChild.getBoundingClientRect().height;\n    this.expectedDomItemCount = this.ValidateItemCount(10000);\n    this.updateDOMItemCount();\n    var lastIndex = isRendered && !isNullOrUndefined(this.uiLastIndex) && this.listDiff !== 0 ? this.uiLastIndex : this.domItemCount - 1;\n    this.uiFirstIndex = firstIndex;\n    this.uiLastIndex = lastIndex;\n    var otherDs = curViewDS.slice(firstIndex + 1, lastIndex + 1);\n    var listItems = ListBase.createListItemFromJson(this.listViewInstance.createElement, otherDs, this.listViewInstance.listBaseOption, null, null, this.listViewInstance);\n    append(listItems, this.listViewInstance.ulElement);\n    this.listViewInstance.liCollection = this.listViewInstance.curUL.querySelectorAll('li');\n    this.topElement = this.listViewInstance.createElement('div');\n    this.listViewInstance.ulElement.insertBefore(this.topElement, this.listViewInstance.ulElement.firstElementChild);\n    this.bottomElement = this.listViewInstance.createElement('div');\n    this.listViewInstance.ulElement.insertBefore(this.bottomElement, null);\n    this.totalHeight = Object.keys(curViewDS).length * this.listItemHeight - this.domItemCount * this.listItemHeight;\n    this.topElement.style.height = isRendered ? this.topElementHeight + 'px' : '0px';\n    this.bottomElement.style.height = isRendered ? this.totalHeight - this.topElementHeight + 'px' : this.totalHeight + 'px';\n    this.topElementHeight = isRendered ? this.topElementHeight : 0;\n    this.bottomElementHeight = isRendered ? this.totalHeight - this.topElementHeight : this.totalHeight;\n    this.listDiff = isRendered && Object.keys(curViewDS).length !== this.domItemCount ? this.listDiff : 0;\n    if (isRendered) {\n      this.listViewInstance.element.scrollTop = this.listViewInstance.previousScrollTop;\n    }\n    this.uiIndicesInitialization();\n  };\n  Virtualization.prototype.wireScrollEvent = function (destroy) {\n    if (!destroy) {\n      if (this.listViewInstance.isWindow) {\n        this.onVirtualScroll = this.onVirtualUiScroll.bind(this);\n        window.addEventListener('scroll', this.onVirtualScroll);\n      } else {\n        EventHandler.add(this.listViewInstance.element, 'scroll', this.onVirtualUiScroll, this);\n      }\n    } else {\n      if (this.listViewInstance.isWindow === true) {\n        window.removeEventListener('scroll', this.onVirtualScroll);\n        window.removeEventListener('scroll', this.updateUl);\n      } else {\n        EventHandler.remove(this.listViewInstance.element, 'scroll', this.onVirtualUiScroll);\n      }\n    }\n  };\n  Virtualization.prototype.ValidateItemCount = function (dataSourceLength) {\n    var height = parseFloat(formatUnit(this.listViewInstance.height));\n    var itemCount;\n    if (this.listViewInstance.isWindow) {\n      itemCount = Math.round(window.innerHeight / this.listItemHeight * windowElementCount);\n    } else {\n      if (typeof this.listViewInstance.height === 'string' && this.listViewInstance.height.indexOf('%') !== -1) {\n        itemCount = Math.round(this.listViewInstance.element.getBoundingClientRect().height / this.listItemHeight * listElementCount);\n      } else {\n        itemCount = Math.round(height / this.listItemHeight * listElementCount);\n      }\n    }\n    if (itemCount > dataSourceLength) {\n      itemCount = dataSourceLength;\n    }\n    return itemCount;\n  };\n  Virtualization.prototype.updateDOMItemCount = function () {\n    this.domItemCount = this.ValidateItemCount(Object.keys(this.listViewInstance.curViewDS).length);\n  };\n  Virtualization.prototype.uiIndicesInitialization = function () {\n    this.uiIndices = {\n      'activeIndices': [],\n      'disabledItemIndices': [],\n      'hiddenItemIndices': []\n    };\n    var data = this.listViewInstance.curViewDS;\n    for (var i = 0; i < data.length; i++) {\n      if (this.listViewInstance.showCheckBox && data[i][this.listViewInstance.fields.isChecked]) {\n        this.uiIndices.activeIndices.push(i);\n      }\n      if (!isNullOrUndefined(data[parseInt(i.toString(), 10)][this.listViewInstance.fields.enabled]) && !data[i][this.listViewInstance.fields.enabled]) {\n        this.uiIndices.disabledItemIndices.push(i);\n      }\n    }\n    if (this.isNgTemplate()) {\n      var items = this.listViewInstance.element.querySelectorAll('.' + classNames.listItem);\n      for (var index = 0; index < items.length; index++) {\n        items[index].context = this.listViewInstance.viewContainerRef.get(index).context;\n      }\n    }\n  };\n  Virtualization.prototype.refreshItemHeight = function () {\n    if (this.listViewInstance.curViewDS.length) {\n      var curViewDS = this.listViewInstance.curViewDS;\n      this.listItemHeight = this.topElement.nextSibling.getBoundingClientRect().height;\n      this.totalHeight = Object.keys(curViewDS).length * this.listItemHeight - this.domItemCount * this.listItemHeight;\n      this.bottomElementHeight = this.totalHeight;\n      this.bottomElement.style.height = this.totalHeight + 'px';\n    }\n  };\n  Virtualization.prototype.getscrollerHeight = function (startingHeight) {\n    return this.listViewInstance.isWindow ? pageYOffset - startingHeight <= 0 ? 0 : pageYOffset - startingHeight : this.listViewInstance.element.scrollTop - startingHeight <= 0 ? 0 : this.listViewInstance.element.scrollTop - startingHeight;\n  };\n  Virtualization.prototype.onVirtualUiScroll = function () {\n    var _a;\n    var startingHeight;\n    var curViewDS = this.listViewInstance.curViewDS;\n    this.listItemHeight = select('.e-list-item', this.listViewInstance.element).getBoundingClientRect().height;\n    this.totalHeight = Object.keys(curViewDS).length * this.listItemHeight - this.domItemCount * this.listItemHeight;\n    if (this.listViewInstance.isWindow) {\n      startingHeight = this.listViewInstance.ulElement.getBoundingClientRect().top - document.documentElement.getBoundingClientRect().top;\n    } else {\n      startingHeight = this.listViewInstance.headerEle ? this.listViewInstance.headerEle.getBoundingClientRect().height : 0;\n    }\n    this.scrollPosition = isNullOrUndefined(this.scrollPosition) ? 0 : this.scrollPosition;\n    var scroll = this.getscrollerHeight(startingHeight);\n    this.topElementHeight = this.listItemHeight * Math.floor(scroll / this.listItemHeight);\n    this.bottomElementHeight = this.totalHeight - this.topElementHeight;\n    _a = scroll <= this.totalHeight ? [this.topElementHeight, this.bottomElementHeight] : [this.totalHeight, 0], this.topElementHeight = _a[0], this.bottomElementHeight = _a[1];\n    if (this.topElementHeight !== parseFloat(this.topElement.style.height)) {\n      this.topElement.style.height = this.topElementHeight + 'px';\n      this.bottomElement.style.height = this.bottomElementHeight + 'px';\n      if (scroll > this.scrollPosition) {\n        var listDiff = Math.round(this.topElementHeight / this.listItemHeight - this.listDiff);\n        if (listDiff > this.expectedDomItemCount + 5) {\n          this.onLongScroll(listDiff, true);\n        } else {\n          this.onNormalScroll(listDiff, true);\n        }\n      } else {\n        var listDiff = Math.round(this.listDiff - this.topElementHeight / this.listItemHeight);\n        if (listDiff > this.expectedDomItemCount + 5) {\n          this.onLongScroll(listDiff, false);\n        } else {\n          this.onNormalScroll(listDiff, false);\n        }\n      }\n    }\n    this.listDiff = Math.round(this.topElementHeight / this.listItemHeight);\n    if (typeof this.listViewInstance.onUIScrolled === 'function') {\n      this.listViewInstance.onUIScrolled();\n    }\n    this.scrollPosition = scroll;\n  };\n  Virtualization.prototype.onLongScroll = function (listDiff, isScrollingDown) {\n    var index = isScrollingDown ? this.uiFirstIndex + listDiff : this.uiFirstIndex - listDiff;\n    var elements = this.listViewInstance.ulElement.querySelectorAll('li');\n    for (var i = 0; i < elements.length; i++) {\n      this.updateUI(elements[i], index);\n      index++;\n    }\n    this.uiLastIndex = isScrollingDown ? this.uiLastIndex + listDiff : this.uiLastIndex - listDiff;\n    this.uiFirstIndex = isScrollingDown ? this.uiFirstIndex + listDiff : this.uiFirstIndex - listDiff;\n  };\n  Virtualization.prototype.onNormalScroll = function (listDiff, isScrollingDown) {\n    if (isScrollingDown) {\n      for (var i = 0; i < listDiff; i++) {\n        var index = ++this.uiLastIndex;\n        this.updateUI(this.topElement.nextElementSibling, index, this.bottomElement);\n        this.uiFirstIndex++;\n      }\n    } else {\n      for (var i = 0; i < listDiff; i++) {\n        var index = --this.uiFirstIndex;\n        var target = this.topElement.nextSibling;\n        this.updateUI(this.bottomElement.previousElementSibling, index, target);\n        this.uiLastIndex--;\n      }\n    }\n  };\n  Virtualization.prototype.updateUiContent = function (element, index) {\n    var curViewDs = this.listViewInstance.curViewDS;\n    if (typeof this.listViewInstance.dataSource[0] === 'string' || typeof this.listViewInstance.dataSource[0] === 'number') {\n      element.dataset.uid = ListBase.generateId();\n      element.getElementsByClassName(classNames.listItemText)[0].innerHTML = this.listViewInstance.curViewDS[index].toString();\n    } else {\n      element.dataset.uid = curViewDs[parseInt(index.toString(), 10)][this.listViewInstance.fields.id] ? curViewDs[parseInt(index.toString(), 10)][this.listViewInstance.fields.id] : ListBase.generateId();\n      element.getElementsByClassName(classNames.listItemText)[0].innerHTML = curViewDs[parseInt(index.toString(), 10)][this.listViewInstance.fields.text];\n    }\n    if (this.listViewInstance.showIcon) {\n      if (element.querySelector('.' + classNames.listIcon)) {\n        detach(element.querySelector('.' + classNames.listIcon));\n      }\n      if (this.listViewInstance.curViewDS[index][this.listViewInstance.fields.iconCss]) {\n        var textContent = element.querySelector('.' + classNames.textContent);\n        var curViewDS = this.listViewInstance.curViewDS[index];\n        var iconCss = curViewDS[this.listViewInstance.fields.iconCss].toString();\n        var target = this.listViewInstance.createElement('div', {\n          className: classNames.listIcon + ' ' + iconCss\n        });\n        textContent.insertBefore(target, element.querySelector('.' + classNames.listItemText));\n      }\n    }\n    if (this.listViewInstance.showCheckBox && this.listViewInstance.fields.groupBy) {\n      if (!this.checkListWrapper) {\n        this.checkListWrapper = this.listViewInstance.curUL.querySelector('.' + classNames.checkboxWrapper).cloneNode(true);\n      }\n      var textContent = element.querySelector('.' + classNames.textContent);\n      if (this.listViewInstance.curViewDS[index].isHeader) {\n        if (element.querySelector('.' + classNames.checkboxWrapper)) {\n          element.classList.remove(classNames.checklist);\n          textContent.classList.remove(classNames.checkbox);\n          detach(element.querySelector('.' + classNames.checkboxWrapper));\n        }\n      } else {\n        if (!element.querySelector('.' + classNames.checkboxWrapper)) {\n          element.classList.add(classNames.checklist);\n          textContent.classList.add(classNames.checkbox);\n          if (this.listViewInstance.checkBoxPosition === 'Left') {\n            textContent.classList.add('e-checkbox-left');\n          } else {\n            textContent.classList.add('e-checkbox-right');\n          }\n          textContent.append(this.checkListWrapper.cloneNode(true));\n        }\n      }\n    }\n  };\n  Virtualization.prototype.changeElementAttributes = function (element, index) {\n    element.classList.remove(classNames.disable);\n    if (this.uiIndices.disabledItemIndices.length && this.uiIndices.disabledItemIndices.indexOf(index) !== -1) {\n      element.classList.add(classNames.disable);\n    }\n    element.style.display = '';\n    if (this.uiIndices.hiddenItemIndices.length && this.uiIndices.hiddenItemIndices.indexOf(index) !== -1) {\n      element.style.display = 'none';\n    }\n    if (this.listViewInstance.showCheckBox) {\n      var checklistElement = element.querySelector('.' + classNames.checkboxWrapper);\n      element.classList.remove(classNames.selected);\n      element.classList.remove(classNames.focused);\n      if (checklistElement) {\n        checklistElement.removeAttribute('aria-checked');\n        checklistElement.firstElementChild.classList.remove(classNames.checked);\n      }\n      if (this.uiIndices.activeIndices.length && this.uiIndices.activeIndices.indexOf(index) !== -1 && !this.listViewInstance.curUL.querySelector(classNames.selected)) {\n        element.classList.add(classNames.selected);\n        checklistElement.firstElementChild.classList.add(classNames.checked);\n        checklistElement.setAttribute('aria-checked', 'true');\n        if (this.activeIndex === index) {\n          element.classList.add(classNames.focused);\n        }\n      }\n    } else {\n      element.classList.remove(classNames.selected);\n      element.removeAttribute('aria-selected');\n      if (!isNullOrUndefined(this.activeIndex) && this.activeIndex === index && !this.listViewInstance.curUL.querySelector(classNames.selected)) {\n        element.classList.add(classNames.selected);\n        element.setAttribute('aria-selected', 'true');\n      }\n    }\n    if (this.listViewInstance.fields.groupBy) {\n      if (this.listViewInstance.curViewDS[index].isHeader) {\n        if (element.classList.contains(classNames.listItem)) {\n          element.classList.remove(classNames.listItem);\n          element.setAttribute('role', 'group');\n          element.classList.add(classNames.groupListItem);\n        }\n      } else {\n        if (element.classList.contains(classNames.groupListItem)) {\n          element.classList.remove(classNames.groupListItem);\n          element.setAttribute('role', 'listitem');\n          element.classList.add(classNames.listItem);\n        }\n      }\n    }\n  };\n  Virtualization.prototype.findDSAndIndexFromId = function (ds, fields) {\n    var _this = this;\n    var resultJSON = {};\n    fields = this.listViewInstance.getElementUID(fields);\n    if (!isNullOrUndefined(fields)) {\n      ds.some(function (data, index) {\n        if (fields[_this.listViewInstance.fields.id] && fields[_this.listViewInstance.fields.id] === (data[_this.listViewInstance.fields.id] && data[_this.listViewInstance.fields.id]) || fields === data) {\n          resultJSON.index = index;\n          resultJSON.data = data;\n          return true;\n        } else {\n          return false;\n        }\n      });\n    }\n    return resultJSON;\n  };\n  Virtualization.prototype.getSelectedItems = function () {\n    var _this = this;\n    if (!isNullOrUndefined(this.activeIndex) || this.listViewInstance.showCheckBox && this.uiIndices.activeIndices.length) {\n      var dataCollection = [];\n      var textCollection = [];\n      if (typeof this.listViewInstance.dataSource[0] === 'string' || typeof this.listViewInstance.dataSource[0] === 'number') {\n        var curViewDS_1 = this.listViewInstance.curViewDS;\n        if (this.listViewInstance.showCheckBox) {\n          var indices = this.uiIndices.activeIndices;\n          for (var i = 0; i < indices.length; i++) {\n            dataCollection.push(curViewDS_1[indices[i]]);\n          }\n          return {\n            text: dataCollection,\n            data: dataCollection,\n            index: this.uiIndices.activeIndices.map(function (index) {\n              return _this.listViewInstance.dataSource.indexOf(curViewDS_1[index]);\n            })\n          };\n        } else {\n          return {\n            text: curViewDS_1[this.activeIndex],\n            data: curViewDS_1[this.activeIndex],\n            index: this.listViewInstance.dataSource.indexOf(curViewDS_1[this.activeIndex])\n          };\n        }\n      } else {\n        var curViewDS_2 = this.listViewInstance.curViewDS;\n        var text = this.listViewInstance.fields.text;\n        if (this.listViewInstance.showCheckBox) {\n          var indexArray = this.uiIndices.activeIndices;\n          for (var i = 0; i < indexArray.length; i++) {\n            textCollection.push(curViewDS_2[indexArray[i]][\"\" + text]);\n            dataCollection.push(curViewDS_2[indexArray[parseInt(i.toString(), 10)]]);\n          }\n          var dataSource_1 = this.listViewInstance.dataSource instanceof DataManager ? curViewDS_2 : this.listViewInstance.dataSource;\n          return {\n            text: textCollection,\n            data: dataCollection,\n            index: this.uiIndices.activeIndices.map(function (index) {\n              return dataSource_1.indexOf(curViewDS_2[index]);\n            })\n          };\n        } else {\n          var dataSource = this.listViewInstance.dataSource instanceof DataManager ? curViewDS_2 : this.listViewInstance.dataSource;\n          return {\n            text: curViewDS_2[this.activeIndex][this.listViewInstance.fields.text],\n            data: curViewDS_2[this.activeIndex],\n            index: dataSource.indexOf(curViewDS_2[this.activeIndex])\n          };\n        }\n      }\n    } else {\n      return undefined;\n    }\n  };\n  Virtualization.prototype.selectItem = function (obj) {\n    var _this = this;\n    var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n    if (Object.keys(resutJSON).length) {\n      var isSelected = this.activeIndex === resutJSON.index;\n      var isChecked_1;\n      this.activeIndex = resutJSON.index;\n      if (this.listViewInstance.showCheckBox) {\n        if (this.uiIndices.activeIndices.indexOf(resutJSON.index) === -1) {\n          isChecked_1 = true;\n          this.uiIndices.activeIndices.push(resutJSON.index);\n        } else {\n          isChecked_1 = false;\n          this.uiIndices.activeIndices.splice(this.uiIndices.activeIndices.indexOf(resutJSON.index), 1);\n        }\n        if (this.listViewInstance.curUL.querySelector('.' + classNames.focused)) {\n          this.listViewInstance.curUL.querySelector('.' + classNames.focused).classList.remove(classNames.focused);\n        }\n      }\n      if (this.listViewInstance.getLiFromObjOrElement(obj)) {\n        if (this.listViewInstance.showCheckBox) {\n          this.listViewInstance.setCheckboxLI(this.listViewInstance.getLiFromObjOrElement(obj));\n        } else {\n          this.listViewInstance.setSelectLI(this.listViewInstance.getLiFromObjOrElement(obj));\n        }\n      } else {\n        var eventArgs_1;\n        if (typeof this.listViewInstance.dataSource[0] === 'string' || typeof this.listViewInstance.dataSource[0] === 'number') {\n          eventArgs_1 = {\n            text: this.listViewInstance.curViewDS[this.activeIndex],\n            data: this.listViewInstance.curViewDS[this.activeIndex],\n            index: this.activeIndex\n          };\n        } else {\n          var curViewDS = this.listViewInstance.curViewDS;\n          eventArgs_1 = {\n            text: curViewDS[this.activeIndex][this.listViewInstance.fields.text],\n            data: curViewDS[this.activeIndex],\n            index: this.activeIndex\n          };\n        }\n        if (this.listViewInstance.showCheckBox) {\n          this.listViewInstance.trigger('select', eventArgs_1, function (observedArgs) {\n            if (observedArgs.cancel) {\n              if (!isChecked_1) {\n                eventArgs_1.isChecked = isChecked_1;\n                _this.uiIndices.activeIndices.push(resutJSON.index);\n              } else {\n                eventArgs_1.isChecked = !isChecked_1;\n                _this.uiIndices.activeIndices.splice(_this.uiIndices.activeIndices.indexOf(resutJSON.index), 1);\n              }\n            }\n          });\n        } else if (!isSelected) {\n          this.listViewInstance.removeSelect();\n          this.listViewInstance.trigger('select', eventArgs_1, function (observedArgs) {\n            if (observedArgs.cancel) {\n              _this.activeIndex = undefined;\n            }\n          });\n        }\n      }\n    } else if (isNullOrUndefined(obj) && !this.listViewInstance.showCheckBox) {\n      this.listViewInstance.removeSelect();\n      this.activeIndex = undefined;\n    }\n  };\n  Virtualization.prototype.enableItem = function (obj) {\n    var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n    if (Object.keys(resutJSON).length) {\n      this.uiIndices.disabledItemIndices.splice(this.uiIndices.disabledItemIndices.indexOf(resutJSON.index), 1);\n    }\n  };\n  Virtualization.prototype.disableItem = function (obj) {\n    var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n    if (Object.keys(resutJSON).length && this.uiIndices.disabledItemIndices.indexOf(resutJSON.index) === -1) {\n      this.uiIndices.disabledItemIndices.push(resutJSON.index);\n    }\n  };\n  Virtualization.prototype.showItem = function (obj) {\n    var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n    if (Object.keys(resutJSON).length) {\n      this.uiIndices.hiddenItemIndices.splice(this.uiIndices.hiddenItemIndices.indexOf(resutJSON.index), 1);\n    }\n  };\n  Virtualization.prototype.hideItem = function (obj) {\n    var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n    if (Object.keys(resutJSON).length && this.uiIndices.hiddenItemIndices.indexOf(resutJSON.index) === -1) {\n      this.uiIndices.hiddenItemIndices.push(resutJSON.index);\n    }\n  };\n  Virtualization.prototype.removeItem = function (obj) {\n    var dataSource;\n    var curViewDS = this.listViewInstance.curViewDS;\n    var resutJSON = this.findDSAndIndexFromId(curViewDS, obj);\n    if (Object.keys(resutJSON).length) {\n      dataSource = resutJSON.data;\n      if (curViewDS[resutJSON.index - 1] && curViewDS[resutJSON.index - 1].isHeader && curViewDS[resutJSON.index - 1].items.length === 1) {\n        this.removeUiItem(resutJSON.index - 1);\n        this.removeUiItem(resutJSON.index - 1);\n      } else {\n        this.removeUiItem(resutJSON.index);\n      }\n    }\n    var listDataSource = this.listViewInstance.dataSource instanceof DataManager ? this.listViewInstance.localData : this.listViewInstance.dataSource;\n    var index = listDataSource.indexOf(dataSource);\n    if (index !== -1) {\n      listDataSource.splice(index, 1);\n      this.listViewInstance.setViewDataSource(listDataSource);\n    }\n    // recollect all the list item into collection\n    this.listViewInstance.liCollection = this.listViewInstance.curUL.querySelectorAll('li');\n  };\n  // eslint-disable-next-line\n  Virtualization.prototype.setCheckboxLI = function (li, e) {\n    var index = Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll('li'), li) + this.uiFirstIndex;\n    this.activeIndex = Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll('li'), li) + this.uiFirstIndex;\n    if (li.classList.contains(classNames.selected)) {\n      if (this.uiIndices.activeIndices.indexOf(index) === -1) {\n        this.uiIndices.activeIndices.push(index);\n      }\n    } else {\n      this.uiIndices.activeIndices.splice(this.uiIndices.activeIndices.indexOf(index), 1);\n    }\n  };\n  // eslint-disable-next-line\n  Virtualization.prototype.setSelectLI = function (li, e) {\n    this.activeIndex = Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll('li'), li) + this.uiFirstIndex;\n  };\n  Virtualization.prototype.checkedItem = function (checked) {\n    if (checked) {\n      this.uiIndices.activeIndices = [];\n      this.activeIndex = undefined;\n      var data = this.listViewInstance.curViewDS;\n      for (var index = 0; index < data.length; index++) {\n        if (!data[index].isHeader) {\n          this.uiIndices.activeIndices.push(index);\n        }\n      }\n    } else {\n      this.activeIndex = undefined;\n      this.uiIndices.activeIndices = [];\n    }\n  };\n  Virtualization.prototype.addUiItem = function (index) {\n    // virtually new add list item based on the scollbar position\n    // if the scroll bar is at the top, just pretend the new item has been added since no UI\n    // change is required for the item that has been added at last but when scroll bar is at the bottom\n    // just detach top and inject into bottom to mimic new item is added\n    var curViewDs = this.listViewInstance.curViewDS;\n    this.changeUiIndices(index, true);\n    if (this.activeIndex && this.activeIndex >= index) {\n      this.activeIndex++;\n    }\n    if (this.listViewInstance.showCheckBox && curViewDs[index][this.listViewInstance.fields.isChecked]) {\n      this.uiIndices.activeIndices.push(index);\n    }\n    if (!parseFloat(this.bottomElement.style.height) && !parseFloat(this.topElement.style.height)) {\n      this.bottomElement.style.height = parseFloat(this.bottomElement.style.height) + this.listItemHeight + 'px';\n    }\n    if (parseFloat(this.bottomElement.style.height)) {\n      var liItem = this.listViewInstance.curUL.lastElementChild.previousSibling;\n      var target = this.listViewInstance.getLiFromObjOrElement(curViewDs[index + 1]) || this.listViewInstance.getLiFromObjOrElement(curViewDs[index + 2]);\n      if (target) {\n        this.bottomElement.style.height = parseFloat(this.bottomElement.style.height) + this.listItemHeight + 'px';\n        this.updateUI(liItem, index, target);\n      }\n    } else {\n      var liItem = this.listViewInstance.curUL.firstElementChild.nextSibling;\n      var target = void 0;\n      if (Object.keys(this.listViewInstance.curViewDS).length - 1 === index) {\n        target = this.listViewInstance.curUL.lastElementChild;\n      } else {\n        target = this.listViewInstance.getLiFromObjOrElement(curViewDs[index + 1]) || this.listViewInstance.getLiFromObjOrElement(curViewDs[index + 2]);\n      }\n      this.topElement.style.height = parseFloat(this.topElement.style.height) + this.listItemHeight + 'px';\n      this.uiFirstIndex++;\n      this.uiLastIndex++;\n      if (target) {\n        this.updateUI(liItem, index, target);\n        if (this.listViewInstance.isWindow === true) {\n          window.scrollTo(0, pageYOffset + this.listItemHeight);\n        } else {\n          this.listViewInstance.element.scrollTop += this.listItemHeight;\n        }\n      }\n    }\n    this.totalHeight += this.listItemHeight;\n    this.listDiff = Math.round(parseFloat(this.topElement.style.height) / this.listItemHeight);\n  };\n  Virtualization.prototype.removeUiItem = function (index) {\n    this.totalHeight -= this.listItemHeight;\n    var curViewDS = this.listViewInstance.curViewDS[index];\n    var liItem = this.listViewInstance.getLiFromObjOrElement(curViewDS);\n    this.listViewInstance.curViewDS.splice(index, 1);\n    if (this.activeIndex && this.activeIndex >= index) {\n      this.activeIndex--;\n    }\n    if (liItem) {\n      if (this.domItemCount > Object.keys(this.listViewInstance.curViewDS).length) {\n        detach(liItem);\n        this.domItemCount--;\n        this.uiLastIndex--;\n        this.totalHeight = 0;\n      } else {\n        if (liItem.classList.contains(classNames.disable)) {\n          liItem.classList.remove(classNames.disable);\n          this.uiIndices.disabledItemIndices.splice(this.uiIndices.disabledItemIndices.indexOf(index), 1);\n        }\n        if (liItem.style.display === 'none') {\n          liItem.style.display = '';\n          this.uiIndices.hiddenItemIndices.splice(this.uiIndices.hiddenItemIndices.indexOf(index), 1);\n        }\n        if (this.listViewInstance.showCheckBox && liItem.classList.contains(classNames.selected)) {\n          this.listViewInstance.removeSelect();\n          this.uiIndices.activeIndices.splice(this.uiIndices.activeIndices.indexOf(index), 1);\n          var checklistElement = liItem.querySelector('.' + classNames.checkboxWrapper);\n          checklistElement.removeAttribute('aria-checked');\n          checklistElement.firstElementChild.classList.remove(classNames.checked);\n          if (liItem.classList.contains(classNames.focused)) {\n            liItem.classList.remove(classNames.focused);\n            this.activeIndex = undefined;\n          }\n        } else if (liItem.classList.contains(classNames.selected)) {\n          this.listViewInstance.removeSelect();\n          this.activeIndex = undefined;\n        }\n        if (!parseFloat(this.bottomElement.style.height) && !parseFloat(this.topElement.style.height)) {\n          this.updateUI(liItem, this.uiLastIndex, this.bottomElement);\n        } else if (parseFloat(this.bottomElement.style.height)) {\n          this.bottomElement.style.height = parseFloat(this.bottomElement.style.height) - this.listItemHeight + 'px';\n          this.updateUI(liItem, this.uiLastIndex, this.bottomElement);\n        } else {\n          this.topElement.style.height = parseFloat(this.topElement.style.height) - this.listItemHeight + 'px';\n          this.updateUI(liItem, this.uiFirstIndex - 1, this.topElement.nextSibling);\n          this.uiLastIndex--;\n          this.uiFirstIndex--;\n        }\n      }\n    }\n    this.changeUiIndices(index, false);\n    this.listDiff = Math.round(parseFloat(this.topElement.style.height) / this.listItemHeight);\n  };\n  Virtualization.prototype.changeUiIndices = function (index, increment) {\n    var keys = Object.keys(this.uiIndices);\n    for (var ind = 0; ind < keys.length; ind++) {\n      this.uiIndices[keys[ind]] = this.uiIndices[keys[ind]].map(function (i) {\n        if (i >= index) {\n          return increment ? ++i : --i;\n        } else {\n          return i;\n        }\n      });\n    }\n  };\n  Virtualization.prototype.addItem = function (data, fields, dataSource, index) {\n    for (var i = 0; i < data.length; i++) {\n      var currentItem = data[i];\n      // push the given data to main data array\n      dataSource = this.listViewInstance.addItemAtIndex(index, dataSource, currentItem);\n      // recalculate all the group data or other datasource related things\n      this.listViewInstance.setViewDataSource(dataSource);\n      // render list items for first time due to no datasource present earlier\n      if (!this.domItemCount) {\n        // fresh rendering for first time\n        if ((this.listViewInstance.template || this.listViewInstance.groupTemplate) && !this.isNgTemplate()) {\n          this.listViewInstance.listBaseOption.template = null;\n          this.listViewInstance.listBaseOption.groupTemplate = null;\n          this.listViewInstance.listBaseOption.itemCreated = this.createUIItem.bind(this);\n        }\n        this.uiVirtualization();\n        // when expected expected DOM count doesn't meet the condition we need to create and inject new item into DOM\n      } else if (this.domItemCount < this.expectedDomItemCount) {\n        var ds = this.listViewInstance.findItemFromDS(dataSource, fields);\n        if (ds instanceof Array) {\n          if (this.listViewInstance.ulElement) {\n            var index_1 = this.listViewInstance.curViewDS.indexOf(currentItem);\n            // inject new list item into DOM\n            this.createAndInjectNewItem(currentItem, index_1);\n            // check for group header item\n            var curViewDS = this.listViewInstance.curViewDS[index_1 - 1];\n            if (curViewDS && curViewDS.isHeader && curViewDS.items.length === 1) {\n              // target group item index in datasource\n              --index_1;\n              // inject new group header into DOM for previously created list item\n              this.createAndInjectNewItem(curViewDS, index_1);\n            }\n          }\n          // recollect all the list item into collection\n          this.listViewInstance.liCollection = this.listViewInstance.curUL.querySelectorAll('li');\n        }\n      } else {\n        var index_2 = this.listViewInstance.curViewDS.indexOf(currentItem);\n        // virtually new add list item based on the scollbar position\n        this.addUiItem(index_2);\n        // check for group header item needs to be added\n        var curViewDS = this.listViewInstance.curViewDS[index_2 - 1];\n        if (curViewDS && curViewDS.isHeader && curViewDS.items.length === 1) {\n          this.addUiItem(index_2 - 1);\n        }\n      }\n    }\n  };\n  Virtualization.prototype.createAndInjectNewItem = function (itemData, index) {\n    // generate li item for given datasource\n    var target;\n    var li = ListBase.createListItemFromJson(this.listViewInstance.createElement, [itemData], this.listViewInstance.listBaseOption, null, null, this.listViewInstance);\n    // check for target element whether to insert before last item or group item\n    if (Object.keys(this.listViewInstance.curViewDS).length - 1 === index) {\n      target = this.listViewInstance.curUL.lastElementChild;\n    } else {\n      // target group header's first child item to append its header\n      target = this.listViewInstance.getLiFromObjOrElement(this.listViewInstance.curViewDS[index + 1]) || this.listViewInstance.getLiFromObjOrElement(this.listViewInstance.curViewDS[index + 2]);\n    }\n    if (this.listViewInstance.fields.groupBy && this.listViewInstance.curViewDS[index + 1] && this.listViewInstance.curViewDS[index + 1].isHeader) {\n      var targetEle = this.listViewInstance.getLiFromObjOrElement(this.listViewInstance.curViewDS[index - 1]);\n      if (targetEle) {\n        target = targetEle.nextElementSibling;\n      }\n    }\n    // insert before the target element\n    this.listViewInstance.ulElement.insertBefore(li[0], target);\n    // increment internal DOM count, last index count for new element\n    this.domItemCount++;\n    if (this.bottomElementHeight <= 0) {\n      this.uiLastIndex++;\n    }\n    // recalculate the current item height, to avoid jumpy scroller\n    this.refreshItemHeight();\n  };\n  Virtualization.prototype.createUIItem = function (args) {\n    if (!args.item.classList.contains('e-list-group-item')) {\n      this.templateData = args.curData.isHeader ? args.curData.items[0] : args.curData;\n      if (this.listViewInstance.showCheckBox) {\n        this.listViewInstance.renderCheckbox(args);\n        if (!isNullOrUndefined(this.listViewInstance.virtualCheckBox) && !isNullOrUndefined(this.listViewInstance.virtualCheckBox.outerHTML)) {\n          var div_1 = document.createElement('div');\n          var commonTemplate = '<div class=\"e-text-content\" role=\"presentation\"> ' + '<span class=\"e-list-text\"> ${' + this.listViewInstance.fields.text + '} </span></div>';\n          var templateFunction = compile(this.listViewInstance.template || commonTemplate, this.listViewInstance);\n          var nodes = templateFunction(this.templateData, this.listViewInstance);\n          if (this.listViewInstance.template && this.listViewInstance.isReact) {\n            this.listViewInstance.renderReactTemplates();\n          }\n          [].slice.call(nodes).forEach(function (ele) {\n            div_1.appendChild(ele);\n          });\n          if (div_1.children && div_1.children[0]) {\n            div_1.children[0].classList.add('e-checkbox');\n            if (this.listViewInstance.checkBoxPosition === 'Left') {\n              div_1.children[0].classList.add('e-checkbox-left');\n            } else {\n              div_1.children[0].classList.add('e-checkbox-right');\n            }\n            if (this.listViewInstance.checkBoxPosition === 'Left') {\n              div_1.children[0].insertBefore(this.listViewInstance.virtualCheckBox, div_1.childNodes[0].children[0]);\n            } else {\n              div_1.children[0].appendChild(this.listViewInstance.virtualCheckBox);\n            }\n            while (args.item.lastChild) {\n              args.item.removeChild(args.item.lastChild);\n            }\n            [].slice.call(div_1.children).forEach(function (ele) {\n              args.item.appendChild(ele);\n            });\n          }\n        }\n      }\n    }\n  };\n  Virtualization.prototype.reRenderUiVirtualization = function () {\n    this.wireScrollEvent(true);\n    if (this.listViewInstance.contentContainer) {\n      detach(this.listViewInstance.contentContainer);\n    }\n    this.listViewInstance.preRender();\n    // resetting the dom count to 0, to avoid edge case of dataSource suddenly becoming zero\n    // and then manually adding item using addItem API\n    this.domItemCount = 0;\n    this.listViewInstance.header();\n    this.listViewInstance.setLocalData();\n  };\n  Virtualization.prototype.updateUI = function (element, index, targetElement) {\n    var onChange = this.isNgTemplate() ? this.onNgChange : this.onChange;\n    if (this.listViewInstance.template || this.listViewInstance.groupTemplate) {\n      var curViewDS = this.listViewInstance.curViewDS[index];\n      element.dataset.uid = curViewDS[this.listViewInstance.fields.id] ? curViewDS[this.listViewInstance.fields.id] : ListBase.generateId();\n      onChange(curViewDS, element, this);\n    } else {\n      this.updateUiContent(element, index);\n    }\n    this.changeElementAttributes(element, index);\n    if (targetElement) {\n      this.listViewInstance.ulElement.insertBefore(element, targetElement);\n    }\n  };\n  /**\n   * Handles the UI change in vue for the list view.\n   *\n   * @param {DataSource} newData - The new data source for the list view.\n   * @param {ElementContext} listElement - The HTML element context for the list view.\n   * @param {Virtualization} virtualThis - The virtualization context for the list view.\n   * @returns {void}\n   */\n  Virtualization.prototype.onChange = function (newData, listElement, virtualThis) {\n    var liItem = ListBase.createListItemFromJson(virtualThis.listViewInstance.createElement, [newData], virtualThis.listViewInstance.listBaseOption, null, null, virtualThis.listViewInstance);\n    if (virtualThis.listViewInstance.isReact) {\n      virtualThis.listViewInstance.renderReactTemplates();\n    }\n    while (listElement.lastChild) {\n      listElement.removeChild(listElement.lastChild);\n    }\n    [].slice.call(liItem[0].children).forEach(function (ele) {\n      listElement.appendChild(ele);\n    });\n  };\n  Virtualization.prototype.onNgChange = function (newData, listElement, virtualThis) {\n    // compile given target element with template for new data\n    var templateCompiler = compile(virtualThis.listViewInstance.template);\n    var resultElement = templateCompiler(newData);\n    while (listElement.lastChild) {\n      listElement.removeChild(listElement.lastChild);\n    }\n    listElement.appendChild(resultElement[0]);\n  };\n  Virtualization.prototype.getModuleName = function () {\n    return 'virtualization';\n  };\n  Virtualization.prototype.destroy = function () {\n    this.wireScrollEvent(true);\n    this.topElement = null;\n    this.bottomElement = null;\n  };\n  return Virtualization;\n}();\nexport { Virtualization };","map":{"version":3,"names":["classNames","EventHandler","append","isNullOrUndefined","detach","compile","formatUnit","select","ListBase","DataManager","listElementCount","windowElementCount","Virtualization","instance","elementDifference","listViewInstance","prototype","isNgTemplate","templateRef","isVueFunctionTemplate","isVue","template","uiVirtualization","wireScrollEvent","curViewDS","isRendered","firstIndex","uiFirstIndex","uiLastIndex","Object","keys","length","firstDs","slice","ulElement","curUL","createList","createElement","listBaseOption","contentContainer","className","container","element","appendChild","listItemHeight","firstElementChild","getBoundingClientRect","height","expectedDomItemCount","ValidateItemCount","updateDOMItemCount","lastIndex","listDiff","domItemCount","otherDs","listItems","createListItemFromJson","liCollection","querySelectorAll","topElement","insertBefore","bottomElement","totalHeight","style","topElementHeight","bottomElementHeight","scrollTop","previousScrollTop","uiIndicesInitialization","destroy","isWindow","onVirtualScroll","onVirtualUiScroll","bind","window","addEventListener","add","removeEventListener","updateUl","remove","dataSourceLength","parseFloat","itemCount","Math","round","innerHeight","indexOf","uiIndices","data","i","showCheckBox","fields","isChecked","activeIndices","push","parseInt","toString","enabled","disabledItemIndices","items","listItem","index","context","viewContainerRef","get","refreshItemHeight","nextSibling","getscrollerHeight","startingHeight","pageYOffset","_a","top","document","documentElement","headerEle","scrollPosition","scroll","floor","onLongScroll","onNormalScroll","onUIScrolled","isScrollingDown","elements","updateUI","nextElementSibling","target","previousElementSibling","updateUiContent","curViewDs","dataSource","dataset","uid","generateId","getElementsByClassName","listItemText","innerHTML","id","text","showIcon","querySelector","listIcon","iconCss","textContent","groupBy","checkListWrapper","checkboxWrapper","cloneNode","isHeader","classList","checklist","checkbox","checkBoxPosition","changeElementAttributes","disable","display","hiddenItemIndices","checklistElement","selected","focused","removeAttribute","checked","setAttribute","activeIndex","contains","groupListItem","findDSAndIndexFromId","ds","_this","resultJSON","getElementUID","some","getSelectedItems","dataCollection","textCollection","curViewDS_1","indices","map","curViewDS_2","indexArray","dataSource_1","undefined","selectItem","obj","resutJSON","isSelected","isChecked_1","splice","getLiFromObjOrElement","setCheckboxLI","setSelectLI","eventArgs_1","trigger","observedArgs","cancel","removeSelect","enableItem","disableItem","showItem","hideItem","removeItem","removeUiItem","listDataSource","localData","setViewDataSource","li","e","Array","call","checkedItem","addUiItem","changeUiIndices","liItem","lastElementChild","previousSibling","scrollTo","increment","ind","addItem","currentItem","addItemAtIndex","groupTemplate","itemCreated","createUIItem","findItemFromDS","index_1","createAndInjectNewItem","index_2","itemData","targetEle","args","item","templateData","curData","renderCheckbox","virtualCheckBox","outerHTML","div_1","commonTemplate","templateFunction","nodes","isReact","renderReactTemplates","forEach","ele","children","childNodes","lastChild","removeChild","reRenderUiVirtualization","preRender","header","setLocalData","targetElement","onChange","onNgChange","newData","listElement","virtualThis","templateCompiler","resultElement","getModuleName"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-lists/src/list-view/virtualization.js"],"sourcesContent":["import { classNames } from './list-view';\nimport { EventHandler, append, isNullOrUndefined, detach, compile, formatUnit, select } from '@syncfusion/ej2-base';\nimport { ListBase } from '../common/list-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nvar listElementCount = 1.5;\nvar windowElementCount = 3;\nvar Virtualization = /** @class */ (function () {\n    function Virtualization(instance) {\n        this.elementDifference = 0;\n        this.listViewInstance = instance;\n    }\n    /**\n     * For internal use only.\n     *\n     * @private\n     */\n    Virtualization.prototype.isNgTemplate = function () {\n        return !isNullOrUndefined(this.listViewInstance.templateRef) && typeof this.listViewInstance.templateRef !== 'string';\n    };\n    /**\n     * Checks if the platform is a Vue and its template property is a function type.\n     *\n     * @returns {boolean} indicating the result of the check\n     */\n    Virtualization.prototype.isVueFunctionTemplate = function () {\n        return this.listViewInstance.isVue && typeof this.listViewInstance.template === 'function';\n    };\n    /**\n     * For internal use only.\n     *\n     * @private\n     */\n    Virtualization.prototype.uiVirtualization = function () {\n        this.wireScrollEvent(false);\n        var curViewDS = this.listViewInstance.curViewDS;\n        var isRendered = this.listViewInstance.isRendered;\n        var firstIndex = isRendered && !isNullOrUndefined(this.uiFirstIndex) && this.uiLastIndex <= Object.keys(curViewDS).length\n            ? this.uiFirstIndex : 0;\n        var firstDs = curViewDS.slice(firstIndex, firstIndex + 1);\n        this.listViewInstance.ulElement = this.listViewInstance.curUL = ListBase.createList(this.listViewInstance.createElement, firstDs, this.listViewInstance.listBaseOption, null, this.listViewInstance);\n        this.listViewInstance.contentContainer = this.listViewInstance.createElement('div', { className: classNames.container });\n        this.listViewInstance.element.appendChild(this.listViewInstance.contentContainer);\n        this.listViewInstance.contentContainer.appendChild(this.listViewInstance.ulElement);\n        this.listItemHeight = this.listViewInstance.ulElement.firstElementChild.getBoundingClientRect().height;\n        this.expectedDomItemCount = this.ValidateItemCount(10000);\n        this.updateDOMItemCount();\n        var lastIndex = isRendered && !isNullOrUndefined(this.uiLastIndex) && this.listDiff !== 0\n            ? this.uiLastIndex : this.domItemCount - 1;\n        this.uiFirstIndex = firstIndex;\n        this.uiLastIndex = lastIndex;\n        var otherDs = curViewDS.slice(firstIndex + 1, lastIndex + 1);\n        var listItems = ListBase.createListItemFromJson(this.listViewInstance.createElement, otherDs, this.listViewInstance.listBaseOption, null, null, this.listViewInstance);\n        append(listItems, this.listViewInstance.ulElement);\n        this.listViewInstance.liCollection = this.listViewInstance.curUL.querySelectorAll('li');\n        this.topElement = this.listViewInstance.createElement('div');\n        this.listViewInstance.ulElement.insertBefore(this.topElement, this.listViewInstance.ulElement.firstElementChild);\n        this.bottomElement = this.listViewInstance.createElement('div');\n        this.listViewInstance.ulElement.insertBefore(this.bottomElement, null);\n        this.totalHeight = (Object.keys(curViewDS).length * this.listItemHeight) - (this.domItemCount * this.listItemHeight);\n        this.topElement.style.height = isRendered ? this.topElementHeight + 'px' : '0px';\n        this.bottomElement.style.height = isRendered ? (this.totalHeight - this.topElementHeight) + 'px' : this.totalHeight + 'px';\n        this.topElementHeight = isRendered ? this.topElementHeight : 0;\n        this.bottomElementHeight = isRendered ? (this.totalHeight - this.topElementHeight) : this.totalHeight;\n        this.listDiff = isRendered && Object.keys(curViewDS).length !== this.domItemCount ? this.listDiff : 0;\n        if (isRendered) {\n            this.listViewInstance.element.scrollTop = this.listViewInstance.previousScrollTop;\n        }\n        this.uiIndicesInitialization();\n    };\n    Virtualization.prototype.wireScrollEvent = function (destroy) {\n        if (!destroy) {\n            if (this.listViewInstance.isWindow) {\n                this.onVirtualScroll = this.onVirtualUiScroll.bind(this);\n                window.addEventListener('scroll', this.onVirtualScroll);\n            }\n            else {\n                EventHandler.add(this.listViewInstance.element, 'scroll', this.onVirtualUiScroll, this);\n            }\n        }\n        else {\n            if (this.listViewInstance.isWindow === true) {\n                window.removeEventListener('scroll', this.onVirtualScroll);\n                window.removeEventListener('scroll', this.updateUl);\n            }\n            else {\n                EventHandler.remove(this.listViewInstance.element, 'scroll', this.onVirtualUiScroll);\n            }\n        }\n    };\n    Virtualization.prototype.ValidateItemCount = function (dataSourceLength) {\n        var height = parseFloat(formatUnit(this.listViewInstance.height));\n        var itemCount;\n        if (this.listViewInstance.isWindow) {\n            itemCount = Math.round((window.innerHeight / this.listItemHeight) * windowElementCount);\n        }\n        else {\n            if (typeof this.listViewInstance.height === 'string' && this.listViewInstance.height.indexOf('%') !== -1) {\n                itemCount = Math.round((this.listViewInstance.element.getBoundingClientRect().height / this.listItemHeight) * listElementCount);\n            }\n            else {\n                itemCount = Math.round((height / this.listItemHeight) * listElementCount);\n            }\n        }\n        if (itemCount > dataSourceLength) {\n            itemCount = dataSourceLength;\n        }\n        return itemCount;\n    };\n    Virtualization.prototype.updateDOMItemCount = function () {\n        this.domItemCount = this.ValidateItemCount(Object.keys(this.listViewInstance.curViewDS).length);\n    };\n    Virtualization.prototype.uiIndicesInitialization = function () {\n        this.uiIndices = { 'activeIndices': [], 'disabledItemIndices': [], 'hiddenItemIndices': [] };\n        var data = this.listViewInstance.curViewDS;\n        for (var i = 0; i < data.length; i++) {\n            if (this.listViewInstance.showCheckBox && data[i][this.listViewInstance.fields.isChecked]) {\n                this.uiIndices.activeIndices.push(i);\n            }\n            if (!isNullOrUndefined(data[parseInt(i.toString(), 10)][this.listViewInstance.fields.enabled]) &&\n                !data[i][this.listViewInstance.fields.enabled]) {\n                (this.uiIndices.disabledItemIndices.push(i));\n            }\n        }\n        if (this.isNgTemplate()) {\n            var items = this.listViewInstance.element.querySelectorAll('.' + classNames.listItem);\n            for (var index = 0; index < items.length; index++) {\n                items[index].context = this.listViewInstance.viewContainerRef.get(index).context;\n            }\n        }\n    };\n    Virtualization.prototype.refreshItemHeight = function () {\n        if (this.listViewInstance.curViewDS.length) {\n            var curViewDS = this.listViewInstance.curViewDS;\n            this.listItemHeight = this.topElement.nextSibling.getBoundingClientRect().height;\n            this.totalHeight = (Object.keys(curViewDS).length * this.listItemHeight) - (this.domItemCount * this.listItemHeight);\n            this.bottomElementHeight = this.totalHeight;\n            this.bottomElement.style.height = this.totalHeight + 'px';\n        }\n    };\n    Virtualization.prototype.getscrollerHeight = function (startingHeight) {\n        return this.listViewInstance.isWindow ? (((pageYOffset - startingHeight) <= 0) ? 0 :\n            (pageYOffset - startingHeight)) : ((this.listViewInstance.element.scrollTop - startingHeight) <= 0) ? 0 :\n            (this.listViewInstance.element.scrollTop - startingHeight);\n    };\n    Virtualization.prototype.onVirtualUiScroll = function () {\n        var _a;\n        var startingHeight;\n        var curViewDS = this.listViewInstance.curViewDS;\n        this.listItemHeight = select('.e-list-item', this.listViewInstance.element).getBoundingClientRect().height;\n        this.totalHeight = (Object.keys(curViewDS).length * this.listItemHeight) - (this.domItemCount * this.listItemHeight);\n        if (this.listViewInstance.isWindow) {\n            startingHeight = this.listViewInstance.ulElement.getBoundingClientRect().top -\n                document.documentElement.getBoundingClientRect().top;\n        }\n        else {\n            startingHeight = this.listViewInstance.headerEle ? this.listViewInstance.headerEle.getBoundingClientRect().height : 0;\n        }\n        this.scrollPosition = isNullOrUndefined(this.scrollPosition) ? 0 : this.scrollPosition;\n        var scroll = this.getscrollerHeight(startingHeight);\n        this.topElementHeight = this.listItemHeight * Math.floor(scroll / this.listItemHeight);\n        this.bottomElementHeight = this.totalHeight - this.topElementHeight;\n        _a = scroll <= this.totalHeight ?\n            [this.topElementHeight, this.bottomElementHeight] : [this.totalHeight, 0], this.topElementHeight = _a[0], this.bottomElementHeight = _a[1];\n        if (this.topElementHeight !== parseFloat(this.topElement.style.height)) {\n            this.topElement.style.height = this.topElementHeight + 'px';\n            this.bottomElement.style.height = this.bottomElementHeight + 'px';\n            if (scroll > this.scrollPosition) {\n                var listDiff = Math.round(((this.topElementHeight / this.listItemHeight) - this.listDiff));\n                if (listDiff > (this.expectedDomItemCount + 5)) {\n                    this.onLongScroll(listDiff, true);\n                }\n                else {\n                    this.onNormalScroll(listDiff, true);\n                }\n            }\n            else {\n                var listDiff = Math.round((this.listDiff - (this.topElementHeight / this.listItemHeight)));\n                if (listDiff > (this.expectedDomItemCount + 5)) {\n                    this.onLongScroll(listDiff, false);\n                }\n                else {\n                    this.onNormalScroll(listDiff, false);\n                }\n            }\n        }\n        this.listDiff = Math.round(this.topElementHeight / this.listItemHeight);\n        if (typeof this.listViewInstance.onUIScrolled === 'function') {\n            this.listViewInstance.onUIScrolled();\n        }\n        this.scrollPosition = scroll;\n    };\n    Virtualization.prototype.onLongScroll = function (listDiff, isScrollingDown) {\n        var index = isScrollingDown ? (this.uiFirstIndex + listDiff) : (this.uiFirstIndex - listDiff);\n        var elements = this.listViewInstance.ulElement.querySelectorAll('li');\n        for (var i = 0; i < elements.length; i++) {\n            this.updateUI(elements[i], index);\n            index++;\n        }\n        this.uiLastIndex = isScrollingDown ? (this.uiLastIndex + listDiff) : (this.uiLastIndex - listDiff);\n        this.uiFirstIndex = isScrollingDown ? (this.uiFirstIndex + listDiff) : (this.uiFirstIndex - listDiff);\n    };\n    Virtualization.prototype.onNormalScroll = function (listDiff, isScrollingDown) {\n        if (isScrollingDown) {\n            for (var i = 0; i < listDiff; i++) {\n                var index = ++this.uiLastIndex;\n                this.updateUI(this.topElement.nextElementSibling, index, this.bottomElement);\n                this.uiFirstIndex++;\n            }\n        }\n        else {\n            for (var i = 0; i < listDiff; i++) {\n                var index = --this.uiFirstIndex;\n                var target = this.topElement.nextSibling;\n                this.updateUI(this.bottomElement.previousElementSibling, index, target);\n                this.uiLastIndex--;\n            }\n        }\n    };\n    Virtualization.prototype.updateUiContent = function (element, index) {\n        var curViewDs = this.listViewInstance.curViewDS;\n        if (typeof this.listViewInstance.dataSource[0] === 'string' ||\n            typeof this.listViewInstance.dataSource[0] === 'number') {\n            element.dataset.uid = ListBase.generateId();\n            element.getElementsByClassName(classNames.listItemText)[0].innerHTML =\n                this.listViewInstance.curViewDS[index].toString();\n        }\n        else {\n            element.dataset.uid = (curViewDs[parseInt(index.toString(), 10)][this.listViewInstance.fields.id]) ?\n                (curViewDs[parseInt(index.toString(), 10)][this.listViewInstance.fields.id]) : ListBase.generateId();\n            element.getElementsByClassName(classNames.listItemText)[0].innerHTML =\n                (curViewDs[parseInt(index.toString(), 10)][this.listViewInstance.fields.text]);\n        }\n        if (this.listViewInstance.showIcon) {\n            if (element.querySelector('.' + classNames.listIcon)) {\n                detach(element.querySelector('.' + classNames.listIcon));\n            }\n            if (this.listViewInstance.curViewDS[index][this.listViewInstance.fields.iconCss]) {\n                var textContent = element.querySelector('.' + classNames.textContent);\n                var curViewDS = this.listViewInstance.curViewDS[index];\n                var iconCss = curViewDS[this.listViewInstance.fields.iconCss].toString();\n                var target = this.listViewInstance.createElement('div', {\n                    className: classNames.listIcon + ' ' + iconCss\n                });\n                textContent.insertBefore(target, element.querySelector('.' + classNames.listItemText));\n            }\n        }\n        if (this.listViewInstance.showCheckBox && this.listViewInstance.fields.groupBy) {\n            if (!this.checkListWrapper) {\n                this.checkListWrapper = this.listViewInstance.curUL.querySelector('.' + classNames.checkboxWrapper).cloneNode(true);\n            }\n            var textContent = element.querySelector('.' + classNames.textContent);\n            if (this.listViewInstance.curViewDS[index].isHeader) {\n                if (element.querySelector('.' + classNames.checkboxWrapper)) {\n                    element.classList.remove(classNames.checklist);\n                    textContent.classList.remove(classNames.checkbox);\n                    detach(element.querySelector('.' + classNames.checkboxWrapper));\n                }\n            }\n            else {\n                if (!element.querySelector('.' + classNames.checkboxWrapper)) {\n                    element.classList.add(classNames.checklist);\n                    textContent.classList.add(classNames.checkbox);\n                    if (this.listViewInstance.checkBoxPosition === 'Left') {\n                        textContent.classList.add('e-checkbox-left');\n                    }\n                    else {\n                        textContent.classList.add('e-checkbox-right');\n                    }\n                    textContent.append(this.checkListWrapper.cloneNode(true));\n                }\n            }\n        }\n    };\n    Virtualization.prototype.changeElementAttributes = function (element, index) {\n        element.classList.remove(classNames.disable);\n        if (this.uiIndices.disabledItemIndices.length && this.uiIndices.disabledItemIndices.indexOf(index) !== -1) {\n            element.classList.add(classNames.disable);\n        }\n        element.style.display = '';\n        if (this.uiIndices.hiddenItemIndices.length && this.uiIndices.hiddenItemIndices.indexOf(index) !== -1) {\n            element.style.display = 'none';\n        }\n        if (this.listViewInstance.showCheckBox) {\n            var checklistElement = element.querySelector('.' + classNames.checkboxWrapper);\n            element.classList.remove(classNames.selected);\n            element.classList.remove(classNames.focused);\n            if (checklistElement) {\n                checklistElement.removeAttribute('aria-checked');\n                checklistElement.firstElementChild.classList.remove(classNames.checked);\n            }\n            if (this.uiIndices.activeIndices.length && this.uiIndices.activeIndices.indexOf(index) !== -1 &&\n                !this.listViewInstance.curUL.querySelector(classNames.selected)) {\n                element.classList.add(classNames.selected);\n                checklistElement.firstElementChild.classList.add(classNames.checked);\n                checklistElement.setAttribute('aria-checked', 'true');\n                if (this.activeIndex === index) {\n                    element.classList.add(classNames.focused);\n                }\n            }\n        }\n        else {\n            element.classList.remove(classNames.selected);\n            element.removeAttribute('aria-selected');\n            if (!isNullOrUndefined(this.activeIndex) && this.activeIndex === index &&\n                !this.listViewInstance.curUL.querySelector(classNames.selected)) {\n                element.classList.add(classNames.selected);\n                element.setAttribute('aria-selected', 'true');\n            }\n        }\n        if (this.listViewInstance.fields.groupBy) {\n            if (this.listViewInstance.curViewDS[index].isHeader) {\n                if (element.classList.contains(classNames.listItem)) {\n                    element.classList.remove(classNames.listItem);\n                    element.setAttribute('role', 'group');\n                    element.classList.add(classNames.groupListItem);\n                }\n            }\n            else {\n                if (element.classList.contains(classNames.groupListItem)) {\n                    element.classList.remove(classNames.groupListItem);\n                    element.setAttribute('role', 'listitem');\n                    element.classList.add(classNames.listItem);\n                }\n            }\n        }\n    };\n    Virtualization.prototype.findDSAndIndexFromId = function (ds, fields) {\n        var _this = this;\n        var resultJSON = {};\n        fields = this.listViewInstance.getElementUID(fields);\n        if (!isNullOrUndefined(fields)) {\n            ds.some(function (data, index) {\n                if ((fields[_this.listViewInstance.fields.id] &&\n                    fields[_this.listViewInstance.fields.id]\n                        === (data[_this.listViewInstance.fields.id] && data[_this.listViewInstance.fields.id]) || fields === data)) {\n                    resultJSON.index = index;\n                    resultJSON.data = data;\n                    return true;\n                }\n                else {\n                    return false;\n                }\n            });\n        }\n        return resultJSON;\n    };\n    Virtualization.prototype.getSelectedItems = function () {\n        var _this = this;\n        if (!isNullOrUndefined(this.activeIndex) || (this.listViewInstance.showCheckBox && this.uiIndices.activeIndices.length)) {\n            var dataCollection = [];\n            var textCollection = [];\n            if (typeof this.listViewInstance.dataSource[0] === 'string' ||\n                typeof this.listViewInstance.dataSource[0] === 'number') {\n                var curViewDS_1 = this.listViewInstance.curViewDS;\n                if (this.listViewInstance.showCheckBox) {\n                    var indices = this.uiIndices.activeIndices;\n                    for (var i = 0; i < indices.length; i++) {\n                        dataCollection.push(curViewDS_1[indices[i]]);\n                    }\n                    return {\n                        text: dataCollection,\n                        data: dataCollection,\n                        index: this.uiIndices.activeIndices.map(function (index) {\n                            return _this.listViewInstance.dataSource.indexOf(curViewDS_1[index]);\n                        })\n                    };\n                }\n                else {\n                    return {\n                        text: curViewDS_1[this.activeIndex],\n                        data: curViewDS_1[this.activeIndex],\n                        index: this.listViewInstance.dataSource.indexOf(curViewDS_1[this.activeIndex])\n                    };\n                }\n            }\n            else {\n                var curViewDS_2 = this.listViewInstance.curViewDS;\n                var text = this.listViewInstance.fields.text;\n                if (this.listViewInstance.showCheckBox) {\n                    var indexArray = this.uiIndices.activeIndices;\n                    for (var i = 0; i < indexArray.length; i++) {\n                        textCollection.push(curViewDS_2[indexArray[i]][\"\" + text]);\n                        dataCollection.push(curViewDS_2[indexArray[parseInt(i.toString(), 10)]]);\n                    }\n                    var dataSource_1 = this.listViewInstance.dataSource instanceof DataManager\n                        ? curViewDS_2 : this.listViewInstance.dataSource;\n                    return {\n                        text: textCollection,\n                        data: dataCollection,\n                        index: this.uiIndices.activeIndices.map(function (index) {\n                            return dataSource_1.indexOf(curViewDS_2[index]);\n                        })\n                    };\n                }\n                else {\n                    var dataSource = this.listViewInstance.dataSource instanceof DataManager\n                        ? curViewDS_2 : this.listViewInstance.dataSource;\n                    return {\n                        text: curViewDS_2[this.activeIndex][this.listViewInstance.fields.text],\n                        data: curViewDS_2[this.activeIndex],\n                        index: dataSource.indexOf(curViewDS_2[this.activeIndex])\n                    };\n                }\n            }\n        }\n        else {\n            return undefined;\n        }\n    };\n    Virtualization.prototype.selectItem = function (obj) {\n        var _this = this;\n        var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n        if (Object.keys(resutJSON).length) {\n            var isSelected = this.activeIndex === resutJSON.index;\n            var isChecked_1;\n            this.activeIndex = resutJSON.index;\n            if (this.listViewInstance.showCheckBox) {\n                if (this.uiIndices.activeIndices.indexOf(resutJSON.index) === -1) {\n                    isChecked_1 = true;\n                    this.uiIndices.activeIndices.push(resutJSON.index);\n                }\n                else {\n                    isChecked_1 = false;\n                    this.uiIndices.activeIndices.splice(this.uiIndices.activeIndices.indexOf(resutJSON.index), 1);\n                }\n                if (this.listViewInstance.curUL.querySelector('.' + classNames.focused)) {\n                    this.listViewInstance.curUL.querySelector('.' + classNames.focused).classList.remove(classNames.focused);\n                }\n            }\n            if (this.listViewInstance.getLiFromObjOrElement(obj)) {\n                if (this.listViewInstance.showCheckBox) {\n                    this.listViewInstance.setCheckboxLI(this.listViewInstance.getLiFromObjOrElement(obj));\n                }\n                else {\n                    this.listViewInstance.setSelectLI(this.listViewInstance.getLiFromObjOrElement(obj));\n                }\n            }\n            else {\n                var eventArgs_1;\n                if (typeof this.listViewInstance.dataSource[0] === 'string' ||\n                    typeof this.listViewInstance.dataSource[0] === 'number') {\n                    eventArgs_1 = {\n                        text: this.listViewInstance.curViewDS[this.activeIndex],\n                        data: this.listViewInstance.curViewDS[this.activeIndex],\n                        index: this.activeIndex\n                    };\n                }\n                else {\n                    var curViewDS = this.listViewInstance.curViewDS;\n                    eventArgs_1 = {\n                        text: curViewDS[this.activeIndex][this.listViewInstance.fields.text],\n                        data: curViewDS[this.activeIndex],\n                        index: this.activeIndex\n                    };\n                }\n                if (this.listViewInstance.showCheckBox) {\n                    this.listViewInstance.trigger('select', eventArgs_1, function (observedArgs) {\n                        if (observedArgs.cancel) {\n                            if (!isChecked_1) {\n                                eventArgs_1.isChecked = isChecked_1;\n                                _this.uiIndices.activeIndices.push(resutJSON.index);\n                            }\n                            else {\n                                eventArgs_1.isChecked = !isChecked_1;\n                                _this.uiIndices.activeIndices.splice(_this.uiIndices.activeIndices.indexOf(resutJSON.index), 1);\n                            }\n                        }\n                    });\n                }\n                else if (!isSelected) {\n                    this.listViewInstance.removeSelect();\n                    this.listViewInstance.trigger('select', eventArgs_1, function (observedArgs) {\n                        if (observedArgs.cancel) {\n                            _this.activeIndex = undefined;\n                        }\n                    });\n                }\n            }\n        }\n        else if (isNullOrUndefined(obj) && !this.listViewInstance.showCheckBox) {\n            this.listViewInstance.removeSelect();\n            this.activeIndex = undefined;\n        }\n    };\n    Virtualization.prototype.enableItem = function (obj) {\n        var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n        if (Object.keys(resutJSON).length) {\n            this.uiIndices.disabledItemIndices.splice(this.uiIndices.disabledItemIndices.indexOf(resutJSON.index), 1);\n        }\n    };\n    Virtualization.prototype.disableItem = function (obj) {\n        var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n        if (Object.keys(resutJSON).length && this.uiIndices.disabledItemIndices.indexOf(resutJSON.index) === -1) {\n            this.uiIndices.disabledItemIndices.push(resutJSON.index);\n        }\n    };\n    Virtualization.prototype.showItem = function (obj) {\n        var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n        if (Object.keys(resutJSON).length) {\n            this.uiIndices.hiddenItemIndices.splice(this.uiIndices.hiddenItemIndices.indexOf(resutJSON.index), 1);\n        }\n    };\n    Virtualization.prototype.hideItem = function (obj) {\n        var resutJSON = this.findDSAndIndexFromId(this.listViewInstance.curViewDS, obj);\n        if (Object.keys(resutJSON).length && this.uiIndices.hiddenItemIndices.indexOf(resutJSON.index) === -1) {\n            this.uiIndices.hiddenItemIndices.push(resutJSON.index);\n        }\n    };\n    Virtualization.prototype.removeItem = function (obj) {\n        var dataSource;\n        var curViewDS = this.listViewInstance.curViewDS;\n        var resutJSON = this.findDSAndIndexFromId(curViewDS, obj);\n        if (Object.keys(resutJSON).length) {\n            dataSource = resutJSON.data;\n            if (curViewDS[resutJSON.index - 1] &&\n                curViewDS[resutJSON.index - 1].isHeader &&\n                (curViewDS[resutJSON.index - 1])\n                    .items.length === 1) {\n                this.removeUiItem(resutJSON.index - 1);\n                this.removeUiItem(resutJSON.index - 1);\n            }\n            else {\n                this.removeUiItem(resutJSON.index);\n            }\n        }\n        var listDataSource = this.listViewInstance.dataSource instanceof DataManager\n            ? this.listViewInstance.localData : this.listViewInstance.dataSource;\n        var index = listDataSource.indexOf(dataSource);\n        if (index !== -1) {\n            listDataSource.splice(index, 1);\n            this.listViewInstance.setViewDataSource(listDataSource);\n        }\n        // recollect all the list item into collection\n        this.listViewInstance.liCollection =\n            this.listViewInstance.curUL.querySelectorAll('li');\n    };\n    // eslint-disable-next-line\n    Virtualization.prototype.setCheckboxLI = function (li, e) {\n        var index = Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll('li'), li) + this.uiFirstIndex;\n        this.activeIndex = Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll('li'), li) + this.uiFirstIndex;\n        if (li.classList.contains(classNames.selected)) {\n            if (this.uiIndices.activeIndices.indexOf(index) === -1) {\n                this.uiIndices.activeIndices.push(index);\n            }\n        }\n        else {\n            this.uiIndices.activeIndices.splice(this.uiIndices.activeIndices.indexOf(index), 1);\n        }\n    };\n    // eslint-disable-next-line\n    Virtualization.prototype.setSelectLI = function (li, e) {\n        this.activeIndex = Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll('li'), li) + this.uiFirstIndex;\n    };\n    Virtualization.prototype.checkedItem = function (checked) {\n        if (checked) {\n            this.uiIndices.activeIndices = [];\n            this.activeIndex = undefined;\n            var data = this.listViewInstance.curViewDS;\n            for (var index = 0; index < data.length; index++) {\n                if (!data[index].isHeader) {\n                    this.uiIndices.activeIndices.push(index);\n                }\n            }\n        }\n        else {\n            this.activeIndex = undefined;\n            this.uiIndices.activeIndices = [];\n        }\n    };\n    Virtualization.prototype.addUiItem = function (index) {\n        // virtually new add list item based on the scollbar position\n        // if the scroll bar is at the top, just pretend the new item has been added since no UI\n        // change is required for the item that has been added at last but when scroll bar is at the bottom\n        // just detach top and inject into bottom to mimic new item is added\n        var curViewDs = this.listViewInstance.curViewDS;\n        this.changeUiIndices(index, true);\n        if (this.activeIndex && this.activeIndex >= index) {\n            this.activeIndex++;\n        }\n        if (this.listViewInstance.showCheckBox &&\n            curViewDs[index][this.listViewInstance.fields.isChecked]) {\n            this.uiIndices.activeIndices.push(index);\n        }\n        if (!parseFloat(this.bottomElement.style.height) && !parseFloat(this.topElement.style.height)) {\n            this.bottomElement.style.height = parseFloat(this.bottomElement.style.height) + this.listItemHeight + 'px';\n        }\n        if (parseFloat(this.bottomElement.style.height)) {\n            var liItem = this.listViewInstance.curUL.lastElementChild.previousSibling;\n            var target = this.listViewInstance.getLiFromObjOrElement(curViewDs[index + 1]) ||\n                this.listViewInstance.getLiFromObjOrElement(curViewDs[index + 2]);\n            if (target) {\n                this.bottomElement.style.height = parseFloat(this.bottomElement.style.height) + this.listItemHeight + 'px';\n                this.updateUI(liItem, index, target);\n            }\n        }\n        else {\n            var liItem = this.listViewInstance.curUL.firstElementChild.nextSibling;\n            var target = void 0;\n            if ((Object.keys(this.listViewInstance.curViewDS).length - 1) === index) {\n                target = this.listViewInstance.curUL.lastElementChild;\n            }\n            else {\n                target = this.listViewInstance.getLiFromObjOrElement(curViewDs[index + 1]) ||\n                    this.listViewInstance.getLiFromObjOrElement(curViewDs[index + 2]);\n            }\n            this.topElement.style.height = parseFloat(this.topElement.style.height) + this.listItemHeight + 'px';\n            this.uiFirstIndex++;\n            this.uiLastIndex++;\n            if (target) {\n                this.updateUI(liItem, index, target);\n                if (this.listViewInstance.isWindow === true) {\n                    window.scrollTo(0, (pageYOffset + this.listItemHeight));\n                }\n                else {\n                    this.listViewInstance.element.scrollTop += this.listItemHeight;\n                }\n            }\n        }\n        this.totalHeight += this.listItemHeight;\n        this.listDiff = Math.round(parseFloat(this.topElement.style.height) / this.listItemHeight);\n    };\n    Virtualization.prototype.removeUiItem = function (index) {\n        this.totalHeight -= this.listItemHeight;\n        var curViewDS = this.listViewInstance.curViewDS[index];\n        var liItem = this.listViewInstance.getLiFromObjOrElement(curViewDS);\n        this.listViewInstance.curViewDS.splice(index, 1);\n        if (this.activeIndex && this.activeIndex >= index) {\n            this.activeIndex--;\n        }\n        if (liItem) {\n            if (this.domItemCount > Object.keys(this.listViewInstance.curViewDS).length) {\n                detach(liItem);\n                this.domItemCount--;\n                this.uiLastIndex--;\n                this.totalHeight = 0;\n            }\n            else {\n                if (liItem.classList.contains(classNames.disable)) {\n                    liItem.classList.remove(classNames.disable);\n                    this.uiIndices.disabledItemIndices.splice(this.uiIndices.disabledItemIndices.indexOf(index), 1);\n                }\n                if (liItem.style.display === 'none') {\n                    liItem.style.display = '';\n                    this.uiIndices.hiddenItemIndices.splice(this.uiIndices.hiddenItemIndices.indexOf(index), 1);\n                }\n                if (this.listViewInstance.showCheckBox && liItem.classList.contains(classNames.selected)) {\n                    this.listViewInstance.removeSelect();\n                    this.uiIndices.activeIndices.splice(this.uiIndices.activeIndices.indexOf(index), 1);\n                    var checklistElement = liItem.querySelector('.' + classNames.checkboxWrapper);\n                    checklistElement.removeAttribute('aria-checked');\n                    checklistElement.firstElementChild.classList.remove(classNames.checked);\n                    if (liItem.classList.contains(classNames.focused)) {\n                        liItem.classList.remove(classNames.focused);\n                        this.activeIndex = undefined;\n                    }\n                }\n                else if (liItem.classList.contains(classNames.selected)) {\n                    this.listViewInstance.removeSelect();\n                    this.activeIndex = undefined;\n                }\n                if (!parseFloat(this.bottomElement.style.height) && !parseFloat(this.topElement.style.height)) {\n                    this.updateUI(liItem, this.uiLastIndex, this.bottomElement);\n                }\n                else if (parseFloat(this.bottomElement.style.height)) {\n                    this.bottomElement.style.height = parseFloat(this.bottomElement.style.height) - this.listItemHeight + 'px';\n                    this.updateUI(liItem, this.uiLastIndex, this.bottomElement);\n                }\n                else {\n                    this.topElement.style.height = parseFloat(this.topElement.style.height) - this.listItemHeight + 'px';\n                    this.updateUI(liItem, (this.uiFirstIndex - 1), this.topElement.nextSibling);\n                    this.uiLastIndex--;\n                    this.uiFirstIndex--;\n                }\n            }\n        }\n        this.changeUiIndices(index, false);\n        this.listDiff = Math.round(parseFloat(this.topElement.style.height) / this.listItemHeight);\n    };\n    Virtualization.prototype.changeUiIndices = function (index, increment) {\n        var keys = Object.keys(this.uiIndices);\n        for (var ind = 0; ind < keys.length; ind++) {\n            this.uiIndices[keys[ind]] = this.uiIndices[keys[ind]].map(function (i) {\n                if (i >= index) {\n                    return increment ? ++i : --i;\n                }\n                else {\n                    return i;\n                }\n            });\n        }\n    };\n    Virtualization.prototype.addItem = function (data, fields, dataSource, index) {\n        for (var i = 0; i < data.length; i++) {\n            var currentItem = data[i];\n            // push the given data to main data array\n            dataSource = this.listViewInstance.addItemAtIndex(index, dataSource, currentItem);\n            // recalculate all the group data or other datasource related things\n            this.listViewInstance.setViewDataSource(dataSource);\n            // render list items for first time due to no datasource present earlier\n            if (!this.domItemCount) {\n                // fresh rendering for first time\n                if ((this.listViewInstance.template || this.listViewInstance.groupTemplate) && !this.isNgTemplate()) {\n                    this.listViewInstance.listBaseOption.template = null;\n                    this.listViewInstance.listBaseOption.groupTemplate = null;\n                    this.listViewInstance.listBaseOption.itemCreated = this.createUIItem.bind(this);\n                }\n                this.uiVirtualization();\n                // when expected expected DOM count doesn't meet the condition we need to create and inject new item into DOM\n            }\n            else if (this.domItemCount < this.expectedDomItemCount) {\n                var ds = this.listViewInstance.findItemFromDS(dataSource, fields);\n                if (ds instanceof Array) {\n                    if (this.listViewInstance.ulElement) {\n                        var index_1 = this.listViewInstance.curViewDS.indexOf(currentItem);\n                        // inject new list item into DOM\n                        this.createAndInjectNewItem(currentItem, index_1);\n                        // check for group header item\n                        var curViewDS = this.listViewInstance.curViewDS[index_1 - 1];\n                        if (curViewDS && curViewDS.isHeader && curViewDS.items.length === 1) {\n                            // target group item index in datasource\n                            --index_1;\n                            // inject new group header into DOM for previously created list item\n                            this.createAndInjectNewItem(curViewDS, index_1);\n                        }\n                    }\n                    // recollect all the list item into collection\n                    this.listViewInstance.liCollection =\n                        this.listViewInstance.curUL.querySelectorAll('li');\n                }\n            }\n            else {\n                var index_2 = this.listViewInstance.curViewDS.indexOf(currentItem);\n                // virtually new add list item based on the scollbar position\n                this.addUiItem(index_2);\n                // check for group header item needs to be added\n                var curViewDS = this.listViewInstance.curViewDS[index_2 - 1];\n                if (curViewDS && curViewDS.isHeader && curViewDS.items.length === 1) {\n                    this.addUiItem(index_2 - 1);\n                }\n            }\n        }\n    };\n    Virtualization.prototype.createAndInjectNewItem = function (itemData, index) {\n        // generate li item for given datasource\n        var target;\n        var li = ListBase.createListItemFromJson(this.listViewInstance.createElement, [itemData], this.listViewInstance.listBaseOption, null, null, this.listViewInstance);\n        // check for target element whether to insert before last item or group item\n        if ((Object.keys(this.listViewInstance.curViewDS).length - 1) === index) {\n            target = this.listViewInstance.curUL.lastElementChild;\n        }\n        else {\n            // target group header's first child item to append its header\n            target = this.listViewInstance.getLiFromObjOrElement(this.listViewInstance.curViewDS[index + 1]) ||\n                this.listViewInstance.getLiFromObjOrElement(this.listViewInstance.curViewDS[index + 2]);\n        }\n        if (this.listViewInstance.fields.groupBy\n            && this.listViewInstance.curViewDS[index + 1]\n            && this.listViewInstance.curViewDS[index + 1].isHeader) {\n            var targetEle = this.listViewInstance.getLiFromObjOrElement(this.listViewInstance.curViewDS[index - 1]);\n            if (targetEle) {\n                target = targetEle.nextElementSibling;\n            }\n        }\n        // insert before the target element\n        this.listViewInstance.ulElement.insertBefore(li[0], target);\n        // increment internal DOM count, last index count for new element\n        this.domItemCount++;\n        if (this.bottomElementHeight <= 0) {\n            this.uiLastIndex++;\n        }\n        // recalculate the current item height, to avoid jumpy scroller\n        this.refreshItemHeight();\n    };\n    Virtualization.prototype.createUIItem = function (args) {\n        if (!args.item.classList.contains('e-list-group-item')) {\n            this.templateData = args.curData.isHeader ? args.curData.items[0] :\n                args.curData;\n            if (this.listViewInstance.showCheckBox) {\n                this.listViewInstance.renderCheckbox(args);\n                if ((!isNullOrUndefined(this.listViewInstance.virtualCheckBox)) &&\n                    (!isNullOrUndefined(this.listViewInstance.virtualCheckBox.outerHTML))) {\n                    var div_1 = document.createElement('div');\n                    var commonTemplate = '<div class=\"e-text-content\" role=\"presentation\"> ' +\n                        '<span class=\"e-list-text\"> ${' + this.listViewInstance.fields.text + '} </span></div>';\n                    var templateFunction = compile(this.listViewInstance.template || commonTemplate, this.listViewInstance);\n                    var nodes = templateFunction(this.templateData, this.listViewInstance);\n                    if (this.listViewInstance.template && this.listViewInstance.isReact) {\n                        this.listViewInstance.renderReactTemplates();\n                    }\n                    [].slice.call(nodes).forEach(function (ele) {\n                        div_1.appendChild(ele);\n                    });\n                    if (div_1.children && div_1.children[0]) {\n                        div_1.children[0].classList.add('e-checkbox');\n                        if (this.listViewInstance.checkBoxPosition === 'Left') {\n                            div_1.children[0].classList.add('e-checkbox-left');\n                        }\n                        else {\n                            div_1.children[0].classList.add('e-checkbox-right');\n                        }\n                        if (this.listViewInstance.checkBoxPosition === 'Left') {\n                            div_1.children[0].insertBefore(this.listViewInstance.virtualCheckBox, div_1.childNodes[0].children[0]);\n                        }\n                        else {\n                            div_1.children[0].appendChild(this.listViewInstance.virtualCheckBox);\n                        }\n                        while (args.item.lastChild) {\n                            args.item.removeChild(args.item.lastChild);\n                        }\n                        [].slice.call(div_1.children).forEach(function (ele) {\n                            args.item.appendChild(ele);\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Virtualization.prototype.reRenderUiVirtualization = function () {\n        this.wireScrollEvent(true);\n        if (this.listViewInstance.contentContainer) {\n            detach(this.listViewInstance.contentContainer);\n        }\n        this.listViewInstance.preRender();\n        // resetting the dom count to 0, to avoid edge case of dataSource suddenly becoming zero\n        // and then manually adding item using addItem API\n        this.domItemCount = 0;\n        this.listViewInstance.header();\n        this.listViewInstance.setLocalData();\n    };\n    Virtualization.prototype.updateUI = function (element, index, targetElement) {\n        var onChange = this.isNgTemplate() ? this.onNgChange : this.onChange;\n        if (this.listViewInstance.template || this.listViewInstance.groupTemplate) {\n            var curViewDS = this.listViewInstance.curViewDS[index];\n            element.dataset.uid = (curViewDS[this.listViewInstance.fields.id]) ?\n                (curViewDS[this.listViewInstance.fields.id]) : ListBase.generateId();\n            onChange(curViewDS, element, this);\n        }\n        else {\n            this.updateUiContent(element, index);\n        }\n        this.changeElementAttributes(element, index);\n        if (targetElement) {\n            this.listViewInstance.ulElement.insertBefore(element, targetElement);\n        }\n    };\n    /**\n     * Handles the UI change in vue for the list view.\n     *\n     * @param {DataSource} newData - The new data source for the list view.\n     * @param {ElementContext} listElement - The HTML element context for the list view.\n     * @param {Virtualization} virtualThis - The virtualization context for the list view.\n     * @returns {void}\n     */\n    Virtualization.prototype.onChange = function (newData, listElement, virtualThis) {\n        var liItem = ListBase.createListItemFromJson(virtualThis.listViewInstance.createElement, [newData], virtualThis.listViewInstance.listBaseOption, null, null, virtualThis.listViewInstance);\n        if (virtualThis.listViewInstance.isReact) {\n            virtualThis.listViewInstance.renderReactTemplates();\n        }\n        while (listElement.lastChild) {\n            listElement.removeChild(listElement.lastChild);\n        }\n        [].slice.call(liItem[0].children).forEach(function (ele) {\n            listElement.appendChild(ele);\n        });\n    };\n    Virtualization.prototype.onNgChange = function (newData, listElement, virtualThis) {\n        // compile given target element with template for new data\n        var templateCompiler = compile(virtualThis.listViewInstance.template);\n        var resultElement = templateCompiler(newData);\n        while (listElement.lastChild) {\n            listElement.removeChild(listElement.lastChild);\n        }\n        listElement.appendChild(resultElement[0]);\n    };\n    Virtualization.prototype.getModuleName = function () {\n        return 'virtualization';\n    };\n    Virtualization.prototype.destroy = function () {\n        this.wireScrollEvent(true);\n        this.topElement = null;\n        this.bottomElement = null;\n    };\n    return Virtualization;\n}());\nexport { Virtualization };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}