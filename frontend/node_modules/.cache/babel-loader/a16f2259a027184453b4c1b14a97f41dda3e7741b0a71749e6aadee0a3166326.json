{"ast":null,"code":"import { Browser, EventHandler, createElement } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, isUndefined, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { remove, closest, select } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { setCssInGridPopUp, getPosition, isGroupAdaptive, addRemoveActiveClasses, removeAddCboxClasses, getCellFromRow } from '../base/util';\nimport { getCellsByTableName, parentsUntil, getScrollBarWidth } from '../base/util';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { iterateExtend, setChecked, isComplexField, getObject } from '../base/util';\nimport { addRemoveEventListener } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * The `Selection` module is used to handle cell and row selection.\n */\nvar Selection = /** @class */function () {\n  /**\n   * Constructor for the Grid selection module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {SelectionSettings} selectionSettings - specifies the selectionsettings\n   * @param {ServiceLocator} locator - specifies the ServiceLocator\n   * @hidden\n   */\n  function Selection(parent, selectionSettings, locator) {\n    //Internal letiables\n    /**\n     * @hidden\n     */\n    this.selectedRowIndexes = [];\n    /**\n     * @hidden\n     */\n    this.selectedRowCellIndexes = [];\n    /**\n     * @hidden\n     */\n    this.selectedRecords = [];\n    /**\n     * @hidden\n     */\n    this.preventFocus = false;\n    /**\n     *  @hidden\n     */\n    this.selectedColumnsIndexes = [];\n    this.checkBoxState = false;\n    this.isMultiShiftRequest = false;\n    this.isMultiCtrlRequest = false;\n    this.isMultiCtrlRequestCell = false;\n    this.enableSelectMultiTouch = false;\n    this.clearRowCheck = false;\n    this.selectRowCheck = false;\n    /**\n     * @hidden\n     */\n    this.selectedRowState = {};\n    this.unSelectedRowState = {};\n    this.totalRecordsCount = 0;\n    this.chkAllCollec = [];\n    this.isCheckedOnAdd = false;\n    this.persistSelectedData = [];\n    this.virtualSelectedData = [];\n    this.deSelectedData = [];\n    this.isHdrSelectAllClicked = false;\n    this.needColumnSelection = false;\n    this.isCancelDeSelect = false;\n    this.isPreventCellSelect = false;\n    this.disableUI = false;\n    this.isPersisted = false;\n    this.cmdKeyPressed = false;\n    this.cellselected = false;\n    this.isMultiSelection = false;\n    this.isAddRowsToSelection = false;\n    this.initialRowSelection = false;\n    this.isPrevRowSelection = false;\n    this.isKeyAction = false;\n    this.isRowDragSelected = false;\n    this.isPartialSelection = false;\n    this.rmtHdrChkbxClicked = false;\n    this.isCheckboxReset = false;\n    this.isRowDeselect = false;\n    /**\n     * @hidden\n     */\n    this.autoFillRLselection = true;\n    this.isFocusLastCell = false;\n    this.bottom = '0 0 2px 0';\n    this.top = '2px 0 0 0';\n    /* eslint-disable */\n    this.right_bottom = '0 2px 2px 0';\n    this.bottom_left = '0 0 2px 2px';\n    this.top_right = '2px 2px 0 0';\n    this.top_left = '2px 0 0 2px';\n    this.top_bottom = '2px 0 2px 0';\n    this.top_right_bottom = '2px 2px 2px 0';\n    this.top_bottom_left = '2px 0 2px 2px';\n    this.top_right_left = '2px 2px 0 2px';\n    this.right_bottom_left = '0 2px 2px 2px';\n    this.all_border = '2px';\n    this.parent = parent;\n    this.selectionSettings = selectionSettings;\n    this.factory = locator.getService('rendererFactory');\n    this.focus = locator.getService('focus');\n    this.addEventListener();\n    this.wireEvents();\n  }\n  Selection.prototype.initializeSelection = function () {\n    this.parent.log('selection_key_missing');\n    this.render();\n  };\n  /**\n   * The function used to trigger onActionBegin\n   *\n   * @param {Object} args - specifies the args\n   * @param {string} type - specifies the type\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.onActionBegin = function (args, type) {\n    this.parent.trigger(type, this.fDataUpdate(args));\n  };\n  Selection.prototype.fDataUpdate = function (args) {\n    if (!this.isMultiSelection && (!isNullOrUndefined(args.cellIndex) || !isNullOrUndefined(args.rowIndex))) {\n      var rowObj = this.getRowObj(isNullOrUndefined(args.rowIndex) ? isNullOrUndefined(args.cellIndex) ? this.currentIndex : args.cellIndex.rowIndex : args.rowIndex);\n      args.foreignKeyData = rowObj.foreignKeyData;\n    }\n    return args;\n  };\n  /**\n   * The function used to trigger onActionComplete\n   *\n   * @param {Object} args - specifies the args\n   * @param {string} type - specifies the type\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.onActionComplete = function (args, type) {\n    this.parent.trigger(type, this.fDataUpdate(args));\n    this.isMultiSelection = false;\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} returns the module name\n   * @private\n   */\n  Selection.prototype.getModuleName = function () {\n    return 'selection';\n  };\n  /**\n   * To destroy the selection\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n    if (!gridElement || !gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent)) {\n      return;\n    }\n    this.hidePopUp();\n    this.clearSelection();\n    this.destroyAutoFillElements();\n    this.removeEventListener();\n    this.unWireEvents();\n    EventHandler.remove(this.parent.getContent(), 'mousedown', this.mouseDownHandler);\n    EventHandler.remove(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler);\n  };\n  Selection.prototype.isEditing = function () {\n    return (this.parent.editSettings.mode === 'Normal' || this.parent.editSettings.mode === 'Batch' && this.parent.editModule && this.parent.editModule.formObj && !this.parent.editModule.formObj.validate()) && this.parent.isEdit && !this.parent.editSettings.showAddNewRow && !this.parent.isPersistSelection;\n  };\n  Selection.prototype.getCurrentBatchRecordChanges = function () {\n    var gObj = this.parent;\n    if (gObj.editSettings.mode === 'Batch' && gObj.editModule) {\n      var currentRecords = iterateExtend(this.parent.getCurrentViewRecords());\n      currentRecords = gObj.editSettings.newRowPosition === 'Bottom' ? currentRecords.concat(this.parent.editModule.getBatchChanges()[literals.addedRecords]) : this.parent.editModule.getBatchChanges()[literals.addedRecords].concat(currentRecords);\n      var deletedRecords = this.parent.editModule.getBatchChanges()[literals.deletedRecords];\n      var primaryKey = this.parent.getPrimaryKeyFieldNames()[0];\n      for (var i = 0; i < deletedRecords.length; i++) {\n        for (var j = 0; j < currentRecords.length; j++) {\n          if (deletedRecords[parseInt(i.toString(), 10)][\"\" + primaryKey] === currentRecords[parseInt(j.toString(), 10)][\"\" + primaryKey]) {\n            currentRecords.splice(j, 1);\n            break;\n          }\n        }\n      }\n      return currentRecords;\n    } else if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length && !this.parent.isPersistSelection) {\n      var selectedGroupedData = gObj.getCurrentViewRecords().filter(function (col) {\n        return col['key'] === undefined;\n      });\n      return selectedGroupedData;\n    } else {\n      return gObj.getCurrentViewRecords();\n    }\n  };\n  /**\n   * Selects a row by the given index.\n   *\n   * @param  {number} index - Defines the row index.\n   * @param  {boolean} isToggle - If set to true, then it toggles the selection.\n   * @returns {void}\n   */\n  Selection.prototype.selectRow = function (index, isToggle) {\n    if (this.selectedRowIndexes.length && this.selectionSettings.enableSimpleMultiRowSelection) {\n      this.addRowsToSelection([index]);\n      return;\n    }\n    var gObj = this.parent;\n    var selectedRow = gObj.getRowByIndex(index);\n    var rowObj = selectedRow && gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid'));\n    if (this.isPartialSelection && rowObj && rowObj.isDataRow && !rowObj.isSelectable) {\n      return;\n    }\n    var selectData;\n    var isRemoved = false;\n    if (gObj.enableVirtualization && index > -1) {\n      var e = {\n        selectedIndex: index,\n        isAvailable: true\n      };\n      this.parent.notify(events.selectVirtualRow, e);\n      if (selectedRow && gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid'))) {\n        selectData = gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid')).data;\n      } else {\n        if (e.isAvailable && !gObj.selectionSettings.persistSelection) {\n          var prevSelectedData = this.parent.getSelectedRecords();\n          if (prevSelectedData.length > 0) {\n            this.clearRowSelection();\n          }\n        }\n        return;\n      }\n    } else {\n      selectData = this.getRowObj(index).data;\n    }\n    if (!this.isRowType() || !selectedRow || this.isEditing()) {\n      // if (this.isEditing()) {\n      //     gObj.selectedRowIndex = index;\n      // }\n      return;\n    }\n    var isRowSelected = selectedRow.hasAttribute('aria-selected');\n    this.activeTarget();\n    if (!isToggle || !this.selectedRowIndexes.length) {\n      isToggle = false;\n    } else {\n      var isCheckboxModeResetOnRowClick = this.selectionSettings.checkboxMode === 'ResetOnRowClick';\n      var isSelectionTypeMultiple = !this.parent.isCheckBoxSelection && this.selectionSettings.type === 'Multiple';\n      if (!isCheckboxModeResetOnRowClick && !isSelectionTypeMultiple || this.selectedRowIndexes.length === 1 && (isCheckboxModeResetOnRowClick || isSelectionTypeMultiple)) {\n        isToggle = !(this.isKeyAction && this.parent.isCheckBoxSelection) ? this.selectedRowIndexes.indexOf(index) !== -1 : false;\n      } else {\n        isToggle = false;\n      }\n    }\n    this.isKeyAction = false;\n    var args;\n    var can = 'cancel';\n    if (!isToggle) {\n      args = {\n        data: selectData,\n        rowIndex: index,\n        isCtrlPressed: this.isMultiCtrlRequest,\n        isShiftPressed: this.isMultiShiftRequest,\n        row: selectedRow,\n        previousRow: gObj.getRowByIndex(this.prevRowIndex),\n        previousRowIndex: this.prevRowIndex,\n        target: this.actualTarget,\n        cancel: false,\n        isInteracted: this.isInteracted,\n        isHeaderCheckboxClicked: this.isHeaderCheckboxClicked\n      };\n      this.parent.trigger(events.rowSelecting, this.fDataUpdate(args), this.rowSelectingCallBack(args, isToggle, index, selectData, isRemoved, isRowSelected, can));\n    } else {\n      if (this.selectionSettings.checkboxMode !== 'ResetOnRowClick' && this.selectionSettings.persistSelection) {\n        this.rowDeselect(events.rowDeselecting, [rowObj.index], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], this.actualTarget);\n        if (this.isCancelDeSelect) {\n          return;\n        }\n        if (!this.parent.isCheckBoxSelection) {\n          this.selectedRowIndexes = [];\n          this.selectedRecords = [];\n          this.isRowSelected = false;\n          this.selectRowIndex(-1);\n        }\n        this.rowDeselect(events.rowDeselected, [rowObj.index], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], this.actualTarget, undefined, undefined, undefined);\n      }\n      this.rowSelectingCallBack(args, isToggle, index, selectData, isRemoved, isRowSelected, can)(args);\n    }\n  };\n  Selection.prototype.rowSelectingCallBack = function (args, isToggle, index, selectData, isRemoved, isRowSelected, can) {\n    var _this = this;\n    return function (args) {\n      if (!isNullOrUndefined(args) && args[\"\" + can] === true) {\n        _this.disableInteracted();\n        return;\n      }\n      _this.index = index;\n      _this.toggle = isToggle;\n      _this.data = selectData;\n      _this.removed = isRemoved;\n      if (isRowSelected && _this.selectionSettings.persistSelection && !(_this.selectionSettings.checkboxMode === 'ResetOnRowClick')) {\n        _this.clearSelectedRow(index);\n        _this.selectRowCallBack();\n      } else if (!isRowSelected && _this.selectionSettings.persistSelection && _this.parent.isCheckBoxSelection && _this.selectionSettings.checkboxMode !== 'ResetOnRowClick') {\n        _this.selectRowCallBack();\n      }\n      if (_this.selectionSettings.checkboxMode === 'ResetOnRowClick') {\n        _this.isCheckboxReset = true;\n        _this.clearSelection();\n      }\n      if (!_this.selectionSettings.persistSelection || _this.selectionSettings.checkboxMode === 'ResetOnRowClick' || !_this.parent.isCheckBoxSelection && _this.selectionSettings.persistSelection) {\n        _this.selectRowCheck = true;\n        _this.clearRow();\n      }\n    };\n  };\n  Selection.prototype.selectRowCallBack = function () {\n    var gObj = this.parent;\n    var args;\n    var index = this.index;\n    var isToggle = this.toggle;\n    var selectData = this.data;\n    var isRemoved = this.removed;\n    var selectedRow = gObj.getRowByIndex(index);\n    if (!isToggle && !isRemoved) {\n      if (this.selectedRowIndexes.indexOf(index) <= -1) {\n        this.updateRowSelection(selectedRow, index);\n      }\n      this.selectRowIndex(index);\n    }\n    if (!isToggle) {\n      args = {\n        data: selectData,\n        rowIndex: index,\n        row: selectedRow,\n        previousRow: gObj.getRowByIndex(this.prevRowIndex),\n        previousRowIndex: this.prevRowIndex,\n        target: this.actualTarget,\n        isInteracted: this.isInteracted,\n        isHeaderCheckBoxClicked: this.isHeaderCheckboxClicked,\n        rowIndexes: index\n      };\n      this.onActionComplete(args, events.rowSelected);\n    }\n    this.isInteracted = false;\n    this.updateRowProps(index);\n  };\n  /**\n   * Selects a range of rows from start and end row indexes.\n   *\n   * @param  {number} startIndex - Specifies the start row index.\n   * @param  {number} endIndex - Specifies the end row index.\n   * @returns {void}\n   */\n  Selection.prototype.selectRowsByRange = function (startIndex, endIndex) {\n    this.selectRows(this.getCollectionFromIndexes(startIndex, endIndex));\n    this.selectRowIndex(endIndex);\n  };\n  Selection.prototype.selectedDataUpdate = function (selectedData, foreignKeyData, selectedRows, rowIndexes, selectableRowIndex) {\n    for (var i = 0, len = rowIndexes.length; i < len; i++) {\n      var currentRow = this.parent.getDataRows()[rowIndexes[parseInt(i.toString(), 10)]];\n      if (this.parent.enableVirtualization) {\n        currentRow = this.parent.getRowByIndex(rowIndexes[parseInt(i.toString(), 10)]);\n      }\n      var rowObj = this.getRowObj(currentRow);\n      if (rowObj && rowObj.isDataRow && rowObj.isSelectable) {\n        selectedData.push(rowObj.data);\n        selectedRows.push(currentRow);\n        foreignKeyData.push(rowObj.foreignKeyData);\n      } else {\n        if (this.isPartialSelection && selectableRowIndex) {\n          selectableRowIndex.splice(selectableRowIndex.indexOf(rowIndexes[parseInt(i.toString(), 10)]), 1);\n        }\n      }\n    }\n  };\n  /**\n   * Selects a collection of rows by index.\n   *\n   * @param  {number[]} rowIndexes - Specifies an array of row indexes.\n   * @returns {void}\n   */\n  Selection.prototype.selectRows = function (rowIndexes) {\n    var _this = this;\n    var gObj = this.parent;\n    var selectableRowIndex = rowIndexes.slice();\n    var rowIndex = !this.isSingleSel() ? rowIndexes[0] : rowIndexes[rowIndexes.length - 1];\n    this.isMultiSelection = true;\n    var selectedRows = [];\n    var foreignKeyData = [];\n    var can = 'cancel';\n    var selectedData = [];\n    if (!this.isRowType() || this.isEditing()) {\n      return;\n    }\n    this.selectedDataUpdate(selectedData, foreignKeyData, selectedRows, rowIndexes, selectableRowIndex);\n    this.activeTarget();\n    var args = {\n      cancel: false,\n      rowIndexes: selectableRowIndex,\n      row: selectedRows,\n      rowIndex: rowIndex,\n      target: this.actualTarget,\n      prevRow: gObj.getRows()[this.prevRowIndex],\n      previousRowIndex: this.prevRowIndex,\n      isInteracted: this.isInteracted,\n      isCtrlPressed: this.isMultiCtrlRequest,\n      isShiftPressed: this.isMultiShiftRequest,\n      data: selectedData,\n      isHeaderCheckboxClicked: this.isHeaderCheckboxClicked,\n      foreignKeyData: foreignKeyData\n    };\n    this.parent.trigger(events.rowSelecting, this.fDataUpdate(args), function (args) {\n      if (!isNullOrUndefined(args) && args[\"\" + can] === true) {\n        _this.disableInteracted();\n        return;\n      }\n      if (!(_this.selectionSettings.persistSelection && gObj.allowRowDragAndDrop && _this.isDragged)) {\n        _this.clearRow();\n      }\n      _this.selectRowIndex(selectableRowIndex.slice(-1)[0]);\n      var selectRowFn = function (index, preventFocus) {\n        _this.updateRowSelection(gObj.getRowByIndex(index), index, preventFocus);\n        _this.updateRowProps(rowIndex);\n      };\n      if (!_this.isSingleSel()) {\n        for (var _i = 0, selectableRowIndex_1 = selectableRowIndex; _i < selectableRowIndex_1.length; _i++) {\n          var rowIdx = selectableRowIndex_1[_i];\n          selectRowFn(rowIdx, gObj.enableVirtualization ? true : false);\n        }\n      } else {\n        selectRowFn(rowIndex);\n      }\n      if (_this.checkVirtualCheckBox() && !_this.parent.isPersistSelection) {\n        if (selectableRowIndex.length === _this.totalRecordsCount) {\n          _this.virtualSelectedData = _this.virtualCheckBoxData().slice();\n          _this.selectedRowIndexes = Object.keys(_this.virtualSelectedData).map(function (key) {\n            return parseInt(key, 10);\n          });\n          _this.setCheckAllState();\n        } else {\n          var selectionData = selectableRowIndex.filter(function (index) {\n            return _this.selectedRowIndexes.indexOf(index) === -1;\n          });\n          if (selectionData.length > 0) {\n            var allData = _this.virtualCheckBoxData().slice();\n            for (var i = 0; i < selectionData.length; i++) {\n              var record = allData[selectionData[i]];\n              if (!isNullOrUndefined(record)) {\n                _this.virtualSelectedData.push(record);\n                _this.selectedRowIndexes.push(selectionData[i]);\n              }\n            }\n            _this.setCheckAllState();\n          }\n        }\n      }\n      args = {\n        rowIndexes: selectableRowIndex,\n        row: selectedRows,\n        rowIndex: rowIndex,\n        target: _this.actualTarget,\n        prevRow: gObj.getRows()[_this.prevRowIndex],\n        previousRowIndex: _this.prevRowIndex,\n        data: _this.getSelectedRecords(),\n        isInteracted: _this.isInteracted,\n        isHeaderCheckboxClicked: _this.isHeaderCheckboxClicked,\n        foreignKeyData: foreignKeyData\n      };\n      if (_this.isRowSelected) {\n        _this.onActionComplete(args, events.rowSelected);\n      }\n      _this.isInteracted = false;\n    });\n  };\n  /**\n   * Select rows with existing row selection by passing row indexes.\n   *\n   * @param {number} rowIndexes - Specifies the row indexes.\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.addRowsToSelection = function (rowIndexes) {\n    var gObj = this.parent;\n    var can = 'cancel';\n    var target = this.target;\n    this.isMultiSelection = true;\n    var selectedRows = [];\n    var foreignKeyData = [];\n    var selectedData = [];\n    var indexes = gObj.getSelectedRowIndexes().concat(rowIndexes);\n    var selectedRow = !this.isSingleSel() ? gObj.getRowByIndex(rowIndexes[0]) : gObj.getRowByIndex(rowIndexes[rowIndexes.length - 1]);\n    if ((!this.isRowType() || this.isEditing()) && !this.selectionSettings.checkboxOnly) {\n      return;\n    }\n    var args;\n    var checkboxColumn = this.parent.getColumns().filter(function (col) {\n      return col.type === 'checkbox';\n    });\n    if (this.isMultiCtrlRequest && !checkboxColumn.length) {\n      this.selectedDataUpdate(selectedData, foreignKeyData, selectedRows, indexes);\n    }\n    for (var _i = 0, rowIndexes_1 = rowIndexes; _i < rowIndexes_1.length; _i++) {\n      var rowIndex = rowIndexes_1[_i];\n      var rowObj = this.getRowObj(rowIndex);\n      var isUnSelected = this.selectedRowIndexes.indexOf(rowIndex) > -1;\n      if (this.isPartialSelection && rowObj && rowObj.isDataRow && !rowObj.isSelectable) {\n        continue;\n      }\n      this.selectRowIndex(rowIndex);\n      if (isUnSelected && ((checkboxColumn.length ? true : this.selectionSettings.enableToggle) || this.isMultiCtrlRequest)) {\n        this.isAddRowsToSelection = true;\n        this.rowDeselect(events.rowDeselecting, [rowIndex], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], target);\n        if (this.isCancelDeSelect) {\n          return;\n        }\n        if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n          this.virtualSelectedData.splice(this.virtualSelectedData.indexOf(rowObj.data), 1);\n        }\n        this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(rowIndex), 1);\n        this.selectedRecords.splice(this.selectedRecords.indexOf(selectedRow), 1);\n        this.selectRowIndex(this.selectedRowIndexes.length ? this.selectedRowIndexes[this.selectedRowIndexes.length - 1] : -1);\n        selectedRow.removeAttribute('aria-selected');\n        this.addRemoveClassesForRow(selectedRow, false, null, 'e-selectionbackground', 'e-active');\n        this.rowDeselect(events.rowDeselected, [rowIndex], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], target, undefined, undefined, undefined);\n        this.isInteracted = false;\n        this.isMultiSelection = false;\n        this.isAddRowsToSelection = false;\n        this.isHdrSelectAllClicked = false;\n      } else {\n        this.activeTarget();\n        args = {\n          cancel: false,\n          data: selectedData.length ? selectedData : rowObj.data,\n          rowIndex: rowIndex,\n          row: selectedRows.length ? selectedRows : selectedRow,\n          target: this.actualTarget,\n          prevRow: gObj.getRows()[this.prevRowIndex],\n          previousRowIndex: this.prevRowIndex,\n          isCtrlPressed: this.isMultiCtrlRequest,\n          isShiftPressed: this.isMultiShiftRequest,\n          foreignKeyData: foreignKeyData.length ? foreignKeyData : rowObj.foreignKeyData,\n          isInteracted: this.isInteracted,\n          isHeaderCheckboxClicked: this.isHeaderCheckboxClicked,\n          rowIndexes: indexes\n        };\n        this.parent.trigger(events.rowSelecting, this.fDataUpdate(args));\n        if (!isNullOrUndefined(args) && args[\"\" + can] === true) {\n          this.disableInteracted();\n          return;\n        }\n        if (this.isSingleSel()) {\n          this.clearRow();\n        }\n        this.updateRowSelection(selectedRow, rowIndex);\n      }\n      if (!isUnSelected) {\n        args = {\n          data: selectedData.length ? selectedData : rowObj.data,\n          rowIndex: rowIndex,\n          row: selectedRows.length ? selectedRows : selectedRow,\n          target: this.actualTarget,\n          prevRow: gObj.getRows()[this.prevRowIndex],\n          previousRowIndex: this.prevRowIndex,\n          foreignKeyData: foreignKeyData.length ? foreignKeyData : rowObj.foreignKeyData,\n          isInteracted: this.isInteracted,\n          isHeaderCheckboxClicked: this.isHeaderCheckboxClicked,\n          rowIndexes: indexes\n        };\n        this.onActionComplete(args, events.rowSelected);\n      }\n      this.isInteracted = false;\n      this.updateRowProps(rowIndex);\n      if (this.isSingleSel()) {\n        break;\n      }\n    }\n  };\n  Selection.prototype.getCollectionFromIndexes = function (startIndex, endIndex) {\n    var indexes = [];\n    // eslint-disable-next-line prefer-const\n    var _a = startIndex <= endIndex ? {\n        i: startIndex,\n        max: endIndex\n      } : {\n        i: endIndex,\n        max: startIndex\n      },\n      i = _a.i,\n      max = _a.max;\n    for (; i <= max; i++) {\n      indexes.push(i);\n    }\n    if (startIndex > endIndex) {\n      indexes.reverse();\n    }\n    return indexes;\n  };\n  Selection.prototype.clearRow = function () {\n    this.clearRowCheck = true;\n    this.clearRowSelection();\n  };\n  Selection.prototype.clearRowCallBack = function () {\n    if (this.isCancelDeSelect && this.parent.checkAllRows !== 'Check') {\n      return;\n    }\n    this.selectedRowIndexes = [];\n    this.selectedRecords = [];\n    this.selectRowIndex(-1);\n    if (this.isSingleSel() && this.parent.isPersistSelection) {\n      this.selectedRowState = {};\n    }\n  };\n  Selection.prototype.clearSelectedRow = function (index) {\n    if (this.toggle) {\n      var selectedEle = this.parent.getRowByIndex(index);\n      if (!this.disableUI) {\n        selectedEle.removeAttribute('aria-selected');\n        this.addRemoveClassesForRow(selectedEle, false, true, 'e-selectionbackground', 'e-active');\n      }\n      this.removed = true;\n      this.updatePersistCollection(selectedEle, false);\n      this.updateCheckBoxes(selectedEle);\n      this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(index), 1);\n      this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(index)), 1);\n    }\n  };\n  Selection.prototype.updateRowProps = function (startIndex) {\n    this.prevRowIndex = startIndex;\n    this.isRowSelected = this.selectedRowIndexes.length && true;\n  };\n  Selection.prototype.getPkValue = function (pkField, data) {\n    return pkField ? isComplexField(pkField) ? getObject(pkField, data) : data[\"\" + pkField] : data[\"\" + pkField];\n  };\n  Selection.prototype.updatePersistCollection = function (selectedRow, chkState) {\n    var _this = this;\n    if ((this.parent.isPersistSelection || this.parent.selectionSettings.persistSelection && this.parent.getPrimaryKeyFieldNames().length > 0) && !isNullOrUndefined(selectedRow)) {\n      if (!this.parent.isPersistSelection) {\n        this.ensureCheckboxFieldSelection();\n      }\n      var rowObj = this.getRowObj(selectedRow);\n      var pKey_1 = rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null;\n      if (pKey_1 === null) {\n        return;\n      }\n      rowObj.isSelected = chkState;\n      if (chkState && !this.isPartialSelection || this.isPartialSelection && rowObj.isSelectable && rowObj.isSelected) {\n        this.selectedRowState[\"\" + pKey_1] = chkState;\n        delete this.unSelectedRowState[\"\" + pKey_1];\n        if (!this.persistSelectedData.some(function (data) {\n          return _this.getPkValue(_this.primaryKey, data) === pKey_1;\n        })) {\n          this.persistSelectedData.push(rowObj.data);\n        }\n      } else {\n        this.updatePersistDelete(pKey_1);\n      }\n    }\n  };\n  Selection.prototype.updatePersistDelete = function (pKey, isPartialSelection) {\n    var _this = this;\n    delete this.selectedRowState[\"\" + pKey];\n    if (this.rmtHdrChkbxClicked) {\n      this.unSelectedRowState[\"\" + pKey] = true;\n    }\n    var index;\n    var isPresent = this.persistSelectedData.some(function (data, i) {\n      index = i;\n      return _this.getPkValue(_this.primaryKey, data) === pKey;\n    });\n    if (isPresent) {\n      this.persistSelectedData.splice(index, 1);\n      if (isPartialSelection) {\n        this.parent.partialSelectedRecords.splice(index, 1);\n      }\n    }\n  };\n  Selection.prototype.updateCheckBoxes = function (row, chkState, rowIndex) {\n    if (!isNullOrUndefined(row)) {\n      var chkBox = row.querySelector('.e-checkselect');\n      if (!isNullOrUndefined(chkBox)) {\n        removeAddCboxClasses(chkBox.nextElementSibling, chkState);\n        setChecked(chkBox, chkState);\n        if (isNullOrUndefined(this.checkedTarget) || !isNullOrUndefined(this.checkedTarget) && !this.checkedTarget.classList.contains('e-checkselectall')) {\n          this.setCheckAllState(rowIndex);\n        }\n      }\n    }\n  };\n  Selection.prototype.updateRowSelection = function (selectedRow, startIndex, preventFocus) {\n    if (!selectedRow) {\n      return;\n    }\n    if (this.selectedRowIndexes.indexOf(startIndex) === -1) {\n      if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n        this.virtualSelectedData.push(this.parent.getRowObjectFromUID(selectedRow.getAttribute('data-uid')).data);\n      }\n      this.selectedRowIndexes.push(startIndex);\n      this.selectedRecords.push(selectedRow);\n    }\n    selectedRow.setAttribute('aria-selected', 'true');\n    this.updatePersistCollection(selectedRow, true);\n    this.updateCheckBoxes(selectedRow, true);\n    this.addRemoveClassesForRow(selectedRow, true, null, 'e-selectionbackground', 'e-active');\n    if (!this.preventFocus || this.parent.isFocusFirstCell || this.isFocusLastCell) {\n      var target = this.focus.getPrevIndexes().cellIndex ? selectedRow.cells[this.focus.getPrevIndexes().cellIndex] : selectedRow.querySelector('.e-selectionbackground:not(.e-hide, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop)');\n      if (this.parent.contextMenuModule && this.mouseButton === 2) {\n        target = this.parent.contextMenuModule.cell;\n      }\n      if (this.parent.isFocusFirstCell || this.isFocusLastCell) {\n        this.parent.isFocusFirstCell = false;\n        var selector = this.isFocusLastCell ? 'last-child' : 'first-child';\n        target = selectedRow.querySelector('.e-selectionbackground.e-rowcell:not(.e-hide, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop, .e-gridchkbox):' + selector);\n        this.isFocusLastCell = false;\n      }\n      if (!target || preventFocus) {\n        return;\n      }\n      this.focus.onClick({\n        target: target\n      }, true, !(this.parent.contextMenuModule && this.mouseButton === 2));\n    }\n  };\n  /**\n   * Deselects the currently selected rows and cells.\n   *\n   * @returns {void}\n   */\n  Selection.prototype.clearSelection = function () {\n    this.checkSelectAllClicked = true;\n    if (this.selectionSettings.persistSelection && this.persistSelectedData.length) {\n      this.deSelectedData = iterateExtend(this.persistSelectedData);\n    }\n    if (!this.parent.isPersistSelection || this.parent.isPersistSelection && !this.parent.isEdit || !isNullOrUndefined(this.checkedTarget) && this.checkedTarget.classList.contains('e-checkselectall')) {\n      var span = this.parent.element.querySelector('.e-gridpopup').querySelector('span');\n      if (span.classList.contains('e-rowselect')) {\n        span.classList.remove('e-spanclicked');\n      }\n      if (this.parent.isPersistSelection) {\n        this.persistSelectedData = [];\n        this.selectedRowState = {};\n        this.parent.partialSelectedRecords = [];\n        this.parent.disableSelectedRecords = [];\n        var rowObjects = this.parent.getRowsObject();\n        for (var i = 0; i < rowObjects.length; i++) {\n          if (rowObjects[i].isDataRow) {\n            if (rowObjects[i].isSelectable) {\n              this.parent.partialSelectedRecords.push(rowObjects[i].data);\n            } else {\n              this.parent.disableSelectedRecords.push(rowObjects[i].data);\n            }\n          }\n        }\n      }\n      this.clearRowSelection();\n      this.clearCellSelection();\n      this.clearColumnSelection();\n      this.prevRowIndex = undefined;\n      this.prevCIdxs = undefined;\n      this.prevECIdxs = undefined;\n      this.enableSelectMultiTouch = false;\n      if (!(this.selectionSettings.checkboxMode === 'ResetOnRowClick' && this.target && parentsUntil(this.target, 'e-rowcell'))) {\n        this.isInteracted = false;\n      }\n      this.checkSelectAllClicked = false;\n      this.isHdrSelectAllClicked = false;\n    }\n  };\n  /**\n   * Deselects the currently selected rows.\n   *\n   * @returns {void}\n   */\n  Selection.prototype.clearRowSelection = function () {\n    var _this = this;\n    if (this.isRowSelected) {\n      var rows_1 = this.parent.getDataRows();\n      var data_1 = [];\n      var row_1 = [];\n      var rowIndex_1 = [];\n      var foreignKeyData_1 = [];\n      var target_1 = this.target;\n      this.isRowDeselect = true;\n      for (var i = 0, len = this.selectedRowIndexes.length; i < len; i++) {\n        var currentRow = void 0;\n        if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) {\n          currentRow = this.parent.getRowByIndex(this.selectedRowIndexes[parseInt(i.toString(), 10)]);\n        } else {\n          currentRow = this.parent.editSettings.mode === 'Batch' ? this.parent.getRows()[this.selectedRowIndexes[parseInt(i.toString(), 10)]] : this.parent.getDataRows()[this.selectedRowIndexes[parseInt(i.toString(), 10)]];\n        }\n        var rowObj = this.getRowObj(currentRow);\n        if (rowObj) {\n          data_1.push(rowObj.data);\n          row_1.push(currentRow);\n          rowIndex_1.push(this.selectedRowIndexes[parseInt(i.toString(), 10)]);\n          foreignKeyData_1.push(rowObj.foreignKeyData);\n        }\n      }\n      if (this.selectionSettings.persistSelection && this.selectionSettings.checkboxMode !== 'ResetOnRowClick') {\n        this.isRowClicked = this.checkSelectAllClicked ? true : false;\n      }\n      this.rowDeselect(events.rowDeselecting, rowIndex_1, data_1, row_1, foreignKeyData_1, target_1, null, function () {\n        if (_this.isCancelDeSelect && (_this.isRowClicked || _this.checkSelectAllClicked || _this.isInteracted && !_this.parent.isPersistSelection)) {\n          if (_this.parent.isPersistSelection) {\n            if (_this.getCheckAllStatus(_this.parent.element.querySelector('.e-checkselectall')) === 'Intermediate' || _this.parent.isPersistSelection) {\n              for (var i = 0; i < _this.selectedRecords.length; i++) {\n                _this.updatePersistCollection(_this.selectedRecords[parseInt(i.toString(), 10)], true);\n              }\n            } else {\n              _this.parent.checkAllRows = 'Check';\n              _this.updatePersistSelectedData(true);\n            }\n          }\n          if (_this.clearRowCheck) {\n            _this.clearRowCallBack();\n            _this.clearRowCheck = false;\n            if (_this.selectRowCheck) {\n              _this.selectRowCallBack();\n              _this.selectRowCheck = false;\n            }\n          }\n          return;\n        }\n        var element = [].slice.call(rows_1.filter(function (record) {\n          return record.hasAttribute('aria-selected');\n        }));\n        for (var j = 0; j < element.length; j++) {\n          if (!_this.disableUI) {\n            element[parseInt(j.toString(), 10)].removeAttribute('aria-selected');\n            _this.addRemoveClassesForRow(element[parseInt(j.toString(), 10)], false, true, 'e-selectionbackground', 'e-active');\n          }\n          // tslint:disable-next-line:align\n          if (!_this.isPrevRowSelection) {\n            _this.updatePersistCollection(element[parseInt(j.toString(), 10)], false);\n          }\n          _this.updateCheckBoxes(element[parseInt(j.toString(), 10)]);\n        }\n        if ((_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling && _this.parent.infiniteScrollSettings.enableCache) && _this.selectedRecords.length && !element.length && !_this.parent.selectionSettings.persistSelection && !_this.disableUI && !_this.parent.isCheckBoxSelection) {\n          _this.addRemoveClassesForRow(null, false, true);\n        }\n        _this.virtualSelectedData = [];\n        _this.selectedRowIndexes = [];\n        _this.selectedRecords = [];\n        _this.isRowSelected = false;\n        _this.selectRowIndex(-1);\n        _this.isPrevRowSelection = false;\n        _this.rowDeselect(events.rowDeselected, rowIndex_1, data_1, row_1, foreignKeyData_1, target_1, null, undefined, null);\n        if (_this.clearRowCheck) {\n          _this.clearRowCallBack();\n          _this.clearRowCheck = false;\n          if (_this.selectRowCheck) {\n            _this.selectRowCallBack();\n            _this.selectRowCheck = false;\n          }\n        }\n      }, null);\n      this.isRowDeselect = false;\n    } else {\n      if (this.clearRowCheck) {\n        this.clearRowCallBack();\n        this.clearRowCheck = false;\n        if (this.selectRowCheck) {\n          this.selectRowCallBack();\n          this.selectRowCheck = false;\n        }\n      }\n    }\n  };\n  Selection.prototype.rowDeselect = function (type, rowIndex, data, row,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  foreignKeyData, target, mRow, rowDeselectCallBack, frozenRightRow) {\n    var _this = this;\n    if (this.selectionSettings.persistSelection && (this.isRowClicked || !this.isRowDeselect || this.checkSelectAllClicked || this.focus['activeKey'] && this.focus.currentInfo.element.classList.contains('e-gridchkbox') && this.focus['activeKey'] === 'space') || !this.selectionSettings.persistSelection) {\n      var cancl_1 = 'cancel';\n      var isSingleDeSel = rowIndex.length === 1 && this.deSelectedData.length === 1;\n      var rowDeselectObj = {\n        rowIndex: rowIndex[0],\n        data: this.selectionSettings.persistSelection && this.parent.checkAllRows === 'Uncheck' && !isSingleDeSel && this.selectionSettings.checkboxMode !== 'ResetOnRowClick' ? this.deSelectedData : data,\n        foreignKeyData: foreignKeyData,\n        cancel: false,\n        isInteracted: this.isInteracted,\n        isHeaderCheckboxClicked: this.isHeaderCheckboxClicked\n      };\n      if (type === 'rowDeselected') {\n        delete rowDeselectObj.cancel;\n      }\n      var rowInString = 'row';\n      var target_2 = 'target';\n      var rowidx = 'rowIndex';\n      var rowidxex = 'rowIndexes';\n      var dataTxt = 'data';\n      var foreignKey = 'foreignKeyData';\n      rowDeselectObj[\"\" + rowInString] = row;\n      rowDeselectObj[\"\" + target_2] = this.actualTarget;\n      var isHeaderCheckBxClick = this.actualTarget && !isNullOrUndefined(closest(this.actualTarget, 'thead'));\n      if (isHeaderCheckBxClick || rowIndex.length > 1) {\n        rowDeselectObj[\"\" + rowidx] = rowIndex[0];\n        rowDeselectObj[\"\" + rowidxex] = rowIndex;\n      } else if (rowIndex.length === 1) {\n        rowDeselectObj[\"\" + dataTxt] = rowDeselectObj[\"\" + dataTxt][0];\n        rowDeselectObj[\"\" + rowInString] = rowDeselectObj[\"\" + rowInString][0];\n        rowDeselectObj[\"\" + foreignKey] = rowDeselectObj[\"\" + foreignKey][0];\n        if (this.isAddRowsToSelection) {\n          rowDeselectObj[\"\" + rowidxex] = rowIndex;\n        }\n      }\n      this.parent.trigger(type, rowDeselectObj, function (args) {\n        _this.isCancelDeSelect = args[\"\" + cancl_1];\n        if (!_this.isCancelDeSelect || !_this.isRowClicked && !_this.isInteracted && !_this.checkSelectAllClicked) {\n          _this.updatePersistCollection(row[0], false);\n          _this.updateCheckBoxes(row[0], undefined, rowIndex[0]);\n        }\n        if (rowDeselectCallBack !== undefined) {\n          rowDeselectCallBack();\n        }\n      });\n    } else if (this.selectionSettings.persistSelection && !this.isInteracted) {\n      if (rowDeselectCallBack !== undefined) {\n        rowDeselectCallBack();\n      }\n    }\n  };\n  Selection.prototype.getRowObj = function (row) {\n    if (row === void 0) {\n      row = this.currentIndex;\n    }\n    if (isNullOrUndefined(row)) {\n      return {};\n    }\n    if (typeof row === 'number') {\n      row = this.parent.getRowByIndex(row);\n    }\n    if (row) {\n      return this.parent.getRowObjectFromUID(row.getAttribute('data-uid')) || {};\n    }\n    return {};\n  };\n  /**\n   * Selects a cell by the given index.\n   *\n   * @param  {IIndex} cellIndex - Defines the row and column indexes.\n   * @param  {boolean} isToggle - If set to true, then it toggles the selection.\n   * @returns {void}\n   */\n  Selection.prototype.selectCell = function (cellIndex, isToggle) {\n    if (!this.isCellType() || this.isCellType() && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache)) {\n      return;\n    }\n    var gObj = this.parent;\n    var args;\n    var selectedCell = gObj.getCellFromIndex(cellIndex.rowIndex, this.getColIndex(cellIndex.rowIndex, cellIndex.cellIndex));\n    this.currentIndex = cellIndex.rowIndex;\n    var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n    if (!this.isCellType() || !selectedCell || this.isEditing()) {\n      return;\n    }\n    var isCellSelected = selectedCell.classList.contains('e-cellselectionbackground');\n    isToggle = !isToggle ? isToggle : !isUndefined(this.prevCIdxs) && cellIndex.rowIndex === this.prevCIdxs.rowIndex && cellIndex.cellIndex === this.prevCIdxs.cellIndex && isCellSelected;\n    if (!isToggle) {\n      args = {\n        data: selectedData,\n        cellIndex: cellIndex,\n        isCtrlPressed: this.isMultiCtrlRequest,\n        isShiftPressed: this.isMultiShiftRequest,\n        previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined,\n        cancel: false\n      };\n      var currentCell = 'currentCell';\n      args[\"\" + currentCell] = selectedCell;\n      var previousRowCellIndex = 'previousRowCellIndex';\n      args[\"\" + previousRowCellIndex] = this.prevECIdxs;\n      this.parent.trigger(events.cellSelecting, this.fDataUpdate(args), this.successCallBack(args, isToggle, cellIndex, selectedCell, selectedData));\n      this.cellselected = true;\n    } else {\n      this.successCallBack(args, isToggle, cellIndex, selectedCell, selectedData)(args);\n    }\n  };\n  Selection.prototype.successCallBack = function (cellSelectingArgs, isToggle, cellIndex, selectedCell, selectedData) {\n    var _this = this;\n    return function (cellSelectingArgs) {\n      var cncl = 'cancel';\n      var currentCell = 'currentCell';\n      if (!isNullOrUndefined(cellSelectingArgs) && cellSelectingArgs[\"\" + cncl] === true) {\n        return;\n      }\n      if (!isToggle) {\n        cellSelectingArgs[\"\" + currentCell] = cellSelectingArgs[\"\" + currentCell] ? cellSelectingArgs[\"\" + currentCell] : selectedCell;\n      }\n      _this.clearCell();\n      if (!isToggle) {\n        _this.updateCellSelection(selectedCell, cellIndex.rowIndex, cellIndex.cellIndex);\n      }\n      if (!isToggle) {\n        var args = {\n          data: selectedData,\n          cellIndex: cellIndex,\n          currentCell: selectedCell,\n          selectedRowCellIndex: _this.selectedRowCellIndexes,\n          previousRowCell: _this.prevECIdxs ? _this.getCellIndex(_this.prevECIdxs.rowIndex, _this.prevECIdxs.cellIndex) : undefined\n        };\n        var previousRowCellIndex = 'previousRowCellIndex';\n        args[\"\" + previousRowCellIndex] = _this.prevECIdxs;\n        _this.updateCellProps(cellIndex, cellIndex);\n        _this.onActionComplete(args, events.cellSelected);\n      }\n    };\n  };\n  Selection.prototype.getCellIndex = function (rIdx, cIdx) {\n    return this.parent.getCellFromIndex(rIdx, cIdx);\n  };\n  /**\n   * Selects a range of cells from start and end indexes.\n   *\n   * @param  {IIndex} startIndex - Specifies the row and column's start index.\n   * @param  {IIndex} endIndex - Specifies the row and column's end index.\n   * @returns {void}\n   */\n  Selection.prototype.selectCellsByRange = function (startIndex, endIndex) {\n    var _this = this;\n    if (!this.isCellType()) {\n      return;\n    }\n    var gObj = this.parent;\n    var selectedCell = this.parent.isSpan ? getCellFromRow(this.parent, startIndex.rowIndex, startIndex.cellIndex) : gObj.getCellFromIndex(startIndex.rowIndex, startIndex.cellIndex);\n    var min;\n    var max;\n    var stIndex = startIndex;\n    var edIndex = endIndex = endIndex ? endIndex : startIndex;\n    var cellIndexes;\n    this.currentIndex = startIndex.rowIndex;\n    var cncl = 'cancel';\n    var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n    if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n      return;\n    }\n    var args = {\n      data: selectedData,\n      cellIndex: startIndex,\n      currentCell: selectedCell,\n      isCtrlPressed: this.isMultiCtrlRequest,\n      isShiftPressed: this.isMultiShiftRequest,\n      previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n    };\n    var previousRowCellIndex = 'previousRowCellIndex';\n    args[\"\" + previousRowCellIndex] = this.prevECIdxs;\n    this.parent.trigger(events.cellSelecting, this.fDataUpdate(args), function (cellSelectingArgs) {\n      if (!isNullOrUndefined(cellSelectingArgs) && cellSelectingArgs[\"\" + cncl] === true) {\n        return;\n      }\n      _this.clearCell();\n      if (startIndex.rowIndex > endIndex.rowIndex) {\n        var temp = startIndex;\n        startIndex = endIndex;\n        endIndex = temp;\n      }\n      for (var i = startIndex.rowIndex; i <= endIndex.rowIndex; i++) {\n        if (_this.selectionSettings.cellSelectionMode.indexOf('Box') < 0) {\n          min = i === startIndex.rowIndex ? startIndex.cellIndex : 0;\n          max = i === endIndex.rowIndex ? endIndex.cellIndex : _this.getLastColIndex(i);\n        } else {\n          min = startIndex.cellIndex;\n          max = endIndex.cellIndex;\n        }\n        cellIndexes = [];\n        for (var j = min < max ? min : max, len = min > max ? min : max; j <= len; j++) {\n          selectedCell = _this.parent.isSpan ? getCellFromRow(gObj, i, j) : gObj.getCellFromIndex(i, j);\n          if (!selectedCell) {\n            continue;\n          }\n          cellIndexes.push(j);\n          _this.updateCellSelection(selectedCell);\n          _this.addAttribute(selectedCell);\n        }\n        _this.selectedRowCellIndexes.push({\n          rowIndex: i,\n          cellIndexes: cellIndexes\n        });\n      }\n      var cellSelectedArgs = {\n        data: selectedData,\n        cellIndex: edIndex,\n        currentCell: gObj.getCellFromIndex(edIndex.rowIndex, edIndex.cellIndex),\n        selectedRowCellIndex: _this.selectedRowCellIndexes,\n        previousRowCell: _this.prevECIdxs ? _this.getCellIndex(_this.prevECIdxs.rowIndex, _this.prevECIdxs.cellIndex) : undefined\n      };\n      var previousRowCellIndex = 'previousRowCellIndex';\n      cellSelectedArgs[\"\" + previousRowCellIndex] = _this.prevECIdxs;\n      if (!_this.isDragged) {\n        _this.onActionComplete(cellSelectedArgs, events.cellSelected);\n        _this.cellselected = true;\n      }\n      _this.updateCellProps(stIndex, edIndex);\n    });\n  };\n  /**\n   * Selects a collection of cells by row and column indexes.\n   *\n   * @param  {ISelectedCell[]} rowCellIndexes - Specifies the row and column indexes.\n   * @returns {void}\n   */\n  Selection.prototype.selectCells = function (rowCellIndexes) {\n    if (!this.isCellType()) {\n      return;\n    }\n    var gObj = this.parent;\n    var selectedCell = gObj.getCellFromIndex(rowCellIndexes[0].rowIndex, rowCellIndexes[0].cellIndexes[0]);\n    this.currentIndex = rowCellIndexes[0].rowIndex;\n    var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n    if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n      return;\n    }\n    var cellSelectArgs = {\n      data: selectedData,\n      cellIndex: rowCellIndexes[0].cellIndexes[0],\n      currentCell: selectedCell,\n      isCtrlPressed: this.isMultiCtrlRequest,\n      isShiftPressed: this.isMultiShiftRequest,\n      previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n    };\n    var previousRowCellIndex = 'previousRowCellIndex';\n    cellSelectArgs[\"\" + previousRowCellIndex] = this.prevECIdxs;\n    this.onActionBegin(cellSelectArgs, events.cellSelecting);\n    for (var i = 0, len = rowCellIndexes.length; i < len; i++) {\n      for (var j = 0, cellLen = rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes.length; j < cellLen; j++) {\n        selectedCell = gObj.getCellFromIndex(rowCellIndexes[parseInt(i.toString(), 10)].rowIndex, rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)]);\n        if (!selectedCell) {\n          continue;\n        }\n        this.updateCellSelection(selectedCell);\n        this.addAttribute(selectedCell);\n        this.addRowCellIndex({\n          rowIndex: rowCellIndexes[parseInt(i.toString(), 10)].rowIndex,\n          cellIndex: rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)]\n        });\n      }\n    }\n    this.updateCellProps({\n      rowIndex: rowCellIndexes[0].rowIndex,\n      cellIndex: rowCellIndexes[0].cellIndexes[0]\n    }, {\n      rowIndex: rowCellIndexes[0].rowIndex,\n      cellIndex: rowCellIndexes[0].cellIndexes[0]\n    });\n    var cellSelectedArgs = {\n      data: selectedData,\n      cellIndex: rowCellIndexes[0].cellIndexes[0],\n      currentCell: selectedCell,\n      selectedRowCellIndex: this.selectedRowCellIndexes,\n      previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n    };\n    var prvRowCellIndex = 'previousRowCellIndex';\n    cellSelectedArgs[\"\" + prvRowCellIndex] = this.prevECIdxs;\n    this.onActionComplete(cellSelectedArgs, events.cellSelected);\n  };\n  /**\n   * Select cells with existing cell selection by passing row and column index.\n   *\n   * @param {IIndex} cellIndexes - Defines the collection of row and column index.\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.addCellsToSelection = function (cellIndexes) {\n    if (!this.isCellType() || this.isCellType() && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache)) {\n      return;\n    }\n    var gObj = this.parent;\n    var selectedCell;\n    var index;\n    this.currentIndex = cellIndexes[0].rowIndex;\n    var cncl = 'cancel';\n    var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n    if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n      return;\n    }\n    this.hideAutoFill();\n    var rowObj;\n    rowObj = gObj.getRowsObject()[cellIndexes[0].rowIndex];\n    if (gObj.groupSettings.columns.length > 0) {\n      rowObj = gObj.getRowObjectFromUID(this.target.parentElement.getAttribute('data-uid'));\n    }\n    var foreignKeyData = [];\n    for (var _i = 0, cellIndexes_1 = cellIndexes; _i < cellIndexes_1.length; _i++) {\n      var cellIndex = cellIndexes_1[_i];\n      for (var i = 0, len = this.selectedRowCellIndexes.length; i < len; i++) {\n        if (this.selectedRowCellIndexes[parseInt(i.toString(), 10)].rowIndex === cellIndex.rowIndex) {\n          index = i;\n          break;\n        }\n      }\n      selectedCell = gObj.getCellFromIndex(cellIndex.rowIndex, this.getColIndex(cellIndex.rowIndex, cellIndex.cellIndex));\n      var idx = cellIndex.cellIndex;\n      if (gObj.groupSettings.columns.length > 0) {\n        foreignKeyData.push(rowObj.cells[idx + gObj.groupSettings.columns.length].foreignKeyData);\n      } else {\n        foreignKeyData.push(rowObj.cells[parseInt(idx.toString(), 10)].foreignKeyData);\n      }\n      var args = {\n        cancel: false,\n        data: selectedData,\n        cellIndex: cellIndexes[0],\n        isShiftPressed: this.isMultiShiftRequest,\n        currentCell: selectedCell,\n        isCtrlPressed: this.isMultiCtrlRequest,\n        previousRowCell: this.prevECIdxs ? gObj.getCellFromIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n      };\n      var prvRowCellIndex = 'previousRowCellIndex';\n      args[\"\" + prvRowCellIndex] = this.prevECIdxs;\n      var isUnSelected = index > -1;\n      if (isUnSelected) {\n        var selectedCellIdx = this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes;\n        if (selectedCellIdx.indexOf(cellIndex.cellIndex) > -1 || this.selectionSettings.mode === 'Both' && selectedCell.classList.contains('e-gridchkbox') && !selectedCell.getAttribute('aria-selected')) {\n          this.cellDeselect(events.cellDeselecting, [{\n            rowIndex: cellIndex.rowIndex,\n            cellIndexes: [cellIndex.cellIndex]\n          }], selectedData, [selectedCell], foreignKeyData);\n          selectedCellIdx.splice(selectedCellIdx.indexOf(cellIndex.cellIndex), 1);\n          if (selectedCellIdx.length === 0) {\n            this.selectedRowCellIndexes.splice(index, 1);\n          }\n          selectedCell.classList.remove('e-cellselectionbackground');\n          selectedCell.removeAttribute('aria-selected');\n          this.cellDeselect(events.cellDeselected, [{\n            rowIndex: cellIndex.rowIndex,\n            cellIndexes: [cellIndex.cellIndex]\n          }], selectedData, [selectedCell], foreignKeyData);\n        } else {\n          isUnSelected = false;\n          this.onActionBegin(args, events.cellSelecting);\n          this.addRowCellIndex({\n            rowIndex: cellIndex.rowIndex,\n            cellIndex: cellIndex.cellIndex\n          });\n          this.updateCellSelection(selectedCell);\n          this.addAttribute(selectedCell);\n        }\n      } else {\n        this.onActionBegin(args, events.cellSelecting);\n        if (!isNullOrUndefined(args) && args[\"\" + cncl] === true) {\n          return;\n        }\n        this.updateCellSelection(selectedCell, cellIndex.rowIndex, cellIndex.cellIndex);\n      }\n      if (!isUnSelected) {\n        var cellSelectedArgs = {\n          data: selectedData,\n          cellIndex: cellIndexes[0],\n          currentCell: selectedCell,\n          previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined,\n          selectedRowCellIndex: this.selectedRowCellIndexes\n        };\n        cellSelectedArgs[\"\" + prvRowCellIndex] = this.prevECIdxs;\n        this.onActionComplete(cellSelectedArgs, events.cellSelected);\n        this.cellselected = true;\n      }\n      this.updateCellProps(cellIndex, cellIndex);\n    }\n  };\n  Selection.prototype.getColIndex = function (rowIndex, index) {\n    var col = this.parent.getColumnByIndex(index);\n    var cells = getCellsByTableName(this.parent, col, rowIndex);\n    if (cells) {\n      for (var m = 0; m < cells.length; m++) {\n        var colIndex = parseInt(cells[parseInt(m.toString(), 10)].getAttribute(literals.ariaColIndex), 10) - 1;\n        if (colIndex === index) {\n          return m;\n        }\n      }\n    }\n    return -1;\n  };\n  Selection.prototype.getLastColIndex = function (rowIndex) {\n    var cells = this.parent.getDataRows()[parseInt(rowIndex.toString(), 10)].querySelectorAll('td.e-rowcell');\n    return parseInt(cells[cells.length - 1].getAttribute(literals.ariaColIndex), 10) - 1;\n  };\n  Selection.prototype.clearCell = function () {\n    this.clearCellSelection();\n  };\n  Selection.prototype.cellDeselect = function (type, cellIndexes, data, cells, foreignKeyData) {\n    var cancl = 'cancel';\n    if (cells && cells.length > 0) {\n      for (var _i = 0, cells_1 = cells; _i < cells_1.length; _i++) {\n        var cell = cells_1[_i];\n        if (cell && cell.classList.contains(literals.gridChkBox)) {\n          this.updateCheckBoxes(closest(cell, 'tr'));\n        }\n      }\n    }\n    var args = {\n      cells: cells,\n      data: data,\n      cellIndexes: cellIndexes,\n      foreignKeyData: foreignKeyData,\n      cancel: false\n    };\n    this.parent.trigger(type, args);\n    this.isPreventCellSelect = args[\"\" + cancl];\n  };\n  Selection.prototype.updateCellSelection = function (selectedCell, rowIndex, cellIndex) {\n    if (!isNullOrUndefined(rowIndex)) {\n      this.addRowCellIndex({\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      });\n    }\n    selectedCell.classList.add('e-cellselectionbackground');\n    if (selectedCell.classList.contains(literals.gridChkBox)) {\n      this.updateCheckBoxes(closest(selectedCell, 'tr'), true);\n    }\n    this.addAttribute(selectedCell);\n  };\n  Selection.prototype.addAttribute = function (cell) {\n    this.target = cell;\n    if (!isNullOrUndefined(cell)) {\n      cell.setAttribute('aria-selected', 'true');\n      if (!this.preventFocus) {\n        this.focus.onClick({\n          target: cell\n        }, true, true);\n      }\n    }\n  };\n  Selection.prototype.updateCellProps = function (startIndex, endIndex) {\n    this.prevCIdxs = startIndex;\n    this.prevECIdxs = endIndex;\n    this.isCellSelected = this.selectedRowCellIndexes.length && true;\n  };\n  Selection.prototype.addRowCellIndex = function (rowCellIndex) {\n    var isRowAvail;\n    var index;\n    for (var i = 0, len = this.selectedRowCellIndexes.length; i < len; i++) {\n      if (this.selectedRowCellIndexes[parseInt(i.toString(), 10)].rowIndex === rowCellIndex.rowIndex) {\n        isRowAvail = true;\n        index = i;\n        break;\n      }\n    }\n    if (isRowAvail) {\n      if (this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes.indexOf(rowCellIndex.cellIndex) < 0) {\n        this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes.push(rowCellIndex.cellIndex);\n      }\n    } else {\n      this.selectedRowCellIndexes.push({\n        rowIndex: rowCellIndex.rowIndex,\n        cellIndexes: [rowCellIndex.cellIndex]\n      });\n    }\n  };\n  /**\n   * Deselects the currently selected cells.\n   *\n   * @returns {void}\n   */\n  Selection.prototype.clearCellSelection = function () {\n    if (this.isCellSelected) {\n      var gObj = this.parent;\n      var selectedCells = this.getSelectedCellsElement();\n      var rowCell = this.selectedRowCellIndexes;\n      var data = [];\n      var cells = [];\n      var foreignKeyData = [];\n      var currentViewData = this.getCurrentBatchRecordChanges();\n      this.hideAutoFill();\n      for (var i = 0, len = rowCell.length; i < len; i++) {\n        data.push(currentViewData[rowCell[parseInt(i.toString(), 10)].rowIndex]);\n        var rowObj = this.getRowObj(rowCell[parseInt(i.toString(), 10)].rowIndex);\n        for (var j = 0, cLen = rowCell[parseInt(i.toString(), 10)].cellIndexes.length; j < cLen; j++) {\n          if (rowObj.cells) {\n            foreignKeyData.push(rowObj.cells[rowCell[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)]].foreignKeyData);\n          }\n          cells.push(gObj.getCellFromIndex(rowCell[parseInt(i.toString(), 10)].rowIndex, rowCell[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)]));\n        }\n      }\n      this.cellDeselect(events.cellDeselecting, rowCell, data, cells, foreignKeyData);\n      if (this.isPreventCellSelect === true) {\n        return;\n      }\n      for (var i = 0, len = selectedCells.length; i < len; i++) {\n        selectedCells[parseInt(i.toString(), 10)].classList.remove('e-cellselectionbackground');\n        selectedCells[parseInt(i.toString(), 10)].removeAttribute('aria-selected');\n      }\n      if (this.bdrElement) {\n        this.showHideBorders('none');\n      }\n      this.selectedRowCellIndexes = [];\n      this.isCellSelected = false;\n      if (!this.isDragged && this.cellselected) {\n        this.cellDeselect(events.cellDeselected, rowCell, data, cells, foreignKeyData);\n      }\n    }\n  };\n  Selection.prototype.getSelectedCellsElement = function () {\n    var gObj = this.parent;\n    var rows = gObj.getDataRows();\n    var cells = [];\n    for (var i = 0, len = rows.length; i < len; i++) {\n      cells = cells.concat([].slice.call(rows[parseInt(i.toString(), 10)].getElementsByClassName('e-cellselectionbackground')));\n    }\n    return cells;\n  };\n  Selection.prototype.mouseMoveHandler = function (e) {\n    e.preventDefault();\n    this.stopTimer();\n    var gBRect = this.parent.element.getBoundingClientRect();\n    var x1 = this.x;\n    var y1 = this.y;\n    var position = getPosition(e);\n    var x2 = position.x - gBRect.left;\n    var y2 = position.y - gBRect.top;\n    var tmp;\n    var target = closest(e.target, 'tr');\n    this.isDragged = true;\n    if (!this.isCellDrag) {\n      if (!target) {\n        target = closest(document.elementFromPoint(this.parent.element.offsetLeft + 2, e.clientY), 'tr');\n      }\n      if (x1 > x2) {\n        tmp = x2;\n        x2 = x1;\n        x1 = tmp;\n      }\n      if (y1 > y2) {\n        tmp = y2;\n        y2 = y1;\n        y1 = tmp;\n      }\n      this.element.style.left = x1 + 'px';\n      this.element.style.top = y1 + 'px';\n      this.element.style.width = x2 - x1 + 'px';\n      this.element.style.height = y2 - y1 + 'px';\n    }\n    if (target && !e.ctrlKey && !e.shiftKey) {\n      var rowIndex = parseInt(target.getAttribute(literals.ariaRowIndex), 10) - 1;\n      if (!this.isCellDrag) {\n        this.hideAutoFill();\n        this.selectRowsByRange(this.startDIndex, rowIndex);\n        this.isRowDragSelected = true;\n      } else {\n        var td = parentsUntil(e.target, literals.rowCell);\n        if (td) {\n          this.startAFCell = this.startCell;\n          this.endAFCell = parentsUntil(e.target, literals.rowCell);\n          if (rowIndex > -1) {\n            this.selectLikeExcel(e, rowIndex, parseInt(td.getAttribute(literals.ariaColIndex), 10) - 1);\n          }\n        }\n      }\n    }\n    if (!e.ctrlKey && !e.shiftKey && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling && !this.parent.enableColumnVirtualization && !this.parent.groupSettings.columns.length && this.isCellDrag) {\n      this.updateScrollPosition(e, position, this.parent.getContent());\n    }\n  };\n  Selection.prototype.updateScrollPosition = function (mouseEvent, position, scrollElement) {\n    var _this = this;\n    var clientRect = scrollElement.getBoundingClientRect();\n    if (clientRect.left >= position.x - 20 - (this.parent.enableRtl && this.parent.height !== 'auto' ? getScrollBarWidth() : 0)) {\n      this.timer1 = window.setInterval(function () {\n        _this.setScrollPosition(scrollElement.firstElementChild, _this.parent.enableRtl ? 'right' : 'left', mouseEvent);\n      }, 200);\n    } else if (clientRect.left + scrollElement.clientWidth - 20 - (!this.parent.enableRtl && this.parent.height !== 'auto' ? getScrollBarWidth() : 0) < position.x) {\n      this.timer1 = window.setInterval(function () {\n        _this.setScrollPosition(scrollElement.firstElementChild, _this.parent.enableRtl ? 'left' : 'right', mouseEvent);\n      }, 200);\n    }\n    if (clientRect.top >= position.y - this.parent.getRowHeight() * 0.5) {\n      this.timer2 = window.setInterval(function () {\n        _this.setScrollPosition(scrollElement.firstElementChild, 'up', mouseEvent);\n      }, 200);\n    } else if (clientRect.top + scrollElement.clientHeight - this.parent.getRowHeight() * 0.5 - (scrollElement.firstElementChild.scrollWidth > scrollElement.firstElementChild.offsetWidth ? getScrollBarWidth() : 0) <= position.y) {\n      this.timer2 = window.setInterval(function () {\n        _this.setScrollPosition(scrollElement.firstElementChild, 'down', mouseEvent);\n      }, 200);\n    }\n  };\n  Selection.prototype.stopTimer = function () {\n    if (this.timer1) {\n      window.clearInterval(this.timer1);\n      this.timer1 = null;\n    }\n    if (this.timer2) {\n      window.clearInterval(this.timer2);\n      this.timer2 = null;\n    }\n    this.preventFocus = false;\n  };\n  Selection.prototype.setScrollPosition = function (scrollElement, direction, mouseEvent) {\n    var rowIndex = -1;\n    var columnIndex = -1;\n    if (this.endAFCell || this.prevECIdxs) {\n      rowIndex = this.endAFCell ? parseInt(this.endAFCell.getAttribute('index'), 10) : this.prevECIdxs.rowIndex;\n      columnIndex = this.endAFCell ? parseInt(this.endAFCell.getAttribute('aria-colindex'), 10) - 1 : this.prevECIdxs.cellIndex;\n    }\n    switch (direction) {\n      case 'up':\n        if (mouseEvent && closest(mouseEvent.target, '.e-headercontent')) {\n          return;\n        }\n        if (this.isAutoFillSel && this.startAFCell && this.selectedRowCellIndexes.length && (this.selectedRowCellIndexes.length === 1 && this.startAFCell !== this.startCell || this.selectedRowCellIndexes.length > 1 && this.startAFCell.getBoundingClientRect().top > 0)) {\n          rowIndex = parseInt(this.startAFCell.getAttribute('index'), 10);\n        }\n        rowIndex -= 1;\n        if (this.parent.frozenRows) {\n          rowIndex += this.parent.frozenRows + 1;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n        rowIndex < 1 ? scrollElement.scrollTop = 0 : scrollElement.scrollTop -= this.parent.getRowByIndex(rowIndex).offsetHeight;\n        break;\n      case 'down':\n        if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n          rowIndex = parseInt(this.startAFCell.getAttribute('index'), 10);\n        }\n        if (rowIndex < this.parent.getRows().length - 1) {\n          rowIndex += 1;\n          if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n            this.startAFCell = this.parent.getCellFromIndex(rowIndex, this.selectedRowCellIndexes[0].cellIndexes[0]);\n          }\n          scrollElement.scrollTop += this.parent.getRowByIndex(rowIndex).offsetHeight;\n        } else {\n          scrollElement.scrollTop = scrollElement.scrollHeight;\n        }\n        break;\n      case 'left':\n        if (columnIndex > 0 && rowIndex > -1) {\n          if (this.isAutoFillSel && this.startAFCell && this.selectedRowCellIndexes.length && (this.selectedRowCellIndexes[0].cellIndexes.length > 0 && this.startAFCell !== this.startCell || this.selectedRowCellIndexes[0].cellIndexes.length > 1 && (!this.parent.enableRtl && this.startAFCell.getBoundingClientRect().left > 0 || this.parent.enableRtl && this.startAFCell.getBoundingClientRect().left < this.parent.element.offsetWidth))) {\n            columnIndex = parseInt(this.startAFCell.getAttribute('aria-colindex'), 10) - 1;\n          }\n          var nextElement_1 = this.findNextCell(scrollElement, direction, columnIndex, rowIndex);\n          columnIndex = nextElement_1 ? parseInt(nextElement_1.getAttribute('aria-colindex'), 10) - 1 : -1;\n          if (this.parent.enableRtl && nextElement_1) {\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            columnIndex < 1 ? scrollElement.scrollLeft = scrollElement.scrollWidth : scrollElement.scrollLeft += nextElement_1.offsetWidth;\n          } else if (nextElement_1) {\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            columnIndex < 1 ? scrollElement.scrollLeft = 0 : scrollElement.scrollLeft -= nextElement_1.offsetWidth;\n          }\n        }\n        break;\n      case 'right':\n        if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n          columnIndex = parseInt(this.startAFCell.getAttribute('aria-colindex'), 10) - 1;\n        }\n        // eslint-disable-next-line no-case-declarations\n        var currentElement = this.parent.getCellFromIndex(rowIndex, columnIndex);\n        // eslint-disable-next-line no-case-declarations\n        var nextElement = this.findNextCell(scrollElement, direction, columnIndex, rowIndex);\n        if (nextElement && this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n          this.startAFCell = this.parent.getCellFromIndex(this.selectedRowCellIndexes[0].rowIndex, parseInt(nextElement.getAttribute('aria-colindex'), 10) - 1);\n        }\n        columnIndex = nextElement ? parseInt(nextElement.getAttribute('aria-colindex'), 10) - 1 : -1;\n        if (this.parent.enableRtl && nextElement) {\n          // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n          columnIndex < this.parent.columns.length - 1 ? scrollElement.scrollLeft -= currentElement.offsetWidth : scrollElement.scrollLeft = -scrollElement.scrollWidth;\n        } else if (nextElement) {\n          // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n          columnIndex < this.parent.columns.length - 1 ? scrollElement.scrollLeft += currentElement.offsetWidth : scrollElement.scrollLeft = scrollElement.scrollWidth;\n        }\n        if (this.isAutoFillSel && (columnIndex === this.parent.columns.length - 1 || columnIndex === -1) && this.startAFCell && this.endAFCell) {\n          this.positionAFBorders();\n          scrollElement.scrollLeft = this.parent.enableRtl ? -scrollElement.scrollWidth : scrollElement.scrollWidth;\n        }\n        break;\n    }\n    if (rowIndex > -1 && rowIndex < this.parent.getRows().length && columnIndex > -1) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      var mouseEvent_1 = {\n        target: this.parent.getCellFromIndex(rowIndex, columnIndex)\n      };\n      if (this.isAutoFillSel && mouseEvent_1.target.classList.contains('e-cellselectionbackground') && (direction === 'down' && parseInt(mouseEvent_1.target.getAttribute('index'), 10) === this.parent.getRows().length - 1 || direction === 'right' && parseInt(mouseEvent_1.target.getAttribute('aria-colindex'), 10) - 1 === this.parent.columns.length - 1)) {\n        return;\n      }\n      this.endAFCell = mouseEvent_1.target;\n      this.preventFocus = true;\n      this.selectLikeExcel(mouseEvent_1, rowIndex, columnIndex);\n    }\n  };\n  Selection.prototype.findNextCell = function (scrollElement, direction, columnIndex, rowIndex) {\n    var nextElement = this.parent.getCellFromIndex(rowIndex, direction === 'left' ? columnIndex - 1 : columnIndex + 1);\n    if (nextElement && nextElement.classList.contains('e-hide')) {\n      var siblingEles = nextElement.closest('tr').querySelectorAll('.e-rowcell:not(.e-hide)');\n      var nextEleInd = Array.from(siblingEles).indexOf(nextElement.nextElementSibling);\n      if (nextEleInd > 0 && nextEleInd < siblingEles.length - 1) {\n        nextElement = siblingEles[nextEleInd + (direction === 'left' ? -1 : 1)];\n        return nextElement;\n      } else {\n        scrollElement.scrollLeft = 0;\n        return null;\n      }\n    }\n    return nextElement;\n  };\n  Selection.prototype.selectLikeExcel = function (e, rowIndex, cellIndex) {\n    if (!this.isAutoFillSel) {\n      this.clearCellSelection();\n      this.selectCellsByRange({\n        rowIndex: this.startDIndex,\n        cellIndex: this.startDCellIndex\n      }, {\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      });\n      this.drawBorders();\n    } else {\n      //Autofill\n      this.showAFBorders();\n      this.selectLikeAutoFill(e);\n    }\n  };\n  Selection.prototype.setFrozenBorders = function (parentEle, border, bdrStr) {\n    var width = border.style.borderWidth.toString().split(' ');\n    var strCell = ['', 'e-leftfreeze', 'e-unfreeze', 'e-leftfreeze', 'e-unfreeze', 'e-rightfreeze', 'e-rightfreeze'];\n    var cells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground' + '.' + strCell[\"\" + bdrStr])).filter(function (ele) {\n      return ele.style.display === '';\n    });\n    var fixedCells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground.e-fixedfreeze')).filter(function (ele) {\n      return ele.style.display === '';\n    });\n    var isRtl = this.parent.enableRtl;\n    if (cells.length) {\n      var firstRowIdx = cells[0].getAttribute('index');\n      var firstColIdx = cells[0].getAttribute('aria-colindex');\n      var lastRowIdx = cells[cells.length - 1].getAttribute('index');\n      var lastColIdx = cells[cells.length - 1].getAttribute('aria-colindex');\n      for (var i = 0; i < cells.length; i++) {\n        if (cells[parseInt(i.toString(), 10)].getAttribute('index') === firstRowIdx && (width.length === 1 || width.length === 3 && parseInt(width[0], 10) === 2 || width.length === 4 && parseInt(width[0], 10) === 2)) {\n          cells[parseInt(i.toString(), 10)].classList.add('e-xlsel-top-border');\n        }\n        if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === firstColIdx && (width.length === 1 || width.length === 3 && parseInt(width[1], 10) === 2 || width.length === 4 && (!isRtl && parseInt(width[3], 10) === 2 || isRtl && parseInt(width[1], 10) === 2))) {\n          cells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-right-border' : 'e-xlsel-left-border');\n        }\n        if (cells[parseInt(i.toString(), 10)].getAttribute('index') === lastRowIdx && (width.length === 1 || width.length === 3 && parseInt(width[2], 10) === 2 || width.length === 4 && parseInt(width[2], 10) === 2)) {\n          cells[parseInt(i.toString(), 10)].classList.add('e-xlsel-bottom-border');\n        }\n        if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === lastColIdx && (width.length === 1 || width.length === 3 && parseInt(width[1], 10) === 2 || width.length === 4 && !isRtl && parseInt(width[1], 10) === 2 || isRtl && parseInt(width[3], 10) === 2)) {\n          cells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-left-border' : 'e-xlsel-right-border');\n        }\n      }\n    }\n    if (fixedCells.length) {\n      var firstRowIdx = fixedCells[0].getAttribute('index');\n      var firstColIdx = (parseInt(fixedCells[0].getAttribute('aria-colindex'), 10) - 1).toString();\n      var lastRowIdx = fixedCells[fixedCells.length - 1].getAttribute('index');\n      var lastColIdx = (parseInt(fixedCells[fixedCells.length - 1].getAttribute('aria-colindex'), 10) - 1).toString();\n      for (var i = 0; i < fixedCells.length; i++) {\n        var idx = fixedCells[parseInt(i.toString(), 10)].getAttribute('index');\n        var colIdx = (parseInt(fixedCells[parseInt(i.toString(), 10)].getAttribute('aria-colindex'), 10) - 1).toString();\n        if (idx === firstRowIdx && (!this.parent.getHeaderContent().querySelector('.e-cellselectionbackground.e-fixedfreeze') && parentsUntil(parentEle, 'e-content') || !parentsUntil(parentEle, 'e-content'))) {\n          fixedCells[parseInt(i.toString(), 10)].classList.add('e-xlsel-top-border');\n        }\n        if (idx === lastRowIdx && (!this.parent.getContent().querySelector('.e-cellselectionbackground.e-fixedfreeze') && parentsUntil(parentEle, 'e-headercontent') || !parentsUntil(parentEle, 'e-headercontent'))) {\n          fixedCells[parseInt(i.toString(), 10)].classList.add('e-xlsel-bottom-border');\n        }\n        var preCell = fixedCells[parseInt(i.toString(), 10)].parentElement.children[parseInt(colIdx, 10) - 1];\n        if (colIdx === firstColIdx && (!preCell || preCell && !preCell.classList.contains('e-cellselectionbackground'))) {\n          fixedCells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-right-border' : 'e-xlsel-left-border');\n        }\n        var nextCell = fixedCells[parseInt(i.toString(), 10)].parentElement.children[parseInt(colIdx, 10) + 1];\n        if (colIdx === lastColIdx && (!nextCell || nextCell && !nextCell.classList.contains('e-cellselectionbackground'))) {\n          fixedCells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-left-border' : 'e-xlsel-right-border');\n        }\n      }\n    }\n  };\n  Selection.prototype.refreshFrozenBorders = function () {\n    if (this.bdrElement) {\n      this.setFrozenBorders(this.parent.getContentTable(), this.bdrElement, '1');\n      if (this.parent.isFrozenGrid() && this.parent.getFrozenMode() === literals.leftRight) {\n        this.setFrozenBorders(this.parent.getContentTable(), this.frcBdrElement, '5');\n      }\n      if (this.parent.frozenRows) {\n        this.setFrozenBorders(this.parent.getHeaderTable(), this.fhBdrElement, '3');\n        if (this.parent.isFrozenGrid() && this.parent.getFrozenMode() === literals.leftRight) {\n          this.setFrozenBorders(this.parent.getHeaderTable(), this.frhBdrElement, '6');\n        }\n      }\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.drawBorders = function () {\n    if (this.selectionSettings.cellSelectionMode === 'BoxWithBorder' && this.selectedRowCellIndexes.length && !this.parent.isEdit) {\n      this.parent.element.classList.add('e-enabledboxbdr');\n      if (!this.bdrElement) {\n        this.createBorders();\n      }\n      this.positionBorders();\n      if (this.parent.isFrozenGrid()) {\n        this.showHideBorders('none', true);\n        this.refreshFrozenBorders();\n      }\n    } else {\n      this.showHideBorders('none');\n    }\n  };\n  Selection.prototype.isLastCell = function (cell) {\n    var cells = [].slice.call(cell.parentElement.querySelectorAll('.e-rowcell:not(.e-hide)'));\n    return cells[cells.length - 1] === cell;\n  };\n  Selection.prototype.isLastRow = function (cell) {\n    var rows = [].slice.call(closest(cell, literals.tbody).querySelectorAll('.e-row:not(.e-hiddenrow)'));\n    return cell.parentElement === rows[rows.length - 1];\n  };\n  Selection.prototype.isFirstRow = function (cell) {\n    var rows = [].slice.call(closest(cell, literals.tbody).querySelectorAll('.e-row:not(.e-hiddenrow)'));\n    return cell.parentElement === rows[0];\n  };\n  Selection.prototype.isFirstCell = function (cell) {\n    var cells = [].slice.call(cell.parentElement.querySelectorAll('.e-rowcell:not(.e-hide)'));\n    return cells[0] === cell;\n  };\n  Selection.prototype.setBorders = function (parentEle, border, bdrStr) {\n    var cells = [].slice.call(parentEle.getElementsByClassName('e-cellselectionbackground')).filter(function (ele) {\n      return ele.style.display === '';\n    });\n    if (cells.length && this.parent.isFrozenGrid()) {\n      var strCell = ['', 'e-leftfreeze', 'e-unfreeze', 'e-leftfreeze', 'e-unfreeze', 'e-rightfreeze', 'e-rightfreeze'];\n      cells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground' + '.' + strCell[\"\" + bdrStr] + ':not(.e-hide)')).filter(function (ele) {\n        return ele.style.display === '';\n      });\n    }\n    if (cells.length) {\n      var isFrozen = this.parent.isFrozenGrid();\n      var start = cells[0];\n      var end = cells[cells.length - 1];\n      var stOff = start.getBoundingClientRect();\n      var endOff = end.getBoundingClientRect();\n      var parentOff = start.offsetParent.getBoundingClientRect();\n      if (start.offsetParent.classList.contains('e-content') || start.offsetParent.classList.contains('e-headercontent')) {\n        parentOff = start.offsetParent.querySelector('table').getBoundingClientRect();\n      }\n      var rowHeight = !isFrozen && this.isLastRow(end) && (bdrStr === '1' || bdrStr === '2' || bdrStr === '5') ? 2 : 0;\n      var topOffSet = 0;\n      var leftOffset = isFrozen && (bdrStr === '2' || bdrStr === '4') && this.isFirstCell(start) ? 1 : 0;\n      var rightOffset = (this.parent.getFrozenMode() === 'Right' && (bdrStr === '1' || bdrStr === '3') || this.parent.getFrozenMode() === literals.leftRight && (bdrStr === '5' || bdrStr === '6')) && this.isFirstCell(start) ? 1 : 0;\n      if (this.parent.enableRtl) {\n        border.style.right = parentOff.right - stOff.right - leftOffset + 'px';\n        border.style.width = stOff.right - endOff.left + leftOffset + 1 + 'px';\n      } else {\n        border.style.left = stOff.left - parentOff.left - leftOffset - rightOffset + 'px';\n        border.style.width = endOff.right - stOff.left + leftOffset - rightOffset + 1 + 'px';\n      }\n      border.style.top = stOff.top - parentOff.top - topOffSet + 'px';\n      border.style.height = endOff.top - stOff.top > 0 ? endOff.top - parentOff.top + endOff.height + (isFrozen ? 0 : 1) - (stOff.top - parentOff.top) - rowHeight + topOffSet + 'px' : endOff.height + topOffSet - rowHeight + (isFrozen ? 0 : 1) + 'px';\n      this.selectDirection += bdrStr;\n    } else {\n      border.style.display = 'none';\n    }\n  };\n  Selection.prototype.positionBorders = function () {\n    this.updateStartEndCells();\n    if (!this.startCell || !this.bdrElement || !this.selectedRowCellIndexes.length) {\n      return;\n    }\n    this.selectDirection = '';\n    this.showHideBorders('');\n    this.setBorders(this.parent.getContentTable(), this.bdrElement, '1');\n    if (this.parent.isFrozenGrid()) {\n      this.setBorders(this.parent.getContentTable(), this.mcBdrElement, '2');\n      if (this.parent.getFrozenMode() === literals.leftRight) {\n        this.setBorders(this.parent.getContentTable(), this.frcBdrElement, '5');\n      }\n    }\n    if (this.parent.frozenRows) {\n      this.setBorders(this.parent.getHeaderTable(), this.fhBdrElement, '3');\n      if (this.parent.isFrozenGrid()) {\n        this.setBorders(this.parent.getHeaderTable(), this.mhBdrElement, '4');\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n          this.setBorders(this.parent.getHeaderTable(), this.frhBdrElement, '6');\n        }\n      }\n    }\n    this.applyBorders(this.selectDirection);\n  };\n  /* eslint-enable */\n  Selection.prototype.applyBothFrozenBorders = function (str) {\n    var rtl = this.parent.enableRtl;\n    switch (str.length) {\n      case 6:\n        {\n          this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n          this.mcBdrElement.style.borderWidth = this.bottom;\n          this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n          this.mhBdrElement.style.borderWidth = this.top;\n          this.frcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n          this.frhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n        }\n        break;\n      case 4:\n        {\n          if (str.includes('1') && str.includes('2') && str.includes('3') && str.includes('4')) {\n            this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n            this.mhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n            this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n            this.mcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n          }\n          if (str.includes('2') && str.includes('4') && str.includes('5') && str.includes('6')) {\n            this.mcBdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n            this.mhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n            this.frcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n            this.frhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n          }\n        }\n        break;\n      case 3:\n        {\n          this.bdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n          this.mcBdrElement.style.borderWidth = this.top_bottom;\n          this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n          if (this.parent.frozenRows) {\n            this.fhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n            this.mhBdrElement.style.borderWidth = this.top_bottom;\n            this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n          }\n        }\n        break;\n      case 2:\n        {\n          if (str.includes('1')) {\n            this.mcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n            if (this.parent.frozenRows) {\n              this.fhBdrElement.style.borderWidth = this.top_right_left;\n            }\n          }\n          if (str.includes('2')) {\n            this.bdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n            this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n            if (this.parent.frozenRows) {\n              this.mhBdrElement.style.borderWidth = this.top_right_left;\n            }\n          }\n          if (str.includes('3')) {\n            this.mhBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n            this.bdrElement.style.borderWidth = this.right_bottom_left;\n          }\n          if (str.includes('4')) {\n            this.fhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n            this.frhBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n            this.mcBdrElement.style.borderWidth = this.right_bottom_left;\n          }\n          if (str.includes('5')) {\n            this.mcBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n            if (this.parent.frozenRows) {\n              this.frhBdrElement.style.borderWidth = this.top_right_left;\n            }\n          }\n          if (str.includes('6')) {\n            this.mhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n            this.frcBdrElement.style.borderWidth = this.right_bottom_left;\n          }\n        }\n        break;\n      default:\n        this.bdrElement.style.borderWidth = this.all_border;\n        this.mcBdrElement.style.borderWidth = this.all_border;\n        this.frcBdrElement.style.borderWidth = this.all_border;\n        if (this.parent.frozenRows) {\n          this.fhBdrElement.style.borderWidth = this.all_border;\n          this.mhBdrElement.style.borderWidth = this.all_border;\n          this.frhBdrElement.style.borderWidth = this.all_border;\n        }\n        break;\n    }\n  };\n  Selection.prototype.applyBorders = function (str) {\n    var rtl = this.parent.enableRtl;\n    if (this.parent.getFrozenMode() === literals.leftRight) {\n      this.applyBothFrozenBorders(str);\n    } else {\n      switch (str.length) {\n        case 4:\n          {\n            if (this.parent.getFrozenMode() === 'Right') {\n              this.bdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n              this.mcBdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n              this.fhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n              this.mhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n            } else {\n              this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n              this.mcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n              this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n              this.mhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n            }\n          }\n          break;\n        case 2:\n          {\n            if (this.parent.getFrozenMode() === 'Right') {\n              this.bdrElement.style.borderWidth = str.includes('2') ? rtl ? this.top_bottom_left : this.top_right_bottom : this.right_bottom_left;\n              this.mcBdrElement.style.borderWidth = str.includes('1') ? rtl ? this.top_right_bottom : this.top_bottom_left : this.right_bottom_left;\n              if (this.parent.frozenRows) {\n                this.fhBdrElement.style.borderWidth = str.includes('1') ? this.top_right_left : rtl ? this.top_bottom_left : this.top_right_bottom;\n                this.mhBdrElement.style.borderWidth = str.includes('2') ? this.top_right_left : rtl ? this.top_right_bottom : this.top_bottom_left;\n              }\n            } else {\n              this.bdrElement.style.borderWidth = str.includes('2') ? rtl ? this.top_right_bottom : this.top_bottom_left : this.right_bottom_left;\n              if (this.parent.isFrozenGrid()) {\n                this.mcBdrElement.style.borderWidth = str.includes('1') ? rtl ? this.top_bottom_left : this.top_right_bottom : this.right_bottom_left;\n              }\n              if (this.parent.frozenRows) {\n                this.fhBdrElement.style.borderWidth = str.includes('1') ? this.top_right_left : rtl ? this.top_right_bottom : this.top_bottom_left;\n                if (this.parent.isFrozenGrid()) {\n                  this.mhBdrElement.style.borderWidth = str.includes('2') ? this.top_right_left : rtl ? this.top_bottom_left : this.top_right_bottom;\n                }\n              }\n            }\n          }\n          break;\n        default:\n          this.bdrElement.style.borderWidth = this.all_border;\n          if (this.parent.isFrozenGrid()) {\n            this.mcBdrElement.style.borderWidth = this.all_border;\n          }\n          if (this.parent.frozenRows) {\n            this.fhBdrElement.style.borderWidth = this.all_border;\n            if (this.parent.isFrozenGrid()) {\n              this.mhBdrElement.style.borderWidth = this.all_border;\n            }\n          }\n          break;\n      }\n    }\n  };\n  Selection.prototype.createBorders = function () {\n    if (!this.bdrElement) {\n      var selectionBorder = createElement('div', {\n        className: 'e-xlsel',\n        id: this.parent.element.id + '_bdr'\n      });\n      selectionBorder.style.cssText = 'width: 2px; border-width: 0;';\n      this.bdrElement = this.parent.getContentTable().parentElement.appendChild(selectionBorder);\n      if (this.parent.isFrozenGrid()) {\n        var middleContentBorder = createElement('div', {\n          className: 'e-xlsel',\n          id: this.parent.element.id + '_mcbdr'\n        });\n        middleContentBorder.style.cssText = 'height: 2px; border-width: 0;';\n        this.mcBdrElement = this.parent.getContentTable().parentElement.appendChild(middleContentBorder);\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n          var frozenRightContentBorder = createElement('div', {\n            className: 'e-xlsel',\n            id: this.parent.element.id + '_frcbdr'\n          });\n          frozenRightContentBorder.style.cssText = 'height: 2px; border-width: 0;';\n          this.frcBdrElement = this.parent.getContentTable().parentElement.appendChild(frozenRightContentBorder);\n        }\n      }\n      if (this.parent.frozenRows) {\n        var frozenHeaderBorder = createElement('div', {\n          className: 'e-xlsel',\n          id: this.parent.element.id + '_fhbdr'\n        });\n        frozenHeaderBorder.style.height = '2px';\n        this.fhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(frozenHeaderBorder);\n      }\n      if (this.parent.frozenRows && this.parent.isFrozenGrid()) {\n        var middleHeaderBorder = createElement('div', {\n          className: 'e-xlsel',\n          id: this.parent.element.id + '_mhbdr'\n        });\n        middleHeaderBorder.style.height = '2px';\n        this.mhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(middleHeaderBorder);\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n          var frozenRightHeaderBorder = createElement('div', {\n            className: 'e-xlsel',\n            id: this.parent.element.id + '_frhbdr'\n          });\n          frozenRightHeaderBorder.style.height = '2px';\n          this.frhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(frozenRightHeaderBorder);\n        }\n      }\n    }\n  };\n  Selection.prototype.showHideBorders = function (display, freeze) {\n    if (this.bdrElement) {\n      this.bdrElement.style.display = display;\n      if (this.parent.isFrozenGrid()) {\n        var parentEle = this.parent.getContentTable();\n        removeClass(parentEle.querySelectorAll('.e-xlsel-top-border'), 'e-xlsel-top-border');\n        removeClass(parentEle.querySelectorAll('.e-xlsel-left-border'), 'e-xlsel-left-border');\n        removeClass(parentEle.querySelectorAll('.e-xlsel-right-border'), 'e-xlsel-right-border');\n        removeClass(parentEle.querySelectorAll('.e-xlsel-bottom-border'), 'e-xlsel-bottom-border');\n        if (!freeze) {\n          this.mcBdrElement.style.display = display;\n        }\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n          this.frcBdrElement.style.display = display;\n        }\n      }\n      if (this.parent.frozenRows) {\n        var parentEle = this.parent.getHeaderTable();\n        removeClass(parentEle.querySelectorAll('.e-xlsel-top-border'), 'e-xlsel-top-border');\n        removeClass(parentEle.querySelectorAll('.e-xlsel-left-border'), 'e-xlsel-left-border');\n        removeClass(parentEle.querySelectorAll('.e-xlsel-right-border'), 'e-xlsel-right-border');\n        removeClass(parentEle.querySelectorAll('.e-xlsel-bottom-border'), 'e-xlsel-bottom-border');\n        this.fhBdrElement.style.display = display;\n      }\n      if (this.parent.frozenRows && this.parent.isFrozenGrid()) {\n        if (!freeze) {\n          this.mhBdrElement.style.display = display;\n        }\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n          this.frhBdrElement.style.display = display;\n        }\n      }\n    }\n  };\n  Selection.prototype.drawAFBorders = function () {\n    if (!this.bdrAFBottom) {\n      this.createAFBorders();\n    }\n    this.positionAFBorders();\n  };\n  Selection.prototype.positionAFBorders = function () {\n    if (!this.startCell || !this.bdrAFLeft) {\n      return;\n    }\n    var stOff = this.startAFCell.getBoundingClientRect();\n    var endOff = this.endAFCell.getBoundingClientRect();\n    var top = endOff.top - stOff.top > 0 ? 1 : 0;\n    var firstCellTop = endOff.top - stOff.top >= 0 && (parentsUntil(this.startAFCell, literals.movableContent) || parentsUntil(this.startAFCell, 'e-frozencontent')) && this.isFirstRow(this.startAFCell) ? 1.5 : 0;\n    var firstCellLeft = (parentsUntil(this.startAFCell, literals.movableContent) || parentsUntil(this.startAFCell, literals.movableHeader)) && this.isFirstCell(this.startAFCell) ? 1 : 0;\n    var rowHeight = this.isLastRow(this.endAFCell) && (parentsUntil(this.endAFCell, literals.movableContent) || parentsUntil(this.endAFCell, 'e-frozencontent')) ? 2 : 0;\n    var parentOff = this.startAFCell.offsetParent.getBoundingClientRect();\n    var parentRect = this.parent.element.getBoundingClientRect();\n    var sTop = this.startAFCell.offsetParent.parentElement.scrollTop;\n    var sLeft = this.startAFCell.offsetParent.parentElement.scrollLeft;\n    var scrollTop = sTop - this.startAFCell.offsetTop;\n    var scrollLeft = sLeft - this.startAFCell.offsetLeft;\n    var totalHeight = this.parent.element.clientHeight - getScrollBarWidth();\n    if (this.parent.allowPaging) {\n      totalHeight -= this.parent.element.querySelector('.e-pager').offsetHeight;\n    }\n    if (this.parent.aggregates.length) {\n      totalHeight -= this.parent.getFooterContent().offsetHeight;\n    }\n    var totalWidth = this.parent.element.clientWidth - (this.parent.height !== 'auto' ? getScrollBarWidth() : 0);\n    scrollTop = scrollTop > 0 ? Math.floor(scrollTop) - 1 : 0;\n    scrollLeft = scrollLeft > 0 ? scrollLeft : 0;\n    var left = stOff.left - parentRect.left;\n    if (!this.parent.enableRtl) {\n      this.bdrAFLeft.style.left = left - firstCellLeft + scrollLeft - 1 + 'px';\n      this.bdrAFRight.style.left = endOff.left - parentRect.left - 2 + endOff.width + 'px';\n      this.bdrAFRight.style.width = totalWidth <= parseInt(this.bdrAFRight.style.left, 10) ? '0px' : '2px';\n      this.bdrAFTop.style.left = left + scrollLeft - 0.5 + 'px';\n      this.bdrAFTop.style.width = parseInt(this.bdrAFRight.style.left, 10) - parseInt(this.bdrAFLeft.style.left, 10) - firstCellLeft + 1 + 'px';\n      if (totalWidth <= parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10)) {\n        var leftRemove = parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10) - totalWidth;\n        this.bdrAFTop.style.width = parseInt(this.bdrAFTop.style.width, 10) - leftRemove + 'px';\n      }\n    } else {\n      var scrolloffSet = parentsUntil(this.startAFCell, literals.movableContent) || parentsUntil(this.startAFCell, literals.movableHeader) ? stOff.right - this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width - parentRect.left : 0;\n      this.bdrAFLeft.style.right = parentRect.right - endOff.right - 2 + endOff.width + 'px';\n      this.bdrAFLeft.style.width = totalWidth <= parseInt(this.bdrAFLeft.style.right, 10) ? '0px' : '2px';\n      var borderAFRightValue = parentRect.right - stOff.right - firstCellLeft + scrolloffSet - 1;\n      // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n      borderAFRightValue > 0 ? this.bdrAFRight.style.right = borderAFRightValue + 'px' : this.bdrAFRight.style.right = '0px';\n      this.bdrAFTop.style.left = endOff.left - parentRect.left - 0.5 + 'px';\n      this.bdrAFTop.style.width = parseInt(this.bdrAFLeft.style.right, 10) - parseInt(this.bdrAFRight.style.right, 10) - firstCellLeft + 1 + 'px';\n      if (parseInt(this.bdrAFTop.style.left, 10) < 0) {\n        this.bdrAFTop.style.width = parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10) + 'px';\n        if (this.parent.height !== 'auto' && getScrollBarWidth()) {\n          this.bdrAFTop.style.left = getScrollBarWidth() + 'px';\n          this.bdrAFTop.style.width = parseInt(this.bdrAFTop.style.width, 10) - getScrollBarWidth() + 'px';\n        } else {\n          this.bdrAFTop.style.left = '0px';\n        }\n      }\n    }\n    this.bdrAFLeft.style.top = stOff.top - parentRect.top - firstCellTop + scrollTop + 'px';\n    this.bdrAFLeft.style.height = endOff.top - stOff.top > 0 ? endOff.top - parentOff.top + endOff.height + 1 - (stOff.top - parentOff.top) + firstCellTop - rowHeight - scrollTop + 'px' : endOff.height + firstCellTop - rowHeight - scrollTop + 'px';\n    this.bdrAFRight.style.top = this.bdrAFLeft.style.top;\n    this.bdrAFRight.style.height = parseInt(this.bdrAFLeft.style.height, 10) + 'px';\n    this.bdrAFTop.style.top = this.bdrAFRight.style.top;\n    this.bdrAFBottom.style.left = this.bdrAFTop.style.left;\n    this.bdrAFBottom.style.top = parseFloat(this.bdrAFLeft.style.top) + parseFloat(this.bdrAFLeft.style.height) - top - 1 + 'px';\n    this.bdrAFBottom.style.width = totalHeight <= parseFloat(this.bdrAFBottom.style.top) ? '0px' : this.bdrAFTop.style.width;\n    if (totalHeight <= parseInt(this.bdrAFLeft.style.height, 10) + parseInt(this.bdrAFLeft.style.top, 10)) {\n      var topRemove = parseInt(this.bdrAFLeft.style.height, 10) + parseInt(this.bdrAFLeft.style.top, 10) - totalHeight;\n      this.bdrAFLeft.style.height = parseInt(this.bdrAFLeft.style.height, 10) - topRemove + 'px';\n      this.bdrAFRight.style.height = parseInt(this.bdrAFLeft.style.height, 10) + 'px';\n    }\n  };\n  Selection.prototype.createAFBorders = function () {\n    if (!this.bdrAFLeft) {\n      var leftSelectionBorder = createElement('div', {\n        className: 'e-xlselaf',\n        id: this.parent.element.id + '_bdrafleft'\n      });\n      leftSelectionBorder.style.width = '2px';\n      this.bdrAFLeft = this.parent.element.appendChild(leftSelectionBorder);\n      var rightSelectionBorder = createElement('div', {\n        className: 'e-xlselaf',\n        id: this.parent.element.id + '_bdrafright'\n      });\n      rightSelectionBorder.style.width = '2px';\n      this.bdrAFRight = this.parent.element.appendChild(rightSelectionBorder);\n      var bottomSelectionBorder = createElement('div', {\n        className: 'e-xlselaf',\n        id: this.parent.element.id + '_bdrafbottom'\n      });\n      bottomSelectionBorder.style.height = '2px';\n      this.bdrAFBottom = this.parent.element.appendChild(bottomSelectionBorder);\n      var topSelectionBorder = createElement('div', {\n        className: 'e-xlselaf',\n        id: this.parent.element.id + '_bdraftop'\n      });\n      topSelectionBorder.style.height = '2px';\n      this.bdrAFTop = this.parent.element.appendChild(topSelectionBorder);\n    }\n  };\n  Selection.prototype.destroyAutoFillElements = function () {\n    if (this.bdrAFLeft) {\n      this.bdrAFLeft.remove();\n      this.bdrAFRight.remove();\n      this.bdrAFBottom.remove();\n      this.bdrAFTop.remove();\n      this.bdrAFLeft = this.bdrAFRight = this.bdrAFBottom = this.bdrAFTop = null;\n    }\n    if (this.autofill) {\n      this.autofill.remove();\n      this.autofill = null;\n    }\n  };\n  Selection.prototype.showAFBorders = function () {\n    if (this.bdrAFLeft) {\n      this.bdrAFLeft.style.display = '';\n      this.bdrAFRight.style.display = '';\n      this.bdrAFBottom.style.display = '';\n      this.bdrAFTop.style.display = '';\n    }\n  };\n  Selection.prototype.hideAFBorders = function () {\n    if (this.bdrAFLeft) {\n      this.bdrAFLeft.style.display = 'none';\n      this.bdrAFRight.style.display = 'none';\n      this.bdrAFBottom.style.display = 'none';\n      this.bdrAFTop.style.display = 'none';\n    }\n  };\n  Selection.prototype.updateValue = function (rIdx, cIdx, cell) {\n    var args = this.createBeforeAutoFill(rIdx, cIdx, cell);\n    if (!args.cancel) {\n      var col = this.parent.getColumnByIndex(cIdx);\n      if (this.parent.editModule && cell) {\n        if (col.type === 'number') {\n          this.parent.editModule.updateCell(rIdx, col.field, parseFloat(args.value));\n        } else {\n          this.parent.editModule.updateCell(rIdx, col.field, args.value);\n        }\n      }\n    }\n  };\n  Selection.prototype.createBeforeAutoFill = function (rowIndex, colIndex, cell) {\n    var col = this.parent.getColumnByIndex(colIndex);\n    var args = {\n      column: col,\n      value: cell.innerText\n    };\n    this.parent.trigger(events.beforeAutoFill, args);\n    return args;\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  Selection.prototype.getAutoFillCells = function (rowIndex, startCellIdx) {\n    var cls = '.e-cellselectionbackground';\n    var cells = [].slice.call(this.parent.getDataRows()[parseInt(rowIndex.toString(), 10)].querySelectorAll(cls));\n    return cells;\n  };\n  Selection.prototype.selectLikeAutoFill = function (e, isApply) {\n    var startrowIdx = parseInt(parentsUntil(this.startAFCell, literals.row).getAttribute(literals.ariaRowIndex), 10) - 1;\n    var startCellIdx = parseInt(this.startAFCell.getAttribute(literals.ariaColIndex), 10) - 1;\n    var endrowIdx = parseInt(parentsUntil(this.endAFCell, literals.row).getAttribute(literals.ariaRowIndex), 10) - 1;\n    var endCellIdx = parseInt(this.endAFCell.getAttribute(literals.ariaColIndex), 10) - 1;\n    var rowLen = this.selectedRowCellIndexes.length - 1;\n    var colLen = this.selectedRowCellIndexes[0].cellIndexes.length - 1;\n    switch (true) {\n      //direction\n      case !isApply && this.endAFCell.classList.contains('e-cellselectionbackground') && !!parentsUntil(e.target, literals.rowCell):\n        this.startAFCell = this.parent.getCellFromIndex(startrowIdx, startCellIdx);\n        this.endAFCell = this.parent.getCellFromIndex(startrowIdx + rowLen, startCellIdx + colLen);\n        this.drawAFBorders();\n        break;\n      case this.autoFillRLselection && startCellIdx + colLen < endCellIdx &&\n      //right\n      endCellIdx - startCellIdx - colLen + 1 > endrowIdx - startrowIdx - rowLen // right bottom\n      && endCellIdx - startCellIdx - colLen + 1 > startrowIdx - endrowIdx:\n        //right top\n        this.endAFCell = this.parent.getCellFromIndex(startrowIdx + rowLen, endCellIdx);\n        endrowIdx = parseInt(parentsUntil(this.endAFCell, literals.row).getAttribute(literals.ariaRowIndex), 10) - 1;\n        endCellIdx = parseInt(this.endAFCell.getAttribute(literals.ariaColIndex), 10) - 1;\n        if (!isApply) {\n          this.drawAFBorders();\n        } else {\n          var cellIdx = parseInt(this.endCell.getAttribute(literals.ariaColIndex), 10) - 1;\n          for (var i = startrowIdx; i <= endrowIdx; i++) {\n            var cells = this.getAutoFillCells(i, startCellIdx);\n            var c = 0;\n            for (var j = cellIdx + 1; j <= endCellIdx; j++) {\n              if (c > colLen) {\n                c = 0;\n              }\n              this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n              c++;\n            }\n          }\n          this.selectCellsByRange({\n            rowIndex: startrowIdx,\n            cellIndex: this.startCellIndex\n          }, {\n            rowIndex: endrowIdx,\n            cellIndex: endCellIdx\n          });\n        }\n        break;\n      case this.autoFillRLselection && startCellIdx > endCellIdx &&\n      // left\n      startCellIdx - endCellIdx + 1 > endrowIdx - startrowIdx - rowLen &&\n      //left top\n      startCellIdx - endCellIdx + 1 > startrowIdx - endrowIdx:\n        // left bottom\n        this.startAFCell = this.parent.getCellFromIndex(startrowIdx, endCellIdx);\n        this.endAFCell = this.endCell;\n        if (!isApply) {\n          this.drawAFBorders();\n        } else {\n          for (var i = startrowIdx; i <= startrowIdx + rowLen; i++) {\n            var cells = this.getAutoFillCells(i, startCellIdx);\n            cells.reverse();\n            var c = 0;\n            for (var j = this.startCellIndex - 1; j >= endCellIdx; j--) {\n              if (c > colLen) {\n                c = 0;\n              }\n              this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n              c++;\n            }\n          }\n          this.selectCellsByRange({\n            rowIndex: startrowIdx,\n            cellIndex: endCellIdx\n          }, {\n            rowIndex: startrowIdx + rowLen,\n            cellIndex: this.startCellIndex + colLen\n          });\n        }\n        break;\n      case startrowIdx > endrowIdx:\n        //up\n        this.startAFCell = this.parent.getCellFromIndex(endrowIdx, startCellIdx);\n        this.endAFCell = this.endCell;\n        if (!isApply) {\n          this.drawAFBorders();\n        } else {\n          var trIdx = parseInt(this.endCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n          var r = trIdx;\n          for (var i = startrowIdx - 1; i >= endrowIdx; i--) {\n            if (r === this.startIndex - 1) {\n              r = trIdx;\n            }\n            var cells = this.getAutoFillCells(r, startCellIdx);\n            var c = 0;\n            r--;\n            for (var j = this.startCellIndex; j <= this.startCellIndex + colLen; j++) {\n              this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n              c++;\n            }\n          }\n          this.selectCellsByRange({\n            rowIndex: endrowIdx,\n            cellIndex: startCellIdx + colLen\n          }, {\n            rowIndex: startrowIdx + rowLen,\n            cellIndex: startCellIdx\n          });\n        }\n        break;\n      default:\n        //down\n        this.endAFCell = this.parent.getCellFromIndex(endrowIdx, startCellIdx + colLen);\n        if (!isApply) {\n          this.drawAFBorders();\n        } else {\n          var trIdx = parseInt(this.endCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n          var r = this.startIndex;\n          for (var i = trIdx + 1; i <= endrowIdx; i++) {\n            if (r === trIdx + 1) {\n              r = this.startIndex;\n            }\n            var cells = this.getAutoFillCells(r, startCellIdx);\n            r++;\n            var c = 0;\n            for (var m = this.startCellIndex; m <= this.startCellIndex + colLen; m++) {\n              this.updateValue(i, m, cells[parseInt(c.toString(), 10)]);\n              c++;\n            }\n          }\n          this.selectCellsByRange({\n            rowIndex: trIdx - rowLen,\n            cellIndex: startCellIdx\n          }, {\n            rowIndex: endrowIdx,\n            cellIndex: startCellIdx + colLen\n          });\n        }\n        break;\n    }\n  };\n  Selection.prototype.mouseUpHandler = function (e) {\n    this.stopTimer();\n    document.body.classList.remove('e-disableuserselect');\n    if (this.element && !isNullOrUndefined(this.element.parentElement)) {\n      remove(this.element);\n    }\n    if (this.isDragged && this.selectedRowCellIndexes.length === 1 && this.selectedRowCellIndexes[0].cellIndexes.length === 1) {\n      this.mUPTarget = parentsUntil(e.target, literals.rowCell);\n    } else {\n      this.mUPTarget = null;\n    }\n    var closeRowCell = closest(e.target, '.e-rowcell');\n    if (this.isDragged && !this.isAutoFillSel && this.selectionSettings.mode === 'Cell' && closeRowCell && closeRowCell.classList.contains(literals.rowCell)) {\n      var rowIndex = parseInt(closeRowCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n      var cellIndex = parseInt(closeRowCell.getAttribute(literals.ariaColIndex), 10) - 1;\n      this.isDragged = false;\n      this.clearCellSelection();\n      this.selectCellsByRange({\n        rowIndex: this.startDIndex,\n        cellIndex: this.startDCellIndex\n      }, {\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      });\n    }\n    this.isDragged = false;\n    this.updateAutoFillPosition();\n    if (this.isAutoFillSel) {\n      this.preventFocus = true;\n      var lastCell = parentsUntil(e.target, literals.rowCell);\n      this.endAFCell = lastCell ? lastCell : this.endCell === this.endAFCell ? this.startAFCell : this.endAFCell;\n      this.startAFCell = this.startCell;\n      if (!isNullOrUndefined(this.endAFCell) && !isNullOrUndefined(this.startAFCell)) {\n        this.updateStartCellsIndex();\n        this.selectLikeAutoFill(e, true);\n        this.updateAutoFillPosition();\n        this.hideAFBorders();\n        this.positionBorders();\n        if (this.parent.isFrozenGrid()) {\n          this.showHideBorders('none', true);\n          this.refreshFrozenBorders();\n        }\n        if (this.parent.aggregates.length > 0) {\n          this.parent.notify(events.refreshFooterRenderer, {});\n        }\n      }\n      this.isAutoFillSel = false;\n      this.preventFocus = false;\n    }\n    EventHandler.remove(this.parent.getContent(), 'mousemove', this.mouseMoveHandler);\n    if (this.parent.frozenRows) {\n      EventHandler.remove(this.parent.getHeaderContent(), 'mousemove', this.mouseMoveHandler);\n    }\n    EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n  };\n  Selection.prototype.hideAutoFill = function () {\n    if (this.autofill) {\n      this.autofill.style.display = 'none';\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.updateAutoFillPosition = function () {\n    if (this.parent.enableAutoFill && !this.parent.isEdit && this.selectionSettings.cellSelectionMode.indexOf('Box') > -1 && !this.isRowType() && !this.isSingleSel() && this.selectedRowCellIndexes.length) {\n      var index = parseInt(this.target.getAttribute(literals.ariaColIndex), 10) - 1;\n      var rindex = parseInt(this.target.getAttribute('index'), 10);\n      var rowIndex = this.selectedRowCellIndexes[this.selectedRowCellIndexes.length - 1].rowIndex;\n      var cells = this.getAutoFillCells(rowIndex, index).filter(function (ele) {\n        return ele.style.display === '';\n      });\n      var col = this.parent.getColumnByIndex(index);\n      var isFrozenCol = col.getFreezeTableName() === 'movable';\n      var isFrozenRow = rindex < this.parent.frozenRows;\n      var isFrozenRight = this.parent.getFrozenMode() === literals.leftRight && col.getFreezeTableName() === literals.frozenRight;\n      if (!select('#' + this.parent.element.id + '_autofill', parentsUntil(this.target, literals.table))) {\n        if (select('#' + this.parent.element.id + '_autofill', this.parent.element)) {\n          select('#' + this.parent.element.id + '_autofill', this.parent.element).remove();\n        }\n        this.autofill = createElement('div', {\n          className: 'e-autofill',\n          id: this.parent.element.id + '_autofill'\n        });\n        this.autofill.style.display = 'none';\n        if (this.target.classList.contains('e-leftfreeze') || this.target.classList.contains('e-rightfreeze') || this.target.classList.contains('e-fixedfreeze')) {\n          this.autofill.classList.add('e-freeze-autofill');\n        }\n        if (!isFrozenRow) {\n          if (!isFrozenCol) {\n            this.parent.getContentTable().parentElement.appendChild(this.autofill);\n          } else {\n            this.parent.getContentTable().parentElement.appendChild(this.autofill);\n          }\n        } else {\n          if (!isFrozenCol) {\n            this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n          } else {\n            this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n          }\n        }\n        if (isFrozenRight) {\n          if (isFrozenRow) {\n            this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n          } else {\n            this.parent.getContentTable().parentElement.appendChild(this.autofill);\n          }\n        }\n      }\n      var cell = cells[cells.length - 1];\n      if (cell && cell.offsetParent) {\n        var clientRect = cell.getBoundingClientRect();\n        var parentOff = cell.offsetParent.getBoundingClientRect();\n        if (cell.offsetParent.classList.contains('e-content') || cell.offsetParent.classList.contains('e-headercontent')) {\n          parentOff = cell.offsetParent.querySelector('table').getBoundingClientRect();\n        }\n        var colWidth = this.isLastCell(cell) ? 4 : 0;\n        var rowHeight = this.isLastRow(cell) ? 3 : 0;\n        if (!this.parent.enableRtl) {\n          this.autofill.style.left = clientRect.left - parentOff.left + clientRect.width - 4 - colWidth + 'px';\n        } else {\n          this.autofill.style.right = parentOff.right - clientRect.right + clientRect.width - 4 - colWidth + 'px';\n        }\n        this.autofill.style.top = clientRect.top - parentOff.top + clientRect.height - 5 - rowHeight + 'px';\n      }\n      this.autofill.style.display = '';\n    } else {\n      this.hideAutoFill();\n    }\n  };\n  Selection.prototype.mouseDownHandler = function (e) {\n    this.mouseButton = e.button;\n    var target = e.target;\n    var gObj = this.parent;\n    var isDrag;\n    var gridElement = parentsUntil(target, 'e-grid');\n    if (gridElement && gridElement.id !== gObj.element.id || parentsUntil(target, literals.headerContent) && !this.parent.frozenRows || parentsUntil(target, 'e-editedbatchcell') || parentsUntil(target, literals.editedRow)) {\n      return;\n    }\n    if (e.shiftKey || e.ctrlKey) {\n      e.preventDefault();\n    }\n    if (parentsUntil(target, literals.rowCell) && !e.shiftKey && !e.ctrlKey) {\n      if (gObj.selectionSettings.cellSelectionMode.indexOf('Box') > -1 && !this.isRowType() && !this.isSingleSel()) {\n        this.isCellDrag = true;\n        isDrag = true;\n      } else if (gObj.allowRowDragAndDrop && !gObj.isEdit && !this.parent.selectionSettings.checkboxOnly) {\n        this.isRowDragSelected = false;\n        if (!this.isRowType() || this.isSingleSel() || closest(target, 'td').classList.contains('e-selectionbackground')) {\n          this.isDragged = false;\n          return;\n        }\n        isDrag = true;\n        this.element = this.parent.createElement('div', {\n          className: 'e-griddragarea'\n        });\n        gObj.getContent().appendChild(this.element);\n      }\n      if (isDrag) {\n        this.enableDrag(e, true);\n      }\n    }\n    this.updateStartEndCells();\n    if (target.classList.contains('e-autofill') || target.classList.contains('e-xlsel')) {\n      this.isCellDrag = true;\n      this.isAutoFillSel = true;\n      this.enableDrag(e);\n    }\n  };\n  Selection.prototype.updateStartEndCells = function () {\n    var cells = [].slice.call(this.parent.element.getElementsByClassName('e-cellselectionbackground'));\n    this.startCell = cells[0];\n    this.endCell = cells[cells.length - 1];\n    if (this.startCell) {\n      this.startIndex = parseInt(this.startCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n      this.startCellIndex = parseInt(parentsUntil(this.startCell, literals.rowCell).getAttribute(literals.ariaColIndex), 10) - 1;\n    }\n  };\n  Selection.prototype.updateStartCellsIndex = function () {\n    if (this.startCell) {\n      this.startIndex = parseInt(this.startCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n      this.startCellIndex = parseInt(parentsUntil(this.startCell, literals.rowCell).getAttribute(literals.ariaColIndex), 10) - 1;\n    }\n  };\n  Selection.prototype.enableDrag = function (e, isUpdate) {\n    var gObj = this.parent;\n    if (isUpdate) {\n      var tr = closest(e.target, 'tr');\n      this.startDIndex = parseInt(tr.getAttribute(literals.ariaRowIndex), 10) - 1;\n      this.startDCellIndex = parseInt(parentsUntil(e.target, literals.rowCell).getAttribute(literals.ariaColIndex), 10) - 1;\n    }\n    document.body.classList.add('e-disableuserselect');\n    var gBRect = gObj.element.getBoundingClientRect();\n    var postion = getPosition(e);\n    this.x = postion.x - gBRect.left;\n    this.y = postion.y - gBRect.top;\n    EventHandler.add(gObj.getContent(), 'mousemove', this.mouseMoveHandler, this);\n    if (this.parent.frozenRows) {\n      EventHandler.add(gObj.getHeaderContent(), 'mousemove', this.mouseMoveHandler, this);\n    }\n    EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n  };\n  Selection.prototype.clearSelAfterRefresh = function (e) {\n    var isInfiniteScroll = this.parent.enableInfiniteScrolling && e.requestType === 'infiniteScroll';\n    if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection && !isInfiniteScroll) {\n      this.clearSelection();\n    }\n    if ((e.requestType === 'virtualscroll' || isInfiniteScroll) && this.parent.isPersistSelection && this.isPartialSelection && this.isHdrSelectAllClicked) {\n      var rowObj = this.parent.getRowsObject().filter(function (e) {\n        return e.isSelectable;\n      });\n      var indexes = [];\n      this.selectedRowState = {};\n      this.persistSelectedData = [];\n      for (var i = 0; i < rowObj.length; i++) {\n        indexes.push(rowObj[parseInt(i.toString(), 10)].index);\n        var pkValue = this.getPkValue(this.primaryKey, rowObj[parseInt(i.toString(), 10)].data);\n        this.selectedRowState[\"\" + pkValue] = true;\n        this.persistSelectedData.push(rowObj[parseInt(i.toString(), 10)].data);\n      }\n      this.selectedRowIndexes = indexes;\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.evtHandlers = [{\n      event: events.uiUpdate,\n      handler: this.enableAfterRender\n    }, {\n      event: events.initialEnd,\n      handler: this.initializeSelection\n    }, {\n      event: events.rowSelectionComplete,\n      handler: this.onActionComplete\n    }, {\n      event: events.cellSelectionComplete,\n      handler: this.onActionComplete\n    }, {\n      event: events.inBoundModelChanged,\n      handler: this.onPropertyChanged\n    }, {\n      event: events.cellFocused,\n      handler: this.onCellFocused\n    }, {\n      event: events.beforeFragAppend,\n      handler: this.clearSelAfterRefresh\n    }, {\n      event: events.columnPositionChanged,\n      handler: this.columnPositionChanged\n    }, {\n      event: events.contentReady,\n      handler: this.initialEnd\n    }, {\n      event: events.rowsRemoved,\n      handler: this.rowsRemoved\n    }, {\n      event: events.headerRefreshed,\n      handler: this.refreshHeader\n    }, {\n      event: events.destroyAutoFillElements,\n      handler: this.destroyAutoFillElements\n    }, {\n      event: events.destroy,\n      handler: this.destroy\n    }];\n    addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n    this.actionBeginFunction = this.actionBegin.bind(this);\n    this.actionCompleteFunction = this.actionComplete.bind(this);\n    this.parent.addEventListener(events.actionBegin, this.actionBeginFunction);\n    this.parent.addEventListener(events.actionComplete, this.actionCompleteFunction);\n    this.addEventListener_checkbox();\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n    EventHandler.remove(this.parent.getContent(), 'mousedown', this.mouseDownHandler);\n    EventHandler.remove(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler);\n    addRemoveEventListener(this.parent, this.evtHandlers, false);\n    this.parent.removeEventListener(events.actionBegin, this.actionBeginFunction);\n    this.parent.removeEventListener(events.actionComplete, this.actionCompleteFunction);\n    this.removeEventListener_checkbox();\n    this.parent.off(events.destroyAutoFillElements, this.destroyAutoFillElements);\n  };\n  Selection.prototype.wireEvents = function () {\n    this.isMacOS = navigator.userAgent.indexOf('Mac OS') !== -1;\n    if (this.isMacOS) {\n      EventHandler.add(this.parent.element, 'keydown', this.keyDownHandler, this);\n      EventHandler.add(this.parent.element, 'keyup', this.keyUpHandler, this);\n    } else {\n      if (!this.parent.allowKeyboard) {\n        EventHandler.add(this.parent.element, 'keydown', this.keyDownHandler, this);\n      }\n    }\n  };\n  Selection.prototype.unWireEvents = function () {\n    if (this.isMacOS) {\n      EventHandler.remove(this.parent.element, 'keydown', this.keyDownHandler);\n      EventHandler.remove(this.parent.element, 'keyup', this.keyUpHandler);\n    } else {\n      if (!this.parent.allowKeyboard) {\n        EventHandler.remove(this.parent.element, 'keydown', this.keyDownHandler);\n      }\n    }\n  };\n  Selection.prototype.columnPositionChanged = function () {\n    if (!this.parent.isPersistSelection) {\n      this.clearSelection();\n    }\n  };\n  Selection.prototype.refreshHeader = function () {\n    var checkboxColumn = this.parent.getColumns().filter(function (col) {\n      return col.type === 'checkbox';\n    });\n    if (checkboxColumn.length && !this.parent.getDataModule().isRemote()) {\n      this.gridCurrentRecord = this.getData();\n    }\n    this.setCheckAllState();\n  };\n  Selection.prototype.rowsRemoved = function (e) {\n    for (var i = 0; i < e.records.length; i++) {\n      var pkValue = this.getPkValue(this.primaryKey, e.records[parseInt(i.toString(), 10)]);\n      delete this.selectedRowState[\"\" + pkValue];\n      --this.totalRecordsCount;\n    }\n    this.setCheckAllState();\n  };\n  Selection.prototype.beforeFragAppend = function (e) {\n    if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection) {\n      this.clearSelection();\n    }\n  };\n  Selection.prototype.getCheckAllBox = function () {\n    return this.parent.getHeaderContent().querySelector('.e-checkselectall');\n  };\n  Selection.prototype.enableAfterRender = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.render();\n      this.initPerisistSelection();\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  Selection.prototype.render = function (e) {\n    EventHandler.add(this.parent.getContent(), 'mousedown', this.mouseDownHandler, this);\n    EventHandler.add(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler, this);\n  };\n  Selection.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n    var gObj = this.parent;\n    if (!isNullOrUndefined(e.properties.type)) {\n      if (this.selectionSettings.type === 'Single') {\n        gObj.element.removeAttribute('aria-multiselectable');\n        if (this.selectedRowCellIndexes.length > 1) {\n          this.clearCellSelection();\n          this.prevCIdxs = undefined;\n        }\n        if (this.selectedRowIndexes.length > 1) {\n          this.clearRowSelection();\n          this.prevRowIndex = undefined;\n        }\n        if (this.selectedColumnsIndexes.length > 1) {\n          this.clearColumnSelection();\n          this.prevColIndex = undefined;\n        }\n        this.enableSelectMultiTouch = false;\n        this.hidePopUp();\n      } else if (this.selectionSettings.type === 'Multiple') {\n        gObj.element.setAttribute('aria-multiselectable', 'true');\n      }\n    }\n    if (!isNullOrUndefined(e.properties.mode) || !isNullOrUndefined(e.properties.cellSelectionMode)) {\n      this.clearSelection();\n      this.prevRowIndex = undefined;\n      this.prevCIdxs = undefined;\n      this.prevColIndex = undefined;\n    }\n    this.isPersisted = true;\n    this.checkBoxSelectionChanged();\n    this.isPersisted = false;\n    if (!this.parent.isCheckBoxSelection) {\n      this.initPerisistSelection();\n    }\n    var checkboxColumn = this.parent.getColumns().filter(function (col) {\n      return col.type === 'checkbox';\n    });\n    if (checkboxColumn.length) {\n      gObj.isCheckBoxSelection = !(this.selectionSettings.checkboxMode === 'ResetOnRowClick');\n    }\n    this.drawBorders();\n  };\n  Selection.prototype.hidePopUp = function () {\n    if (this.parent.element.querySelector('.e-gridpopup').getElementsByClassName('e-rowselect').length) {\n      this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n    }\n  };\n  Selection.prototype.initialEnd = function () {\n    if (!this.selectedRowIndexes.length) {\n      this.parent.off(events.contentReady, this.initialEnd);\n      this.selectRow(this.parent.selectedRowIndex);\n    }\n  };\n  Selection.prototype.checkBoxSelectionChanged = function () {\n    var gobj = this.parent;\n    gobj.off(events.contentReady, this.checkBoxSelectionChanged);\n    var checkboxColumn = gobj.getColumns().filter(function (col) {\n      return col.type === 'checkbox';\n    });\n    if (checkboxColumn.length > 0) {\n      gobj.isCheckBoxSelection = true;\n      this.chkField = checkboxColumn[0].field;\n      this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n      if (isNullOrUndefined(this.totalRecordsCount)) {\n        this.totalRecordsCount = this.getCurrentBatchRecordChanges().length;\n      }\n      if (this.isSingleSel()) {\n        gobj.selectionSettings.type = 'Multiple';\n        gobj.dataBind();\n      } else {\n        this.initPerisistSelection();\n      }\n    }\n    if (!gobj.isCheckBoxSelection && !this.isPersisted) {\n      this.chkField = null;\n      this.initPerisistSelection();\n    }\n  };\n  Selection.prototype.initPerisistSelection = function () {\n    var gobj = this.parent;\n    if (this.parent.selectionSettings.persistSelection && this.parent.getPrimaryKeyFieldNames().length > 0) {\n      gobj.isPersistSelection = true;\n      this.ensureCheckboxFieldSelection();\n    } else if (this.parent.getPrimaryKeyFieldNames().length > 0) {\n      gobj.isPersistSelection = false;\n      this.ensureCheckboxFieldSelection();\n    } else {\n      gobj.isPersistSelection = false;\n      this.selectedRowState = {};\n    }\n  };\n  Selection.prototype.ensureCheckboxFieldSelection = function () {\n    var gobj = this.parent;\n    this.primaryKey = this.parent.getPrimaryKeyFieldNames()[0];\n    if (!gobj.enableVirtualization && this.chkField && (gobj.isPersistSelection && Object.keys(this.selectedRowState).length === 0 || !gobj.isPersistSelection)) {\n      this.dataSuccess(!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result || this.parent.getDataModule().isRemote() ? this.parent.getCurrentViewRecords() : this.parent.renderModule.data.dataManager.dataSource.json);\n    }\n  };\n  Selection.prototype.dataSuccess = function (res) {\n    for (var i = 0; i < res.length; i++) {\n      var pkValue = this.getPkValue(this.primaryKey, res[parseInt(i.toString(), 10)]);\n      var checkedFieldData = res[parseInt(i.toString(), 10)][this.chkField];\n      if (isNullOrUndefined(this.selectedRowState[\"\" + pkValue]) && checkedFieldData && typeof checkedFieldData === 'boolean') {\n        this.selectedRowState[\"\" + pkValue] = checkedFieldData;\n        if (this.parent.isPersistSelection) {\n          this.persistSelectedData.push(res[parseInt(i.toString(), 10)]);\n        }\n      }\n    }\n  };\n  Selection.prototype.setRowSelection = function (state) {\n    if (!(this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result)) {\n      if (state) {\n        if (this.isPartialSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n          var rowObj = this.parent.getRowsObject().filter(function (e) {\n            return e.isSelectable;\n          });\n          for (var _i = 0, rowObj_1 = rowObj; _i < rowObj_1.length; _i++) {\n            var row = rowObj_1[_i];\n            this.selectedRowState[this.getPkValue(this.primaryKey, row.data)] = true;\n          }\n        } else {\n          var selectedData = this.isPartialSelection ? this.parent.partialSelectedRecords : this.getData();\n          if (this.parent.groupSettings.columns.length) {\n            for (var _a = 0, _b = this.isPartialSelection ? selectedData : selectedData.records; _a < _b.length; _a++) {\n              var data = _b[_a];\n              this.selectedRowState[this.getPkValue(this.primaryKey, data)] = true;\n            }\n          } else {\n            for (var _c = 0, selectedData_1 = selectedData; _c < selectedData_1.length; _c++) {\n              var data = selectedData_1[_c];\n              this.selectedRowState[this.getPkValue(this.primaryKey, data)] = true;\n            }\n          }\n        }\n      } else {\n        this.selectedRowState = {};\n      }\n      // (this.getData()).forEach(function (data) {\n      //     this.selectedRowState[data[this.primaryKey]] = true;\n      // })\n    } else {\n      if (state) {\n        var selectedStateKeys = Object.keys(this.selectedRowState);\n        var unSelectedRowStateKeys = Object.keys(this.unSelectedRowState);\n        if (!this.isCheckboxReset) {\n          var rowData = this.parent.groupSettings.columns.length && this.parent.isPersistSelection ? this.parent.currentViewData['records'] : this.parent.currentViewData;\n          for (var _d = 0, rowData_1 = rowData; _d < rowData_1.length; _d++) {\n            var data = rowData_1[_d];\n            if (!isNullOrUndefined(data[this.primaryKey])) {\n              var key = data[this.primaryKey].toString();\n              if (selectedStateKeys.indexOf(key) === -1 && unSelectedRowStateKeys.indexOf(key) === -1) {\n                this.selectedRowState[data[this.primaryKey]] = true;\n              }\n            }\n          }\n        }\n      } else {\n        this.selectedRowState = {};\n        this.unSelectedRowState = {};\n        this.rmtHdrChkbxClicked = false;\n      }\n    }\n  };\n  Selection.prototype.getData = function () {\n    return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(true));\n  };\n  Selection.prototype.getAvailableSelectedData = function (data) {\n    var filteredSearchedSelectedData = new DataManager(data).executeLocal(this.parent.getDataModule().generateQuery(true));\n    if (this.parent.groupSettings.columns.length && filteredSearchedSelectedData && filteredSearchedSelectedData.records) {\n      filteredSearchedSelectedData = filteredSearchedSelectedData.records.slice();\n    }\n    return filteredSearchedSelectedData;\n  };\n  Selection.prototype.refreshPersistSelection = function () {\n    var rows = this.parent.getRows();\n    this.totalRecordsCount = this.parent.getCurrentViewRecords().length;\n    if (this.parent.allowPaging) {\n      this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n    }\n    if (!isNullOrUndefined(rows) && rows.length > 0 && (this.parent.isPersistSelection || this.chkField)) {\n      var indexes = [];\n      for (var j = 0; j < rows.length; j++) {\n        var rowObj = this.getRowObj(rows[parseInt(j.toString(), 10)]);\n        var pKey = rowObj ? rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null : null;\n        if (pKey === null) {\n          return;\n        }\n        if (this.isPartialSelection && !rowObj.isSelectable) {\n          continue;\n        }\n        var checkState = void 0;\n        var chkBox = rows[parseInt(j.toString(), 10)].querySelector('.e-checkselect');\n        if (this.selectedRowState[\"\" + pKey] || this.parent.checkAllRows === 'Check' && this.selectedRowState[\"\" + pKey] && this.totalRecordsCount === Object.keys(this.selectedRowState).length && this.chkAllCollec.indexOf(pKey) < 0 || this.parent.checkAllRows === 'Uncheck' && this.chkAllCollec.indexOf(pKey) > 0 && !this.parent.selectedRowIndex || this.parent.checkAllRows === 'Intermediate' && !isNullOrUndefined(this.chkField) && rowObj.data[this.chkField]) {\n          indexes.push(parseInt(rows[parseInt(j.toString(), 10)].getAttribute(literals.ariaRowIndex), 10) - 1);\n          checkState = true;\n        } else {\n          checkState = false;\n          if (this.checkedTarget !== chkBox && this.parent.isCheckBoxSelection && chkBox) {\n            removeAddCboxClasses(chkBox.nextElementSibling, checkState);\n          }\n        }\n        this.updatePersistCollection(rows[parseInt(j.toString(), 10)], checkState);\n      }\n      if (this.isSingleSel() && indexes.length > 0) {\n        this.selectRow(indexes[0], true);\n      } else {\n        this.selectRows(indexes);\n      }\n    }\n    if ((this.parent.isCheckBoxSelection || this.parent.selectionSettings.checkboxMode === 'ResetOnRowClick') && this.getCurrentBatchRecordChanges().length > 0) {\n      this.setCheckAllState();\n    }\n  };\n  Selection.prototype.actionBegin = function (e) {\n    if (e.requestType === 'save' && this.parent.isPersistSelection) {\n      var editChkBox = this.parent.element.querySelector('.e-edit-checkselect');\n      if (!isNullOrUndefined(editChkBox)) {\n        var row = closest(editChkBox, '.' + literals.editedRow);\n        if (row) {\n          if (this.parent.editSettings.mode === 'Dialog') {\n            row = this.parent.element.querySelector('.e-dlgeditrow');\n          }\n          var rowObj = this.getRowObj(row);\n          if (!rowObj) {\n            return;\n          }\n          this.selectedRowState[this.getPkValue(this.primaryKey, rowObj.data)] = rowObj.isSelected = editChkBox.checked;\n        } else {\n          this.isCheckedOnAdd = editChkBox.checked;\n        }\n      }\n    }\n    if (this.parent.isPersistSelection && this.isPartialSelection) {\n      if (e.requestType === 'paging' && (this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result)) {\n        this.selectedRowIndexes = [];\n      }\n    }\n  };\n  Selection.prototype.actionComplete = function (e) {\n    if (e.requestType === 'save' && this.parent.isPersistSelection) {\n      if (e.action === 'add') {\n        if (this.isCheckedOnAdd) {\n          var rowObj = this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute('data-uid'));\n          this.selectedRowState[this.getPkValue(this.primaryKey, rowObj.data)] = rowObj.isSelected = this.isCheckedOnAdd;\n        }\n        this.isHdrSelectAllClicked = false;\n        this.setCheckAllState();\n      }\n      this.refreshPersistSelection();\n    }\n    if (e.requestType === 'delete' && this.parent.isPersistSelection) {\n      var records = e.data;\n      var data = records.slice();\n      for (var i = 0; i < data.length; i++) {\n        var pkValue = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n        if (!isNullOrUndefined(pkValue)) {\n          this.updatePersistDelete(pkValue, this.isPartialSelection);\n        }\n      }\n      this.isHdrSelectAllClicked = false;\n      this.setCheckAllState();\n      this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n    }\n    if (e.requestType === 'paging') {\n      if (this.parent.isPersistSelection && this.isPartialSelection && this.isHdrSelectAllClicked) {\n        var rows = this.parent.getRowsObject();\n        var indexes = [];\n        for (var i = 0; i < rows.length; i++) {\n          if (rows[parseInt(i.toString(), 10)].isSelectable) {\n            indexes.push(rows[parseInt(i.toString(), 10)].index);\n          }\n        }\n        if (indexes.length) {\n          this.selectRows(indexes);\n        }\n      }\n      this.prevRowIndex = undefined;\n      this.prevCIdxs = undefined;\n      this.prevECIdxs = undefined;\n    }\n  };\n  Selection.prototype.onDataBound = function () {\n    var checkboxColumn = this.parent.getColumns().filter(function (col) {\n      return col.type === 'checkbox';\n    });\n    if (checkboxColumn.length && !this.parent.getDataModule().isRemote()) {\n      this.gridCurrentRecord = this.getData();\n    }\n    if (!this.parent.enableVirtualization && this.parent.isPersistSelection) {\n      if (this.selectedRecords.length) {\n        this.isPrevRowSelection = true;\n      }\n    }\n    if ((this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && this.rmtHdrChkbxClicked || this.isPartialSelection && this.parent.isPersistSelection && this.isHdrSelectAllClicked) {\n      if (this.parent.checkAllRows === 'Intermediate') {\n        this.setRowSelection(true);\n      } else if (this.parent.checkAllRows === 'Uncheck') {\n        this.setRowSelection(false);\n      }\n    }\n    if (this.parent.enableVirtualization) {\n      this.setCheckAllState();\n    }\n    if (this.parent.isPersistSelection) {\n      this.refreshPersistSelection();\n    }\n    this.initialRowSelection = this.isRowType() && this.parent.element.querySelectorAll('.e-selectionbackground') && this.parent.getSelectedRows().length ? true : false;\n    if (this.parent.isCheckBoxSelection && !this.initialRowSelection) {\n      var totalRecords = this.parent.getRowsObject();\n      var indexes = [];\n      for (var i = 0; i < totalRecords.length; i++) {\n        if (totalRecords[parseInt(i.toString(), 10)].isSelected) {\n          indexes.push(i);\n        }\n      }\n      if (indexes.length) {\n        this.selectRows(indexes);\n      }\n      this.initialRowSelection = true;\n    }\n  };\n  Selection.prototype.updatePersistSelectedData = function (checkState) {\n    if (this.parent.isPersistSelection) {\n      var rows = this.parent.getRows();\n      for (var i = 0; i < rows.length; i++) {\n        this.updatePersistCollection(rows[parseInt(i.toString(), 10)], checkState);\n      }\n      if (this.parent.checkAllRows === 'Uncheck') {\n        this.setRowSelection(false);\n        this.persistSelectedData = this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result ? this.persistSelectedData : [];\n      } else if (this.parent.checkAllRows === 'Check') {\n        this.setRowSelection(true);\n        this.persistSelectedData = !(this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && !this.isPartialSelection ? this.parent.groupSettings.columns.length ? this.getData().records.slice() : this.getData().slice() : this.persistSelectedData;\n      }\n    }\n  };\n  Selection.prototype.checkSelectAllAction = function (checkState) {\n    var cRenderer = this.getRenderer();\n    var editForm = this.parent.element.querySelector('.e-gridform');\n    this.checkedTarget = this.getCheckAllBox();\n    if (checkState && this.getCurrentBatchRecordChanges().length) {\n      this.parent.checkAllRows = 'Check';\n      this.updatePersistSelectedData(checkState);\n      this.selectRowsByRange(cRenderer.getVirtualRowIndex(0), cRenderer.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length - 1));\n      if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n        this.virtualSelectedData = this.virtualCheckBoxData().slice();\n        this.selectedRowIndexes = Object.keys(this.virtualSelectedData).map(function (key) {\n          return parseInt(key, 10);\n        });\n      }\n    } else {\n      this.parent.checkAllRows = 'Uncheck';\n      this.updatePersistSelectedData(checkState);\n      this.clearSelection();\n    }\n    this.chkAllCollec = [];\n    if (!isNullOrUndefined(editForm)) {\n      var editChkBox = editForm.querySelector('.e-edit-checkselect');\n      if (!isNullOrUndefined(editChkBox)) {\n        removeAddCboxClasses(editChkBox.nextElementSibling, checkState);\n      }\n    }\n  };\n  Selection.prototype.checkSelectAll = function (checkBox) {\n    var _this = this;\n    var stateStr = this.getCheckAllStatus(checkBox);\n    var state = stateStr === 'Check';\n    this.isHeaderCheckboxClicked = true;\n    if ((this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && (stateStr === 'Uncheck' || this.isCheckboxReset || stateStr === 'Intermediate' && this.parent.isPersistSelection)) {\n      this.rmtHdrChkbxClicked = true;\n    } else {\n      this.rmtHdrChkbxClicked = false;\n    }\n    if (this.rmtHdrChkbxClicked && this.isCheckboxReset) {\n      this.unSelectedRowState = {};\n    }\n    this.isCheckboxReset = false;\n    if (stateStr === 'Intermediate') {\n      if (!this.chkField && !this.parent.isPersistSelection) {\n        state = this.getCurrentBatchRecordChanges().some(function (data) {\n          return _this.getPkValue(_this.primaryKey, data) in _this.selectedRowState;\n        });\n      }\n      if (this.parent.isPersistSelection) {\n        if (this.parent.allowPaging && this.isPartialSelection) {\n          var rowObjects = this.parent.getRowsObject();\n          for (var i = 0; i < rowObjects.length; i++) {\n            if (rowObjects[i].isDataRow && rowObjects[i].isSelectable && !rowObjects[i].isSelected) {\n              state = false;\n              break;\n            } else {\n              state = true;\n            }\n          }\n        } else if (this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) {\n          for (var i = 0; i < this.getCurrentBatchRecordChanges().length; i++) {\n            if (!isNullOrUndefined(this.getPkValue(this.primaryKey, this.getCurrentBatchRecordChanges()[\"\" + i]))) {\n              // eslint-disable-next-line @typescript-eslint/no-explicit-any\n              if (Object.keys(this.selectedRowState).includes(this.getPkValue(this.primaryKey, this.getCurrentBatchRecordChanges()[\"\" + i]).toString())) {\n                state = true;\n              } else {\n                state = false;\n                break;\n              }\n            }\n          }\n        }\n      }\n    }\n    if (this.parent.isPersistSelection && this.parent.allowPaging) {\n      this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n    }\n    this.checkSelectAllAction(!state);\n    this.target = null;\n    if (this.getCurrentBatchRecordChanges().length > 0) {\n      this.setCheckAllState();\n      this.updateSelectedRowIndexes();\n    }\n    this.triggerChkChangeEvent(checkBox, !state);\n  };\n  Selection.prototype.getCheckAllStatus = function (ele) {\n    var classes;\n    if (!isNullOrUndefined(ele)) {\n      classes = ele.nextElementSibling.classList;\n    } else {\n      if (!isNullOrUndefined(this.getCheckAllBox())) {\n        classes = this.getCheckAllBox().nextElementSibling.classList;\n      }\n    }\n    var status = 'None';\n    if (classes instanceof DOMTokenList) {\n      if (classes.contains('e-check')) {\n        status = 'Check';\n      } else if (classes.contains('e-uncheck')) {\n        status = 'Uncheck';\n      } else if (classes.contains('e-stop')) {\n        status = 'Intermediate';\n      }\n    }\n    return status;\n  };\n  Selection.prototype.checkSelect = function (checkBox) {\n    var target = closest(this.checkedTarget, '.' + literals.rowCell);\n    var gObj = this.parent;\n    this.isMultiCtrlRequest = true;\n    var rIndex = 0;\n    this.isHeaderCheckboxClicked = false;\n    if (isGroupAdaptive(gObj)) {\n      var uid = target.parentElement.getAttribute('data-uid');\n      if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n        rIndex = parseInt(target.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n      } else {\n        rIndex = gObj.getRows().map(function (m) {\n          return m.getAttribute('data-uid');\n        }).indexOf(uid);\n      }\n    } else {\n      rIndex = parseInt(target.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n    }\n    if (this.parent.isPersistSelection && this.parent.element.getElementsByClassName(literals.addedRow).length > 0 && this.parent.editSettings.newRowPosition === 'Top' && !this.parent.editSettings.showAddNewRow) {\n      ++rIndex;\n    }\n    this.rowCellSelectionHandler(rIndex, parseInt(target.getAttribute(literals.ariaColIndex), 10) - 1);\n    this.moveIntoUncheckCollection(closest(target, '.' + literals.row));\n    this.setCheckAllState();\n    this.isMultiCtrlRequest = false;\n    this.triggerChkChangeEvent(checkBox, checkBox.nextElementSibling.classList.contains('e-check'));\n  };\n  Selection.prototype.moveIntoUncheckCollection = function (row) {\n    if (this.parent.checkAllRows === 'Check' || this.parent.checkAllRows === 'Uncheck') {\n      var rowObj = this.getRowObj(row);\n      var pKey = rowObj && rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null;\n      if (!pKey) {\n        return;\n      }\n      if (this.chkAllCollec.indexOf(pKey) < 0) {\n        this.chkAllCollec.push(pKey);\n      } else {\n        this.chkAllCollec.splice(this.chkAllCollec.indexOf(pKey), 1);\n      }\n    }\n  };\n  Selection.prototype.triggerChkChangeEvent = function (checkBox, checkState) {\n    this.parent.trigger(events.checkBoxChange, {\n      checked: checkState,\n      selectedRowIndexes: this.parent.getSelectedRowIndexes(),\n      target: checkBox\n    });\n    if (!this.parent.isEdit) {\n      this.checkedTarget = null;\n    }\n  };\n  Selection.prototype.updateSelectedRowIndexes = function () {\n    if (this.parent.isCheckBoxSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.isPartialSelection && !(this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && this.parent.selectionSettings.persistSelection) {\n      if (this.parent.checkAllRows !== 'Uncheck') {\n        var rowObj = this.parent.getRowsObject().filter(function (e) {\n          return e.isSelectable;\n        });\n        for (var _i = 0, rowObj_2 = rowObj; _i < rowObj_2.length; _i++) {\n          var row = rowObj_2[_i];\n          this.selectedRowIndexes.push(row.index);\n        }\n      }\n    }\n    if (this.parent.isCheckBoxSelection && this.parent.enableVirtualization && !this.isPartialSelection && (this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && !this.parent.isPersistSelection && this.parent.checkAllRows === 'Check') {\n      var rowObj = this.parent.getRowsObject().filter(function (e) {\n        return e.isSelectable;\n      });\n      if (rowObj.length !== this.selectedRowIndexes.length) {\n        for (var _a = 0, rowObj_3 = rowObj; _a < rowObj_3.length; _a++) {\n          var row = rowObj_3[_a];\n          if (this.selectedRowIndexes.indexOf(row.index) <= -1) {\n            this.selectedRowIndexes.push(row.index);\n          }\n        }\n      }\n    }\n  };\n  Selection.prototype.updateSelectedRowIndex = function (index) {\n    if (this.parent.isCheckBoxSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && !(this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && !this.isPartialSelection) {\n      if (this.parent.checkAllRows === 'Check') {\n        this.selectedRowIndexes = [];\n        var dataLength = this.parent.groupSettings.columns.length ? this.getData()['records'].length : this.getData().length;\n        for (var data = 0; data < dataLength; data++) {\n          this.selectedRowIndexes.push(data);\n        }\n      } else if (this.parent.checkAllRows === 'Uncheck') {\n        this.selectedRowIndexes = [];\n      } else {\n        var row = this.parent.getRowByIndex(index);\n        if (index && row && row.getAttribute('aria-selected') === 'false') {\n          var selectedVal = this.selectedRowIndexes.indexOf(index);\n          this.selectedRowIndexes.splice(selectedVal, 1);\n        }\n      }\n    }\n  };\n  Selection.prototype.isAllSelected = function (count) {\n    if (this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) {\n      return this.getAvailableSelectedData(this.persistSelectedData).length === (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling ? this.parent.totalDataRecordsCount : this.totalRecordsCount);\n    } else {\n      if (this.isPartialSelection) {\n        if (this.parent.allowPaging && !this.selectionSettings.persistSelection && this.parent.pageSettings.pageSize < this.parent.pageSettings.totalRecordsCount) {\n          var data = this.parent.partialSelectedRecords;\n          for (var i = 0; i < data.length; i++) {\n            var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n            if (!this.selectedRowState[\"\" + pKey]) {\n              return false;\n            }\n          }\n          return true;\n        } else {\n          return this.isSelectAllRowCount(count);\n        }\n      } else {\n        var data = this.getData();\n        if (this.parent.groupSettings.columns.length && data['records']) {\n          data = data['records'];\n        }\n        for (var i = 0; i < data.length; i++) {\n          var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n          if (!this.selectedRowState[\"\" + pKey]) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n  };\n  Selection.prototype.someDataSelected = function () {\n    if ((this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && (this.parent.searchSettings.key.length || this.parent.filterSettings.columns.length)) {\n      var filteredSearchedSelectedData = this.getAvailableSelectedData(this.persistSelectedData);\n      for (var i = 0; i < filteredSearchedSelectedData.length; i++) {\n        var pKey = this.getPkValue(this.primaryKey, filteredSearchedSelectedData[parseInt(i.toString(), 10)]);\n        if (this.selectedRowState[\"\" + pKey]) {\n          return false;\n        }\n      }\n    }\n    var data = this.isPartialSelection ? this.getAvailableSelectedData(this.parent.partialSelectedRecords) : this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result ? [] : this.getData();\n    for (var i = 0; i < data.length; i++) {\n      var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n      if (this.selectedRowState[\"\" + pKey]) {\n        return false;\n      }\n    }\n    return true;\n  };\n  Selection.prototype.setCheckAllState = function (index, isInteraction) {\n    if (this.parent.isCheckBoxSelection || this.parent.selectionSettings.checkboxMode === 'ResetOnRowClick') {\n      var checkToSelectAll = false;\n      var isFiltered = false;\n      var checkedLen = Object.keys(this.selectedRowState).length;\n      if (this.parent.element.classList.contains('e-treelistgrid') && this.parent.isPersistSelection && !this.parent.enableVirtualization && !this.parent.getDataModule().isRemote() && Array.isArray(this.parent.dataSource) && checkedLen === this.parent.dataSource.length && checkedLen > this.totalRecordsCount) {\n        checkedLen = this.totalRecordsCount;\n      }\n      if (!this.parent.isPersistSelection) {\n        checkedLen = this.selectedRowIndexes.length;\n        this.totalRecordsCount = this.getCurrentBatchRecordChanges().length;\n      }\n      if (this.parent.isPersistSelection && !((this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && this.isPartialSelection) && (this.parent.searchSettings.key.length || this.parent.filterSettings.columns.length)) {\n        isFiltered = true;\n        checkToSelectAll = this.isAllSelected(checkedLen);\n      }\n      var input = this.getCheckAllBox();\n      if (input) {\n        var spanEle = input.nextElementSibling;\n        removeClass([spanEle], ['e-check', 'e-stop', 'e-uncheck']);\n        setChecked(input, false);\n        input.indeterminate = false;\n        var getRecord = this.parent.getDataModule().isRemote() ? [] : this.gridCurrentRecord;\n        if (this.parent.groupSettings.columns.length && getRecord['records']) {\n          getRecord = getRecord['records'];\n        }\n        this.totalRecordsCount = this.checkVirtualCheckBox() ? getRecord.length : this.totalRecordsCount;\n        if (checkToSelectAll && isFiltered && (this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result || getRecord.length) || !isFiltered && (checkedLen === this.totalRecordsCount && this.totalRecordsCount && !this.isPartialSelection && (!(this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) || this.parent.allowPaging) || !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling && this.isPartialSelection && (this.isSelectAllRowCount(checkedLen) || this.isHdrSelectAllClicked && !this.parent.isPersistSelection) || (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && !this.parent.allowPaging && (!(this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && getRecord.length && checkedLen === getRecord.length || (this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && !this.isPartialSelection && (checkedLen === this.parent.totalDataRecordsCount || (this.isSelectAllRowCount(checkedLen) || checkedLen === this.totalRecordsCount) && !this.parent.isPersistSelection) || this.isPartialSelection && (this.isHdrSelectAllClicked || this.isSelectAllRowCount(checkedLen))) || checkedLen === this.totalRecordsCount && this.totalRecordsCount && !this.isPartialSelection && !this.parent.allowPaging && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling)) {\n          addClass([spanEle], ['e-check']);\n          setChecked(input, true);\n          if (isInteraction) {\n            this.getRenderer().setSelection(null, true, true);\n          }\n          this.parent.checkAllRows = 'Check';\n        } else if ((!this.selectedRowIndexes.length && (!this.parent.enableVirtualization || !this.persistSelectedData.length && !isFiltered || isFiltered && this.someDataSelected()) || checkedLen === 0 && this.getCurrentBatchRecordChanges().length === 0) && !this.parent.allowPaging || this.parent.allowPaging && (checkedLen === 0 || checkedLen && isFiltered && this.someDataSelected())) {\n          addClass([spanEle], ['e-uncheck']);\n          if (isInteraction) {\n            this.getRenderer().setSelection(null, false, true);\n          }\n          this.parent.checkAllRows = 'Uncheck';\n        } else {\n          addClass([spanEle], ['e-stop']);\n          this.parent.checkAllRows = 'Intermediate';\n          input.indeterminate = true;\n        }\n        if (checkedLen === 0 && this.getCurrentBatchRecordChanges().length === 0) {\n          addClass([spanEle.parentElement], ['e-checkbox-disabled']);\n        } else {\n          removeClass([spanEle.parentElement], ['e-checkbox-disabled']);\n        }\n        if (this.isPartialSelection) {\n          var rowCount = this.parent.getRowsObject().filter(function (e) {\n            return e.isSelectable;\n          }).length;\n          if (rowCount === 0 && spanEle.parentElement.querySelector('.e-frame').classList.contains('e-uncheck')) {\n            addClass([spanEle.parentElement], ['e-checkbox-disabled']);\n          } else {\n            removeClass([spanEle.parentElement], ['e-checkbox-disabled']);\n          }\n        }\n        if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && !this.parent.allowPaging && !(this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result)) {\n          this.updateSelectedRowIndex(index);\n        }\n      }\n    }\n  };\n  Selection.prototype.checkVirtualCheckBox = function () {\n    return this.parent.enableVirtualization && !(this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) && this.parent.isCheckBoxSelection && !this.isPartialSelection;\n  };\n  Selection.prototype.virtualCheckBoxData = function () {\n    var data = this.getData();\n    if (this.parent.groupSettings.columns.length && data['records']) {\n      data = data['records'];\n    }\n    return data;\n  };\n  Selection.prototype.isSelectAllRowCount = function (count) {\n    var rowCount = 0;\n    var rowObj = this.parent.getRowsObject();\n    if (this.parent.selectionSettings.persistSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n      var dataLen = this.parent.getDataModule().isRemote() || !isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result ? this.parent.totalDataRecordsCount : this.getData() && this.getData().length;\n      if (dataLen === rowObj.length) {\n        rowCount = rowObj.filter(function (e) {\n          return e.isSelectable;\n        }).length;\n        return rowCount && count === rowCount;\n      } else {\n        return false;\n      }\n    } else {\n      if (this.parent.allowPaging && this.parent.selectionSettings.persistSelection) {\n        var disableSelectedRecordsCount = this.getAvailableSelectedData(this.parent.disableSelectedRecords).length;\n        var partialSelectedRecordsCount = this.getAvailableSelectedData(this.parent.partialSelectedRecords).length;\n        var selectedRowCount = this.getAvailableSelectedData(this.persistSelectedData).length;\n        rowCount = disableSelectedRecordsCount + partialSelectedRecordsCount;\n        return rowCount === this.totalRecordsCount && selectedRowCount !== 0 && selectedRowCount === partialSelectedRecordsCount;\n      } else {\n        rowCount = rowObj.filter(function (e) {\n          return e.isSelectable;\n        }).length;\n        return rowCount && count === rowCount;\n      }\n    }\n  };\n  Selection.prototype.keyDownHandler = function (e) {\n    // Below are keyCode for command key in MAC OS. Safari/Chrome(91-Left command, 93-Right Command), Opera(17), FireFox(224)\n    if (Browser.info.name === 'opera' && e.keyCode === 17 || Browser.info.name === 'mozilla' && e.keyCode === 224 || (Browser.info.name === 'safari' || Browser.info.name === 'chrome') && (e.keyCode === 91 || e.keyCode === 93)) {\n      this.cmdKeyPressed = true;\n    }\n    var targetHeadCell = parentsUntil(e.target, 'e-headercell');\n    var targetRowCell = parentsUntil(e.target, literals.rowCell);\n    var isCheckBox = targetHeadCell ? targetHeadCell.children[0].classList.contains('e-headerchkcelldiv') : targetRowCell ? targetRowCell.classList.contains('e-gridchkbox') : false;\n    if (isCheckBox && !this.parent.allowKeyboard && e.keyCode === 32) {\n      e.preventDefault();\n    }\n  };\n  Selection.prototype.keyUpHandler = function (e) {\n    if (Browser.info.name === 'opera' && e.keyCode === 17 || Browser.info.name === 'mozilla' && e.keyCode === 224 || (Browser.info.name === 'safari' || Browser.info.name === 'chrome') && (e.keyCode === 91 || e.keyCode === 93)) {\n      this.cmdKeyPressed = false;\n    }\n  };\n  Selection.prototype.clickHandler = function (e) {\n    var target = e.target;\n    this.actualTarget = target;\n    if (!this.isAutoFillSel && !e.ctrlKey && !e.shiftKey) {\n      this.startAFCell = this.endAFCell = null;\n    }\n    if (this.selectionSettings.persistSelection) {\n      this.deSelectedData = iterateExtend(this.persistSelectedData);\n    }\n    if (parentsUntil(target, literals.row) || parentsUntil(target, 'e-headerchkcelldiv') || this.selectionSettings.allowColumnSelection && target.classList.contains('e-headercell')) {\n      this.isInteracted = true;\n    }\n    this.cmdKeyPressed = e.metaKey;\n    this.isMultiCtrlRequest = e.ctrlKey || this.enableSelectMultiTouch || this.isMacOS && this.cmdKeyPressed;\n    if (!this.parent.allowKeyboard) {\n      this.isMultiShiftRequest = false;\n      this.isMultiCtrlRequest = false;\n    } else {\n      this.isMultiShiftRequest = e.shiftKey;\n    }\n    this.isMultiCtrlRequestCell = this.isMultiCtrlRequest;\n    this.popUpClickHandler(e);\n    var chkSelect = false;\n    this.preventFocus = true;\n    var checkBox;\n    var checkWrap = parentsUntil(target, 'e-checkbox-wrapper');\n    this.checkSelectAllClicked = checkWrap && checkWrap.getElementsByClassName('e-checkselectall') || this.selectionSettings.persistSelection && parentsUntil(target, literals.row) ? true : false;\n    if (this.selectionSettings.persistSelection && this.isPartialSelection && parentsUntil(target, 'e-headerchkcelldiv') && !target.querySelector('.e-checkbox-disabled')) {\n      this.isHdrSelectAllClicked = true;\n    }\n    if (checkWrap && checkWrap.querySelectorAll('.e-checkselect,.e-checkselectall').length > 0) {\n      checkBox = checkWrap.querySelector('input[type=\"checkbox\"]');\n      chkSelect = true;\n    }\n    this.drawBorders();\n    this.updateAutoFillPosition();\n    target = parentsUntil(target, literals.rowCell);\n    if (this.parent.isReact && target && !target.parentElement && target.classList.contains('e-rowcell')) {\n      target = this.parent.getCellFromIndex(parseInt(target.getAttribute('index'), 10), parseInt(target.getAttribute('aria-colindex'), 10) - 1);\n    }\n    if (this.isRowDragSelected && isNullOrUndefined(target) && this.parent.allowRowDragAndDrop && this.selectionSettings.persistSelection && this.checkSelectAllClicked) {\n      this.isRowDragSelected = false;\n    }\n    if ((target && target.parentElement.classList.contains(literals.row) && !this.parent.selectionSettings.checkboxOnly || chkSelect) && !this.isRowDragSelected) {\n      if (this.parent.isCheckBoxSelection) {\n        this.isMultiCtrlRequest = true;\n      }\n      this.target = target;\n      if (!isNullOrUndefined(checkBox)) {\n        this.checkedTarget = checkBox;\n        if (checkBox.classList.contains('e-checkselectall')) {\n          this.checkSelectAll(checkBox);\n        } else {\n          this.checkSelect(checkBox);\n        }\n      } else {\n        var rIndex = 0;\n        rIndex = parseInt(target.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n        if (this.parent.isPersistSelection && !this.parent.editSettings.showAddNewRow && this.parent.element.getElementsByClassName(literals.addedRow).length > 0) {\n          ++rIndex;\n        }\n        if (!this.mUPTarget || !this.mUPTarget.isEqualNode(target)) {\n          this.rowCellSelectionHandler(rIndex, parseInt(target.getAttribute(literals.ariaColIndex), 10) - 1);\n        }\n        if (this.parent.isCheckBoxSelection) {\n          this.moveIntoUncheckCollection(closest(target, '.' + literals.row));\n          this.setCheckAllState();\n        }\n      }\n      if (!this.parent.isCheckBoxSelection && Browser.isDevice && !this.isSingleSel()) {\n        this.showPopup(e);\n      }\n    } else if (e.target.classList.contains('e-headercell') && !e.target.classList.contains('e-stackedheadercell')) {\n      var uid = e.target.querySelector('.e-headercelldiv').getAttribute('e-mappinguid');\n      this.headerSelectionHandler(this.parent.getColumnIndexByUid(uid));\n    }\n    this.isMultiCtrlRequest = false;\n    this.isMultiCtrlRequestCell = this.isMultiCtrlRequest;\n    this.isMultiShiftRequest = false;\n    if (isNullOrUndefined(closest(e.target, '.e-unboundcell'))) {\n      this.preventFocus = false;\n    }\n  };\n  Selection.prototype.popUpClickHandler = function (e) {\n    var target = e.target;\n    if (closest(target, '.e-headercell') || e.target.classList.contains(literals.rowCell) || closest(target, '.e-gridpopup')) {\n      if (target.classList.contains('e-rowselect')) {\n        if (!target.classList.contains('e-spanclicked')) {\n          target.classList.add('e-spanclicked');\n          this.enableSelectMultiTouch = true;\n        } else {\n          target.classList.remove('e-spanclicked');\n          this.enableSelectMultiTouch = false;\n          this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n        }\n      }\n    } else {\n      this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n    }\n  };\n  Selection.prototype.showPopup = function (e) {\n    if (!this.selectionSettings.enableSimpleMultiRowSelection) {\n      setCssInGridPopUp(this.parent.element.querySelector('.e-gridpopup'), e, 'e-rowselect e-icons e-icon-rowselect' + (!this.isSingleSel() && (this.selectedRecords.length > 1 || this.selectedRowCellIndexes.length > 1) ? ' e-spanclicked' : ''));\n    }\n  };\n  Selection.prototype.rowCellSelectionHandler = function (rowIndex, cellIndex) {\n    if (!this.isMultiCtrlRequest && !this.isMultiShiftRequest || this.isSingleSel()) {\n      if (!this.isDragged) {\n        this.selectRow(rowIndex, this.selectionSettings.enableToggle);\n      }\n      this.selectCell({\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      }, this.selectionSettings.enableToggle);\n      if (this.selectedRowCellIndexes.length) {\n        this.updateAutoFillPosition();\n      }\n      this.drawBorders();\n    } else if (this.isMultiShiftRequest) {\n      var isChkBox = closest(this.target, '.' + literals.rowCell).classList.contains(literals.gridChkBox);\n      if (this.parent.isCheckBoxSelection || !this.parent.isCheckBoxSelection && !isChkBox || this.parent.getColumns().some(function (col) {\n        return col.type === 'checkbox';\n      }) && this.selectionSettings.checkboxMode === 'ResetOnRowClick' && isChkBox) {\n        this.selectRowsByRange(isUndefined(this.prevRowIndex) ? rowIndex : this.prevRowIndex, rowIndex);\n      } else {\n        this.addRowsToSelection([rowIndex]);\n      }\n      this.selectCellsByRange(isUndefined(this.prevCIdxs) ? {\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      } : this.prevCIdxs, {\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      });\n      this.updateAutoFillPosition();\n      this.drawBorders();\n    } else {\n      this.addRowsToSelection([rowIndex]);\n      if (this.selectionSettings.mode === 'Both') {\n        var checkboxColumn = this.parent.getColumns().find(function (col) {\n          return col.type === 'checkbox';\n        });\n        var checkboxColumnIndexCheck = checkboxColumn && checkboxColumn.index !== cellIndex;\n        if (checkboxColumnIndexCheck && !this.isMultiCtrlRequestCell) {\n          this.selectCell({\n            rowIndex: rowIndex,\n            cellIndex: cellIndex\n          }, this.selectionSettings.enableToggle);\n        } else if (!checkboxColumn || checkboxColumnIndexCheck) {\n          this.addCellsToSelection([{\n            rowIndex: rowIndex,\n            cellIndex: cellIndex\n          }]);\n        }\n      } else {\n        this.addCellsToSelection([{\n          rowIndex: rowIndex,\n          cellIndex: cellIndex\n        }]);\n      }\n      this.showHideBorders('none');\n    }\n    this.isDragged = false;\n  };\n  Selection.prototype.onCellFocused = function (e) {\n    if (this.parent.frozenRows && e.container.isHeader && e.byKey) {\n      if (e.keyArgs.action === 'upArrow') {\n        if (this.parent.allowFiltering) {\n          e.isJump = e.element.tagName === 'INPUT' ? true : false;\n        } else {\n          e.isJump = e.element.tagName === 'TH' ? true : false;\n        }\n      } else {\n        if (e.keyArgs.action === 'downArrow') {\n          var rIdx = Number(e.element.parentElement.getAttribute(literals.ariaRowIndex)) - 1;\n          e.isJump = rIdx === 0 ? true : false;\n        } else {\n          if (e.keyArgs.action === 'ctrlHome') {\n            e.isJump = true;\n          }\n        }\n      }\n    }\n    var clear = (e.container.isHeader && e.isJump || e.container.isContent && !e.container.isSelectable) && !(e.byKey && e.keyArgs.action === 'space') && !(e.element.classList.contains('e-detailrowexpand') || e.element.classList.contains('e-detailrowcollapse'));\n    var headerAction = e.container.isHeader && e.element.tagName !== 'TD' && !closest(e.element, '.' + literals.rowCell) && !(e.byKey && e.keyArgs.action === 'space');\n    if (!e.byKey || clear) {\n      if (clear && !(this.parent.isCheckBoxSelection || this.selectionSettings.persistSelection && (e.parent.classList.contains('e-recordplusexpand') || e.parent.classList.contains('e-recordpluscollapse') || e.parent.classList.contains('e-groupcaption')))) {\n        this.clearSelection();\n      }\n      return;\n    }\n    var _a = e.container.isContent ? e.container.indexes : e.indexes,\n      rowIndex = _a[0],\n      cellIndex = _a[1];\n    var prev = this.focus.getPrevIndexes();\n    if (e.element.parentElement.querySelector('.e-rowcelldrag') || e.element.parentElement.querySelector('.e-dtdiagonalright') || e.element.parentElement.querySelector('.e-dtdiagonaldown')) {\n      prev.cellIndex = prev.cellIndex - 1;\n    }\n    if (this.parent.frozenRows) {\n      if (e.container.isHeader && (e.element.tagName === 'TD' || closest(e.element, '.' + literals.rowCell))) {\n        var hdrLength = this.parent.getHeaderTable().querySelector('thead').childElementCount;\n        if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' && e.keyArgs.action === 'upArrow') {\n          hdrLength++;\n        }\n        rowIndex -= hdrLength;\n        prev.rowIndex = !isNullOrUndefined(prev.rowIndex) ? prev.rowIndex - hdrLength : null;\n      } else {\n        rowIndex += this.parent.frozenRows;\n        prev.rowIndex = prev.rowIndex === 0 || !isNullOrUndefined(prev.rowIndex) ? prev.rowIndex + this.parent.frozenRows : null;\n      }\n    }\n    if (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) {\n      rowIndex = parseInt(e.element.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n    }\n    if ((headerAction || ['ctrlPlusA', 'escape'].indexOf(e.keyArgs.action) === -1 && e.keyArgs.action !== 'space' && rowIndex === prev.rowIndex && cellIndex === prev.cellIndex) && !this.selectionSettings.allowColumnSelection) {\n      return;\n    }\n    if (this.parent.enableVirtualization) {\n      rowIndex = parseInt(e.element.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n      if (!this.parent.enableColumnVirtualization && !this.parent.groupSettings.columns.length && this.parent.totalDataRecordsCount >= 1) {\n        if (e.keyArgs.action === 'ctrlHome') {\n          rowIndex = 0;\n          this.parent.isFocusFirstCell = true;\n        } else if (e.keyArgs.action === 'ctrlEnd') {\n          rowIndex = this.parent.totalDataRecordsCount - 1;\n          this.isFocusLastCell = true;\n        }\n      }\n    }\n    if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling && e.keyArgs.action === 'downArrow') {\n      rowIndex--;\n    }\n    this.preventFocus = true;\n    var columnIndex = this.getKeyColIndex(e);\n    if (this.needColumnSelection) {\n      cellIndex = columnIndex;\n    }\n    if (this.parent.element.classList.contains('e-gridcell-read') && (e.keyArgs.action === 'tab' || e.keyArgs.action === 'shiftTab' || e.keyArgs.action === 'rightArrow' || e.keyArgs.action === 'leftArrow')) {\n      var targetLabel = this.target.getAttribute('aria-label');\n      targetLabel = this.target.innerHTML + ' column header ' + this.parent.getColumnByIndex(cellIndex).field;\n      this.target.setAttribute('aria-label', targetLabel);\n    }\n    switch (e.keyArgs.action) {\n      case 'downArrow':\n      case 'upArrow':\n      case 'enter':\n      case 'shiftEnter':\n        this.target = e.element;\n        this.isKeyAction = true;\n        this.applyDownUpKey(rowIndex, cellIndex);\n        break;\n      case 'rightArrow':\n      case 'leftArrow':\n        this.applyRightLeftKey(rowIndex, cellIndex);\n        break;\n      case 'shiftDown':\n      case 'shiftUp':\n        this.shiftDownKey(rowIndex, cellIndex);\n        break;\n      case 'shiftLeft':\n      case 'shiftRight':\n        this.applyShiftLeftRightKey(rowIndex, cellIndex);\n        break;\n      case 'home':\n      case 'end':\n        cellIndex = e.keyArgs.action === 'end' ? this.getLastColIndex(rowIndex) : 0;\n        this.applyHomeEndKey(rowIndex, cellIndex);\n        break;\n      case 'ctrlHome':\n      case 'ctrlEnd':\n        this.applyCtrlHomeEndKey(rowIndex, cellIndex);\n        break;\n      case 'escape':\n        this.clearSelection();\n        if (this.parent.clipboardModule) {\n          window.navigator['clipboard'].writeText('');\n        }\n        break;\n      case 'ctrlPlusA':\n        this.ctrlPlusA();\n        break;\n      case 'space':\n        this.applySpaceSelection(e.element);\n        break;\n      case 'tab':\n        if (this.parent.editSettings.allowNextRowEdit) {\n          this.selectRow(rowIndex);\n        }\n        break;\n    }\n    this.needColumnSelection = false;\n    this.preventFocus = false;\n    this.positionBorders();\n    if (this.parent.isFrozenGrid()) {\n      this.showHideBorders('none', true);\n      this.refreshFrozenBorders();\n    }\n    this.updateAutoFillPosition();\n  };\n  Selection.prototype.getKeyColIndex = function (e) {\n    var uid;\n    var index = null;\n    var stackedHeader = e.element.querySelector('.e-stackedheadercelldiv');\n    if (this.selectionSettings.allowColumnSelection && parentsUntil(e.element, 'e-columnheader')) {\n      this.needColumnSelection = e.container.isHeader ? true : false;\n      if (stackedHeader) {\n        if (e.keyArgs.action === 'rightArrow' || e.keyArgs.action === 'leftArrow') {\n          return index;\n        }\n        uid = stackedHeader.getAttribute('e-mappinguid');\n        var innerColumn = this.getstackedColumns(this.parent.getColumnByUid(uid).columns);\n        var lastIndex = this.parent.getColumnIndexByUid(innerColumn[innerColumn.length - 1].uid);\n        var firstIndex = this.parent.getColumnIndexByUid(innerColumn[0].uid);\n        index = this.prevColIndex >= lastIndex ? firstIndex : lastIndex;\n      } else {\n        index = this.parent.getColumnIndexByUid(e.element.querySelector('.e-headercelldiv').getAttribute('e-mappinguid'));\n      }\n    }\n    return index;\n  };\n  /**\n   * Apply ctrl + A key selection\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.ctrlPlusA = function () {\n    if (this.isRowType() && !this.isSingleSel()) {\n      var rowObj = this.parent.getRowsObject();\n      this.selectRowsByRange(rowObj[0].index, rowObj[rowObj.length - 1].index);\n    }\n    if (this.isCellType() && !this.isSingleSel()) {\n      this.selectCellsByRange({\n        rowIndex: 0,\n        cellIndex: 0\n      }, {\n        rowIndex: this.parent.getRows().length - 1,\n        cellIndex: this.parent.getColumns().length - 1\n      });\n    }\n  };\n  Selection.prototype.applySpaceSelection = function (target) {\n    if (target.classList.contains('e-checkselectall')) {\n      this.checkedTarget = target;\n      this.checkSelectAll(this.checkedTarget);\n    } else {\n      if (target.classList.contains('e-checkselect')) {\n        this.checkedTarget = target;\n        this.checkSelect(this.checkedTarget);\n      }\n    }\n  };\n  Selection.prototype.applyDownUpKey = function (rowIndex, cellIndex) {\n    var gObj = this.parent;\n    if (this.parent.isCheckBoxSelection && this.parent.checkAllRows === 'Check' && !this.selectionSettings.persistSelection && !this.selectionSettings.checkboxOnly) {\n      this.checkSelectAllAction(false);\n      this.checkedTarget = null;\n    }\n    if (this.isRowType() && !this.selectionSettings.checkboxOnly) {\n      if (this.parent.frozenRows) {\n        this.selectRow(rowIndex, true);\n        this.applyUpDown(gObj.selectedRowIndex);\n      } else {\n        this.selectRow(rowIndex, true);\n        this.applyUpDown(gObj.selectedRowIndex);\n      }\n    }\n    if (this.isCellType()) {\n      this.selectCell({\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      }, true);\n    }\n    if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n      this.selectColumn(cellIndex);\n    }\n  };\n  Selection.prototype.applyUpDown = function (rowIndex) {\n    if (rowIndex < 0) {\n      return;\n    }\n    if (!this.target) {\n      this.target = this.parent.getRows()[0].children[this.parent.groupSettings.columns.length || 0];\n    }\n    var cIndex = parseInt(this.target.getAttribute(literals.ariaColIndex), 10) - 1;\n    var row = this.contentRenderer.getRowByIndex(rowIndex);\n    if (row) {\n      this.target = row.getElementsByClassName(literals.rowCell)[parseInt(cIndex.toString(), 10)];\n    }\n    this.addAttribute(this.target);\n    if (this.parent.element.classList.contains('e-gridcell-read')) {\n      var targetLabel = this.target.getAttribute('aria-label');\n      targetLabel = this.target.innerHTML;\n      this.target.setAttribute('aria-label', targetLabel);\n    }\n  };\n  Selection.prototype.applyRightLeftKey = function (rowIndex, cellIndex) {\n    if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n      this.selectColumn(cellIndex);\n    } else if (this.isCellType()) {\n      this.selectCell({\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      }, true);\n      this.addAttribute(this.target);\n    }\n  };\n  Selection.prototype.applyHomeEndKey = function (rowIndex, cellIndex) {\n    if (this.isCellType()) {\n      this.selectCell({\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      }, true);\n    } else {\n      this.addAttribute(this.parent.getCellFromIndex(rowIndex, cellIndex));\n    }\n  };\n  /**\n   * Apply shift+down key selection\n   *\n   * @param {number} rowIndex - specfies the rowIndex\n   * @param {number} cellIndex - specifies the CellIndex\n   * @returns {void}\n   * @hidden\n   */\n  Selection.prototype.shiftDownKey = function (rowIndex, cellIndex) {\n    this.isMultiShiftRequest = true;\n    if (this.isRowType() && !this.isSingleSel()) {\n      if (!isUndefined(this.prevRowIndex)) {\n        this.selectRowsByRange(this.prevRowIndex, rowIndex);\n        this.applyUpDown(rowIndex);\n      } else if (this.isPartialSelection) {\n        this.selectRow(rowIndex, true);\n      } else {\n        this.selectRow(0, true);\n      }\n    }\n    if (this.isCellType() && !this.isSingleSel()) {\n      this.selectCellsByRange(this.prevCIdxs || {\n        rowIndex: 0,\n        cellIndex: 0\n      }, {\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      });\n    }\n    this.isMultiShiftRequest = false;\n  };\n  Selection.prototype.applyShiftLeftRightKey = function (rowIndex, cellIndex) {\n    this.isMultiShiftRequest = true;\n    if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n      this.selectColumnsByRange(this.prevColIndex, cellIndex);\n    } else {\n      this.selectCellsByRange(this.prevCIdxs, {\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      });\n    }\n    this.isMultiShiftRequest = false;\n  };\n  Selection.prototype.getstackedColumns = function (column) {\n    var innerColumnIndexes = [];\n    for (var i = 0, len = column.length; i < len; i++) {\n      if (column[parseInt(i.toString(), 10)].columns) {\n        this.getstackedColumns(column[parseInt(i.toString(), 10)].columns);\n      } else {\n        innerColumnIndexes.push(column[parseInt(i.toString(), 10)]);\n      }\n    }\n    return innerColumnIndexes;\n  };\n  Selection.prototype.applyCtrlHomeEndKey = function (rowIndex, cellIndex) {\n    if (this.isRowType()) {\n      this.selectRow(rowIndex, true);\n      if (!(this.parent.enableVirtualization || this.parent.enableColumnVirtualization)) {\n        this.addAttribute(this.parent.getCellFromIndex(rowIndex, cellIndex));\n      }\n    }\n    if (this.isCellType()) {\n      this.selectCell({\n        rowIndex: rowIndex,\n        cellIndex: cellIndex\n      }, true);\n    }\n  };\n  Selection.prototype.addRemoveClassesForRow = function (row, isAdd, clearAll) {\n    var args = [];\n    for (var _i = 3; _i < arguments.length; _i++) {\n      args[_i - 3] = arguments[_i];\n    }\n    if (row) {\n      var cells = [].slice.call(row.getElementsByClassName(literals.rowCell));\n      var detailIndentCell = row.querySelector('.e-detailrowcollapse') || row.querySelector('.e-detailrowexpand');\n      var dragdropIndentCell = row.querySelector('.e-rowdragdrop');\n      if (detailIndentCell) {\n        cells.push(detailIndentCell);\n      }\n      if (dragdropIndentCell) {\n        cells.push(dragdropIndentCell);\n      }\n      addRemoveActiveClasses.apply(void 0, [cells, isAdd].concat(args));\n    }\n    this.getRenderer().setSelection(row ? row.getAttribute('data-uid') : null, isAdd, clearAll);\n  };\n  Selection.prototype.isRowType = function () {\n    return this.selectionSettings.mode === 'Row' || this.selectionSettings.mode === 'Both';\n  };\n  Selection.prototype.isCellType = function () {\n    return this.selectionSettings.mode === 'Cell' || this.selectionSettings.mode === 'Both';\n  };\n  Selection.prototype.isSingleSel = function () {\n    return this.selectionSettings.type === 'Single';\n  };\n  Selection.prototype.getRenderer = function () {\n    if (isNullOrUndefined(this.contentRenderer)) {\n      this.contentRenderer = this.factory.getRenderer(RenderType.Content);\n    }\n    return this.contentRenderer;\n  };\n  /**\n   * Gets the collection of selected records.\n   *\n   * @returns {Object[]} returns the Object\n   */\n  Selection.prototype.getSelectedRecords = function () {\n    var selectedData = [];\n    if (!this.selectionSettings.persistSelection && this.selectedRecords.length) {\n      selectedData = this.parent.getRowsObject().filter(function (row) {\n        return row.isSelected;\n      }).map(function (m) {\n        return m.data;\n      });\n    } else {\n      selectedData = this.persistSelectedData;\n    }\n    if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n      selectedData = this.virtualSelectedData;\n    }\n    return selectedData;\n  };\n  /**\n   * Select the column by passing start column index\n   *\n   * @param {number} index - specifies the index\n   * @returns {void}\n   */\n  Selection.prototype.selectColumn = function (index) {\n    var gObj = this.parent;\n    if (isNullOrUndefined(gObj.getColumns()[parseInt(index.toString(), 10)])) {\n      return;\n    }\n    var column = gObj.getColumnByIndex(index);\n    var selectedCol = gObj.getColumnHeaderByUid(column.uid);\n    var isColSelected = selectedCol.classList.contains('e-columnselection');\n    if (!gObj.selectionSettings.allowColumnSelection) {\n      return;\n    }\n    var isMultiColumns = this.selectedColumnsIndexes.length > 1 && this.selectedColumnsIndexes.indexOf(index) > -1;\n    this.clearColDependency();\n    if (!this.selectionSettings.enableToggle || isMultiColumns || !isColSelected) {\n      var args = {\n        columnIndex: index,\n        headerCell: selectedCol,\n        column: column,\n        cancel: false,\n        target: this.actualTarget,\n        isInteracted: this.isInteracted,\n        previousColumnIndex: this.prevColIndex,\n        isCtrlPressed: this.isMultiCtrlRequest,\n        isShiftPressed: this.isMultiShiftRequest\n      };\n      this.onActionBegin(args, events.columnSelecting);\n      if (args.cancel) {\n        this.disableInteracted();\n        return;\n      }\n      if (isMultiColumns || !(isColSelected && gObj.selectionSettings.enableToggle && index === this.prevColIndex)) {\n        this.updateColSelection(selectedCol, index);\n      }\n      var selectedArgs = {\n        columnIndex: index,\n        headerCell: selectedCol,\n        column: column,\n        target: this.actualTarget,\n        isInteracted: this.isInteracted,\n        previousColumnIndex: this.prevColIndex\n      };\n      this.onActionComplete(selectedArgs, events.columnSelected);\n    }\n    this.updateColProps(index);\n  };\n  /**\n   * Select the columns by passing start and end column index\n   *\n   * @param  {number} startIndex - specifies the start index\n   * @param  {number} endIndex - specifies the end index\n   * @returns {void}\n   */\n  Selection.prototype.selectColumnsByRange = function (startIndex, endIndex) {\n    var gObj = this.parent;\n    if (isNullOrUndefined(gObj.getColumns()[parseInt(startIndex.toString(), 10)])) {\n      return;\n    }\n    var indexes = [];\n    if (gObj.selectionSettings.type === 'Single' || isNullOrUndefined(endIndex)) {\n      indexes[0] = startIndex;\n    } else {\n      var min = startIndex < endIndex;\n      for (var i = startIndex; min ? i <= endIndex : i >= endIndex; min ? i++ : i--) {\n        indexes.push(i);\n      }\n    }\n    this.selectColumns(indexes);\n  };\n  /**\n   * Select the columns by passing column indexes\n   *\n   * @param  {number[]} columnIndexes - specifies the columnIndexes\n   * @returns {void}\n   */\n  Selection.prototype.selectColumns = function (columnIndexes) {\n    var gObj = this.parent;\n    var selectedCol = this.getselectedCols();\n    if (gObj.selectionSettings.type === 'Single') {\n      columnIndexes = [columnIndexes[0]];\n    }\n    if (!gObj.selectionSettings.allowColumnSelection) {\n      return;\n    }\n    this.clearColDependency();\n    var selectingArgs = {\n      columnIndex: columnIndexes[0],\n      headerCell: selectedCol,\n      columnIndexes: columnIndexes,\n      column: gObj.getColumnByIndex(columnIndexes[0]),\n      cancel: false,\n      target: this.actualTarget,\n      isInteracted: this.isInteracted,\n      previousColumnIndex: this.prevColIndex,\n      isCtrlPressed: this.isMultiCtrlRequest,\n      isShiftPressed: this.isMultiShiftRequest\n    };\n    this.onActionBegin(selectingArgs, events.columnSelecting);\n    if (selectingArgs.cancel) {\n      this.disableInteracted();\n      return;\n    }\n    for (var i = 0, len = columnIndexes.length; i < len; i++) {\n      this.updateColSelection(gObj.getColumnHeaderByUid(gObj.getColumnByIndex(columnIndexes[parseInt(i.toString(), 10)]).uid), columnIndexes[parseInt(i.toString(), 10)]);\n    }\n    selectedCol = this.getselectedCols();\n    var selectedArgs = {\n      columnIndex: columnIndexes[0],\n      headerCell: selectedCol,\n      columnIndexes: columnIndexes,\n      column: gObj.getColumnByIndex(columnIndexes[0]),\n      target: this.actualTarget,\n      isInteracted: this.isInteracted,\n      previousColumnIndex: this.prevColIndex\n    };\n    this.onActionComplete(selectedArgs, events.columnSelected);\n    this.updateColProps(columnIndexes[0]);\n  };\n  /**\n   * Select the column with existing column by passing column index\n   *\n   * @param  {number} startIndex - specifies the start index\n   * @returns {void}\n   */\n  Selection.prototype.selectColumnWithExisting = function (startIndex) {\n    var gObj = this.parent;\n    if (isNullOrUndefined(gObj.getColumns()[parseInt(startIndex.toString(), 10)])) {\n      return;\n    }\n    var newCol = gObj.getColumnHeaderByUid(gObj.getColumnByIndex(startIndex).uid);\n    var selectedCol = this.getselectedCols();\n    if (gObj.selectionSettings.type === 'Single') {\n      this.clearColDependency();\n    }\n    if (!gObj.selectionSettings.allowColumnSelection) {\n      return;\n    }\n    if (this.selectedColumnsIndexes.indexOf(startIndex) > -1) {\n      this.clearColumnSelection(startIndex);\n    } else {\n      var selectingArgs = {\n        columnIndex: startIndex,\n        headerCell: selectedCol,\n        columnIndexes: this.selectedColumnsIndexes,\n        column: gObj.getColumnByIndex(startIndex),\n        cancel: false,\n        target: this.actualTarget,\n        isInteracted: this.isInteracted,\n        previousColumnIndex: this.prevColIndex,\n        isCtrlPressed: this.isMultiCtrlRequest,\n        isShiftPressed: this.isMultiShiftRequest\n      };\n      this.onActionBegin(selectingArgs, events.columnSelecting);\n      if (selectingArgs.cancel) {\n        this.disableInteracted();\n        return;\n      }\n      this.updateColSelection(newCol, startIndex);\n      selectedCol = this.getselectedCols();\n      var selectedArgs = {\n        columnIndex: startIndex,\n        headerCell: selectedCol,\n        column: gObj.getColumnByIndex(startIndex),\n        columnIndexes: this.selectedColumnsIndexes,\n        target: this.actualTarget,\n        isInteracted: this.isInteracted,\n        previousColumnIndex: this.prevColIndex\n      };\n      this.onActionComplete(selectedArgs, events.columnSelected);\n    }\n    this.updateColProps(startIndex);\n  };\n  /**\n   * Clear the column selection\n   *\n   * @param {number} clearIndex - specifies the clearIndex\n   * @returns {void}\n   */\n  Selection.prototype.clearColumnSelection = function (clearIndex) {\n    if (this.isColumnSelected) {\n      var gObj = this.parent;\n      if (!isNullOrUndefined(clearIndex) && this.selectedColumnsIndexes.indexOf(clearIndex) === -1) {\n        return;\n      }\n      var index = !isNullOrUndefined(clearIndex) ? clearIndex : this.selectedColumnsIndexes[this.selectedColumnsIndexes.length - 1];\n      var column = gObj.getColumnByIndex(index);\n      var selectedCol = gObj.getColumnHeaderByUid(column.uid);\n      var deselectedArgs = {\n        columnIndex: index,\n        headerCell: selectedCol,\n        columnIndexes: this.selectedColumnsIndexes,\n        column: column,\n        cancel: false,\n        target: this.actualTarget,\n        isInteracted: this.isInteracted\n      };\n      var isCanceled = this.columnDeselect(deselectedArgs, events.columnDeselecting);\n      if (isCanceled) {\n        this.disableInteracted();\n        return;\n      }\n      var selectedHeader = !isNullOrUndefined(clearIndex) ? [selectedCol] : [].slice.call(gObj.getHeaderContent().getElementsByClassName('e-columnselection'));\n      var selectedCells = this.getSelectedColumnCells(clearIndex);\n      for (var i = 0, len = selectedHeader.length; i < len; i++) {\n        addRemoveActiveClasses([selectedHeader[parseInt(i.toString(), 10)]], false, 'e-columnselection');\n      }\n      for (var i = 0, len = selectedCells.length; i < len; i++) {\n        addRemoveActiveClasses([selectedCells[parseInt(i.toString(), 10)]], false, 'e-columnselection');\n      }\n      if (!isNullOrUndefined(clearIndex)) {\n        this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(clearIndex), 1);\n        this.parent.getColumns()[parseInt(clearIndex.toString(), 10)].isSelected = false;\n      } else {\n        this.columnDeselect(deselectedArgs, events.columnDeselected);\n        this.selectedColumnsIndexes = [];\n        this.isColumnSelected = false;\n        this.parent.getColumns().filter(function (col) {\n          return col.isSelected = false;\n        });\n      }\n    }\n  };\n  Selection.prototype.getselectedCols = function () {\n    var gObj = this.parent;\n    var selectedCol;\n    if (this.selectedColumnsIndexes.length > 1) {\n      selectedCol = [];\n      for (var i = 0; i < this.selectedColumnsIndexes.length; i++) {\n        selectedCol.push(gObj.getColumnHeaderByUid(gObj.getColumnByIndex(this.selectedColumnsIndexes[parseInt(i.toString(), 10)]).uid));\n      }\n    } else {\n      selectedCol = gObj.getColumnHeaderByUid(gObj.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);\n    }\n    return selectedCol;\n  };\n  Selection.prototype.getSelectedColumnCells = function (clearIndex) {\n    var gObj = this.parent;\n    var isRowTemplate = !isNullOrUndefined(this.parent.rowTemplate);\n    var rows = isRowTemplate ? gObj.getRows() : gObj.getDataRows();\n    var seletedcells = [];\n    var selectionString = !isNullOrUndefined(clearIndex) ? '[aria-colindex=\"' + (clearIndex + 1) + '\"]' : '.e-columnselection';\n    for (var i = 0, len = rows.length; i < len; i++) {\n      seletedcells = seletedcells.concat([].slice.call(rows[parseInt(i.toString(), 10)].querySelectorAll(selectionString)));\n    }\n    return seletedcells;\n  };\n  Selection.prototype.columnDeselect = function (args, event) {\n    if (event === 'columnDeselected') {\n      delete args.cancel;\n    }\n    this.onActionComplete(args, event);\n    return args.cancel;\n  };\n  Selection.prototype.updateColProps = function (startIndex) {\n    this.prevColIndex = startIndex;\n    this.isColumnSelected = this.selectedColumnsIndexes.length && true;\n  };\n  Selection.prototype.clearColDependency = function () {\n    this.clearColumnSelection();\n    this.selectedColumnsIndexes = [];\n  };\n  Selection.prototype.updateColSelection = function (selectedCol, startIndex) {\n    if (isNullOrUndefined(this.parent.getColumns()[parseInt(startIndex.toString(), 10)])) {\n      return;\n    }\n    var isRowTemplate = !isNullOrUndefined(this.parent.rowTemplate);\n    var rows = isRowTemplate ? this.parent.getRows() : this.parent.getDataRows();\n    this.selectedColumnsIndexes.push(startIndex);\n    this.parent.getColumns()[parseInt(startIndex.toString(), 10)].isSelected = true;\n    startIndex = startIndex + this.parent.getIndentCount();\n    addRemoveActiveClasses([selectedCol], true, 'e-columnselection');\n    for (var j = 0, len = rows.length; j < len; j++) {\n      if (rows[parseInt(j.toString(), 10)].classList.contains(literals.row)) {\n        if ((rows[parseInt(j.toString(), 10)].classList.contains(literals.editedRow) || rows[parseInt(j.toString(), 10)].classList.contains(literals.addedRow)) && this.parent.editSettings.mode === 'Normal' && !isNullOrUndefined(rows[parseInt(j.toString(), 10)].querySelector('tr').childNodes[parseInt(startIndex.toString(), 10)])) {\n          addRemoveActiveClasses([rows[parseInt(j.toString(), 10)].querySelector('tr').childNodes[parseInt(startIndex.toString(), 10)]], true, 'e-columnselection');\n        } else {\n          if (this.parent.isSpan && this.parent.isFrozenGrid()) {\n            var cells = rows[parseInt(j.toString(), 10)].querySelectorAll('.e-rowcell');\n            for (var i = 0; i < cells.length; i++) {\n              if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === selectedCol.getAttribute('aria-colindex')) {\n                addRemoveActiveClasses([cells[parseInt(i.toString(), 10)]], true, 'e-columnselection');\n              }\n            }\n          } else if (!isNullOrUndefined(rows[parseInt(j.toString(), 10)].childNodes[parseInt(startIndex.toString(), 10)])) {\n            addRemoveActiveClasses([rows[parseInt(j.toString(), 10)].childNodes[parseInt(startIndex.toString(), 10)]], true, 'e-columnselection');\n          }\n        }\n      }\n    }\n  };\n  Selection.prototype.headerSelectionHandler = function (colIndex) {\n    if (!this.isMultiCtrlRequest && !this.isMultiShiftRequest || this.isSingleSel()) {\n      this.selectColumn(colIndex);\n    } else if (this.isMultiShiftRequest) {\n      this.selectColumnsByRange(isUndefined(this.prevColIndex) ? colIndex : this.prevColIndex, colIndex);\n    } else {\n      this.selectColumnWithExisting(colIndex);\n    }\n  };\n  // eslint-disable-next-line camelcase\n  Selection.prototype.addEventListener_checkbox = function () {\n    var _this = this;\n    this.parent.on(events.dataReady, this.dataReady, this);\n    this.onDataBoundFunction = this.onDataBound.bind(this);\n    this.parent.addEventListener(events.dataBound, this.onDataBoundFunction);\n    this.parent.on(events.refreshInfinitePersistSelection, this.onDataBoundFunction);\n    this.parent.on(events.contentReady, this.checkBoxSelectionChanged, this);\n    this.parent.on(events.beforeRefreshOnDataChange, this.initPerisistSelection, this);\n    this.parent.on(events.onEmpty, this.setCheckAllForEmptyGrid, this);\n    this.actionCompleteFunc = this.actionCompleteHandler.bind(this);\n    this.parent.addEventListener(events.actionComplete, this.actionCompleteFunc);\n    this.parent.on(events.click, this.clickHandler, this);\n    this.resizeEndFn = function () {\n      _this.updateAutoFillPosition();\n      _this.drawBorders();\n    };\n    this.resizeEndFn.bind(this);\n    this.parent.addEventListener(events.resizeStop, this.resizeEndFn);\n  };\n  // eslint-disable-next-line camelcase\n  Selection.prototype.removeEventListener_checkbox = function () {\n    this.parent.off(events.dataReady, this.dataReady);\n    this.parent.removeEventListener(events.dataBound, this.onDataBoundFunction);\n    this.parent.removeEventListener(events.actionComplete, this.actionCompleteFunc);\n    this.parent.off(events.refreshInfinitePersistSelection, this.onDataBoundFunction);\n    this.parent.off(events.onEmpty, this.setCheckAllForEmptyGrid);\n    this.parent.off(events.click, this.clickHandler);\n    this.parent.removeEventListener(events.resizeStop, this.resizeEndFn);\n    this.parent.off(events.beforeRefreshOnDataChange, this.initPerisistSelection);\n  };\n  Selection.prototype.setCheckAllForEmptyGrid = function () {\n    var checkAllBox = this.getCheckAllBox();\n    if (checkAllBox) {\n      this.parent.isCheckBoxSelection = true;\n      var spanEle = checkAllBox.nextElementSibling;\n      removeClass([spanEle], ['e-check', 'e-stop', 'e-uncheck']);\n      addClass([spanEle.parentElement], ['e-checkbox-disabled']);\n    }\n  };\n  Selection.prototype.dataReady = function (e) {\n    this.isHeaderCheckboxClicked = false;\n    var isInfinitecroll = this.parent.enableInfiniteScrolling && e.requestType === 'infiniteScroll';\n    if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection && !isInfinitecroll) {\n      this.disableUI = !this.parent.enableImmutableMode && !(e.requestType === 'save' && e['action'] === 'add');\n      this.clearSelection();\n      this.setCheckAllState();\n      this.disableUI = false;\n    }\n  };\n  Selection.prototype.actionCompleteHandler = function (e) {\n    if (e.requestType === 'save' && this.parent.isPersistSelection) {\n      this.refreshPersistSelection();\n    }\n  };\n  Selection.prototype.selectRowIndex = function (index) {\n    this.parent.isSelectedRowIndexUpdating = true;\n    if (isNullOrUndefined(this.parent.selectedRowIndex) || this.parent.selectedRowIndex === -1 || !this.parent.enablePersistence) {\n      this.parent.selectedRowIndex = index;\n    } else {\n      this.parent.selectedRowIndex = -1;\n    }\n  };\n  Selection.prototype.disableInteracted = function () {\n    this.isInteracted = false;\n  };\n  Selection.prototype.activeTarget = function () {\n    this.actualTarget = this.isInteracted ? this.actualTarget : null;\n  };\n  return Selection;\n}();\nexport { Selection };","map":{"version":3,"names":["Browser","EventHandler","createElement","isNullOrUndefined","isUndefined","addClass","removeClass","remove","closest","select","DataManager","setCssInGridPopUp","getPosition","isGroupAdaptive","addRemoveActiveClasses","removeAddCboxClasses","getCellFromRow","getCellsByTableName","parentsUntil","getScrollBarWidth","events","RenderType","iterateExtend","setChecked","isComplexField","getObject","addRemoveEventListener","literals","Selection","parent","selectionSettings","locator","selectedRowIndexes","selectedRowCellIndexes","selectedRecords","preventFocus","selectedColumnsIndexes","checkBoxState","isMultiShiftRequest","isMultiCtrlRequest","isMultiCtrlRequestCell","enableSelectMultiTouch","clearRowCheck","selectRowCheck","selectedRowState","unSelectedRowState","totalRecordsCount","chkAllCollec","isCheckedOnAdd","persistSelectedData","virtualSelectedData","deSelectedData","isHdrSelectAllClicked","needColumnSelection","isCancelDeSelect","isPreventCellSelect","disableUI","isPersisted","cmdKeyPressed","cellselected","isMultiSelection","isAddRowsToSelection","initialRowSelection","isPrevRowSelection","isKeyAction","isRowDragSelected","isPartialSelection","rmtHdrChkbxClicked","isCheckboxReset","isRowDeselect","autoFillRLselection","isFocusLastCell","bottom","top","right_bottom","bottom_left","top_right","top_left","top_bottom","top_right_bottom","top_bottom_left","top_right_left","right_bottom_left","all_border","factory","getService","focus","addEventListener","wireEvents","prototype","initializeSelection","log","render","onActionBegin","args","type","trigger","fDataUpdate","cellIndex","rowIndex","rowObj","getRowObj","currentIndex","foreignKeyData","onActionComplete","getModuleName","destroy","gridElement","element","querySelector","gridHeader","gridContent","hidePopUp","clearSelection","destroyAutoFillElements","removeEventListener","unWireEvents","getContent","mouseDownHandler","getHeaderContent","isEditing","editSettings","mode","editModule","formObj","validate","isEdit","showAddNewRow","isPersistSelection","getCurrentBatchRecordChanges","gObj","currentRecords","getCurrentViewRecords","newRowPosition","concat","getBatchChanges","addedRecords","deletedRecords","primaryKey","getPrimaryKeyFieldNames","i","length","j","parseInt","toString","splice","enableVirtualization","groupSettings","columns","selectedGroupedData","filter","col","undefined","selectRow","index","isToggle","enableSimpleMultiRowSelection","addRowsToSelection","selectedRow","getRowByIndex","getRowObjectFromUID","getAttribute","isDataRow","isSelectable","selectData","isRemoved","e","selectedIndex","isAvailable","notify","selectVirtualRow","data","persistSelection","prevSelectedData","getSelectedRecords","clearRowSelection","isRowType","isRowSelected","hasAttribute","activeTarget","isCheckboxModeResetOnRowClick","checkboxMode","isSelectionTypeMultiple","isCheckBoxSelection","indexOf","can","isCtrlPressed","isShiftPressed","row","previousRow","prevRowIndex","previousRowIndex","target","actualTarget","cancel","isInteracted","isHeaderCheckboxClicked","rowSelecting","rowSelectingCallBack","rowDeselect","rowDeselecting","selectRowIndex","rowDeselected","_this","disableInteracted","toggle","removed","clearSelectedRow","selectRowCallBack","clearRow","updateRowSelection","isHeaderCheckBoxClicked","rowIndexes","rowSelected","updateRowProps","selectRowsByRange","startIndex","endIndex","selectRows","getCollectionFromIndexes","selectedDataUpdate","selectedData","selectedRows","selectableRowIndex","len","currentRow","getDataRows","push","slice","isSingleSel","prevRow","getRows","allowRowDragAndDrop","isDragged","selectRowFn","_i","selectableRowIndex_1","rowIdx","checkVirtualCheckBox","virtualCheckBoxData","Object","keys","map","key","setCheckAllState","selectionData","allData","record","indexes","getSelectedRowIndexes","checkboxOnly","checkboxColumn","getColumns","rowIndexes_1","isUnSelected","enableToggle","removeAttribute","addRemoveClassesForRow","_a","max","reverse","clearRowCallBack","checkAllRows","selectedEle","updatePersistCollection","updateCheckBoxes","getPkValue","pkField","chkState","ensureCheckboxFieldSelection","pKey_1","isSelected","some","updatePersistDelete","pKey","isPresent","partialSelectedRecords","chkBox","nextElementSibling","checkedTarget","classList","contains","setAttribute","isFocusFirstCell","getPrevIndexes","cells","contextMenuModule","mouseButton","cell","selector","onClick","checkSelectAllClicked","span","disableSelectedRecords","rowObjects","getRowsObject","clearCellSelection","clearColumnSelection","prevCIdxs","prevECIdxs","rows_1","data_1","row_1","rowIndex_1","foreignKeyData_1","target_1","enableInfiniteScrolling","infiniteScrollSettings","enableCache","isRowClicked","getCheckAllStatus","updatePersistSelectedData","call","mRow","rowDeselectCallBack","frozenRightRow","currentInfo","cancl_1","isSingleDeSel","rowDeselectObj","rowInString","target_2","rowidx","rowidxex","dataTxt","foreignKey","isHeaderCheckBxClick","selectCell","isCellType","selectedCell","getCellFromIndex","getColIndex","isCellSelected","previousRowCell","getCellIndex","currentCell","previousRowCellIndex","cellSelecting","successCallBack","cellSelectingArgs","cncl","clearCell","updateCellSelection","selectedRowCellIndex","updateCellProps","cellSelected","rIdx","cIdx","selectCellsByRange","isSpan","min","stIndex","edIndex","cellIndexes","temp","cellSelectionMode","getLastColIndex","addAttribute","cellSelectedArgs","selectCells","rowCellIndexes","cellSelectArgs","cellLen","addRowCellIndex","prvRowCellIndex","addCellsToSelection","hideAutoFill","parentElement","cellIndexes_1","idx","selectedCellIdx","cellDeselect","cellDeselecting","cellDeselected","getColumnByIndex","m","colIndex","ariaColIndex","querySelectorAll","cancl","cells_1","gridChkBox","add","rowCellIndex","isRowAvail","selectedCells","getSelectedCellsElement","rowCell","currentViewData","cLen","bdrElement","showHideBorders","rows","getElementsByClassName","mouseMoveHandler","preventDefault","stopTimer","gBRect","getBoundingClientRect","x1","x","y1","y","position","x2","left","y2","tmp","isCellDrag","document","elementFromPoint","offsetLeft","clientY","style","width","height","ctrlKey","shiftKey","ariaRowIndex","startDIndex","td","startAFCell","startCell","endAFCell","selectLikeExcel","enableColumnVirtualization","updateScrollPosition","mouseEvent","scrollElement","clientRect","enableRtl","timer1","window","setInterval","setScrollPosition","firstElementChild","clientWidth","getRowHeight","timer2","clientHeight","scrollWidth","offsetWidth","clearInterval","direction","columnIndex","isAutoFillSel","frozenRows","scrollTop","offsetHeight","scrollHeight","nextElement_1","findNextCell","scrollLeft","currentElement","nextElement","positionAFBorders","mouseEvent_1","siblingEles","nextEleInd","Array","from","startDCellIndex","drawBorders","showAFBorders","selectLikeAutoFill","setFrozenBorders","parentEle","border","bdrStr","borderWidth","split","strCell","ele","display","fixedCells","isRtl","firstRowIdx","firstColIdx","lastRowIdx","lastColIdx","colIdx","preCell","children","nextCell","refreshFrozenBorders","getContentTable","isFrozenGrid","getFrozenMode","leftRight","frcBdrElement","getHeaderTable","fhBdrElement","frhBdrElement","createBorders","positionBorders","isLastCell","isLastRow","tbody","isFirstRow","isFirstCell","setBorders","isFrozen","start","end","stOff","endOff","parentOff","offsetParent","rowHeight","topOffSet","leftOffset","rightOffset","right","selectDirection","updateStartEndCells","mcBdrElement","mhBdrElement","applyBorders","applyBothFrozenBorders","str","rtl","includes","selectionBorder","className","id","cssText","appendChild","middleContentBorder","frozenRightContentBorder","frozenHeaderBorder","middleHeaderBorder","frozenRightHeaderBorder","freeze","drawAFBorders","bdrAFBottom","createAFBorders","bdrAFLeft","firstCellTop","movableContent","firstCellLeft","movableHeader","parentRect","sTop","sLeft","offsetTop","totalHeight","allowPaging","aggregates","getFooterContent","totalWidth","Math","floor","bdrAFRight","bdrAFTop","leftRemove","scrolloffSet","borderAFRightValue","parseFloat","topRemove","leftSelectionBorder","rightSelectionBorder","bottomSelectionBorder","topSelectionBorder","autofill","hideAFBorders","updateValue","createBeforeAutoFill","updateCell","field","value","column","innerText","beforeAutoFill","getAutoFillCells","startCellIdx","cls","isApply","startrowIdx","endrowIdx","endCellIdx","rowLen","colLen","cellIdx","endCell","c","startCellIndex","trIdx","r","mouseUpHandler","body","mUPTarget","closeRowCell","updateAutoFillPosition","lastCell","updateStartCellsIndex","refreshFooterRenderer","enableAutoFill","rindex","isFrozenCol","getFreezeTableName","isFrozenRow","isFrozenRight","frozenRight","table","colWidth","button","isDrag","headerContent","editedRow","enableDrag","isUpdate","tr","postion","clearSelAfterRefresh","isInfiniteScroll","requestType","pkValue","isDestroyed","evtHandlers","event","uiUpdate","handler","enableAfterRender","initialEnd","rowSelectionComplete","cellSelectionComplete","inBoundModelChanged","onPropertyChanged","cellFocused","onCellFocused","beforeFragAppend","columnPositionChanged","contentReady","rowsRemoved","headerRefreshed","refreshHeader","actionBeginFunction","actionBegin","bind","actionCompleteFunction","actionComplete","addEventListener_checkbox","removeEventListener_checkbox","off","isMacOS","navigator","userAgent","keyDownHandler","keyUpHandler","allowKeyboard","getDataModule","isRemote","gridCurrentRecord","getData","records","getCheckAllBox","module","enable","initPerisistSelection","properties","prevColIndex","checkBoxSelectionChanged","selectedRowIndex","gobj","chkField","pageSettings","dataBind","dataSuccess","dataSource","result","renderModule","dataManager","json","res","checkedFieldData","setRowSelection","state","rowObj_1","_b","_c","selectedData_1","selectedStateKeys","unSelectedRowStateKeys","rowData","_d","rowData_1","executeLocal","generateQuery","getAvailableSelectedData","filteredSearchedSelectedData","refreshPersistSelection","checkState","editChkBox","checked","action","onDataBound","getSelectedRows","totalRecords","checkSelectAllAction","cRenderer","getRenderer","editForm","getVirtualRowIndex","checkSelectAll","checkBox","stateStr","updateSelectedRowIndexes","triggerChkChangeEvent","classes","status","DOMTokenList","checkSelect","rIndex","uid","addedRow","rowCellSelectionHandler","moveIntoUncheckCollection","checkBoxChange","rowObj_2","rowObj_3","updateSelectedRowIndex","dataLength","selectedVal","isAllSelected","count","totalDataRecordsCount","pageSize","isSelectAllRowCount","someDataSelected","searchSettings","filterSettings","isInteraction","checkToSelectAll","isFiltered","checkedLen","isArray","input","spanEle","indeterminate","getRecord","setSelection","rowCount","dataLen","disableSelectedRecordsCount","partialSelectedRecordsCount","selectedRowCount","info","name","keyCode","targetHeadCell","targetRowCell","isCheckBox","clickHandler","allowColumnSelection","metaKey","popUpClickHandler","chkSelect","checkWrap","isReact","isEqualNode","isDevice","showPopup","headerSelectionHandler","getColumnIndexByUid","isChkBox","find","checkboxColumnIndexCheck","container","isHeader","byKey","keyArgs","allowFiltering","isJump","tagName","Number","clear","isContent","headerAction","prev","hdrLength","childElementCount","getKeyColIndex","targetLabel","innerHTML","applyDownUpKey","applyRightLeftKey","shiftDownKey","applyShiftLeftRightKey","applyHomeEndKey","applyCtrlHomeEndKey","clipboardModule","writeText","ctrlPlusA","applySpaceSelection","allowNextRowEdit","stackedHeader","innerColumn","getstackedColumns","getColumnByUid","lastIndex","firstIndex","applyUpDown","selectColumn","cIndex","contentRenderer","selectColumnsByRange","innerColumnIndexes","isAdd","clearAll","arguments","detailIndentCell","dragdropIndentCell","apply","Content","selectedCol","getColumnHeaderByUid","isColSelected","isMultiColumns","clearColDependency","headerCell","previousColumnIndex","columnSelecting","updateColSelection","selectedArgs","columnSelected","updateColProps","selectColumns","columnIndexes","getselectedCols","selectingArgs","selectColumnWithExisting","newCol","clearIndex","isColumnSelected","deselectedArgs","isCanceled","columnDeselect","columnDeselecting","selectedHeader","getSelectedColumnCells","columnDeselected","isRowTemplate","rowTemplate","seletedcells","selectionString","getIndentCount","childNodes","on","dataReady","onDataBoundFunction","dataBound","refreshInfinitePersistSelection","beforeRefreshOnDataChange","onEmpty","setCheckAllForEmptyGrid","actionCompleteFunc","actionCompleteHandler","click","resizeEndFn","resizeStop","checkAllBox","isInfinitecroll","enableImmutableMode","isSelectedRowIndexUpdating","enablePersistence"],"sources":["D:/weektable/frontend/node_modules/@syncfusion/ej2-grids/src/grid/actions/selection.js"],"sourcesContent":["import { Browser, EventHandler, createElement } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, isUndefined, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { remove, closest, select } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { setCssInGridPopUp, getPosition, isGroupAdaptive, addRemoveActiveClasses, removeAddCboxClasses, getCellFromRow } from '../base/util';\nimport { getCellsByTableName, parentsUntil, getScrollBarWidth } from '../base/util';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { iterateExtend, setChecked, isComplexField, getObject } from '../base/util';\nimport { addRemoveEventListener } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * The `Selection` module is used to handle cell and row selection.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Grid selection module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {SelectionSettings} selectionSettings - specifies the selectionsettings\n     * @param {ServiceLocator} locator - specifies the ServiceLocator\n     * @hidden\n     */\n    function Selection(parent, selectionSettings, locator) {\n        //Internal letiables\n        /**\n         * @hidden\n         */\n        this.selectedRowIndexes = [];\n        /**\n         * @hidden\n         */\n        this.selectedRowCellIndexes = [];\n        /**\n         * @hidden\n         */\n        this.selectedRecords = [];\n        /**\n         * @hidden\n         */\n        this.preventFocus = false;\n        /**\n         *  @hidden\n         */\n        this.selectedColumnsIndexes = [];\n        this.checkBoxState = false;\n        this.isMultiShiftRequest = false;\n        this.isMultiCtrlRequest = false;\n        this.isMultiCtrlRequestCell = false;\n        this.enableSelectMultiTouch = false;\n        this.clearRowCheck = false;\n        this.selectRowCheck = false;\n        /**\n         * @hidden\n         */\n        this.selectedRowState = {};\n        this.unSelectedRowState = {};\n        this.totalRecordsCount = 0;\n        this.chkAllCollec = [];\n        this.isCheckedOnAdd = false;\n        this.persistSelectedData = [];\n        this.virtualSelectedData = [];\n        this.deSelectedData = [];\n        this.isHdrSelectAllClicked = false;\n        this.needColumnSelection = false;\n        this.isCancelDeSelect = false;\n        this.isPreventCellSelect = false;\n        this.disableUI = false;\n        this.isPersisted = false;\n        this.cmdKeyPressed = false;\n        this.cellselected = false;\n        this.isMultiSelection = false;\n        this.isAddRowsToSelection = false;\n        this.initialRowSelection = false;\n        this.isPrevRowSelection = false;\n        this.isKeyAction = false;\n        this.isRowDragSelected = false;\n        this.isPartialSelection = false;\n        this.rmtHdrChkbxClicked = false;\n        this.isCheckboxReset = false;\n        this.isRowDeselect = false;\n        /**\n         * @hidden\n         */\n        this.autoFillRLselection = true;\n        this.isFocusLastCell = false;\n        this.bottom = '0 0 2px 0';\n        this.top = '2px 0 0 0';\n        /* eslint-disable */\n        this.right_bottom = '0 2px 2px 0';\n        this.bottom_left = '0 0 2px 2px';\n        this.top_right = '2px 2px 0 0';\n        this.top_left = '2px 0 0 2px';\n        this.top_bottom = '2px 0 2px 0';\n        this.top_right_bottom = '2px 2px 2px 0';\n        this.top_bottom_left = '2px 0 2px 2px';\n        this.top_right_left = '2px 2px 0 2px';\n        this.right_bottom_left = '0 2px 2px 2px';\n        this.all_border = '2px';\n        this.parent = parent;\n        this.selectionSettings = selectionSettings;\n        this.factory = locator.getService('rendererFactory');\n        this.focus = locator.getService('focus');\n        this.addEventListener();\n        this.wireEvents();\n    }\n    Selection.prototype.initializeSelection = function () {\n        this.parent.log('selection_key_missing');\n        this.render();\n    };\n    /**\n     * The function used to trigger onActionBegin\n     *\n     * @param {Object} args - specifies the args\n     * @param {string} type - specifies the type\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.onActionBegin = function (args, type) {\n        this.parent.trigger(type, this.fDataUpdate(args));\n    };\n    Selection.prototype.fDataUpdate = function (args) {\n        if (!this.isMultiSelection && (!isNullOrUndefined(args.cellIndex) || !isNullOrUndefined(args.rowIndex))) {\n            var rowObj = this.getRowObj(isNullOrUndefined(args.rowIndex) ? isNullOrUndefined(args.cellIndex) ?\n                this.currentIndex : args.cellIndex.rowIndex : args.rowIndex);\n            args.foreignKeyData = rowObj.foreignKeyData;\n        }\n        return args;\n    };\n    /**\n     * The function used to trigger onActionComplete\n     *\n     * @param {Object} args - specifies the args\n     * @param {string} type - specifies the type\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.onActionComplete = function (args, type) {\n        this.parent.trigger(type, this.fDataUpdate(args));\n        this.isMultiSelection = false;\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    /**\n     * To destroy the selection\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent))) {\n            return;\n        }\n        this.hidePopUp();\n        this.clearSelection();\n        this.destroyAutoFillElements();\n        this.removeEventListener();\n        this.unWireEvents();\n        EventHandler.remove(this.parent.getContent(), 'mousedown', this.mouseDownHandler);\n        EventHandler.remove(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler);\n    };\n    Selection.prototype.isEditing = function () {\n        return (this.parent.editSettings.mode === 'Normal' || (this.parent.editSettings.mode === 'Batch' && this.parent.editModule &&\n            this.parent.editModule.formObj && !this.parent.editModule.formObj.validate())) &&\n            (this.parent.isEdit && !this.parent.editSettings.showAddNewRow) && !this.parent.isPersistSelection;\n    };\n    Selection.prototype.getCurrentBatchRecordChanges = function () {\n        var gObj = this.parent;\n        if (gObj.editSettings.mode === 'Batch' && gObj.editModule) {\n            var currentRecords = iterateExtend(this.parent.getCurrentViewRecords());\n            currentRecords = gObj.editSettings.newRowPosition === 'Bottom' ?\n                currentRecords.concat(this.parent.editModule.getBatchChanges()[literals.addedRecords]) :\n                this.parent.editModule.getBatchChanges()[literals.addedRecords].concat(currentRecords);\n            var deletedRecords = this.parent.editModule.getBatchChanges()[literals.deletedRecords];\n            var primaryKey = this.parent.getPrimaryKeyFieldNames()[0];\n            for (var i = 0; i < (deletedRecords.length); i++) {\n                for (var j = 0; j < currentRecords.length; j++) {\n                    if (deletedRecords[parseInt(i.toString(), 10)][\"\" + primaryKey] === currentRecords[parseInt(j.toString(), 10)][\"\" + primaryKey]) {\n                        currentRecords.splice(j, 1);\n                        break;\n                    }\n                }\n            }\n            return currentRecords;\n        }\n        else if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length && !this.parent.isPersistSelection) {\n            var selectedGroupedData = gObj.getCurrentViewRecords().filter(function (col) { return col['key'] === undefined; });\n            return selectedGroupedData;\n        }\n        else {\n            return gObj.getCurrentViewRecords();\n        }\n    };\n    /**\n     * Selects a row by the given index.\n     *\n     * @param  {number} index - Defines the row index.\n     * @param  {boolean} isToggle - If set to true, then it toggles the selection.\n     * @returns {void}\n     */\n    Selection.prototype.selectRow = function (index, isToggle) {\n        if (this.selectedRowIndexes.length && this.selectionSettings.enableSimpleMultiRowSelection) {\n            this.addRowsToSelection([index]);\n            return;\n        }\n        var gObj = this.parent;\n        var selectedRow = gObj.getRowByIndex(index);\n        var rowObj = selectedRow && gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid'));\n        if (this.isPartialSelection && rowObj && rowObj.isDataRow && !rowObj.isSelectable) {\n            return;\n        }\n        var selectData;\n        var isRemoved = false;\n        if (gObj.enableVirtualization && index > -1) {\n            var e = { selectedIndex: index, isAvailable: true };\n            this.parent.notify(events.selectVirtualRow, e);\n            if (selectedRow && (gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid')))) {\n                selectData = gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid')).data;\n            }\n            else {\n                if (e.isAvailable && !gObj.selectionSettings.persistSelection) {\n                    var prevSelectedData = this.parent.getSelectedRecords();\n                    if (prevSelectedData.length > 0) {\n                        this.clearRowSelection();\n                    }\n                }\n                return;\n            }\n        }\n        else {\n            selectData = this.getRowObj(index).data;\n        }\n        if (!this.isRowType() || !selectedRow || this.isEditing()) {\n            // if (this.isEditing()) {\n            //     gObj.selectedRowIndex = index;\n            // }\n            return;\n        }\n        var isRowSelected = selectedRow.hasAttribute('aria-selected');\n        this.activeTarget();\n        if (!isToggle || !this.selectedRowIndexes.length) {\n            isToggle = false;\n        }\n        else {\n            var isCheckboxModeResetOnRowClick = this.selectionSettings.checkboxMode === 'ResetOnRowClick';\n            var isSelectionTypeMultiple = !this.parent.isCheckBoxSelection && this.selectionSettings.type === 'Multiple';\n            if ((!isCheckboxModeResetOnRowClick && !isSelectionTypeMultiple) ||\n                (this.selectedRowIndexes.length === 1 && (isCheckboxModeResetOnRowClick || isSelectionTypeMultiple))) {\n                isToggle = !(this.isKeyAction && this.parent.isCheckBoxSelection) ? this.selectedRowIndexes.indexOf(index) !== -1 : false;\n            }\n            else {\n                isToggle = false;\n            }\n        }\n        this.isKeyAction = false;\n        var args;\n        var can = 'cancel';\n        if (!isToggle) {\n            args = {\n                data: selectData, rowIndex: index, isCtrlPressed: this.isMultiCtrlRequest,\n                isShiftPressed: this.isMultiShiftRequest, row: selectedRow,\n                previousRow: gObj.getRowByIndex(this.prevRowIndex),\n                previousRowIndex: this.prevRowIndex, target: this.actualTarget, cancel: false, isInteracted: this.isInteracted,\n                isHeaderCheckboxClicked: this.isHeaderCheckboxClicked\n            };\n            this.parent.trigger(events.rowSelecting, this.fDataUpdate(args), this.rowSelectingCallBack(args, isToggle, index, selectData, isRemoved, isRowSelected, can));\n        }\n        else {\n            if (this.selectionSettings.checkboxMode !== 'ResetOnRowClick' && this.selectionSettings.persistSelection) {\n                this.rowDeselect(events.rowDeselecting, [rowObj.index], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], this.actualTarget);\n                if (this.isCancelDeSelect) {\n                    return;\n                }\n                if (!this.parent.isCheckBoxSelection) {\n                    this.selectedRowIndexes = [];\n                    this.selectedRecords = [];\n                    this.isRowSelected = false;\n                    this.selectRowIndex(-1);\n                }\n                this.rowDeselect(events.rowDeselected, [rowObj.index], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], this.actualTarget, undefined, undefined, undefined);\n            }\n            this.rowSelectingCallBack(args, isToggle, index, selectData, isRemoved, isRowSelected, can)(args);\n        }\n    };\n    Selection.prototype.rowSelectingCallBack = function (args, isToggle, index, selectData, isRemoved, isRowSelected, can) {\n        var _this = this;\n        return function (args) {\n            if (!isNullOrUndefined(args) && args[\"\" + can] === true) {\n                _this.disableInteracted();\n                return;\n            }\n            _this.index = index;\n            _this.toggle = isToggle;\n            _this.data = selectData;\n            _this.removed = isRemoved;\n            if (isRowSelected && _this.selectionSettings.persistSelection && !(_this.selectionSettings.checkboxMode === 'ResetOnRowClick')) {\n                _this.clearSelectedRow(index);\n                _this.selectRowCallBack();\n            }\n            else if (!isRowSelected && _this.selectionSettings.persistSelection && _this.parent.isCheckBoxSelection &&\n                _this.selectionSettings.checkboxMode !== 'ResetOnRowClick') {\n                _this.selectRowCallBack();\n            }\n            if (_this.selectionSettings.checkboxMode === 'ResetOnRowClick') {\n                _this.isCheckboxReset = true;\n                _this.clearSelection();\n            }\n            if (!_this.selectionSettings.persistSelection || _this.selectionSettings.checkboxMode === 'ResetOnRowClick' ||\n                (!_this.parent.isCheckBoxSelection && _this.selectionSettings.persistSelection)) {\n                _this.selectRowCheck = true;\n                _this.clearRow();\n            }\n        };\n    };\n    Selection.prototype.selectRowCallBack = function () {\n        var gObj = this.parent;\n        var args;\n        var index = this.index;\n        var isToggle = this.toggle;\n        var selectData = this.data;\n        var isRemoved = this.removed;\n        var selectedRow = gObj.getRowByIndex(index);\n        if (!isToggle && !isRemoved) {\n            if (this.selectedRowIndexes.indexOf(index) <= -1) {\n                this.updateRowSelection(selectedRow, index);\n            }\n            this.selectRowIndex(index);\n        }\n        if (!isToggle) {\n            args = {\n                data: selectData, rowIndex: index,\n                row: selectedRow, previousRow: gObj.getRowByIndex(this.prevRowIndex),\n                previousRowIndex: this.prevRowIndex, target: this.actualTarget, isInteracted: this.isInteracted,\n                isHeaderCheckBoxClicked: this.isHeaderCheckboxClicked, rowIndexes: index\n            };\n            this.onActionComplete(args, events.rowSelected);\n        }\n        this.isInteracted = false;\n        this.updateRowProps(index);\n    };\n    /**\n     * Selects a range of rows from start and end row indexes.\n     *\n     * @param  {number} startIndex - Specifies the start row index.\n     * @param  {number} endIndex - Specifies the end row index.\n     * @returns {void}\n     */\n    Selection.prototype.selectRowsByRange = function (startIndex, endIndex) {\n        this.selectRows(this.getCollectionFromIndexes(startIndex, endIndex));\n        this.selectRowIndex(endIndex);\n    };\n    Selection.prototype.selectedDataUpdate = function (selectedData, foreignKeyData, selectedRows, rowIndexes, selectableRowIndex) {\n        for (var i = 0, len = rowIndexes.length; i < len; i++) {\n            var currentRow = this.parent.getDataRows()[rowIndexes[parseInt(i.toString(), 10)]];\n            if (this.parent.enableVirtualization) {\n                currentRow = this.parent.getRowByIndex(rowIndexes[parseInt(i.toString(), 10)]);\n            }\n            var rowObj = this.getRowObj(currentRow);\n            if (rowObj && rowObj.isDataRow && rowObj.isSelectable) {\n                selectedData.push(rowObj.data);\n                selectedRows.push(currentRow);\n                foreignKeyData.push(rowObj.foreignKeyData);\n            }\n            else {\n                if (this.isPartialSelection && selectableRowIndex) {\n                    selectableRowIndex.splice(selectableRowIndex.indexOf(rowIndexes[parseInt(i.toString(), 10)]), 1);\n                }\n            }\n        }\n    };\n    /**\n     * Selects a collection of rows by index.\n     *\n     * @param  {number[]} rowIndexes - Specifies an array of row indexes.\n     * @returns {void}\n     */\n    Selection.prototype.selectRows = function (rowIndexes) {\n        var _this = this;\n        var gObj = this.parent;\n        var selectableRowIndex = rowIndexes.slice();\n        var rowIndex = !this.isSingleSel() ? rowIndexes[0] : rowIndexes[rowIndexes.length - 1];\n        this.isMultiSelection = true;\n        var selectedRows = [];\n        var foreignKeyData = [];\n        var can = 'cancel';\n        var selectedData = [];\n        if (!this.isRowType() || this.isEditing()) {\n            return;\n        }\n        this.selectedDataUpdate(selectedData, foreignKeyData, selectedRows, rowIndexes, selectableRowIndex);\n        this.activeTarget();\n        var args = {\n            cancel: false,\n            rowIndexes: selectableRowIndex, row: selectedRows, rowIndex: rowIndex, target: this.actualTarget,\n            prevRow: gObj.getRows()[this.prevRowIndex], previousRowIndex: this.prevRowIndex,\n            isInteracted: this.isInteracted, isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest,\n            data: selectedData, isHeaderCheckboxClicked: this.isHeaderCheckboxClicked, foreignKeyData: foreignKeyData\n        };\n        this.parent.trigger(events.rowSelecting, this.fDataUpdate(args), function (args) {\n            if (!isNullOrUndefined(args) && args[\"\" + can] === true) {\n                _this.disableInteracted();\n                return;\n            }\n            if (!(_this.selectionSettings.persistSelection && gObj.allowRowDragAndDrop && _this.isDragged)) {\n                _this.clearRow();\n            }\n            _this.selectRowIndex(selectableRowIndex.slice(-1)[0]);\n            var selectRowFn = function (index, preventFocus) {\n                _this.updateRowSelection(gObj.getRowByIndex(index), index, preventFocus);\n                _this.updateRowProps(rowIndex);\n            };\n            if (!_this.isSingleSel()) {\n                for (var _i = 0, selectableRowIndex_1 = selectableRowIndex; _i < selectableRowIndex_1.length; _i++) {\n                    var rowIdx = selectableRowIndex_1[_i];\n                    selectRowFn(rowIdx, gObj.enableVirtualization ? true : false);\n                }\n            }\n            else {\n                selectRowFn(rowIndex);\n            }\n            if (_this.checkVirtualCheckBox() && !_this.parent.isPersistSelection) {\n                if (selectableRowIndex.length === _this.totalRecordsCount) {\n                    _this.virtualSelectedData = _this.virtualCheckBoxData().slice();\n                    _this.selectedRowIndexes = Object.keys(_this.virtualSelectedData).map(function (key) { return parseInt(key, 10); });\n                    _this.setCheckAllState();\n                }\n                else {\n                    var selectionData = selectableRowIndex.filter(function (index) {\n                        return _this.selectedRowIndexes.indexOf(index) === -1;\n                    });\n                    if (selectionData.length > 0) {\n                        var allData = _this.virtualCheckBoxData().slice();\n                        for (var i = 0; i < selectionData.length; i++) {\n                            var record = allData[selectionData[i]];\n                            if (!isNullOrUndefined(record)) {\n                                _this.virtualSelectedData.push(record);\n                                _this.selectedRowIndexes.push(selectionData[i]);\n                            }\n                        }\n                        _this.setCheckAllState();\n                    }\n                }\n            }\n            args = {\n                rowIndexes: selectableRowIndex, row: selectedRows, rowIndex: rowIndex, target: _this.actualTarget,\n                prevRow: gObj.getRows()[_this.prevRowIndex], previousRowIndex: _this.prevRowIndex,\n                data: _this.getSelectedRecords(), isInteracted: _this.isInteracted,\n                isHeaderCheckboxClicked: _this.isHeaderCheckboxClicked, foreignKeyData: foreignKeyData\n            };\n            if (_this.isRowSelected) {\n                _this.onActionComplete(args, events.rowSelected);\n            }\n            _this.isInteracted = false;\n        });\n    };\n    /**\n     * Select rows with existing row selection by passing row indexes.\n     *\n     * @param {number} rowIndexes - Specifies the row indexes.\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.addRowsToSelection = function (rowIndexes) {\n        var gObj = this.parent;\n        var can = 'cancel';\n        var target = this.target;\n        this.isMultiSelection = true;\n        var selectedRows = [];\n        var foreignKeyData = [];\n        var selectedData = [];\n        var indexes = gObj.getSelectedRowIndexes().concat(rowIndexes);\n        var selectedRow = !this.isSingleSel() ? gObj.getRowByIndex(rowIndexes[0]) :\n            gObj.getRowByIndex(rowIndexes[rowIndexes.length - 1]);\n        if ((!this.isRowType() || this.isEditing()) && !this.selectionSettings.checkboxOnly) {\n            return;\n        }\n        var args;\n        var checkboxColumn = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (this.isMultiCtrlRequest && !checkboxColumn.length) {\n            this.selectedDataUpdate(selectedData, foreignKeyData, selectedRows, indexes);\n        }\n        for (var _i = 0, rowIndexes_1 = rowIndexes; _i < rowIndexes_1.length; _i++) {\n            var rowIndex = rowIndexes_1[_i];\n            var rowObj = this.getRowObj(rowIndex);\n            var isUnSelected = this.selectedRowIndexes.indexOf(rowIndex) > -1;\n            if (this.isPartialSelection && rowObj && rowObj.isDataRow && !rowObj.isSelectable) {\n                continue;\n            }\n            this.selectRowIndex(rowIndex);\n            if (isUnSelected && ((checkboxColumn.length ? true : this.selectionSettings.enableToggle) || this.isMultiCtrlRequest)) {\n                this.isAddRowsToSelection = true;\n                this.rowDeselect(events.rowDeselecting, [rowIndex], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], target);\n                if (this.isCancelDeSelect) {\n                    return;\n                }\n                if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n                    this.virtualSelectedData.splice(this.virtualSelectedData.indexOf(rowObj.data), 1);\n                }\n                this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(rowIndex), 1);\n                this.selectedRecords.splice(this.selectedRecords.indexOf(selectedRow), 1);\n                this.selectRowIndex(this.selectedRowIndexes.length ? this.selectedRowIndexes[this.selectedRowIndexes.length - 1] : -1);\n                selectedRow.removeAttribute('aria-selected');\n                this.addRemoveClassesForRow(selectedRow, false, null, 'e-selectionbackground', 'e-active');\n                this.rowDeselect(events.rowDeselected, [rowIndex], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], target, undefined, undefined, undefined);\n                this.isInteracted = false;\n                this.isMultiSelection = false;\n                this.isAddRowsToSelection = false;\n                this.isHdrSelectAllClicked = false;\n            }\n            else {\n                this.activeTarget();\n                args = {\n                    cancel: false,\n                    data: selectedData.length ? selectedData : rowObj.data, rowIndex: rowIndex, row: selectedRows.length ? selectedRows :\n                        selectedRow, target: this.actualTarget, prevRow: gObj.getRows()[this.prevRowIndex],\n                    previousRowIndex: this.prevRowIndex, isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest,\n                    foreignKeyData: foreignKeyData.length ? foreignKeyData : rowObj.foreignKeyData, isInteracted: this.isInteracted,\n                    isHeaderCheckboxClicked: this.isHeaderCheckboxClicked, rowIndexes: indexes\n                };\n                this.parent.trigger(events.rowSelecting, this.fDataUpdate(args));\n                if (!isNullOrUndefined(args) && args[\"\" + can] === true) {\n                    this.disableInteracted();\n                    return;\n                }\n                if (this.isSingleSel()) {\n                    this.clearRow();\n                }\n                this.updateRowSelection(selectedRow, rowIndex);\n            }\n            if (!isUnSelected) {\n                args = {\n                    data: selectedData.length ? selectedData : rowObj.data, rowIndex: rowIndex, row: selectedRows.length ? selectedRows :\n                        selectedRow, target: this.actualTarget, prevRow: gObj.getRows()[this.prevRowIndex],\n                    previousRowIndex: this.prevRowIndex, foreignKeyData: foreignKeyData.length ? foreignKeyData : rowObj.foreignKeyData,\n                    isInteracted: this.isInteracted, isHeaderCheckboxClicked: this.isHeaderCheckboxClicked, rowIndexes: indexes\n                };\n                this.onActionComplete(args, events.rowSelected);\n            }\n            this.isInteracted = false;\n            this.updateRowProps(rowIndex);\n            if (this.isSingleSel()) {\n                break;\n            }\n        }\n    };\n    Selection.prototype.getCollectionFromIndexes = function (startIndex, endIndex) {\n        var indexes = [];\n        // eslint-disable-next-line prefer-const\n        var _a = (startIndex <= endIndex) ?\n            { i: startIndex, max: endIndex } : { i: endIndex, max: startIndex }, i = _a.i, max = _a.max;\n        for (; i <= max; i++) {\n            indexes.push(i);\n        }\n        if (startIndex > endIndex) {\n            indexes.reverse();\n        }\n        return indexes;\n    };\n    Selection.prototype.clearRow = function () {\n        this.clearRowCheck = true;\n        this.clearRowSelection();\n    };\n    Selection.prototype.clearRowCallBack = function () {\n        if (this.isCancelDeSelect && this.parent.checkAllRows !== 'Check') {\n            return;\n        }\n        this.selectedRowIndexes = [];\n        this.selectedRecords = [];\n        this.selectRowIndex(-1);\n        if (this.isSingleSel() && this.parent.isPersistSelection) {\n            this.selectedRowState = {};\n        }\n    };\n    Selection.prototype.clearSelectedRow = function (index) {\n        if (this.toggle) {\n            var selectedEle = this.parent.getRowByIndex(index);\n            if (!this.disableUI) {\n                selectedEle.removeAttribute('aria-selected');\n                this.addRemoveClassesForRow(selectedEle, false, true, 'e-selectionbackground', 'e-active');\n            }\n            this.removed = true;\n            this.updatePersistCollection(selectedEle, false);\n            this.updateCheckBoxes(selectedEle);\n            this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(index), 1);\n            this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(index)), 1);\n        }\n    };\n    Selection.prototype.updateRowProps = function (startIndex) {\n        this.prevRowIndex = startIndex;\n        this.isRowSelected = this.selectedRowIndexes.length && true;\n    };\n    Selection.prototype.getPkValue = function (pkField, data) {\n        return pkField ? isComplexField(pkField) ? getObject(pkField, data) : data[\"\" + pkField] : data[\"\" + pkField];\n    };\n    Selection.prototype.updatePersistCollection = function (selectedRow, chkState) {\n        var _this = this;\n        if ((this.parent.isPersistSelection || this.parent.selectionSettings.persistSelection &&\n            this.parent.getPrimaryKeyFieldNames().length > 0) && !isNullOrUndefined(selectedRow)) {\n            if (!this.parent.isPersistSelection) {\n                this.ensureCheckboxFieldSelection();\n            }\n            var rowObj = this.getRowObj(selectedRow);\n            var pKey_1 = rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null;\n            if (pKey_1 === null) {\n                return;\n            }\n            rowObj.isSelected = chkState;\n            if ((chkState && !this.isPartialSelection) || (this.isPartialSelection && rowObj.isSelectable && rowObj.isSelected)) {\n                this.selectedRowState[\"\" + pKey_1] = chkState;\n                delete (this.unSelectedRowState[\"\" + pKey_1]);\n                if (!this.persistSelectedData.some(function (data) { return _this.getPkValue(_this.primaryKey, data) === pKey_1; })) {\n                    this.persistSelectedData.push(rowObj.data);\n                }\n            }\n            else {\n                this.updatePersistDelete(pKey_1);\n            }\n        }\n    };\n    Selection.prototype.updatePersistDelete = function (pKey, isPartialSelection) {\n        var _this = this;\n        delete (this.selectedRowState[\"\" + pKey]);\n        if (this.rmtHdrChkbxClicked) {\n            this.unSelectedRowState[\"\" + pKey] = true;\n        }\n        var index;\n        var isPresent = this.persistSelectedData.some(function (data, i) {\n            index = i;\n            return _this.getPkValue(_this.primaryKey, data) === pKey;\n        });\n        if (isPresent) {\n            this.persistSelectedData.splice(index, 1);\n            if (isPartialSelection) {\n                this.parent.partialSelectedRecords.splice(index, 1);\n            }\n        }\n    };\n    Selection.prototype.updateCheckBoxes = function (row, chkState, rowIndex) {\n        if (!isNullOrUndefined(row)) {\n            var chkBox = row.querySelector('.e-checkselect');\n            if (!isNullOrUndefined(chkBox)) {\n                removeAddCboxClasses(chkBox.nextElementSibling, chkState);\n                setChecked(chkBox, chkState);\n                if (isNullOrUndefined(this.checkedTarget) || (!isNullOrUndefined(this.checkedTarget)\n                    && !this.checkedTarget.classList.contains('e-checkselectall'))) {\n                    this.setCheckAllState(rowIndex);\n                }\n            }\n        }\n    };\n    Selection.prototype.updateRowSelection = function (selectedRow, startIndex, preventFocus) {\n        if (!selectedRow) {\n            return;\n        }\n        if (this.selectedRowIndexes.indexOf(startIndex) === -1) {\n            if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n                this.virtualSelectedData.push(this.parent.getRowObjectFromUID(selectedRow.getAttribute('data-uid')).data);\n            }\n            this.selectedRowIndexes.push(startIndex);\n            this.selectedRecords.push(selectedRow);\n        }\n        selectedRow.setAttribute('aria-selected', 'true');\n        this.updatePersistCollection(selectedRow, true);\n        this.updateCheckBoxes(selectedRow, true);\n        this.addRemoveClassesForRow(selectedRow, true, null, 'e-selectionbackground', 'e-active');\n        if (!this.preventFocus || this.parent.isFocusFirstCell || this.isFocusLastCell) {\n            var target = this.focus.getPrevIndexes().cellIndex ?\n                selectedRow.cells[this.focus.getPrevIndexes().cellIndex] :\n                selectedRow.querySelector('.e-selectionbackground:not(.e-hide, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop)');\n            if (this.parent.contextMenuModule && this.mouseButton === 2) {\n                target = this.parent.contextMenuModule.cell;\n            }\n            if (this.parent.isFocusFirstCell || this.isFocusLastCell) {\n                this.parent.isFocusFirstCell = false;\n                var selector = this.isFocusLastCell ? 'last-child' : 'first-child';\n                target = selectedRow.querySelector('.e-selectionbackground.e-rowcell:not(.e-hide, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop, .e-gridchkbox):' + selector);\n                this.isFocusLastCell = false;\n            }\n            if (!target || preventFocus) {\n                return;\n            }\n            this.focus.onClick({ target: target }, true, !(this.parent.contextMenuModule && this.mouseButton === 2));\n        }\n    };\n    /**\n     * Deselects the currently selected rows and cells.\n     *\n     * @returns {void}\n     */\n    Selection.prototype.clearSelection = function () {\n        this.checkSelectAllClicked = true;\n        if (this.selectionSettings.persistSelection && this.persistSelectedData.length) {\n            this.deSelectedData = iterateExtend(this.persistSelectedData);\n        }\n        if (!this.parent.isPersistSelection || (this.parent.isPersistSelection && !this.parent.isEdit) ||\n            (!isNullOrUndefined(this.checkedTarget) && this.checkedTarget.classList.contains('e-checkselectall'))) {\n            var span = this.parent.element.querySelector('.e-gridpopup').querySelector('span');\n            if (span.classList.contains('e-rowselect')) {\n                span.classList.remove('e-spanclicked');\n            }\n            if (this.parent.isPersistSelection) {\n                this.persistSelectedData = [];\n                this.selectedRowState = {};\n                this.parent.partialSelectedRecords = [];\n                this.parent.disableSelectedRecords = [];\n                var rowObjects = this.parent.getRowsObject();\n                for (var i = 0; i < rowObjects.length; i++) {\n                    if (rowObjects[i].isDataRow) {\n                        if (rowObjects[i].isSelectable) {\n                            this.parent.partialSelectedRecords.push(rowObjects[i].data);\n                        }\n                        else {\n                            this.parent.disableSelectedRecords.push(rowObjects[i].data);\n                        }\n                    }\n                }\n            }\n            this.clearRowSelection();\n            this.clearCellSelection();\n            this.clearColumnSelection();\n            this.prevRowIndex = undefined;\n            this.prevCIdxs = undefined;\n            this.prevECIdxs = undefined;\n            this.enableSelectMultiTouch = false;\n            if (!(this.selectionSettings.checkboxMode === 'ResetOnRowClick' && this.target && parentsUntil(this.target, 'e-rowcell'))) {\n                this.isInteracted = false;\n            }\n            this.checkSelectAllClicked = false;\n            this.isHdrSelectAllClicked = false;\n        }\n    };\n    /**\n     * Deselects the currently selected rows.\n     *\n     * @returns {void}\n     */\n    Selection.prototype.clearRowSelection = function () {\n        var _this = this;\n        if (this.isRowSelected) {\n            var rows_1 = this.parent.getDataRows();\n            var data_1 = [];\n            var row_1 = [];\n            var rowIndex_1 = [];\n            var foreignKeyData_1 = [];\n            var target_1 = this.target;\n            this.isRowDeselect = true;\n            for (var i = 0, len = this.selectedRowIndexes.length; i < len; i++) {\n                var currentRow = void 0;\n                if (this.parent.enableVirtualization || (this.parent.enableInfiniteScrolling\n                    && this.parent.infiniteScrollSettings.enableCache)) {\n                    currentRow = this.parent.getRowByIndex(this.selectedRowIndexes[parseInt(i.toString(), 10)]);\n                }\n                else {\n                    currentRow = this.parent.editSettings.mode === 'Batch' ?\n                        this.parent.getRows()[this.selectedRowIndexes[parseInt(i.toString(), 10)]]\n                        : this.parent.getDataRows()[this.selectedRowIndexes[parseInt(i.toString(), 10)]];\n                }\n                var rowObj = this.getRowObj(currentRow);\n                if (rowObj) {\n                    data_1.push(rowObj.data);\n                    row_1.push(currentRow);\n                    rowIndex_1.push(this.selectedRowIndexes[parseInt(i.toString(), 10)]);\n                    foreignKeyData_1.push(rowObj.foreignKeyData);\n                }\n            }\n            if (this.selectionSettings.persistSelection && this.selectionSettings.checkboxMode !== 'ResetOnRowClick') {\n                this.isRowClicked = this.checkSelectAllClicked ? true : false;\n            }\n            this.rowDeselect(events.rowDeselecting, rowIndex_1, data_1, row_1, foreignKeyData_1, target_1, null, function () {\n                if (_this.isCancelDeSelect && (_this.isRowClicked || _this.checkSelectAllClicked || (_this.isInteracted &&\n                    !_this.parent.isPersistSelection))) {\n                    if (_this.parent.isPersistSelection) {\n                        if (_this.getCheckAllStatus(_this.parent.element.querySelector('.e-checkselectall')) === 'Intermediate' || _this.parent.isPersistSelection) {\n                            for (var i = 0; i < _this.selectedRecords.length; i++) {\n                                _this.updatePersistCollection(_this.selectedRecords[parseInt(i.toString(), 10)], true);\n                            }\n                        }\n                        else {\n                            _this.parent.checkAllRows = 'Check';\n                            _this.updatePersistSelectedData(true);\n                        }\n                    }\n                    if (_this.clearRowCheck) {\n                        _this.clearRowCallBack();\n                        _this.clearRowCheck = false;\n                        if (_this.selectRowCheck) {\n                            _this.selectRowCallBack();\n                            _this.selectRowCheck = false;\n                        }\n                    }\n                    return;\n                }\n                var element = [].slice.call(rows_1.filter(function (record) { return record.hasAttribute('aria-selected'); }));\n                for (var j = 0; j < element.length; j++) {\n                    if (!_this.disableUI) {\n                        element[parseInt(j.toString(), 10)].removeAttribute('aria-selected');\n                        _this.addRemoveClassesForRow(element[parseInt(j.toString(), 10)], false, true, 'e-selectionbackground', 'e-active');\n                    }\n                    // tslint:disable-next-line:align\n                    if (!_this.isPrevRowSelection) {\n                        _this.updatePersistCollection(element[parseInt(j.toString(), 10)], false);\n                    }\n                    _this.updateCheckBoxes(element[parseInt(j.toString(), 10)]);\n                }\n                if ((_this.parent.enableVirtualization || (_this.parent.enableInfiniteScrolling\n                    && _this.parent.infiniteScrollSettings.enableCache)) && _this.selectedRecords.length && !element.length\n                    && !_this.parent.selectionSettings.persistSelection && !_this.disableUI\n                    && !_this.parent.isCheckBoxSelection) {\n                    _this.addRemoveClassesForRow(null, false, true);\n                }\n                _this.virtualSelectedData = [];\n                _this.selectedRowIndexes = [];\n                _this.selectedRecords = [];\n                _this.isRowSelected = false;\n                _this.selectRowIndex(-1);\n                _this.isPrevRowSelection = false;\n                _this.rowDeselect(events.rowDeselected, rowIndex_1, data_1, row_1, foreignKeyData_1, target_1, null, undefined, null);\n                if (_this.clearRowCheck) {\n                    _this.clearRowCallBack();\n                    _this.clearRowCheck = false;\n                    if (_this.selectRowCheck) {\n                        _this.selectRowCallBack();\n                        _this.selectRowCheck = false;\n                    }\n                }\n            }, null);\n            this.isRowDeselect = false;\n        }\n        else {\n            if (this.clearRowCheck) {\n                this.clearRowCallBack();\n                this.clearRowCheck = false;\n                if (this.selectRowCheck) {\n                    this.selectRowCallBack();\n                    this.selectRowCheck = false;\n                }\n            }\n        }\n    };\n    Selection.prototype.rowDeselect = function (type, rowIndex, data, row, \n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    foreignKeyData, target, mRow, rowDeselectCallBack, frozenRightRow) {\n        var _this = this;\n        if ((this.selectionSettings.persistSelection && (this.isRowClicked || !this.isRowDeselect || this.checkSelectAllClicked || (this.focus['activeKey'] &&\n            this.focus.currentInfo.element.classList.contains('e-gridchkbox') && this.focus['activeKey'] === 'space'))) ||\n            !this.selectionSettings.persistSelection) {\n            var cancl_1 = 'cancel';\n            var isSingleDeSel = rowIndex.length === 1 && this.deSelectedData.length === 1;\n            var rowDeselectObj = {\n                rowIndex: rowIndex[0], data: this.selectionSettings.persistSelection && (this.parent.checkAllRows === 'Uncheck' &&\n                    !isSingleDeSel) && this.selectionSettings.checkboxMode !== 'ResetOnRowClick' ? this.deSelectedData : data,\n                foreignKeyData: foreignKeyData, cancel: false, isInteracted: this.isInteracted,\n                isHeaderCheckboxClicked: this.isHeaderCheckboxClicked\n            };\n            if (type === 'rowDeselected') {\n                delete rowDeselectObj.cancel;\n            }\n            var rowInString = 'row';\n            var target_2 = 'target';\n            var rowidx = 'rowIndex';\n            var rowidxex = 'rowIndexes';\n            var dataTxt = 'data';\n            var foreignKey = 'foreignKeyData';\n            rowDeselectObj[\"\" + rowInString] = row;\n            rowDeselectObj[\"\" + target_2] = this.actualTarget;\n            var isHeaderCheckBxClick = this.actualTarget && !isNullOrUndefined(closest(this.actualTarget, 'thead'));\n            if (isHeaderCheckBxClick || rowIndex.length > 1) {\n                rowDeselectObj[\"\" + rowidx] = rowIndex[0];\n                rowDeselectObj[\"\" + rowidxex] = rowIndex;\n            }\n            else if (rowIndex.length === 1) {\n                rowDeselectObj[\"\" + dataTxt] = rowDeselectObj[\"\" + dataTxt][0];\n                rowDeselectObj[\"\" + rowInString] = rowDeselectObj[\"\" + rowInString][0];\n                rowDeselectObj[\"\" + foreignKey] = rowDeselectObj[\"\" + foreignKey][0];\n                if (this.isAddRowsToSelection) {\n                    rowDeselectObj[\"\" + rowidxex] = rowIndex;\n                }\n            }\n            this.parent.trigger(type, rowDeselectObj, function (args) {\n                _this.isCancelDeSelect = args[\"\" + cancl_1];\n                if (!_this.isCancelDeSelect || (!_this.isRowClicked && !_this.isInteracted && !_this.checkSelectAllClicked)) {\n                    _this.updatePersistCollection(row[0], false);\n                    _this.updateCheckBoxes(row[0], undefined, rowIndex[0]);\n                }\n                if (rowDeselectCallBack !== undefined) {\n                    rowDeselectCallBack();\n                }\n            });\n        }\n        else if (this.selectionSettings.persistSelection && !this.isInteracted) {\n            if (rowDeselectCallBack !== undefined) {\n                rowDeselectCallBack();\n            }\n        }\n    };\n    Selection.prototype.getRowObj = function (row) {\n        if (row === void 0) { row = this.currentIndex; }\n        if (isNullOrUndefined(row)) {\n            return {};\n        }\n        if (typeof row === 'number') {\n            row = this.parent.getRowByIndex(row);\n        }\n        if (row) {\n            return this.parent.getRowObjectFromUID(row.getAttribute('data-uid')) || {};\n        }\n        return {};\n    };\n    /**\n     * Selects a cell by the given index.\n     *\n     * @param  {IIndex} cellIndex - Defines the row and column indexes.\n     * @param  {boolean} isToggle - If set to true, then it toggles the selection.\n     * @returns {void}\n     */\n    Selection.prototype.selectCell = function (cellIndex, isToggle) {\n        if (!this.isCellType() || (this.isCellType() && (this.parent.enableVirtualization ||\n            (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache)))) {\n            return;\n        }\n        var gObj = this.parent;\n        var args;\n        var selectedCell = gObj.getCellFromIndex(cellIndex.rowIndex, this.getColIndex(cellIndex.rowIndex, cellIndex.cellIndex));\n        this.currentIndex = cellIndex.rowIndex;\n        var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n        if (!this.isCellType() || !selectedCell || this.isEditing()) {\n            return;\n        }\n        var isCellSelected = selectedCell.classList.contains('e-cellselectionbackground');\n        isToggle = !isToggle ? isToggle : (!isUndefined(this.prevCIdxs) &&\n            cellIndex.rowIndex === this.prevCIdxs.rowIndex && cellIndex.cellIndex === this.prevCIdxs.cellIndex &&\n            isCellSelected);\n        if (!isToggle) {\n            args = {\n                data: selectedData, cellIndex: cellIndex,\n                isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest,\n                previousRowCell: this.prevECIdxs ?\n                    this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined,\n                cancel: false\n            };\n            var currentCell = 'currentCell';\n            args[\"\" + currentCell] = selectedCell;\n            var previousRowCellIndex = 'previousRowCellIndex';\n            args[\"\" + previousRowCellIndex] = this.prevECIdxs;\n            this.parent.trigger(events.cellSelecting, this.fDataUpdate(args), this.successCallBack(args, isToggle, cellIndex, selectedCell, selectedData));\n            this.cellselected = true;\n        }\n        else {\n            this.successCallBack(args, isToggle, cellIndex, selectedCell, selectedData)(args);\n        }\n    };\n    Selection.prototype.successCallBack = function (cellSelectingArgs, isToggle, cellIndex, selectedCell, selectedData) {\n        var _this = this;\n        return function (cellSelectingArgs) {\n            var cncl = 'cancel';\n            var currentCell = 'currentCell';\n            if (!isNullOrUndefined(cellSelectingArgs) && cellSelectingArgs[\"\" + cncl] === true) {\n                return;\n            }\n            if (!isToggle) {\n                cellSelectingArgs[\"\" + currentCell] = cellSelectingArgs[\"\" + currentCell] ? cellSelectingArgs[\"\" + currentCell] : selectedCell;\n            }\n            _this.clearCell();\n            if (!isToggle) {\n                _this.updateCellSelection(selectedCell, cellIndex.rowIndex, cellIndex.cellIndex);\n            }\n            if (!isToggle) {\n                var args = {\n                    data: selectedData, cellIndex: cellIndex, currentCell: selectedCell,\n                    selectedRowCellIndex: _this.selectedRowCellIndexes,\n                    previousRowCell: _this.prevECIdxs ?\n                        _this.getCellIndex(_this.prevECIdxs.rowIndex, _this.prevECIdxs.cellIndex) : undefined\n                };\n                var previousRowCellIndex = 'previousRowCellIndex';\n                args[\"\" + previousRowCellIndex] = _this.prevECIdxs;\n                _this.updateCellProps(cellIndex, cellIndex);\n                _this.onActionComplete(args, events.cellSelected);\n            }\n        };\n    };\n    Selection.prototype.getCellIndex = function (rIdx, cIdx) {\n        return this.parent.getCellFromIndex(rIdx, cIdx);\n    };\n    /**\n     * Selects a range of cells from start and end indexes.\n     *\n     * @param  {IIndex} startIndex - Specifies the row and column's start index.\n     * @param  {IIndex} endIndex - Specifies the row and column's end index.\n     * @returns {void}\n     */\n    Selection.prototype.selectCellsByRange = function (startIndex, endIndex) {\n        var _this = this;\n        if (!this.isCellType()) {\n            return;\n        }\n        var gObj = this.parent;\n        var selectedCell = this.parent.isSpan ? getCellFromRow(this.parent, startIndex.rowIndex, startIndex.cellIndex) :\n            gObj.getCellFromIndex(startIndex.rowIndex, startIndex.cellIndex);\n        var min;\n        var max;\n        var stIndex = startIndex;\n        var edIndex = endIndex = endIndex ? endIndex : startIndex;\n        var cellIndexes;\n        this.currentIndex = startIndex.rowIndex;\n        var cncl = 'cancel';\n        var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n        if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n            return;\n        }\n        var args = {\n            data: selectedData, cellIndex: startIndex, currentCell: selectedCell,\n            isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest,\n            previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n        };\n        var previousRowCellIndex = 'previousRowCellIndex';\n        args[\"\" + previousRowCellIndex] = this.prevECIdxs;\n        this.parent.trigger(events.cellSelecting, this.fDataUpdate(args), function (cellSelectingArgs) {\n            if (!isNullOrUndefined(cellSelectingArgs) && cellSelectingArgs[\"\" + cncl] === true) {\n                return;\n            }\n            _this.clearCell();\n            if (startIndex.rowIndex > endIndex.rowIndex) {\n                var temp = startIndex;\n                startIndex = endIndex;\n                endIndex = temp;\n            }\n            for (var i = startIndex.rowIndex; i <= endIndex.rowIndex; i++) {\n                if (_this.selectionSettings.cellSelectionMode.indexOf('Box') < 0) {\n                    min = i === startIndex.rowIndex ? (startIndex.cellIndex) : 0;\n                    max = i === endIndex.rowIndex ? (endIndex.cellIndex) : _this.getLastColIndex(i);\n                }\n                else {\n                    min = startIndex.cellIndex;\n                    max = endIndex.cellIndex;\n                }\n                cellIndexes = [];\n                for (var j = min < max ? min : max, len = min > max ? min : max; j <= len; j++) {\n                    selectedCell = _this.parent.isSpan ? getCellFromRow(gObj, i, j) : gObj.getCellFromIndex(i, j);\n                    if (!selectedCell) {\n                        continue;\n                    }\n                    cellIndexes.push(j);\n                    _this.updateCellSelection(selectedCell);\n                    _this.addAttribute(selectedCell);\n                }\n                _this.selectedRowCellIndexes.push({ rowIndex: i, cellIndexes: cellIndexes });\n            }\n            var cellSelectedArgs = {\n                data: selectedData, cellIndex: edIndex, currentCell: gObj.getCellFromIndex(edIndex.rowIndex, edIndex.cellIndex),\n                selectedRowCellIndex: _this.selectedRowCellIndexes,\n                previousRowCell: _this.prevECIdxs ? _this.getCellIndex(_this.prevECIdxs.rowIndex, _this.prevECIdxs.cellIndex) : undefined\n            };\n            var previousRowCellIndex = 'previousRowCellIndex';\n            cellSelectedArgs[\"\" + previousRowCellIndex] = _this.prevECIdxs;\n            if (!_this.isDragged) {\n                _this.onActionComplete(cellSelectedArgs, events.cellSelected);\n                _this.cellselected = true;\n            }\n            _this.updateCellProps(stIndex, edIndex);\n        });\n    };\n    /**\n     * Selects a collection of cells by row and column indexes.\n     *\n     * @param  {ISelectedCell[]} rowCellIndexes - Specifies the row and column indexes.\n     * @returns {void}\n     */\n    Selection.prototype.selectCells = function (rowCellIndexes) {\n        if (!this.isCellType()) {\n            return;\n        }\n        var gObj = this.parent;\n        var selectedCell = gObj.getCellFromIndex(rowCellIndexes[0].rowIndex, rowCellIndexes[0].cellIndexes[0]);\n        this.currentIndex = rowCellIndexes[0].rowIndex;\n        var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n        if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n            return;\n        }\n        var cellSelectArgs = {\n            data: selectedData, cellIndex: rowCellIndexes[0].cellIndexes[0],\n            currentCell: selectedCell, isCtrlPressed: this.isMultiCtrlRequest,\n            isShiftPressed: this.isMultiShiftRequest,\n            previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n        };\n        var previousRowCellIndex = 'previousRowCellIndex';\n        cellSelectArgs[\"\" + previousRowCellIndex] = this.prevECIdxs;\n        this.onActionBegin(cellSelectArgs, events.cellSelecting);\n        for (var i = 0, len = rowCellIndexes.length; i < len; i++) {\n            for (var j = 0, cellLen = rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes.length; j < cellLen; j++) {\n                selectedCell = gObj.getCellFromIndex(rowCellIndexes[parseInt(i.toString(), 10)].rowIndex, rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)]);\n                if (!selectedCell) {\n                    continue;\n                }\n                this.updateCellSelection(selectedCell);\n                this.addAttribute(selectedCell);\n                this.addRowCellIndex({ rowIndex: rowCellIndexes[parseInt(i.toString(), 10)].rowIndex,\n                    cellIndex: rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)] });\n            }\n        }\n        this.updateCellProps({ rowIndex: rowCellIndexes[0].rowIndex, cellIndex: rowCellIndexes[0].cellIndexes[0] }, { rowIndex: rowCellIndexes[0].rowIndex, cellIndex: rowCellIndexes[0].cellIndexes[0] });\n        var cellSelectedArgs = {\n            data: selectedData, cellIndex: rowCellIndexes[0].cellIndexes[0],\n            currentCell: selectedCell, selectedRowCellIndex: this.selectedRowCellIndexes,\n            previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n        };\n        var prvRowCellIndex = 'previousRowCellIndex';\n        cellSelectedArgs[\"\" + prvRowCellIndex] = this.prevECIdxs;\n        this.onActionComplete(cellSelectedArgs, events.cellSelected);\n    };\n    /**\n     * Select cells with existing cell selection by passing row and column index.\n     *\n     * @param {IIndex} cellIndexes - Defines the collection of row and column index.\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.addCellsToSelection = function (cellIndexes) {\n        if (!this.isCellType() || (this.isCellType() && (this.parent.enableVirtualization ||\n            (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache)))) {\n            return;\n        }\n        var gObj = this.parent;\n        var selectedCell;\n        var index;\n        this.currentIndex = cellIndexes[0].rowIndex;\n        var cncl = 'cancel';\n        var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n        if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n            return;\n        }\n        this.hideAutoFill();\n        var rowObj;\n        rowObj = gObj.getRowsObject()[cellIndexes[0].rowIndex];\n        if (gObj.groupSettings.columns.length > 0) {\n            rowObj = gObj.getRowObjectFromUID(this.target.parentElement.getAttribute('data-uid'));\n        }\n        var foreignKeyData = [];\n        for (var _i = 0, cellIndexes_1 = cellIndexes; _i < cellIndexes_1.length; _i++) {\n            var cellIndex = cellIndexes_1[_i];\n            for (var i = 0, len = this.selectedRowCellIndexes.length; i < len; i++) {\n                if (this.selectedRowCellIndexes[parseInt(i.toString(), 10)].rowIndex === cellIndex.rowIndex) {\n                    index = i;\n                    break;\n                }\n            }\n            selectedCell = gObj.getCellFromIndex(cellIndex.rowIndex, this.getColIndex(cellIndex.rowIndex, cellIndex.cellIndex));\n            var idx = cellIndex.cellIndex;\n            if (gObj.groupSettings.columns.length > 0) {\n                foreignKeyData.push(rowObj.cells[idx + gObj.groupSettings.columns.length].foreignKeyData);\n            }\n            else {\n                foreignKeyData.push(rowObj.cells[parseInt(idx.toString(), 10)].foreignKeyData);\n            }\n            var args = {\n                cancel: false, data: selectedData, cellIndex: cellIndexes[0],\n                isShiftPressed: this.isMultiShiftRequest,\n                currentCell: selectedCell, isCtrlPressed: this.isMultiCtrlRequest,\n                previousRowCell: this.prevECIdxs ?\n                    gObj.getCellFromIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n            };\n            var prvRowCellIndex = 'previousRowCellIndex';\n            args[\"\" + prvRowCellIndex] = this.prevECIdxs;\n            var isUnSelected = index > -1;\n            if (isUnSelected) {\n                var selectedCellIdx = this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes;\n                if (selectedCellIdx.indexOf(cellIndex.cellIndex) > -1 || (this.selectionSettings.mode === 'Both' &&\n                    selectedCell.classList.contains('e-gridchkbox') && !selectedCell.getAttribute('aria-selected'))) {\n                    this.cellDeselect(events.cellDeselecting, [{ rowIndex: cellIndex.rowIndex, cellIndexes: [cellIndex.cellIndex] }], selectedData, [selectedCell], foreignKeyData);\n                    selectedCellIdx.splice(selectedCellIdx.indexOf(cellIndex.cellIndex), 1);\n                    if (selectedCellIdx.length === 0) {\n                        this.selectedRowCellIndexes.splice(index, 1);\n                    }\n                    selectedCell.classList.remove('e-cellselectionbackground');\n                    selectedCell.removeAttribute('aria-selected');\n                    this.cellDeselect(events.cellDeselected, [{ rowIndex: cellIndex.rowIndex, cellIndexes: [cellIndex.cellIndex] }], selectedData, [selectedCell], foreignKeyData);\n                }\n                else {\n                    isUnSelected = false;\n                    this.onActionBegin(args, events.cellSelecting);\n                    this.addRowCellIndex({ rowIndex: cellIndex.rowIndex, cellIndex: cellIndex.cellIndex });\n                    this.updateCellSelection(selectedCell);\n                    this.addAttribute(selectedCell);\n                }\n            }\n            else {\n                this.onActionBegin(args, events.cellSelecting);\n                if (!isNullOrUndefined(args) && args[\"\" + cncl] === true) {\n                    return;\n                }\n                this.updateCellSelection(selectedCell, cellIndex.rowIndex, cellIndex.cellIndex);\n            }\n            if (!isUnSelected) {\n                var cellSelectedArgs = {\n                    data: selectedData, cellIndex: cellIndexes[0], currentCell: selectedCell,\n                    previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) :\n                        undefined, selectedRowCellIndex: this.selectedRowCellIndexes\n                };\n                cellSelectedArgs[\"\" + prvRowCellIndex] = this.prevECIdxs;\n                this.onActionComplete(cellSelectedArgs, events.cellSelected);\n                this.cellselected = true;\n            }\n            this.updateCellProps(cellIndex, cellIndex);\n        }\n    };\n    Selection.prototype.getColIndex = function (rowIndex, index) {\n        var col = this.parent.getColumnByIndex(index);\n        var cells = getCellsByTableName(this.parent, col, rowIndex);\n        if (cells) {\n            for (var m = 0; m < cells.length; m++) {\n                var colIndex = parseInt(cells[parseInt(m.toString(), 10)].getAttribute(literals.ariaColIndex), 10) - 1;\n                if (colIndex === index) {\n                    return m;\n                }\n            }\n        }\n        return -1;\n    };\n    Selection.prototype.getLastColIndex = function (rowIndex) {\n        var cells = this.parent.getDataRows()[parseInt(rowIndex.toString(), 10)].querySelectorAll('td.e-rowcell');\n        return parseInt(cells[cells.length - 1].getAttribute(literals.ariaColIndex), 10) - 1;\n    };\n    Selection.prototype.clearCell = function () {\n        this.clearCellSelection();\n    };\n    Selection.prototype.cellDeselect = function (type, cellIndexes, data, cells, foreignKeyData) {\n        var cancl = 'cancel';\n        if (cells && cells.length > 0) {\n            for (var _i = 0, cells_1 = cells; _i < cells_1.length; _i++) {\n                var cell = cells_1[_i];\n                if (cell && cell.classList.contains(literals.gridChkBox)) {\n                    this.updateCheckBoxes(closest(cell, 'tr'));\n                }\n            }\n        }\n        var args = {\n            cells: cells, data: data, cellIndexes: cellIndexes, foreignKeyData: foreignKeyData, cancel: false\n        };\n        this.parent.trigger(type, args);\n        this.isPreventCellSelect = args[\"\" + cancl];\n    };\n    Selection.prototype.updateCellSelection = function (selectedCell, rowIndex, cellIndex) {\n        if (!isNullOrUndefined(rowIndex)) {\n            this.addRowCellIndex({ rowIndex: rowIndex, cellIndex: cellIndex });\n        }\n        selectedCell.classList.add('e-cellselectionbackground');\n        if (selectedCell.classList.contains(literals.gridChkBox)) {\n            this.updateCheckBoxes(closest(selectedCell, 'tr'), true);\n        }\n        this.addAttribute(selectedCell);\n    };\n    Selection.prototype.addAttribute = function (cell) {\n        this.target = cell;\n        if (!isNullOrUndefined(cell)) {\n            cell.setAttribute('aria-selected', 'true');\n            if (!this.preventFocus) {\n                this.focus.onClick({ target: cell }, true, true);\n            }\n        }\n    };\n    Selection.prototype.updateCellProps = function (startIndex, endIndex) {\n        this.prevCIdxs = startIndex;\n        this.prevECIdxs = endIndex;\n        this.isCellSelected = this.selectedRowCellIndexes.length && true;\n    };\n    Selection.prototype.addRowCellIndex = function (rowCellIndex) {\n        var isRowAvail;\n        var index;\n        for (var i = 0, len = this.selectedRowCellIndexes.length; i < len; i++) {\n            if (this.selectedRowCellIndexes[parseInt(i.toString(), 10)].rowIndex === rowCellIndex.rowIndex) {\n                isRowAvail = true;\n                index = i;\n                break;\n            }\n        }\n        if (isRowAvail) {\n            if (this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes.indexOf(rowCellIndex.cellIndex) < 0) {\n                this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes.push(rowCellIndex.cellIndex);\n            }\n        }\n        else {\n            this.selectedRowCellIndexes.push({ rowIndex: rowCellIndex.rowIndex, cellIndexes: [rowCellIndex.cellIndex] });\n        }\n    };\n    /**\n     * Deselects the currently selected cells.\n     *\n     * @returns {void}\n     */\n    Selection.prototype.clearCellSelection = function () {\n        if (this.isCellSelected) {\n            var gObj = this.parent;\n            var selectedCells = this.getSelectedCellsElement();\n            var rowCell = this.selectedRowCellIndexes;\n            var data = [];\n            var cells = [];\n            var foreignKeyData = [];\n            var currentViewData = this.getCurrentBatchRecordChanges();\n            this.hideAutoFill();\n            for (var i = 0, len = rowCell.length; i < len; i++) {\n                data.push(currentViewData[rowCell[parseInt(i.toString(), 10)].rowIndex]);\n                var rowObj = this.getRowObj(rowCell[parseInt(i.toString(), 10)].rowIndex);\n                for (var j = 0, cLen = rowCell[parseInt(i.toString(), 10)].cellIndexes.length; j < cLen; j++) {\n                    if (rowObj.cells) {\n                        foreignKeyData.push(rowObj.cells[rowCell[parseInt(i.toString(), 10)]\n                            .cellIndexes[parseInt(j.toString(), 10)]].foreignKeyData);\n                    }\n                    cells.push(gObj.getCellFromIndex(rowCell[parseInt(i.toString(), 10)].rowIndex, rowCell[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)]));\n                }\n            }\n            this.cellDeselect(events.cellDeselecting, rowCell, data, cells, foreignKeyData);\n            if (this.isPreventCellSelect === true) {\n                return;\n            }\n            for (var i = 0, len = selectedCells.length; i < len; i++) {\n                selectedCells[parseInt(i.toString(), 10)].classList.remove('e-cellselectionbackground');\n                selectedCells[parseInt(i.toString(), 10)].removeAttribute('aria-selected');\n            }\n            if (this.bdrElement) {\n                this.showHideBorders('none');\n            }\n            this.selectedRowCellIndexes = [];\n            this.isCellSelected = false;\n            if (!this.isDragged && this.cellselected) {\n                this.cellDeselect(events.cellDeselected, rowCell, data, cells, foreignKeyData);\n            }\n        }\n    };\n    Selection.prototype.getSelectedCellsElement = function () {\n        var gObj = this.parent;\n        var rows = gObj.getDataRows();\n        var cells = [];\n        for (var i = 0, len = rows.length; i < len; i++) {\n            cells = cells.concat([].slice.call(rows[parseInt(i.toString(), 10)].getElementsByClassName('e-cellselectionbackground')));\n        }\n        return cells;\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        e.preventDefault();\n        this.stopTimer();\n        var gBRect = this.parent.element.getBoundingClientRect();\n        var x1 = this.x;\n        var y1 = this.y;\n        var position = getPosition(e);\n        var x2 = position.x - gBRect.left;\n        var y2 = position.y - gBRect.top;\n        var tmp;\n        var target = closest(e.target, 'tr');\n        this.isDragged = true;\n        if (!this.isCellDrag) {\n            if (!target) {\n                target = closest(document.elementFromPoint(this.parent.element.offsetLeft + 2, e.clientY), 'tr');\n            }\n            if (x1 > x2) {\n                tmp = x2;\n                x2 = x1;\n                x1 = tmp;\n            }\n            if (y1 > y2) {\n                tmp = y2;\n                y2 = y1;\n                y1 = tmp;\n            }\n            this.element.style.left = x1 + 'px';\n            this.element.style.top = y1 + 'px';\n            this.element.style.width = x2 - x1 + 'px';\n            this.element.style.height = y2 - y1 + 'px';\n        }\n        if (target && !e.ctrlKey && !e.shiftKey) {\n            var rowIndex = parseInt(target.getAttribute(literals.ariaRowIndex), 10) - 1;\n            if (!this.isCellDrag) {\n                this.hideAutoFill();\n                this.selectRowsByRange(this.startDIndex, rowIndex);\n                this.isRowDragSelected = true;\n            }\n            else {\n                var td = parentsUntil(e.target, literals.rowCell);\n                if (td) {\n                    this.startAFCell = this.startCell;\n                    this.endAFCell = parentsUntil(e.target, literals.rowCell);\n                    if (rowIndex > -1) {\n                        this.selectLikeExcel(e, rowIndex, parseInt(td.getAttribute(literals.ariaColIndex), 10) - 1);\n                    }\n                }\n            }\n        }\n        if (!e.ctrlKey && !e.shiftKey && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling &&\n            !this.parent.enableColumnVirtualization && !this.parent.groupSettings.columns.length && this.isCellDrag) {\n            this.updateScrollPosition(e, position, this.parent.getContent());\n        }\n    };\n    Selection.prototype.updateScrollPosition = function (mouseEvent, position, scrollElement) {\n        var _this = this;\n        var clientRect = scrollElement.getBoundingClientRect();\n        if (clientRect.left >= position.x - 20 -\n            (this.parent.enableRtl && this.parent.height !== 'auto' ? getScrollBarWidth() : 0)) {\n            this.timer1 = window.setInterval(function () { _this.setScrollPosition(scrollElement.firstElementChild, _this.parent.enableRtl ? 'right' : 'left', mouseEvent); }, 200);\n        }\n        else if (clientRect.left + scrollElement.clientWidth - 20 -\n            (!this.parent.enableRtl && this.parent.height !== 'auto' ? getScrollBarWidth() : 0) < position.x) {\n            this.timer1 = window.setInterval(function () { _this.setScrollPosition(scrollElement.firstElementChild, _this.parent.enableRtl ? 'left' : 'right', mouseEvent); }, 200);\n        }\n        if (clientRect.top >= position.y - (this.parent.getRowHeight() * 0.5)) {\n            this.timer2 = window.setInterval(function () { _this.setScrollPosition(scrollElement.firstElementChild, 'up', mouseEvent); }, 200);\n        }\n        else if (clientRect.top + scrollElement.clientHeight - (this.parent.getRowHeight() * 0.5) -\n            (scrollElement.firstElementChild.scrollWidth > scrollElement.firstElementChild.offsetWidth ?\n                getScrollBarWidth() : 0) <= position.y) {\n            this.timer2 = window.setInterval(function () { _this.setScrollPosition(scrollElement.firstElementChild, 'down', mouseEvent); }, 200);\n        }\n    };\n    Selection.prototype.stopTimer = function () {\n        if (this.timer1) {\n            window.clearInterval(this.timer1);\n            this.timer1 = null;\n        }\n        if (this.timer2) {\n            window.clearInterval(this.timer2);\n            this.timer2 = null;\n        }\n        this.preventFocus = false;\n    };\n    Selection.prototype.setScrollPosition = function (scrollElement, direction, mouseEvent) {\n        var rowIndex = -1;\n        var columnIndex = -1;\n        if (this.endAFCell || this.prevECIdxs) {\n            rowIndex = this.endAFCell ? parseInt(this.endAFCell.getAttribute('index'), 10) : this.prevECIdxs.rowIndex;\n            columnIndex = this.endAFCell ? parseInt(this.endAFCell.getAttribute('aria-colindex'), 10) - 1 : this.prevECIdxs.cellIndex;\n        }\n        switch (direction) {\n            case 'up':\n                if (mouseEvent && closest(mouseEvent.target, '.e-headercontent')) {\n                    return;\n                }\n                if (this.isAutoFillSel && this.startAFCell && this.selectedRowCellIndexes.length &&\n                    ((this.selectedRowCellIndexes.length === 1 && this.startAFCell !== this.startCell) ||\n                        (this.selectedRowCellIndexes.length > 1 && this.startAFCell.getBoundingClientRect().top > 0))) {\n                    rowIndex = parseInt(this.startAFCell.getAttribute('index'), 10);\n                }\n                rowIndex -= 1;\n                if (this.parent.frozenRows) {\n                    rowIndex += this.parent.frozenRows + 1;\n                }\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                rowIndex < 1 ? scrollElement.scrollTop = 0 : scrollElement.scrollTop -= this.parent.getRowByIndex(rowIndex)\n                    .offsetHeight;\n                break;\n            case 'down':\n                if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n                    rowIndex = parseInt(this.startAFCell.getAttribute('index'), 10);\n                }\n                if (rowIndex < this.parent.getRows().length - 1) {\n                    rowIndex += 1;\n                    if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n                        this.startAFCell = this.parent.getCellFromIndex(rowIndex, this.selectedRowCellIndexes[0].cellIndexes[0]);\n                    }\n                    scrollElement.scrollTop += this.parent.getRowByIndex(rowIndex).offsetHeight;\n                }\n                else {\n                    scrollElement.scrollTop = scrollElement.scrollHeight;\n                }\n                break;\n            case 'left':\n                if (columnIndex > 0 && rowIndex > -1) {\n                    if (this.isAutoFillSel && this.startAFCell && this.selectedRowCellIndexes.length &&\n                        ((this.selectedRowCellIndexes[0].cellIndexes.length > 0 && this.startAFCell !== this.startCell) ||\n                            (this.selectedRowCellIndexes[0].cellIndexes.length > 1 &&\n                                ((!this.parent.enableRtl && this.startAFCell.getBoundingClientRect().left > 0) || (this.parent.enableRtl &&\n                                    this.startAFCell.getBoundingClientRect().left < this.parent.element.offsetWidth))))) {\n                        columnIndex = parseInt(this.startAFCell.getAttribute('aria-colindex'), 10) - 1;\n                    }\n                    var nextElement_1 = this.findNextCell(scrollElement, direction, columnIndex, rowIndex);\n                    columnIndex = nextElement_1 ? parseInt(nextElement_1.getAttribute('aria-colindex'), 10) - 1 : -1;\n                    if (this.parent.enableRtl && nextElement_1) {\n                        // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                        columnIndex < 1 ? scrollElement.scrollLeft = scrollElement.scrollWidth :\n                            scrollElement.scrollLeft += nextElement_1.offsetWidth;\n                    }\n                    else if (nextElement_1) {\n                        // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                        columnIndex < 1 ? scrollElement.scrollLeft = 0 : scrollElement.scrollLeft -= nextElement_1.offsetWidth;\n                    }\n                }\n                break;\n            case 'right':\n                if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n                    columnIndex = parseInt(this.startAFCell.getAttribute('aria-colindex'), 10) - 1;\n                }\n                // eslint-disable-next-line no-case-declarations\n                var currentElement = this.parent.getCellFromIndex(rowIndex, columnIndex);\n                // eslint-disable-next-line no-case-declarations\n                var nextElement = this.findNextCell(scrollElement, direction, columnIndex, rowIndex);\n                if (nextElement && this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n                    this.startAFCell = this.parent.getCellFromIndex(this.selectedRowCellIndexes[0].rowIndex, parseInt(nextElement.getAttribute('aria-colindex'), 10) - 1);\n                }\n                columnIndex = nextElement ? parseInt(nextElement.getAttribute('aria-colindex'), 10) - 1 : -1;\n                if (this.parent.enableRtl && nextElement) {\n                    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                    columnIndex < this.parent.columns.length - 1 ? scrollElement.scrollLeft -= currentElement.offsetWidth :\n                        scrollElement.scrollLeft = -scrollElement.scrollWidth;\n                }\n                else if (nextElement) {\n                    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                    columnIndex < this.parent.columns.length - 1 ? scrollElement.scrollLeft += currentElement.offsetWidth :\n                        scrollElement.scrollLeft = scrollElement.scrollWidth;\n                }\n                if (this.isAutoFillSel && (columnIndex === this.parent.columns.length - 1 || columnIndex === -1) &&\n                    this.startAFCell && this.endAFCell) {\n                    this.positionAFBorders();\n                    scrollElement.scrollLeft = this.parent.enableRtl ? -scrollElement.scrollWidth : scrollElement.scrollWidth;\n                }\n                break;\n        }\n        if (rowIndex > -1 && rowIndex < this.parent.getRows().length && columnIndex > -1) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var mouseEvent_1 = { target: this.parent.getCellFromIndex(rowIndex, columnIndex) };\n            if (this.isAutoFillSel && mouseEvent_1.target.classList.contains('e-cellselectionbackground') &&\n                ((direction === 'down' && parseInt(mouseEvent_1.target.getAttribute('index'), 10) === this.parent.getRows().length - 1) ||\n                    (direction === 'right' && parseInt(mouseEvent_1.target.getAttribute('aria-colindex'), 10) - 1 === this.parent.columns.length - 1))) {\n                return;\n            }\n            this.endAFCell = mouseEvent_1.target;\n            this.preventFocus = true;\n            this.selectLikeExcel(mouseEvent_1, rowIndex, columnIndex);\n        }\n    };\n    Selection.prototype.findNextCell = function (scrollElement, direction, columnIndex, rowIndex) {\n        var nextElement = this.parent.getCellFromIndex(rowIndex, direction === 'left' ? columnIndex - 1 : columnIndex + 1);\n        if (nextElement && nextElement.classList.contains('e-hide')) {\n            var siblingEles = nextElement.closest('tr').querySelectorAll('.e-rowcell:not(.e-hide)');\n            var nextEleInd = Array.from(siblingEles).indexOf(nextElement.nextElementSibling);\n            if (nextEleInd > 0 && nextEleInd < siblingEles.length - 1) {\n                nextElement = siblingEles[nextEleInd + (direction === 'left' ? -1 : 1)];\n                return nextElement;\n            }\n            else {\n                scrollElement.scrollLeft = 0;\n                return null;\n            }\n        }\n        return nextElement;\n    };\n    Selection.prototype.selectLikeExcel = function (e, rowIndex, cellIndex) {\n        if (!this.isAutoFillSel) {\n            this.clearCellSelection();\n            this.selectCellsByRange({ rowIndex: this.startDIndex, cellIndex: this.startDCellIndex }, { rowIndex: rowIndex, cellIndex: cellIndex });\n            this.drawBorders();\n        }\n        else { //Autofill\n            this.showAFBorders();\n            this.selectLikeAutoFill(e);\n        }\n    };\n    Selection.prototype.setFrozenBorders = function (parentEle, border, bdrStr) {\n        var width = border.style.borderWidth.toString().split(' ');\n        var strCell = ['', 'e-leftfreeze', 'e-unfreeze', 'e-leftfreeze', 'e-unfreeze', 'e-rightfreeze', 'e-rightfreeze'];\n        var cells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground' + '.' + strCell[\"\" + bdrStr])).\n            filter(function (ele) { return ele.style.display === ''; });\n        var fixedCells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground.e-fixedfreeze')).\n            filter(function (ele) { return ele.style.display === ''; });\n        var isRtl = this.parent.enableRtl;\n        if (cells.length) {\n            var firstRowIdx = cells[0].getAttribute('index');\n            var firstColIdx = cells[0].getAttribute('aria-colindex');\n            var lastRowIdx = cells[cells.length - 1].getAttribute('index');\n            var lastColIdx = cells[cells.length - 1].getAttribute('aria-colindex');\n            for (var i = 0; i < cells.length; i++) {\n                if (cells[parseInt(i.toString(), 10)].getAttribute('index') === firstRowIdx && (width.length === 1 || (width.length === 3\n                    && parseInt(width[0], 10) === 2) || (width.length === 4 && parseInt(width[0], 10) === 2))) {\n                    cells[parseInt(i.toString(), 10)].classList.add('e-xlsel-top-border');\n                }\n                if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === firstColIdx && (width.length === 1 ||\n                    (width.length === 3 && parseInt(width[1], 10) === 2) || (width.length === 4 && (((!isRtl &&\n                    parseInt(width[3], 10) === 2)) || (isRtl && parseInt(width[1], 10) === 2))))) {\n                    cells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-right-border' : 'e-xlsel-left-border');\n                }\n                if (cells[parseInt(i.toString(), 10)].getAttribute('index') === lastRowIdx && (width.length === 1 ||\n                    (width.length === 3 && parseInt(width[2], 10) === 2) || (width.length === 4 && parseInt(width[2], 10) === 2))) {\n                    cells[parseInt(i.toString(), 10)].classList.add('e-xlsel-bottom-border');\n                }\n                if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === lastColIdx && (width.length === 1 ||\n                    (width.length === 3 && parseInt(width[1], 10) === 2) || (width.length === 4 && ((!isRtl &&\n                    parseInt(width[1], 10) === 2)) || (isRtl && parseInt(width[3], 10) === 2)))) {\n                    cells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-left-border' : 'e-xlsel-right-border');\n                }\n            }\n        }\n        if (fixedCells.length) {\n            var firstRowIdx = fixedCells[0].getAttribute('index');\n            var firstColIdx = (parseInt(fixedCells[0].getAttribute('aria-colindex'), 10) - 1).toString();\n            var lastRowIdx = fixedCells[fixedCells.length - 1].getAttribute('index');\n            var lastColIdx = (parseInt(fixedCells[fixedCells.length - 1].getAttribute('aria-colindex'), 10) - 1).toString();\n            for (var i = 0; i < fixedCells.length; i++) {\n                var idx = fixedCells[parseInt(i.toString(), 10)].getAttribute('index');\n                var colIdx = (parseInt(fixedCells[parseInt(i.toString(), 10)].getAttribute('aria-colindex'), 10) - 1).toString();\n                if (idx === firstRowIdx &&\n                    ((!this.parent.getHeaderContent().querySelector('.e-cellselectionbackground.e-fixedfreeze')\n                        && parentsUntil(parentEle, 'e-content')) || !parentsUntil(parentEle, 'e-content'))) {\n                    fixedCells[parseInt(i.toString(), 10)].classList.add('e-xlsel-top-border');\n                }\n                if (idx === lastRowIdx &&\n                    ((!this.parent.getContent().querySelector('.e-cellselectionbackground.e-fixedfreeze')\n                        && parentsUntil(parentEle, 'e-headercontent')) || !parentsUntil(parentEle, 'e-headercontent'))) {\n                    fixedCells[parseInt(i.toString(), 10)].classList.add('e-xlsel-bottom-border');\n                }\n                var preCell = fixedCells[parseInt(i.toString(), 10)].parentElement.children[parseInt(colIdx, 10) - 1];\n                if (colIdx === firstColIdx && (!preCell || (preCell && !preCell.classList.contains('e-cellselectionbackground')))) {\n                    fixedCells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-right-border' : 'e-xlsel-left-border');\n                }\n                var nextCell = fixedCells[parseInt(i.toString(), 10)].parentElement.children[parseInt(colIdx, 10) + 1];\n                if (colIdx === lastColIdx && (!nextCell || (nextCell && !nextCell.classList.contains('e-cellselectionbackground')))) {\n                    fixedCells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-left-border' : 'e-xlsel-right-border');\n                }\n            }\n        }\n    };\n    Selection.prototype.refreshFrozenBorders = function () {\n        if (this.bdrElement) {\n            this.setFrozenBorders(this.parent.getContentTable(), this.bdrElement, '1');\n            if (this.parent.isFrozenGrid() && this.parent.getFrozenMode() === literals.leftRight) {\n                this.setFrozenBorders(this.parent.getContentTable(), this.frcBdrElement, '5');\n            }\n            if (this.parent.frozenRows) {\n                this.setFrozenBorders(this.parent.getHeaderTable(), this.fhBdrElement, '3');\n                if (this.parent.isFrozenGrid() && this.parent.getFrozenMode() === literals.leftRight) {\n                    this.setFrozenBorders(this.parent.getHeaderTable(), this.frhBdrElement, '6');\n                }\n            }\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.drawBorders = function () {\n        if (this.selectionSettings.cellSelectionMode === 'BoxWithBorder' && this.selectedRowCellIndexes.length && !this.parent.isEdit) {\n            this.parent.element.classList.add('e-enabledboxbdr');\n            if (!this.bdrElement) {\n                this.createBorders();\n            }\n            this.positionBorders();\n            if (this.parent.isFrozenGrid()) {\n                this.showHideBorders('none', true);\n                this.refreshFrozenBorders();\n            }\n        }\n        else {\n            this.showHideBorders('none');\n        }\n    };\n    Selection.prototype.isLastCell = function (cell) {\n        var cells = [].slice.call(cell.parentElement.querySelectorAll('.e-rowcell:not(.e-hide)'));\n        return cells[cells.length - 1] === cell;\n    };\n    Selection.prototype.isLastRow = function (cell) {\n        var rows = [].slice.call(closest(cell, literals.tbody).querySelectorAll('.e-row:not(.e-hiddenrow)'));\n        return cell.parentElement === rows[rows.length - 1];\n    };\n    Selection.prototype.isFirstRow = function (cell) {\n        var rows = [].slice.call(closest(cell, literals.tbody).querySelectorAll('.e-row:not(.e-hiddenrow)'));\n        return cell.parentElement === rows[0];\n    };\n    Selection.prototype.isFirstCell = function (cell) {\n        var cells = [].slice.call(cell.parentElement.querySelectorAll('.e-rowcell:not(.e-hide)'));\n        return cells[0] === cell;\n    };\n    Selection.prototype.setBorders = function (parentEle, border, bdrStr) {\n        var cells = [].slice.call(parentEle.getElementsByClassName('e-cellselectionbackground')).\n            filter(function (ele) { return ele.style.display === ''; });\n        if (cells.length && this.parent.isFrozenGrid()) {\n            var strCell = ['', 'e-leftfreeze', 'e-unfreeze', 'e-leftfreeze', 'e-unfreeze', 'e-rightfreeze', 'e-rightfreeze'];\n            cells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground' + '.' + strCell[\"\" + bdrStr] + ':not(.e-hide)')).\n                filter(function (ele) { return ele.style.display === ''; });\n        }\n        if (cells.length) {\n            var isFrozen = this.parent.isFrozenGrid();\n            var start = cells[0];\n            var end = cells[cells.length - 1];\n            var stOff = start.getBoundingClientRect();\n            var endOff = end.getBoundingClientRect();\n            var parentOff = start.offsetParent.getBoundingClientRect();\n            if (start.offsetParent.classList.contains('e-content') || start.offsetParent.classList.contains('e-headercontent')) {\n                parentOff = start.offsetParent.querySelector('table').getBoundingClientRect();\n            }\n            var rowHeight = !isFrozen && this.isLastRow(end) && (bdrStr === '1' || bdrStr === '2' || bdrStr === '5') ? 2 : 0;\n            var topOffSet = 0;\n            var leftOffset = isFrozen && (bdrStr === '2' || bdrStr === '4') && this.isFirstCell(start) ? 1 : 0;\n            var rightOffset = ((this.parent.getFrozenMode() === 'Right' && (bdrStr === '1' || bdrStr === '3'))\n                || (this.parent.getFrozenMode() === literals.leftRight && (bdrStr === '5' || bdrStr === '6')))\n                && this.isFirstCell(start) ? 1 : 0;\n            if (this.parent.enableRtl) {\n                border.style.right = parentOff.right - stOff.right - leftOffset + 'px';\n                border.style.width = stOff.right - endOff.left + leftOffset + 1 + 'px';\n            }\n            else {\n                border.style.left = stOff.left - parentOff.left - leftOffset - rightOffset + 'px';\n                border.style.width = endOff.right - stOff.left + leftOffset - rightOffset + 1 + 'px';\n            }\n            border.style.top = stOff.top - parentOff.top - topOffSet + 'px';\n            border.style.height = endOff.top - stOff.top > 0 ?\n                (endOff.top - parentOff.top + endOff.height + (isFrozen ? 0 : 1)) - (stOff.top - parentOff.top) - rowHeight + topOffSet + 'px' :\n                endOff.height + topOffSet - rowHeight + (isFrozen ? 0 : 1) + 'px';\n            this.selectDirection += bdrStr;\n        }\n        else {\n            border.style.display = 'none';\n        }\n    };\n    Selection.prototype.positionBorders = function () {\n        this.updateStartEndCells();\n        if (!this.startCell || !this.bdrElement || !this.selectedRowCellIndexes.length) {\n            return;\n        }\n        this.selectDirection = '';\n        this.showHideBorders('');\n        this.setBorders(this.parent.getContentTable(), this.bdrElement, '1');\n        if (this.parent.isFrozenGrid()) {\n            this.setBorders(this.parent.getContentTable(), this.mcBdrElement, '2');\n            if (this.parent.getFrozenMode() === literals.leftRight) {\n                this.setBorders(this.parent.getContentTable(), this.frcBdrElement, '5');\n            }\n        }\n        if (this.parent.frozenRows) {\n            this.setBorders(this.parent.getHeaderTable(), this.fhBdrElement, '3');\n            if (this.parent.isFrozenGrid()) {\n                this.setBorders(this.parent.getHeaderTable(), this.mhBdrElement, '4');\n                if (this.parent.getFrozenMode() === literals.leftRight) {\n                    this.setBorders(this.parent.getHeaderTable(), this.frhBdrElement, '6');\n                }\n            }\n        }\n        this.applyBorders(this.selectDirection);\n    };\n    /* eslint-enable */\n    Selection.prototype.applyBothFrozenBorders = function (str) {\n        var rtl = this.parent.enableRtl;\n        switch (str.length) {\n            case 6:\n                {\n                    this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                    this.mcBdrElement.style.borderWidth = this.bottom;\n                    this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                    this.mhBdrElement.style.borderWidth = this.top;\n                    this.frcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                    this.frhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                }\n                break;\n            case 4:\n                {\n                    if (str.includes('1') && str.includes('2') && str.includes('3') && str.includes('4')) {\n                        this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                        this.mhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                        this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                        this.mcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                    }\n                    if (str.includes('2') && str.includes('4') && str.includes('5') && str.includes('6')) {\n                        this.mcBdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                        this.mhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                        this.frcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                        this.frhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                    }\n                }\n                break;\n            case 3:\n                {\n                    this.bdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                    this.mcBdrElement.style.borderWidth = this.top_bottom;\n                    this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                    if (this.parent.frozenRows) {\n                        this.fhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        this.mhBdrElement.style.borderWidth = this.top_bottom;\n                        this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                    }\n                }\n                break;\n            case 2:\n                {\n                    if (str.includes('1')) {\n                        this.mcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                        if (this.parent.frozenRows) {\n                            this.fhBdrElement.style.borderWidth = this.top_right_left;\n                        }\n                    }\n                    if (str.includes('2')) {\n                        this.bdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                        if (this.parent.frozenRows) {\n                            this.mhBdrElement.style.borderWidth = this.top_right_left;\n                        }\n                    }\n                    if (str.includes('3')) {\n                        this.mhBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                        this.bdrElement.style.borderWidth = this.right_bottom_left;\n                    }\n                    if (str.includes('4')) {\n                        this.fhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        this.frhBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                        this.mcBdrElement.style.borderWidth = this.right_bottom_left;\n                    }\n                    if (str.includes('5')) {\n                        this.mcBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        if (this.parent.frozenRows) {\n                            this.frhBdrElement.style.borderWidth = this.top_right_left;\n                        }\n                    }\n                    if (str.includes('6')) {\n                        this.mhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        this.frcBdrElement.style.borderWidth = this.right_bottom_left;\n                    }\n                }\n                break;\n            default:\n                this.bdrElement.style.borderWidth = this.all_border;\n                this.mcBdrElement.style.borderWidth = this.all_border;\n                this.frcBdrElement.style.borderWidth = this.all_border;\n                if (this.parent.frozenRows) {\n                    this.fhBdrElement.style.borderWidth = this.all_border;\n                    this.mhBdrElement.style.borderWidth = this.all_border;\n                    this.frhBdrElement.style.borderWidth = this.all_border;\n                }\n                break;\n        }\n    };\n    Selection.prototype.applyBorders = function (str) {\n        var rtl = this.parent.enableRtl;\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n            this.applyBothFrozenBorders(str);\n        }\n        else {\n            switch (str.length) {\n                case 4:\n                    {\n                        if (this.parent.getFrozenMode() === 'Right') {\n                            this.bdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                            this.mcBdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                            this.fhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                            this.mhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                        }\n                        else {\n                            this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                            this.mcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                            this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                            this.mhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                        }\n                    }\n                    break;\n                case 2:\n                    {\n                        if (this.parent.getFrozenMode() === 'Right') {\n                            this.bdrElement.style.borderWidth = str.includes('2') ? rtl ? this.top_bottom_left\n                                : this.top_right_bottom : this.right_bottom_left;\n                            this.mcBdrElement.style.borderWidth = str.includes('1') ? rtl ? this.top_right_bottom\n                                : this.top_bottom_left : this.right_bottom_left;\n                            if (this.parent.frozenRows) {\n                                this.fhBdrElement.style.borderWidth = str.includes('1') ? this.top_right_left\n                                    : rtl ? this.top_bottom_left : this.top_right_bottom;\n                                this.mhBdrElement.style.borderWidth = str.includes('2') ? this.top_right_left\n                                    : rtl ? this.top_right_bottom : this.top_bottom_left;\n                            }\n                        }\n                        else {\n                            this.bdrElement.style.borderWidth = str.includes('2') ? rtl ? this.top_right_bottom\n                                : this.top_bottom_left : this.right_bottom_left;\n                            if (this.parent.isFrozenGrid()) {\n                                this.mcBdrElement.style.borderWidth = str.includes('1') ? rtl ? this.top_bottom_left\n                                    : this.top_right_bottom : this.right_bottom_left;\n                            }\n                            if (this.parent.frozenRows) {\n                                this.fhBdrElement.style.borderWidth = str.includes('1') ? this.top_right_left\n                                    : rtl ? this.top_right_bottom : this.top_bottom_left;\n                                if (this.parent.isFrozenGrid()) {\n                                    this.mhBdrElement.style.borderWidth = str.includes('2') ? this.top_right_left\n                                        : rtl ? this.top_bottom_left : this.top_right_bottom;\n                                }\n                            }\n                        }\n                    }\n                    break;\n                default:\n                    this.bdrElement.style.borderWidth = this.all_border;\n                    if (this.parent.isFrozenGrid()) {\n                        this.mcBdrElement.style.borderWidth = this.all_border;\n                    }\n                    if (this.parent.frozenRows) {\n                        this.fhBdrElement.style.borderWidth = this.all_border;\n                        if (this.parent.isFrozenGrid()) {\n                            this.mhBdrElement.style.borderWidth = this.all_border;\n                        }\n                    }\n                    break;\n            }\n        }\n    };\n    Selection.prototype.createBorders = function () {\n        if (!this.bdrElement) {\n            var selectionBorder = createElement('div', {\n                className: 'e-xlsel', id: this.parent.element.id + '_bdr'\n            });\n            selectionBorder.style.cssText = 'width: 2px; border-width: 0;';\n            this.bdrElement = this.parent.getContentTable().parentElement.appendChild(selectionBorder);\n            if (this.parent.isFrozenGrid()) {\n                var middleContentBorder = createElement('div', {\n                    className: 'e-xlsel', id: this.parent.element.id + '_mcbdr'\n                });\n                middleContentBorder.style.cssText = 'height: 2px; border-width: 0;';\n                this.mcBdrElement = this.parent.getContentTable().parentElement.appendChild(middleContentBorder);\n                if (this.parent.getFrozenMode() === literals.leftRight) {\n                    var frozenRightContentBorder = createElement('div', {\n                        className: 'e-xlsel', id: this.parent.element.id + '_frcbdr'\n                    });\n                    frozenRightContentBorder.style.cssText = 'height: 2px; border-width: 0;';\n                    this.frcBdrElement = this.parent.getContentTable().parentElement.appendChild(frozenRightContentBorder);\n                }\n            }\n            if (this.parent.frozenRows) {\n                var frozenHeaderBorder = createElement('div', {\n                    className: 'e-xlsel', id: this.parent.element.id + '_fhbdr'\n                });\n                frozenHeaderBorder.style.height = '2px';\n                this.fhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(frozenHeaderBorder);\n            }\n            if (this.parent.frozenRows && this.parent.isFrozenGrid()) {\n                var middleHeaderBorder = createElement('div', {\n                    className: 'e-xlsel', id: this.parent.element.id + '_mhbdr'\n                });\n                middleHeaderBorder.style.height = '2px';\n                this.mhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(middleHeaderBorder);\n                if (this.parent.getFrozenMode() === literals.leftRight) {\n                    var frozenRightHeaderBorder = createElement('div', {\n                        className: 'e-xlsel', id: this.parent.element.id + '_frhbdr'\n                    });\n                    frozenRightHeaderBorder.style.height = '2px';\n                    this.frhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(frozenRightHeaderBorder);\n                }\n            }\n        }\n    };\n    Selection.prototype.showHideBorders = function (display, freeze) {\n        if (this.bdrElement) {\n            this.bdrElement.style.display = display;\n            if (this.parent.isFrozenGrid()) {\n                var parentEle = this.parent.getContentTable();\n                removeClass(parentEle.querySelectorAll('.e-xlsel-top-border'), 'e-xlsel-top-border');\n                removeClass(parentEle.querySelectorAll('.e-xlsel-left-border'), 'e-xlsel-left-border');\n                removeClass(parentEle.querySelectorAll('.e-xlsel-right-border'), 'e-xlsel-right-border');\n                removeClass(parentEle.querySelectorAll('.e-xlsel-bottom-border'), 'e-xlsel-bottom-border');\n                if (!freeze) {\n                    this.mcBdrElement.style.display = display;\n                }\n                if (this.parent.getFrozenMode() === literals.leftRight) {\n                    this.frcBdrElement.style.display = display;\n                }\n            }\n            if (this.parent.frozenRows) {\n                var parentEle = this.parent.getHeaderTable();\n                removeClass(parentEle.querySelectorAll('.e-xlsel-top-border'), 'e-xlsel-top-border');\n                removeClass(parentEle.querySelectorAll('.e-xlsel-left-border'), 'e-xlsel-left-border');\n                removeClass(parentEle.querySelectorAll('.e-xlsel-right-border'), 'e-xlsel-right-border');\n                removeClass(parentEle.querySelectorAll('.e-xlsel-bottom-border'), 'e-xlsel-bottom-border');\n                this.fhBdrElement.style.display = display;\n            }\n            if (this.parent.frozenRows && this.parent.isFrozenGrid()) {\n                if (!freeze) {\n                    this.mhBdrElement.style.display = display;\n                }\n                if (this.parent.getFrozenMode() === literals.leftRight) {\n                    this.frhBdrElement.style.display = display;\n                }\n            }\n        }\n    };\n    Selection.prototype.drawAFBorders = function () {\n        if (!this.bdrAFBottom) {\n            this.createAFBorders();\n        }\n        this.positionAFBorders();\n    };\n    Selection.prototype.positionAFBorders = function () {\n        if (!this.startCell || !this.bdrAFLeft) {\n            return;\n        }\n        var stOff = this.startAFCell.getBoundingClientRect();\n        var endOff = this.endAFCell.getBoundingClientRect();\n        var top = endOff.top - stOff.top > 0 ? 1 : 0;\n        var firstCellTop = endOff.top - stOff.top >= 0 && (parentsUntil(this.startAFCell, literals.movableContent) ||\n            parentsUntil(this.startAFCell, 'e-frozencontent')) && this.isFirstRow(this.startAFCell) ? 1.5 : 0;\n        var firstCellLeft = (parentsUntil(this.startAFCell, literals.movableContent) ||\n            parentsUntil(this.startAFCell, literals.movableHeader)) && this.isFirstCell(this.startAFCell) ? 1 : 0;\n        var rowHeight = this.isLastRow(this.endAFCell) && (parentsUntil(this.endAFCell, literals.movableContent) ||\n            parentsUntil(this.endAFCell, 'e-frozencontent')) ? 2 : 0;\n        var parentOff = this.startAFCell.offsetParent.getBoundingClientRect();\n        var parentRect = this.parent.element.getBoundingClientRect();\n        var sTop = this.startAFCell.offsetParent.parentElement.scrollTop;\n        var sLeft = this.startAFCell.offsetParent.parentElement.scrollLeft;\n        var scrollTop = sTop - this.startAFCell.offsetTop;\n        var scrollLeft = sLeft - this.startAFCell.offsetLeft;\n        var totalHeight = this.parent.element.clientHeight - getScrollBarWidth();\n        if (this.parent.allowPaging) {\n            totalHeight -= this.parent.element.querySelector('.e-pager').offsetHeight;\n        }\n        if (this.parent.aggregates.length) {\n            totalHeight -= this.parent.getFooterContent().offsetHeight;\n        }\n        var totalWidth = this.parent.element.clientWidth - (this.parent.height !== 'auto' ? getScrollBarWidth() : 0);\n        scrollTop = scrollTop > 0 ? Math.floor(scrollTop) - 1 : 0;\n        scrollLeft = scrollLeft > 0 ? scrollLeft : 0;\n        var left = stOff.left - parentRect.left;\n        if (!this.parent.enableRtl) {\n            this.bdrAFLeft.style.left = left - firstCellLeft + scrollLeft - 1 + 'px';\n            this.bdrAFRight.style.left = endOff.left - parentRect.left - 2 + endOff.width + 'px';\n            this.bdrAFRight.style.width = totalWidth <= parseInt(this.bdrAFRight.style.left, 10) ? '0px' : '2px';\n            this.bdrAFTop.style.left = left + scrollLeft - 0.5 + 'px';\n            this.bdrAFTop.style.width = parseInt(this.bdrAFRight.style.left, 10) - parseInt(this.bdrAFLeft.style.left, 10)\n                - firstCellLeft + 1 + 'px';\n            if (totalWidth <= (parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10))) {\n                var leftRemove = (parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10)) - totalWidth;\n                this.bdrAFTop.style.width = parseInt(this.bdrAFTop.style.width, 10) - leftRemove + 'px';\n            }\n        }\n        else {\n            var scrolloffSet = (parentsUntil(this.startAFCell, literals.movableContent) ||\n                parentsUntil(this.startAFCell, literals.movableHeader)) ? stOff.right -\n                this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width -\n                parentRect.left : 0;\n            this.bdrAFLeft.style.right = parentRect.right - endOff.right - 2 + endOff.width + 'px';\n            this.bdrAFLeft.style.width = totalWidth <= parseInt(this.bdrAFLeft.style.right, 10) ? '0px' : '2px';\n            var borderAFRightValue = parentRect.right - stOff.right - firstCellLeft + scrolloffSet - 1;\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            borderAFRightValue > 0 ? this.bdrAFRight.style.right = borderAFRightValue + 'px' : this.bdrAFRight.style.right = '0px';\n            this.bdrAFTop.style.left = endOff.left - parentRect.left - 0.5 + 'px';\n            this.bdrAFTop.style.width = parseInt(this.bdrAFLeft.style.right, 10) - parseInt(this.bdrAFRight.style.right, 10)\n                - firstCellLeft + 1 + 'px';\n            if (parseInt(this.bdrAFTop.style.left, 10) < 0) {\n                this.bdrAFTop.style.width = parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10) + 'px';\n                if (this.parent.height !== 'auto' && getScrollBarWidth()) {\n                    this.bdrAFTop.style.left = getScrollBarWidth() + 'px';\n                    this.bdrAFTop.style.width = (parseInt(this.bdrAFTop.style.width, 10) - getScrollBarWidth()) + 'px';\n                }\n                else {\n                    this.bdrAFTop.style.left = '0px';\n                }\n            }\n        }\n        this.bdrAFLeft.style.top = stOff.top - parentRect.top - firstCellTop + scrollTop + 'px';\n        this.bdrAFLeft.style.height = endOff.top - stOff.top > 0 ?\n            (endOff.top - parentOff.top + endOff.height + 1) - (stOff.top - parentOff.top) + firstCellTop - rowHeight - scrollTop + 'px' :\n            endOff.height + firstCellTop - rowHeight - scrollTop + 'px';\n        this.bdrAFRight.style.top = this.bdrAFLeft.style.top;\n        this.bdrAFRight.style.height = parseInt(this.bdrAFLeft.style.height, 10) + 'px';\n        this.bdrAFTop.style.top = this.bdrAFRight.style.top;\n        this.bdrAFBottom.style.left = this.bdrAFTop.style.left;\n        this.bdrAFBottom.style.top = parseFloat(this.bdrAFLeft.style.top) + parseFloat(this.bdrAFLeft.style.height) - top - 1 + 'px';\n        this.bdrAFBottom.style.width = totalHeight <= parseFloat(this.bdrAFBottom.style.top) ? '0px' : this.bdrAFTop.style.width;\n        if (totalHeight <= (parseInt(this.bdrAFLeft.style.height, 10) + parseInt(this.bdrAFLeft.style.top, 10))) {\n            var topRemove = parseInt(this.bdrAFLeft.style.height, 10) + parseInt(this.bdrAFLeft.style.top, 10) - totalHeight;\n            this.bdrAFLeft.style.height = parseInt(this.bdrAFLeft.style.height, 10) - topRemove + 'px';\n            this.bdrAFRight.style.height = parseInt(this.bdrAFLeft.style.height, 10) + 'px';\n        }\n    };\n    Selection.prototype.createAFBorders = function () {\n        if (!this.bdrAFLeft) {\n            var leftSelectionBorder = createElement('div', {\n                className: 'e-xlselaf', id: this.parent.element.id + '_bdrafleft'\n            });\n            leftSelectionBorder.style.width = '2px';\n            this.bdrAFLeft = this.parent.element.appendChild(leftSelectionBorder);\n            var rightSelectionBorder = createElement('div', {\n                className: 'e-xlselaf', id: this.parent.element.id + '_bdrafright'\n            });\n            rightSelectionBorder.style.width = '2px';\n            this.bdrAFRight = this.parent.element.appendChild(rightSelectionBorder);\n            var bottomSelectionBorder = createElement('div', {\n                className: 'e-xlselaf', id: this.parent.element.id + '_bdrafbottom'\n            });\n            bottomSelectionBorder.style.height = '2px';\n            this.bdrAFBottom = this.parent.element.appendChild(bottomSelectionBorder);\n            var topSelectionBorder = createElement('div', {\n                className: 'e-xlselaf', id: this.parent.element.id + '_bdraftop'\n            });\n            topSelectionBorder.style.height = '2px';\n            this.bdrAFTop = this.parent.element.appendChild(topSelectionBorder);\n        }\n    };\n    Selection.prototype.destroyAutoFillElements = function () {\n        if (this.bdrAFLeft) {\n            this.bdrAFLeft.remove();\n            this.bdrAFRight.remove();\n            this.bdrAFBottom.remove();\n            this.bdrAFTop.remove();\n            this.bdrAFLeft = this.bdrAFRight = this.bdrAFBottom = this.bdrAFTop = null;\n        }\n        if (this.autofill) {\n            this.autofill.remove();\n            this.autofill = null;\n        }\n    };\n    Selection.prototype.showAFBorders = function () {\n        if (this.bdrAFLeft) {\n            this.bdrAFLeft.style.display = '';\n            this.bdrAFRight.style.display = '';\n            this.bdrAFBottom.style.display = '';\n            this.bdrAFTop.style.display = '';\n        }\n    };\n    Selection.prototype.hideAFBorders = function () {\n        if (this.bdrAFLeft) {\n            this.bdrAFLeft.style.display = 'none';\n            this.bdrAFRight.style.display = 'none';\n            this.bdrAFBottom.style.display = 'none';\n            this.bdrAFTop.style.display = 'none';\n        }\n    };\n    Selection.prototype.updateValue = function (rIdx, cIdx, cell) {\n        var args = this.createBeforeAutoFill(rIdx, cIdx, cell);\n        if (!args.cancel) {\n            var col = this.parent.getColumnByIndex(cIdx);\n            if (this.parent.editModule && cell) {\n                if (col.type === 'number') {\n                    this.parent.editModule.updateCell(rIdx, col.field, parseFloat(args.value));\n                }\n                else {\n                    this.parent.editModule.updateCell(rIdx, col.field, args.value);\n                }\n            }\n        }\n    };\n    Selection.prototype.createBeforeAutoFill = function (rowIndex, colIndex, cell) {\n        var col = this.parent.getColumnByIndex(colIndex);\n        var args = {\n            column: col,\n            value: cell.innerText\n        };\n        this.parent.trigger(events.beforeAutoFill, args);\n        return args;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Selection.prototype.getAutoFillCells = function (rowIndex, startCellIdx) {\n        var cls = '.e-cellselectionbackground';\n        var cells = [].slice.call(this.parent.getDataRows()[parseInt(rowIndex.toString(), 10)].querySelectorAll(cls));\n        return cells;\n    };\n    Selection.prototype.selectLikeAutoFill = function (e, isApply) {\n        var startrowIdx = parseInt(parentsUntil(this.startAFCell, literals.row).getAttribute(literals.ariaRowIndex), 10) - 1;\n        var startCellIdx = parseInt(this.startAFCell.getAttribute(literals.ariaColIndex), 10) - 1;\n        var endrowIdx = parseInt(parentsUntil(this.endAFCell, literals.row).getAttribute(literals.ariaRowIndex), 10) - 1;\n        var endCellIdx = parseInt(this.endAFCell.getAttribute(literals.ariaColIndex), 10) - 1;\n        var rowLen = this.selectedRowCellIndexes.length - 1;\n        var colLen = this.selectedRowCellIndexes[0].cellIndexes.length - 1;\n        switch (true) { //direction\n            case !isApply && this.endAFCell.classList.contains('e-cellselectionbackground') &&\n                !!parentsUntil(e.target, literals.rowCell):\n                this.startAFCell = this.parent.getCellFromIndex(startrowIdx, startCellIdx);\n                this.endAFCell = this.parent.getCellFromIndex(startrowIdx + rowLen, startCellIdx + colLen);\n                this.drawAFBorders();\n                break;\n            case this.autoFillRLselection && startCellIdx + colLen < endCellIdx && //right\n                endCellIdx - startCellIdx - colLen + 1 > endrowIdx - startrowIdx - rowLen // right bottom\n                && endCellIdx - startCellIdx - colLen + 1 > startrowIdx - endrowIdx: //right top\n                this.endAFCell = this.parent.getCellFromIndex(startrowIdx + rowLen, endCellIdx);\n                endrowIdx = parseInt(parentsUntil(this.endAFCell, literals.row).getAttribute(literals.ariaRowIndex), 10) - 1;\n                endCellIdx = parseInt(this.endAFCell.getAttribute(literals.ariaColIndex), 10) - 1;\n                if (!isApply) {\n                    this.drawAFBorders();\n                }\n                else {\n                    var cellIdx = parseInt(this.endCell.getAttribute(literals.ariaColIndex), 10) - 1;\n                    for (var i = startrowIdx; i <= endrowIdx; i++) {\n                        var cells = this.getAutoFillCells(i, startCellIdx);\n                        var c = 0;\n                        for (var j = cellIdx + 1; j <= endCellIdx; j++) {\n                            if (c > colLen) {\n                                c = 0;\n                            }\n                            this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n                            c++;\n                        }\n                    }\n                    this.selectCellsByRange({ rowIndex: startrowIdx, cellIndex: this.startCellIndex }, { rowIndex: endrowIdx, cellIndex: endCellIdx });\n                }\n                break;\n            case this.autoFillRLselection && startCellIdx > endCellIdx && // left\n                startCellIdx - endCellIdx + 1 > endrowIdx - startrowIdx - rowLen && //left top\n                startCellIdx - endCellIdx + 1 > startrowIdx - endrowIdx: // left bottom\n                this.startAFCell = this.parent.getCellFromIndex(startrowIdx, endCellIdx);\n                this.endAFCell = this.endCell;\n                if (!isApply) {\n                    this.drawAFBorders();\n                }\n                else {\n                    for (var i = startrowIdx; i <= startrowIdx + rowLen; i++) {\n                        var cells = this.getAutoFillCells(i, startCellIdx);\n                        cells.reverse();\n                        var c = 0;\n                        for (var j = this.startCellIndex - 1; j >= endCellIdx; j--) {\n                            if (c > colLen) {\n                                c = 0;\n                            }\n                            this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n                            c++;\n                        }\n                    }\n                    this.selectCellsByRange({ rowIndex: startrowIdx, cellIndex: endCellIdx }, { rowIndex: startrowIdx + rowLen, cellIndex: this.startCellIndex + colLen });\n                }\n                break;\n            case startrowIdx > endrowIdx: //up\n                this.startAFCell = this.parent.getCellFromIndex(endrowIdx, startCellIdx);\n                this.endAFCell = this.endCell;\n                if (!isApply) {\n                    this.drawAFBorders();\n                }\n                else {\n                    var trIdx = parseInt(this.endCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n                    var r = trIdx;\n                    for (var i = startrowIdx - 1; i >= endrowIdx; i--) {\n                        if (r === this.startIndex - 1) {\n                            r = trIdx;\n                        }\n                        var cells = this.getAutoFillCells(r, startCellIdx);\n                        var c = 0;\n                        r--;\n                        for (var j = this.startCellIndex; j <= this.startCellIndex + colLen; j++) {\n                            this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n                            c++;\n                        }\n                    }\n                    this.selectCellsByRange({ rowIndex: endrowIdx, cellIndex: startCellIdx + colLen }, { rowIndex: startrowIdx + rowLen, cellIndex: startCellIdx });\n                }\n                break;\n            default: //down\n                this.endAFCell = this.parent.getCellFromIndex(endrowIdx, startCellIdx + colLen);\n                if (!isApply) {\n                    this.drawAFBorders();\n                }\n                else {\n                    var trIdx = parseInt(this.endCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n                    var r = this.startIndex;\n                    for (var i = trIdx + 1; i <= endrowIdx; i++) {\n                        if (r === trIdx + 1) {\n                            r = this.startIndex;\n                        }\n                        var cells = this.getAutoFillCells(r, startCellIdx);\n                        r++;\n                        var c = 0;\n                        for (var m = this.startCellIndex; m <= this.startCellIndex + colLen; m++) {\n                            this.updateValue(i, m, cells[parseInt(c.toString(), 10)]);\n                            c++;\n                        }\n                    }\n                    this.selectCellsByRange({ rowIndex: trIdx - rowLen, cellIndex: startCellIdx }, { rowIndex: endrowIdx, cellIndex: startCellIdx + colLen });\n                }\n                break;\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        this.stopTimer();\n        document.body.classList.remove('e-disableuserselect');\n        if (this.element && !isNullOrUndefined(this.element.parentElement)) {\n            remove(this.element);\n        }\n        if (this.isDragged && this.selectedRowCellIndexes.length === 1 && this.selectedRowCellIndexes[0].cellIndexes.length === 1) {\n            this.mUPTarget = parentsUntil(e.target, literals.rowCell);\n        }\n        else {\n            this.mUPTarget = null;\n        }\n        var closeRowCell = closest(e.target, '.e-rowcell');\n        if (this.isDragged && !this.isAutoFillSel && this.selectionSettings.mode === 'Cell' &&\n            closeRowCell && closeRowCell.classList.contains(literals.rowCell)) {\n            var rowIndex = parseInt(closeRowCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n            var cellIndex = parseInt(closeRowCell.getAttribute(literals.ariaColIndex), 10) - 1;\n            this.isDragged = false;\n            this.clearCellSelection();\n            this.selectCellsByRange({ rowIndex: this.startDIndex, cellIndex: this.startDCellIndex }, { rowIndex: rowIndex, cellIndex: cellIndex });\n        }\n        this.isDragged = false;\n        this.updateAutoFillPosition();\n        if (this.isAutoFillSel) {\n            this.preventFocus = true;\n            var lastCell = parentsUntil(e.target, literals.rowCell);\n            this.endAFCell = lastCell ? lastCell : this.endCell === this.endAFCell ? this.startAFCell : this.endAFCell;\n            this.startAFCell = this.startCell;\n            if (!isNullOrUndefined(this.endAFCell) && !isNullOrUndefined(this.startAFCell)) {\n                this.updateStartCellsIndex();\n                this.selectLikeAutoFill(e, true);\n                this.updateAutoFillPosition();\n                this.hideAFBorders();\n                this.positionBorders();\n                if (this.parent.isFrozenGrid()) {\n                    this.showHideBorders('none', true);\n                    this.refreshFrozenBorders();\n                }\n                if (this.parent.aggregates.length > 0) {\n                    this.parent.notify(events.refreshFooterRenderer, {});\n                }\n            }\n            this.isAutoFillSel = false;\n            this.preventFocus = false;\n        }\n        EventHandler.remove(this.parent.getContent(), 'mousemove', this.mouseMoveHandler);\n        if (this.parent.frozenRows) {\n            EventHandler.remove(this.parent.getHeaderContent(), 'mousemove', this.mouseMoveHandler);\n        }\n        EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n    };\n    Selection.prototype.hideAutoFill = function () {\n        if (this.autofill) {\n            this.autofill.style.display = 'none';\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.updateAutoFillPosition = function () {\n        if (this.parent.enableAutoFill && !this.parent.isEdit &&\n            this.selectionSettings.cellSelectionMode.indexOf('Box') > -1 && !this.isRowType() && !this.isSingleSel()\n            && this.selectedRowCellIndexes.length) {\n            var index = parseInt(this.target.getAttribute(literals.ariaColIndex), 10) - 1;\n            var rindex = parseInt(this.target.getAttribute('index'), 10);\n            var rowIndex = this.selectedRowCellIndexes[this.selectedRowCellIndexes.length - 1].rowIndex;\n            var cells = this.getAutoFillCells(rowIndex, index).filter(function (ele) { return ele.style.display === ''; });\n            var col = this.parent.getColumnByIndex(index);\n            var isFrozenCol = col.getFreezeTableName() === 'movable';\n            var isFrozenRow = rindex < this.parent.frozenRows;\n            var isFrozenRight = this.parent.getFrozenMode() === literals.leftRight\n                && col.getFreezeTableName() === literals.frozenRight;\n            if (!select('#' + this.parent.element.id + '_autofill', parentsUntil(this.target, literals.table))) {\n                if (select('#' + this.parent.element.id + '_autofill', this.parent.element)) {\n                    select('#' + this.parent.element.id + '_autofill', this.parent.element).remove();\n                }\n                this.autofill = createElement('div', { className: 'e-autofill', id: this.parent.element.id + '_autofill' });\n                this.autofill.style.display = 'none';\n                if (this.target.classList.contains('e-leftfreeze') || this.target.classList.contains('e-rightfreeze') ||\n                    this.target.classList.contains('e-fixedfreeze')) {\n                    this.autofill.classList.add('e-freeze-autofill');\n                }\n                if (!isFrozenRow) {\n                    if (!isFrozenCol) {\n                        this.parent.getContentTable().parentElement.appendChild(this.autofill);\n                    }\n                    else {\n                        this.parent.getContentTable().parentElement.appendChild(this.autofill);\n                    }\n                }\n                else {\n                    if (!isFrozenCol) {\n                        this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n                    }\n                    else {\n                        this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n                    }\n                }\n                if (isFrozenRight) {\n                    if (isFrozenRow) {\n                        this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n                    }\n                    else {\n                        this.parent.getContentTable().parentElement.appendChild(this.autofill);\n                    }\n                }\n            }\n            var cell = cells[cells.length - 1];\n            if (cell && cell.offsetParent) {\n                var clientRect = cell.getBoundingClientRect();\n                var parentOff = cell.offsetParent.getBoundingClientRect();\n                if (cell.offsetParent.classList.contains('e-content') || cell.offsetParent.classList.contains('e-headercontent')) {\n                    parentOff = cell.offsetParent.querySelector('table').getBoundingClientRect();\n                }\n                var colWidth = this.isLastCell(cell) ? 4 : 0;\n                var rowHeight = this.isLastRow(cell) ? 3 : 0;\n                if (!this.parent.enableRtl) {\n                    this.autofill.style.left = clientRect.left - parentOff.left + clientRect.width - 4 - colWidth + 'px';\n                }\n                else {\n                    this.autofill.style.right = parentOff.right - clientRect.right + clientRect.width - 4 - colWidth + 'px';\n                }\n                this.autofill.style.top = clientRect.top - parentOff.top + clientRect.height - 5 - rowHeight + 'px';\n            }\n            this.autofill.style.display = '';\n        }\n        else {\n            this.hideAutoFill();\n        }\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        this.mouseButton = e.button;\n        var target = e.target;\n        var gObj = this.parent;\n        var isDrag;\n        var gridElement = parentsUntil(target, 'e-grid');\n        if (gridElement && gridElement.id !== gObj.element.id || parentsUntil(target, literals.headerContent) && !this.parent.frozenRows ||\n            parentsUntil(target, 'e-editedbatchcell') || parentsUntil(target, literals.editedRow)) {\n            return;\n        }\n        if (e.shiftKey || e.ctrlKey) {\n            e.preventDefault();\n        }\n        if (parentsUntil(target, literals.rowCell) && !e.shiftKey && !e.ctrlKey) {\n            if (gObj.selectionSettings.cellSelectionMode.indexOf('Box') > -1 && !this.isRowType() && !this.isSingleSel()) {\n                this.isCellDrag = true;\n                isDrag = true;\n            }\n            else if (gObj.allowRowDragAndDrop && !gObj.isEdit && !this.parent.selectionSettings.checkboxOnly) {\n                this.isRowDragSelected = false;\n                if (!this.isRowType() || this.isSingleSel() || closest(target, 'td').classList.contains('e-selectionbackground')) {\n                    this.isDragged = false;\n                    return;\n                }\n                isDrag = true;\n                this.element = this.parent.createElement('div', { className: 'e-griddragarea' });\n                gObj.getContent().appendChild(this.element);\n            }\n            if (isDrag) {\n                this.enableDrag(e, true);\n            }\n        }\n        this.updateStartEndCells();\n        if (target.classList.contains('e-autofill') || target.classList.contains('e-xlsel')) {\n            this.isCellDrag = true;\n            this.isAutoFillSel = true;\n            this.enableDrag(e);\n        }\n    };\n    Selection.prototype.updateStartEndCells = function () {\n        var cells = [].slice.call(this.parent.element.getElementsByClassName('e-cellselectionbackground'));\n        this.startCell = cells[0];\n        this.endCell = cells[cells.length - 1];\n        if (this.startCell) {\n            this.startIndex = parseInt(this.startCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n            this.startCellIndex = parseInt(parentsUntil(this.startCell, literals.rowCell).getAttribute(literals.ariaColIndex), 10) - 1;\n        }\n    };\n    Selection.prototype.updateStartCellsIndex = function () {\n        if (this.startCell) {\n            this.startIndex = parseInt(this.startCell.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n            this.startCellIndex = parseInt(parentsUntil(this.startCell, literals.rowCell).getAttribute(literals.ariaColIndex), 10) - 1;\n        }\n    };\n    Selection.prototype.enableDrag = function (e, isUpdate) {\n        var gObj = this.parent;\n        if (isUpdate) {\n            var tr = closest(e.target, 'tr');\n            this.startDIndex = parseInt(tr.getAttribute(literals.ariaRowIndex), 10) - 1;\n            this.startDCellIndex = parseInt(parentsUntil(e.target, literals.rowCell)\n                .getAttribute(literals.ariaColIndex), 10) - 1;\n        }\n        document.body.classList.add('e-disableuserselect');\n        var gBRect = gObj.element.getBoundingClientRect();\n        var postion = getPosition(e);\n        this.x = postion.x - gBRect.left;\n        this.y = postion.y - gBRect.top;\n        EventHandler.add(gObj.getContent(), 'mousemove', this.mouseMoveHandler, this);\n        if (this.parent.frozenRows) {\n            EventHandler.add(gObj.getHeaderContent(), 'mousemove', this.mouseMoveHandler, this);\n        }\n        EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    };\n    Selection.prototype.clearSelAfterRefresh = function (e) {\n        var isInfiniteScroll = this.parent.enableInfiniteScrolling && e.requestType === 'infiniteScroll';\n        if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection && !isInfiniteScroll) {\n            this.clearSelection();\n        }\n        if ((e.requestType === 'virtualscroll' || isInfiniteScroll) && this.parent.isPersistSelection && this.isPartialSelection\n            && this.isHdrSelectAllClicked) {\n            var rowObj = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; });\n            var indexes = [];\n            this.selectedRowState = {};\n            this.persistSelectedData = [];\n            for (var i = 0; i < rowObj.length; i++) {\n                indexes.push(rowObj[parseInt(i.toString(), 10)].index);\n                var pkValue = this.getPkValue(this.primaryKey, rowObj[parseInt(i.toString(), 10)].data);\n                this.selectedRowState[\"\" + pkValue] = true;\n                this.persistSelectedData.push(rowObj[parseInt(i.toString(), 10)].data);\n            }\n            this.selectedRowIndexes = indexes;\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.evtHandlers = [{ event: events.uiUpdate, handler: this.enableAfterRender },\n            { event: events.initialEnd, handler: this.initializeSelection },\n            { event: events.rowSelectionComplete, handler: this.onActionComplete },\n            { event: events.cellSelectionComplete, handler: this.onActionComplete },\n            { event: events.inBoundModelChanged, handler: this.onPropertyChanged },\n            { event: events.cellFocused, handler: this.onCellFocused },\n            { event: events.beforeFragAppend, handler: this.clearSelAfterRefresh },\n            { event: events.columnPositionChanged, handler: this.columnPositionChanged },\n            { event: events.contentReady, handler: this.initialEnd },\n            { event: events.rowsRemoved, handler: this.rowsRemoved },\n            { event: events.headerRefreshed, handler: this.refreshHeader },\n            { event: events.destroyAutoFillElements, handler: this.destroyAutoFillElements },\n            { event: events.destroy, handler: this.destroy }];\n        addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n        this.actionBeginFunction = this.actionBegin.bind(this);\n        this.actionCompleteFunction = this.actionComplete.bind(this);\n        this.parent.addEventListener(events.actionBegin, this.actionBeginFunction);\n        this.parent.addEventListener(events.actionComplete, this.actionCompleteFunction);\n        this.addEventListener_checkbox();\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        EventHandler.remove(this.parent.getContent(), 'mousedown', this.mouseDownHandler);\n        EventHandler.remove(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler);\n        addRemoveEventListener(this.parent, this.evtHandlers, false);\n        this.parent.removeEventListener(events.actionBegin, this.actionBeginFunction);\n        this.parent.removeEventListener(events.actionComplete, this.actionCompleteFunction);\n        this.removeEventListener_checkbox();\n        this.parent.off(events.destroyAutoFillElements, this.destroyAutoFillElements);\n    };\n    Selection.prototype.wireEvents = function () {\n        this.isMacOS = navigator.userAgent.indexOf('Mac OS') !== -1;\n        if (this.isMacOS) {\n            EventHandler.add(this.parent.element, 'keydown', this.keyDownHandler, this);\n            EventHandler.add(this.parent.element, 'keyup', this.keyUpHandler, this);\n        }\n        else {\n            if (!this.parent.allowKeyboard) {\n                EventHandler.add(this.parent.element, 'keydown', this.keyDownHandler, this);\n            }\n        }\n    };\n    Selection.prototype.unWireEvents = function () {\n        if (this.isMacOS) {\n            EventHandler.remove(this.parent.element, 'keydown', this.keyDownHandler);\n            EventHandler.remove(this.parent.element, 'keyup', this.keyUpHandler);\n        }\n        else {\n            if (!this.parent.allowKeyboard) {\n                EventHandler.remove(this.parent.element, 'keydown', this.keyDownHandler);\n            }\n        }\n    };\n    Selection.prototype.columnPositionChanged = function () {\n        if (!this.parent.isPersistSelection) {\n            this.clearSelection();\n        }\n    };\n    Selection.prototype.refreshHeader = function () {\n        var checkboxColumn = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length && !this.parent.getDataModule().isRemote()) {\n            this.gridCurrentRecord = this.getData();\n        }\n        this.setCheckAllState();\n    };\n    Selection.prototype.rowsRemoved = function (e) {\n        for (var i = 0; i < e.records.length; i++) {\n            var pkValue = this.getPkValue(this.primaryKey, e.records[parseInt(i.toString(), 10)]);\n            delete (this.selectedRowState[\"\" + pkValue]);\n            --this.totalRecordsCount;\n        }\n        this.setCheckAllState();\n    };\n    Selection.prototype.beforeFragAppend = function (e) {\n        if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection) {\n            this.clearSelection();\n        }\n    };\n    Selection.prototype.getCheckAllBox = function () {\n        return this.parent.getHeaderContent().querySelector('.e-checkselectall');\n    };\n    Selection.prototype.enableAfterRender = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.render();\n            this.initPerisistSelection();\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Selection.prototype.render = function (e) {\n        EventHandler.add(this.parent.getContent(), 'mousedown', this.mouseDownHandler, this);\n        EventHandler.add(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler, this);\n    };\n    Selection.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        var gObj = this.parent;\n        if (!isNullOrUndefined(e.properties.type)) {\n            if (this.selectionSettings.type === 'Single') {\n                gObj.element.removeAttribute('aria-multiselectable');\n                if (this.selectedRowCellIndexes.length > 1) {\n                    this.clearCellSelection();\n                    this.prevCIdxs = undefined;\n                }\n                if (this.selectedRowIndexes.length > 1) {\n                    this.clearRowSelection();\n                    this.prevRowIndex = undefined;\n                }\n                if (this.selectedColumnsIndexes.length > 1) {\n                    this.clearColumnSelection();\n                    this.prevColIndex = undefined;\n                }\n                this.enableSelectMultiTouch = false;\n                this.hidePopUp();\n            }\n            else if (this.selectionSettings.type === 'Multiple') {\n                gObj.element.setAttribute('aria-multiselectable', 'true');\n            }\n        }\n        if (!isNullOrUndefined(e.properties.mode) ||\n            !isNullOrUndefined(e.properties.cellSelectionMode)) {\n            this.clearSelection();\n            this.prevRowIndex = undefined;\n            this.prevCIdxs = undefined;\n            this.prevColIndex = undefined;\n        }\n        this.isPersisted = true;\n        this.checkBoxSelectionChanged();\n        this.isPersisted = false;\n        if (!this.parent.isCheckBoxSelection) {\n            this.initPerisistSelection();\n        }\n        var checkboxColumn = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length) {\n            gObj.isCheckBoxSelection = !(this.selectionSettings.checkboxMode === 'ResetOnRowClick');\n        }\n        this.drawBorders();\n    };\n    Selection.prototype.hidePopUp = function () {\n        if (this.parent.element.querySelector('.e-gridpopup').getElementsByClassName('e-rowselect').length) {\n            this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n        }\n    };\n    Selection.prototype.initialEnd = function () {\n        if (!this.selectedRowIndexes.length) {\n            this.parent.off(events.contentReady, this.initialEnd);\n            this.selectRow(this.parent.selectedRowIndex);\n        }\n    };\n    Selection.prototype.checkBoxSelectionChanged = function () {\n        var gobj = this.parent;\n        gobj.off(events.contentReady, this.checkBoxSelectionChanged);\n        var checkboxColumn = gobj.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length > 0) {\n            gobj.isCheckBoxSelection = true;\n            this.chkField = checkboxColumn[0].field;\n            this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n            if (isNullOrUndefined(this.totalRecordsCount)) {\n                this.totalRecordsCount = this.getCurrentBatchRecordChanges().length;\n            }\n            if (this.isSingleSel()) {\n                gobj.selectionSettings.type = 'Multiple';\n                gobj.dataBind();\n            }\n            else {\n                this.initPerisistSelection();\n            }\n        }\n        if (!gobj.isCheckBoxSelection && !this.isPersisted) {\n            this.chkField = null;\n            this.initPerisistSelection();\n        }\n    };\n    Selection.prototype.initPerisistSelection = function () {\n        var gobj = this.parent;\n        if (this.parent.selectionSettings.persistSelection && this.parent.getPrimaryKeyFieldNames().length > 0) {\n            gobj.isPersistSelection = true;\n            this.ensureCheckboxFieldSelection();\n        }\n        else if (this.parent.getPrimaryKeyFieldNames().length > 0) {\n            gobj.isPersistSelection = false;\n            this.ensureCheckboxFieldSelection();\n        }\n        else {\n            gobj.isPersistSelection = false;\n            this.selectedRowState = {};\n        }\n    };\n    Selection.prototype.ensureCheckboxFieldSelection = function () {\n        var gobj = this.parent;\n        this.primaryKey = this.parent.getPrimaryKeyFieldNames()[0];\n        if (!gobj.enableVirtualization && this.chkField\n            && ((gobj.isPersistSelection && Object.keys(this.selectedRowState).length === 0) ||\n                !gobj.isPersistSelection)) {\n            this.dataSuccess((!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) ||\n                this.parent.getDataModule().isRemote() ? this.parent.getCurrentViewRecords() :\n                this.parent.renderModule.data.dataManager.dataSource.json);\n        }\n    };\n    Selection.prototype.dataSuccess = function (res) {\n        for (var i = 0; i < res.length; i++) {\n            var pkValue = this.getPkValue(this.primaryKey, res[parseInt(i.toString(), 10)]);\n            var checkedFieldData = res[parseInt(i.toString(), 10)][this.chkField];\n            if (isNullOrUndefined(this.selectedRowState[\"\" + pkValue]) && checkedFieldData && typeof checkedFieldData === 'boolean') {\n                this.selectedRowState[\"\" + pkValue] = checkedFieldData;\n                if (this.parent.isPersistSelection) {\n                    this.persistSelectedData.push(res[parseInt(i.toString(), 10)]);\n                }\n            }\n        }\n    };\n    Selection.prototype.setRowSelection = function (state) {\n        if (!(this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n            && this.parent.dataSource.result))) {\n            if (state) {\n                if (this.isPartialSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n                    var rowObj = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; });\n                    for (var _i = 0, rowObj_1 = rowObj; _i < rowObj_1.length; _i++) {\n                        var row = rowObj_1[_i];\n                        this.selectedRowState[this.getPkValue(this.primaryKey, row.data)] = true;\n                    }\n                }\n                else {\n                    var selectedData = this.isPartialSelection ? this.parent.partialSelectedRecords : this.getData();\n                    if (this.parent.groupSettings.columns.length) {\n                        for (var _a = 0, _b = this.isPartialSelection ? selectedData : selectedData.records; _a < _b.length; _a++) {\n                            var data = _b[_a];\n                            this.selectedRowState[this.getPkValue(this.primaryKey, data)] = true;\n                        }\n                    }\n                    else {\n                        for (var _c = 0, selectedData_1 = selectedData; _c < selectedData_1.length; _c++) {\n                            var data = selectedData_1[_c];\n                            this.selectedRowState[this.getPkValue(this.primaryKey, data)] = true;\n                        }\n                    }\n                }\n            }\n            else {\n                this.selectedRowState = {};\n            }\n            // (this.getData()).forEach(function (data) {\n            //     this.selectedRowState[data[this.primaryKey]] = true;\n            // })\n        }\n        else {\n            if (state) {\n                var selectedStateKeys = Object.keys(this.selectedRowState);\n                var unSelectedRowStateKeys = Object.keys(this.unSelectedRowState);\n                if (!this.isCheckboxReset) {\n                    var rowData = (this.parent.groupSettings.columns.length && this.parent.isPersistSelection) ?\n                        this.parent.currentViewData['records'] : this.parent.currentViewData;\n                    for (var _d = 0, rowData_1 = rowData; _d < rowData_1.length; _d++) {\n                        var data = rowData_1[_d];\n                        if (!isNullOrUndefined(data[this.primaryKey])) {\n                            var key = data[this.primaryKey].toString();\n                            if (selectedStateKeys.indexOf(key) === -1 && unSelectedRowStateKeys.indexOf(key) === -1) {\n                                this.selectedRowState[data[this.primaryKey]] = true;\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                this.selectedRowState = {};\n                this.unSelectedRowState = {};\n                this.rmtHdrChkbxClicked = false;\n            }\n        }\n    };\n    Selection.prototype.getData = function () {\n        return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(true));\n    };\n    Selection.prototype.getAvailableSelectedData = function (data) {\n        var filteredSearchedSelectedData = new DataManager(data).executeLocal(this.parent.getDataModule().generateQuery(true));\n        if (this.parent.groupSettings.columns.length && filteredSearchedSelectedData &&\n            filteredSearchedSelectedData.records) {\n            filteredSearchedSelectedData = filteredSearchedSelectedData.records.slice();\n        }\n        return filteredSearchedSelectedData;\n    };\n    Selection.prototype.refreshPersistSelection = function () {\n        var rows = this.parent.getRows();\n        this.totalRecordsCount = this.parent.getCurrentViewRecords().length;\n        if (this.parent.allowPaging) {\n            this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n        }\n        if (!isNullOrUndefined(rows) && rows.length > 0 && (this.parent.isPersistSelection || this.chkField)) {\n            var indexes = [];\n            for (var j = 0; j < rows.length; j++) {\n                var rowObj = this.getRowObj(rows[parseInt(j.toString(), 10)]);\n                var pKey = rowObj ? rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null : null;\n                if (pKey === null) {\n                    return;\n                }\n                if (this.isPartialSelection && !rowObj.isSelectable) {\n                    continue;\n                }\n                var checkState = void 0;\n                var chkBox = rows[parseInt(j.toString(), 10)].querySelector('.e-checkselect');\n                if (this.selectedRowState[\"\" + pKey] || (this.parent.checkAllRows === 'Check' && this.selectedRowState[\"\" + pKey] &&\n                    this.totalRecordsCount === Object.keys(this.selectedRowState).length && this.chkAllCollec.indexOf(pKey) < 0)\n                    || (this.parent.checkAllRows === 'Uncheck' && this.chkAllCollec.indexOf(pKey) > 0 && !this.parent.selectedRowIndex)\n                    || (this.parent.checkAllRows === 'Intermediate' && !isNullOrUndefined(this.chkField) && rowObj.data[this.chkField])) {\n                    indexes.push(parseInt(rows[parseInt(j.toString(), 10)].getAttribute(literals.ariaRowIndex), 10) - 1);\n                    checkState = true;\n                }\n                else {\n                    checkState = false;\n                    if (this.checkedTarget !== chkBox && this.parent.isCheckBoxSelection && chkBox) {\n                        removeAddCboxClasses(chkBox.nextElementSibling, checkState);\n                    }\n                }\n                this.updatePersistCollection(rows[parseInt(j.toString(), 10)], checkState);\n            }\n            if (this.isSingleSel() && indexes.length > 0) {\n                this.selectRow(indexes[0], true);\n            }\n            else {\n                this.selectRows(indexes);\n            }\n        }\n        if ((this.parent.isCheckBoxSelection || this.parent.selectionSettings.checkboxMode === 'ResetOnRowClick') && this.getCurrentBatchRecordChanges().length > 0) {\n            this.setCheckAllState();\n        }\n    };\n    Selection.prototype.actionBegin = function (e) {\n        if (e.requestType === 'save' && this.parent.isPersistSelection) {\n            var editChkBox = this.parent.element.querySelector('.e-edit-checkselect');\n            if (!isNullOrUndefined(editChkBox)) {\n                var row = closest(editChkBox, '.' + literals.editedRow);\n                if (row) {\n                    if (this.parent.editSettings.mode === 'Dialog') {\n                        row = this.parent.element.querySelector('.e-dlgeditrow');\n                    }\n                    var rowObj = this.getRowObj(row);\n                    if (!rowObj) {\n                        return;\n                    }\n                    this.selectedRowState[this.getPkValue(this.primaryKey, rowObj.data)] = rowObj.isSelected = editChkBox.checked;\n                }\n                else {\n                    this.isCheckedOnAdd = editChkBox.checked;\n                }\n            }\n        }\n        if (this.parent.isPersistSelection && this.isPartialSelection) {\n            if (e.requestType === 'paging' && (this.parent.getDataModule().isRemote()\n                || (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result))) {\n                this.selectedRowIndexes = [];\n            }\n        }\n    };\n    Selection.prototype.actionComplete = function (e) {\n        if (e.requestType === 'save' && this.parent.isPersistSelection) {\n            if (e.action === 'add') {\n                if (this.isCheckedOnAdd) {\n                    var rowObj = this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute('data-uid'));\n                    this.selectedRowState[this.getPkValue(this.primaryKey, rowObj.data)] = rowObj.isSelected = this.isCheckedOnAdd;\n                }\n                this.isHdrSelectAllClicked = false;\n                this.setCheckAllState();\n            }\n            this.refreshPersistSelection();\n        }\n        if (e.requestType === 'delete' && this.parent.isPersistSelection) {\n            var records = e.data;\n            var data = records.slice();\n            for (var i = 0; i < data.length; i++) {\n                var pkValue = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n                if (!isNullOrUndefined(pkValue)) {\n                    this.updatePersistDelete(pkValue, this.isPartialSelection);\n                }\n            }\n            this.isHdrSelectAllClicked = false;\n            this.setCheckAllState();\n            this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n        }\n        if (e.requestType === 'paging') {\n            if (this.parent.isPersistSelection && this.isPartialSelection && this.isHdrSelectAllClicked) {\n                var rows = this.parent.getRowsObject();\n                var indexes = [];\n                for (var i = 0; i < rows.length; i++) {\n                    if (rows[parseInt(i.toString(), 10)].isSelectable) {\n                        indexes.push(rows[parseInt(i.toString(), 10)].index);\n                    }\n                }\n                if (indexes.length) {\n                    this.selectRows(indexes);\n                }\n            }\n            this.prevRowIndex = undefined;\n            this.prevCIdxs = undefined;\n            this.prevECIdxs = undefined;\n        }\n    };\n    Selection.prototype.onDataBound = function () {\n        var checkboxColumn = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length && !this.parent.getDataModule().isRemote()) {\n            this.gridCurrentRecord = this.getData();\n        }\n        if (!this.parent.enableVirtualization && this.parent.isPersistSelection) {\n            if (this.selectedRecords.length) {\n                this.isPrevRowSelection = true;\n            }\n        }\n        if (((this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n            && this.parent.dataSource.result)) && this.rmtHdrChkbxClicked)\n            || (this.isPartialSelection && this.parent.isPersistSelection && this.isHdrSelectAllClicked)) {\n            if (this.parent.checkAllRows === 'Intermediate') {\n                this.setRowSelection(true);\n            }\n            else if (this.parent.checkAllRows === 'Uncheck') {\n                this.setRowSelection(false);\n            }\n        }\n        if (this.parent.enableVirtualization) {\n            this.setCheckAllState();\n        }\n        if (this.parent.isPersistSelection) {\n            this.refreshPersistSelection();\n        }\n        this.initialRowSelection = this.isRowType() && this.parent.element.querySelectorAll('.e-selectionbackground') &&\n            this.parent.getSelectedRows().length ? true : false;\n        if (this.parent.isCheckBoxSelection && !this.initialRowSelection) {\n            var totalRecords = this.parent.getRowsObject();\n            var indexes = [];\n            for (var i = 0; i < totalRecords.length; i++) {\n                if (totalRecords[parseInt(i.toString(), 10)].isSelected) {\n                    indexes.push(i);\n                }\n            }\n            if (indexes.length) {\n                this.selectRows(indexes);\n            }\n            this.initialRowSelection = true;\n        }\n    };\n    Selection.prototype.updatePersistSelectedData = function (checkState) {\n        if (this.parent.isPersistSelection) {\n            var rows = this.parent.getRows();\n            for (var i = 0; i < rows.length; i++) {\n                this.updatePersistCollection(rows[parseInt(i.toString(), 10)], checkState);\n            }\n            if (this.parent.checkAllRows === 'Uncheck') {\n                this.setRowSelection(false);\n                this.persistSelectedData = (this.parent.getDataModule().isRemote()\n                    || (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result))\n                    ? this.persistSelectedData : [];\n            }\n            else if (this.parent.checkAllRows === 'Check') {\n                this.setRowSelection(true);\n                this.persistSelectedData = !(this.parent.getDataModule().isRemote()\n                    || (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result))\n                    && !this.isPartialSelection ?\n                    this.parent.groupSettings.columns.length ? this.getData().records.slice() :\n                        this.getData().slice() : this.persistSelectedData;\n            }\n        }\n    };\n    Selection.prototype.checkSelectAllAction = function (checkState) {\n        var cRenderer = this.getRenderer();\n        var editForm = this.parent.element.querySelector('.e-gridform');\n        this.checkedTarget = this.getCheckAllBox();\n        if (checkState && this.getCurrentBatchRecordChanges().length) {\n            this.parent.checkAllRows = 'Check';\n            this.updatePersistSelectedData(checkState);\n            this.selectRowsByRange(cRenderer.getVirtualRowIndex(0), cRenderer.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length - 1));\n            if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n                this.virtualSelectedData = this.virtualCheckBoxData().slice();\n                this.selectedRowIndexes = Object.keys(this.virtualSelectedData).map(function (key) { return parseInt(key, 10); });\n            }\n        }\n        else {\n            this.parent.checkAllRows = 'Uncheck';\n            this.updatePersistSelectedData(checkState);\n            this.clearSelection();\n        }\n        this.chkAllCollec = [];\n        if (!isNullOrUndefined(editForm)) {\n            var editChkBox = editForm.querySelector('.e-edit-checkselect');\n            if (!isNullOrUndefined(editChkBox)) {\n                removeAddCboxClasses(editChkBox.nextElementSibling, checkState);\n            }\n        }\n    };\n    Selection.prototype.checkSelectAll = function (checkBox) {\n        var _this = this;\n        var stateStr = this.getCheckAllStatus(checkBox);\n        var state = stateStr === 'Check';\n        this.isHeaderCheckboxClicked = true;\n        if ((this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n            && this.parent.dataSource.result)) && ((stateStr === 'Uncheck' || this.isCheckboxReset) ||\n            (stateStr === 'Intermediate' && this.parent.isPersistSelection))) {\n            this.rmtHdrChkbxClicked = true;\n        }\n        else {\n            this.rmtHdrChkbxClicked = false;\n        }\n        if (this.rmtHdrChkbxClicked && this.isCheckboxReset) {\n            this.unSelectedRowState = {};\n        }\n        this.isCheckboxReset = false;\n        if (stateStr === 'Intermediate') {\n            if (!this.chkField && !this.parent.isPersistSelection) {\n                state = this.getCurrentBatchRecordChanges().some(function (data) {\n                    return _this.getPkValue(_this.primaryKey, data) in _this.selectedRowState;\n                });\n            }\n            if (this.parent.isPersistSelection) {\n                if (this.parent.allowPaging && this.isPartialSelection) {\n                    var rowObjects = this.parent.getRowsObject();\n                    for (var i = 0; i < rowObjects.length; i++) {\n                        if (rowObjects[i].isDataRow && rowObjects[i].isSelectable &&\n                            !rowObjects[i].isSelected) {\n                            state = false;\n                            break;\n                        }\n                        else {\n                            state = true;\n                        }\n                    }\n                }\n                else if ((this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n                    && this.parent.dataSource.result))) {\n                    for (var i = 0; i < this.getCurrentBatchRecordChanges().length; i++) {\n                        if (!isNullOrUndefined(this.getPkValue(this.primaryKey, this.getCurrentBatchRecordChanges()[\"\" + i]))) {\n                            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                            if (Object.keys(this.selectedRowState).includes((this.getPkValue(this.primaryKey, this.getCurrentBatchRecordChanges()[\"\" + i])).toString())) {\n                                state = true;\n                            }\n                            else {\n                                state = false;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (this.parent.isPersistSelection && this.parent.allowPaging) {\n            this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n        }\n        this.checkSelectAllAction(!state);\n        this.target = null;\n        if (this.getCurrentBatchRecordChanges().length > 0) {\n            this.setCheckAllState();\n            this.updateSelectedRowIndexes();\n        }\n        this.triggerChkChangeEvent(checkBox, !state);\n    };\n    Selection.prototype.getCheckAllStatus = function (ele) {\n        var classes;\n        if (!isNullOrUndefined(ele)) {\n            classes = ele.nextElementSibling.classList;\n        }\n        else {\n            if (!isNullOrUndefined(this.getCheckAllBox())) {\n                classes = this.getCheckAllBox().nextElementSibling.classList;\n            }\n        }\n        var status = 'None';\n        if (classes instanceof DOMTokenList) {\n            if (classes.contains('e-check')) {\n                status = 'Check';\n            }\n            else if (classes.contains('e-uncheck')) {\n                status = 'Uncheck';\n            }\n            else if (classes.contains('e-stop')) {\n                status = 'Intermediate';\n            }\n        }\n        return status;\n    };\n    Selection.prototype.checkSelect = function (checkBox) {\n        var target = closest(this.checkedTarget, '.' + literals.rowCell);\n        var gObj = this.parent;\n        this.isMultiCtrlRequest = true;\n        var rIndex = 0;\n        this.isHeaderCheckboxClicked = false;\n        if (isGroupAdaptive(gObj)) {\n            var uid = target.parentElement.getAttribute('data-uid');\n            if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n                rIndex = parseInt(target.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n            }\n            else {\n                rIndex = gObj.getRows().map(function (m) { return m.getAttribute('data-uid'); }).indexOf(uid);\n            }\n        }\n        else {\n            rIndex = parseInt(target.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n        }\n        if (this.parent.isPersistSelection && this.parent.element.getElementsByClassName(literals.addedRow).length > 0 &&\n            this.parent.editSettings.newRowPosition === 'Top' && !this.parent.editSettings.showAddNewRow) {\n            ++rIndex;\n        }\n        this.rowCellSelectionHandler(rIndex, parseInt(target.getAttribute(literals.ariaColIndex), 10) - 1);\n        this.moveIntoUncheckCollection(closest(target, '.' + literals.row));\n        this.setCheckAllState();\n        this.isMultiCtrlRequest = false;\n        this.triggerChkChangeEvent(checkBox, checkBox.nextElementSibling.classList.contains('e-check'));\n    };\n    Selection.prototype.moveIntoUncheckCollection = function (row) {\n        if (this.parent.checkAllRows === 'Check' || this.parent.checkAllRows === 'Uncheck') {\n            var rowObj = this.getRowObj(row);\n            var pKey = rowObj && rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null;\n            if (!pKey) {\n                return;\n            }\n            if (this.chkAllCollec.indexOf(pKey) < 0) {\n                this.chkAllCollec.push(pKey);\n            }\n            else {\n                this.chkAllCollec.splice(this.chkAllCollec.indexOf(pKey), 1);\n            }\n        }\n    };\n    Selection.prototype.triggerChkChangeEvent = function (checkBox, checkState) {\n        this.parent.trigger(events.checkBoxChange, {\n            checked: checkState, selectedRowIndexes: this.parent.getSelectedRowIndexes(),\n            target: checkBox\n        });\n        if (!this.parent.isEdit) {\n            this.checkedTarget = null;\n        }\n    };\n    Selection.prototype.updateSelectedRowIndexes = function () {\n        if (this.parent.isCheckBoxSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) &&\n            this.isPartialSelection && !(this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n            && this.parent.dataSource.result))\n            && this.parent.selectionSettings.persistSelection) {\n            if (this.parent.checkAllRows !== 'Uncheck') {\n                var rowObj = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; });\n                for (var _i = 0, rowObj_2 = rowObj; _i < rowObj_2.length; _i++) {\n                    var row = rowObj_2[_i];\n                    this.selectedRowIndexes.push(row.index);\n                }\n            }\n        }\n        if (this.parent.isCheckBoxSelection && this.parent.enableVirtualization && !this.isPartialSelection &&\n            (this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n                && this.parent.dataSource.result))\n            && !this.parent.isPersistSelection && this.parent.checkAllRows === 'Check') {\n            var rowObj = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; });\n            if (rowObj.length !== this.selectedRowIndexes.length) {\n                for (var _a = 0, rowObj_3 = rowObj; _a < rowObj_3.length; _a++) {\n                    var row = rowObj_3[_a];\n                    if (this.selectedRowIndexes.indexOf(row.index) <= -1) {\n                        this.selectedRowIndexes.push(row.index);\n                    }\n                }\n            }\n        }\n    };\n    Selection.prototype.updateSelectedRowIndex = function (index) {\n        if (this.parent.isCheckBoxSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)\n            && !(this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n                && this.parent.dataSource.result))\n            && !this.isPartialSelection) {\n            if (this.parent.checkAllRows === 'Check') {\n                this.selectedRowIndexes = [];\n                var dataLength = this.parent.groupSettings.columns.length ? this.getData()['records'].length :\n                    this.getData().length;\n                for (var data = 0; data < dataLength; data++) {\n                    this.selectedRowIndexes.push(data);\n                }\n            }\n            else if (this.parent.checkAllRows === 'Uncheck') {\n                this.selectedRowIndexes = [];\n            }\n            else {\n                var row = this.parent.getRowByIndex(index);\n                if (index && row && row.getAttribute('aria-selected') === 'false') {\n                    var selectedVal = this.selectedRowIndexes.indexOf(index);\n                    this.selectedRowIndexes.splice(selectedVal, 1);\n                }\n            }\n        }\n    };\n    Selection.prototype.isAllSelected = function (count) {\n        if (this.parent.getDataModule().isRemote()\n            || (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result)) {\n            return this.getAvailableSelectedData(this.persistSelectedData).length === (this.parent.enableVirtualization\n                || this.parent.enableInfiniteScrolling ? this.parent.totalDataRecordsCount : this.totalRecordsCount);\n        }\n        else {\n            if (this.isPartialSelection) {\n                if (this.parent.allowPaging && !this.selectionSettings.persistSelection\n                    && this.parent.pageSettings.pageSize < this.parent.pageSettings.totalRecordsCount) {\n                    var data = this.parent.partialSelectedRecords;\n                    for (var i = 0; i < data.length; i++) {\n                        var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n                        if (!this.selectedRowState[\"\" + pKey]) {\n                            return false;\n                        }\n                    }\n                    return true;\n                }\n                else {\n                    return this.isSelectAllRowCount(count);\n                }\n            }\n            else {\n                var data = this.getData();\n                if (this.parent.groupSettings.columns.length && data['records']) {\n                    data = data['records'];\n                }\n                for (var i = 0; i < data.length; i++) {\n                    var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n                    if (!this.selectedRowState[\"\" + pKey]) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        }\n    };\n    Selection.prototype.someDataSelected = function () {\n        if ((this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n            && this.parent.dataSource.result))\n            && (this.parent.searchSettings.key.length || this.parent.filterSettings.columns.length)) {\n            var filteredSearchedSelectedData = this.getAvailableSelectedData(this.persistSelectedData);\n            for (var i = 0; i < filteredSearchedSelectedData.length; i++) {\n                var pKey = this.getPkValue(this.primaryKey, filteredSearchedSelectedData[parseInt(i.toString(), 10)]);\n                if (this.selectedRowState[\"\" + pKey]) {\n                    return false;\n                }\n            }\n        }\n        var data = this.isPartialSelection ? this.getAvailableSelectedData(this.parent.partialSelectedRecords)\n            : (this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n                && this.parent.dataSource.result)) ? [] : this.getData();\n        for (var i = 0; i < data.length; i++) {\n            var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n            if (this.selectedRowState[\"\" + pKey]) {\n                return false;\n            }\n        }\n        return true;\n    };\n    Selection.prototype.setCheckAllState = function (index, isInteraction) {\n        if (this.parent.isCheckBoxSelection || this.parent.selectionSettings.checkboxMode === 'ResetOnRowClick') {\n            var checkToSelectAll = false;\n            var isFiltered = false;\n            var checkedLen = Object.keys(this.selectedRowState).length;\n            if (this.parent.element.classList.contains('e-treelistgrid') && this.parent.isPersistSelection && !this.parent.enableVirtualization &&\n                !this.parent.getDataModule().isRemote() && Array.isArray(this.parent.dataSource) &&\n                checkedLen === this.parent.dataSource.length && checkedLen > this.totalRecordsCount) {\n                checkedLen = this.totalRecordsCount;\n            }\n            if (!this.parent.isPersistSelection) {\n                checkedLen = this.selectedRowIndexes.length;\n                this.totalRecordsCount = this.getCurrentBatchRecordChanges().length;\n            }\n            if (this.parent.isPersistSelection && !((this.parent.getDataModule().isRemote() ||\n                (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result)) &&\n                this.isPartialSelection)\n                && (this.parent.searchSettings.key.length || this.parent.filterSettings.columns.length)) {\n                isFiltered = true;\n                checkToSelectAll = this.isAllSelected(checkedLen);\n            }\n            var input = this.getCheckAllBox();\n            if (input) {\n                var spanEle = input.nextElementSibling;\n                removeClass([spanEle], ['e-check', 'e-stop', 'e-uncheck']);\n                setChecked(input, false);\n                input.indeterminate = false;\n                var getRecord = this.parent.getDataModule().isRemote() ? [] : this.gridCurrentRecord;\n                if (this.parent.groupSettings.columns.length && getRecord['records']) {\n                    getRecord = getRecord['records'];\n                }\n                this.totalRecordsCount = this.checkVirtualCheckBox() ? getRecord.length : this.totalRecordsCount;\n                if ((checkToSelectAll && isFiltered && (this.parent.getDataModule().isRemote() ||\n                    (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result) ||\n                    getRecord.length)) || (!isFiltered && ((checkedLen === this.totalRecordsCount && this.totalRecordsCount\n                    && !this.isPartialSelection && (!(this.parent.getDataModule().isRemote()\n                    || (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result))\n                    || this.parent.allowPaging)) ||\n                    (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling\n                        && this.isPartialSelection && (this.isSelectAllRowCount(checkedLen)\n                        || (this.isHdrSelectAllClicked && !this.parent.isPersistSelection)))\n                    || ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)\n                        && !this.parent.allowPaging && ((!(this.parent.getDataModule().isRemote()\n                        || (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result)) &&\n                        getRecord.length && checkedLen === getRecord.length) || ((this.parent.getDataModule().isRemote()\n                        || (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result)) &&\n                        !this.isPartialSelection && ((checkedLen === this.parent.totalDataRecordsCount) || ((this.\n                        isSelectAllRowCount(checkedLen) || checkedLen === this.totalRecordsCount) && !this.parent.isPersistSelection))) ||\n                        (this.isPartialSelection && (this.isHdrSelectAllClicked || this.isSelectAllRowCount(checkedLen)))))\n                    || (checkedLen === this.totalRecordsCount && this.totalRecordsCount && !this.isPartialSelection &&\n                        !this.parent.allowPaging && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling)))) {\n                    addClass([spanEle], ['e-check']);\n                    setChecked(input, true);\n                    if (isInteraction) {\n                        this.getRenderer().setSelection(null, true, true);\n                    }\n                    this.parent.checkAllRows = 'Check';\n                }\n                else if (((!this.selectedRowIndexes.length && (!this.parent.enableVirtualization ||\n                    (!this.persistSelectedData.length && !isFiltered) || (isFiltered && this.someDataSelected())) ||\n                    checkedLen === 0 && this.getCurrentBatchRecordChanges().length === 0) && !this.parent.allowPaging) ||\n                    (this.parent.allowPaging && (checkedLen === 0 || (checkedLen && isFiltered && this.someDataSelected())))) {\n                    addClass([spanEle], ['e-uncheck']);\n                    if (isInteraction) {\n                        this.getRenderer().setSelection(null, false, true);\n                    }\n                    this.parent.checkAllRows = 'Uncheck';\n                }\n                else {\n                    addClass([spanEle], ['e-stop']);\n                    this.parent.checkAllRows = 'Intermediate';\n                    input.indeterminate = true;\n                }\n                if (checkedLen === 0 && this.getCurrentBatchRecordChanges().length === 0) {\n                    addClass([spanEle.parentElement], ['e-checkbox-disabled']);\n                }\n                else {\n                    removeClass([spanEle.parentElement], ['e-checkbox-disabled']);\n                }\n                if (this.isPartialSelection) {\n                    var rowCount = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; }).length;\n                    if (rowCount === 0 && spanEle.parentElement.querySelector('.e-frame').classList.contains('e-uncheck')) {\n                        addClass([spanEle.parentElement], ['e-checkbox-disabled']);\n                    }\n                    else {\n                        removeClass([spanEle.parentElement], ['e-checkbox-disabled']);\n                    }\n                }\n                if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)\n                    && !this.parent.allowPaging && !(this.parent.getDataModule().isRemote()\n                    || (!isNullOrUndefined(this.parent.dataSource) && this.parent.dataSource.result))) {\n                    this.updateSelectedRowIndex(index);\n                }\n            }\n        }\n    };\n    Selection.prototype.checkVirtualCheckBox = function () {\n        return this.parent.enableVirtualization && !(this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n            && this.parent.dataSource.result)) && this.parent.isCheckBoxSelection && !this.isPartialSelection;\n    };\n    Selection.prototype.virtualCheckBoxData = function () {\n        var data = this.getData();\n        if (this.parent.groupSettings.columns.length && data['records']) {\n            data = data['records'];\n        }\n        return data;\n    };\n    Selection.prototype.isSelectAllRowCount = function (count) {\n        var rowCount = 0;\n        var rowObj = this.parent.getRowsObject();\n        if (this.parent.selectionSettings.persistSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n            var dataLen = (this.parent.getDataModule().isRemote() || (!isNullOrUndefined(this.parent.dataSource)\n                && this.parent.dataSource.result)) ?\n                this.parent.totalDataRecordsCount : this.getData() && this.getData().length;\n            if (dataLen === rowObj.length) {\n                rowCount = rowObj.filter(function (e) { return e.isSelectable; }).length;\n                return rowCount && count === rowCount;\n            }\n            else {\n                return false;\n            }\n        }\n        else {\n            if (this.parent.allowPaging && this.parent.selectionSettings.persistSelection) {\n                var disableSelectedRecordsCount = this.getAvailableSelectedData(this.parent.disableSelectedRecords).length;\n                var partialSelectedRecordsCount = this.getAvailableSelectedData(this.parent.partialSelectedRecords).length;\n                var selectedRowCount = this.getAvailableSelectedData(this.persistSelectedData).length;\n                rowCount = disableSelectedRecordsCount + partialSelectedRecordsCount;\n                return rowCount === this.totalRecordsCount && selectedRowCount !== 0 && selectedRowCount === partialSelectedRecordsCount;\n            }\n            else {\n                rowCount = rowObj.filter(function (e) { return e.isSelectable; }).length;\n                return rowCount && count === rowCount;\n            }\n        }\n    };\n    Selection.prototype.keyDownHandler = function (e) {\n        // Below are keyCode for command key in MAC OS. Safari/Chrome(91-Left command, 93-Right Command), Opera(17), FireFox(224)\n        if ((Browser.info.name === 'opera' && e.keyCode === 17) || (Browser.info.name === 'mozilla' && e.keyCode === 224) ||\n            (((Browser.info.name === 'safari') || (Browser.info.name === 'chrome')) && (e.keyCode === 91 || e.keyCode === 93))) {\n            this.cmdKeyPressed = true;\n        }\n        var targetHeadCell = parentsUntil(e.target, 'e-headercell');\n        var targetRowCell = parentsUntil(e.target, literals.rowCell);\n        var isCheckBox = targetHeadCell ? targetHeadCell.children[0].classList.contains('e-headerchkcelldiv') :\n            targetRowCell ? targetRowCell.classList.contains('e-gridchkbox') : false;\n        if (isCheckBox && !this.parent.allowKeyboard && e.keyCode === 32) {\n            e.preventDefault();\n        }\n    };\n    Selection.prototype.keyUpHandler = function (e) {\n        if ((Browser.info.name === 'opera' && e.keyCode === 17) || (Browser.info.name === 'mozilla' && e.keyCode === 224) ||\n            (((Browser.info.name === 'safari') || (Browser.info.name === 'chrome')) && (e.keyCode === 91 || e.keyCode === 93))) {\n            this.cmdKeyPressed = false;\n        }\n    };\n    Selection.prototype.clickHandler = function (e) {\n        var target = e.target;\n        this.actualTarget = target;\n        if (!this.isAutoFillSel && !e.ctrlKey && !e.shiftKey) {\n            this.startAFCell = this.endAFCell = null;\n        }\n        if (this.selectionSettings.persistSelection) {\n            this.deSelectedData = iterateExtend(this.persistSelectedData);\n        }\n        if (parentsUntil(target, literals.row) || parentsUntil(target, 'e-headerchkcelldiv') ||\n            (this.selectionSettings.allowColumnSelection && target.classList.contains('e-headercell'))) {\n            this.isInteracted = true;\n        }\n        this.cmdKeyPressed = e.metaKey;\n        this.isMultiCtrlRequest = e.ctrlKey || this.enableSelectMultiTouch ||\n            (this.isMacOS && this.cmdKeyPressed);\n        if (!this.parent.allowKeyboard) {\n            this.isMultiShiftRequest = false;\n            this.isMultiCtrlRequest = false;\n        }\n        else {\n            this.isMultiShiftRequest = e.shiftKey;\n        }\n        this.isMultiCtrlRequestCell = this.isMultiCtrlRequest;\n        this.popUpClickHandler(e);\n        var chkSelect = false;\n        this.preventFocus = true;\n        var checkBox;\n        var checkWrap = parentsUntil(target, 'e-checkbox-wrapper');\n        this.checkSelectAllClicked = checkWrap && checkWrap.getElementsByClassName('e-checkselectall') ||\n            (this.selectionSettings.persistSelection && parentsUntil(target, literals.row)) ? true : false;\n        if (this.selectionSettings.persistSelection && this.isPartialSelection && parentsUntil(target, 'e-headerchkcelldiv')\n            && !target.querySelector('.e-checkbox-disabled')) {\n            this.isHdrSelectAllClicked = true;\n        }\n        if (checkWrap && checkWrap.querySelectorAll('.e-checkselect,.e-checkselectall').length > 0) {\n            checkBox = checkWrap.querySelector('input[type=\"checkbox\"]');\n            chkSelect = true;\n        }\n        this.drawBorders();\n        this.updateAutoFillPosition();\n        target = parentsUntil(target, literals.rowCell);\n        if (this.parent.isReact && (target && !target.parentElement && target.classList.contains('e-rowcell'))) {\n            target = this.parent.getCellFromIndex(parseInt(target.getAttribute('index'), 10), parseInt(target.getAttribute('aria-colindex'), 10) - 1);\n        }\n        if (this.isRowDragSelected && isNullOrUndefined(target) && this.parent.allowRowDragAndDrop &&\n            this.selectionSettings.persistSelection && this.checkSelectAllClicked) {\n            this.isRowDragSelected = false;\n        }\n        if (((target && target.parentElement.classList.contains(literals.row) && !this.parent.selectionSettings.checkboxOnly) || chkSelect)\n            && !this.isRowDragSelected) {\n            if (this.parent.isCheckBoxSelection) {\n                this.isMultiCtrlRequest = true;\n            }\n            this.target = target;\n            if (!isNullOrUndefined(checkBox)) {\n                this.checkedTarget = checkBox;\n                if (checkBox.classList.contains('e-checkselectall')) {\n                    this.checkSelectAll(checkBox);\n                }\n                else {\n                    this.checkSelect(checkBox);\n                }\n            }\n            else {\n                var rIndex = 0;\n                rIndex = parseInt(target.parentElement.getAttribute(literals.ariaRowIndex), 10) - 1;\n                if (this.parent.isPersistSelection && !this.parent.editSettings.showAddNewRow\n                    && this.parent.element.getElementsByClassName(literals.addedRow).length > 0) {\n                    ++rIndex;\n                }\n                if (!this.mUPTarget || !this.mUPTarget.isEqualNode(target)) {\n                    this.rowCellSelectionHandler(rIndex, parseInt(target.getAttribute(literals.ariaColIndex), 10) - 1);\n                }\n                if (this.parent.isCheckBoxSelection) {\n                    this.moveIntoUncheckCollection(closest(target, '.' + literals.row));\n                    this.setCheckAllState();\n                }\n            }\n            if (!this.parent.isCheckBoxSelection && Browser.isDevice && !this.isSingleSel()) {\n                this.showPopup(e);\n            }\n        }\n        else if (e.target.classList.contains('e-headercell') &&\n            !e.target.classList.contains('e-stackedheadercell')) {\n            var uid = e.target.querySelector('.e-headercelldiv').getAttribute('e-mappinguid');\n            this.headerSelectionHandler(this.parent.getColumnIndexByUid(uid));\n        }\n        this.isMultiCtrlRequest = false;\n        this.isMultiCtrlRequestCell = this.isMultiCtrlRequest;\n        this.isMultiShiftRequest = false;\n        if (isNullOrUndefined(closest(e.target, '.e-unboundcell'))) {\n            this.preventFocus = false;\n        }\n    };\n    Selection.prototype.popUpClickHandler = function (e) {\n        var target = e.target;\n        if (closest(target, '.e-headercell') || e.target.classList.contains(literals.rowCell) ||\n            closest(target, '.e-gridpopup')) {\n            if (target.classList.contains('e-rowselect')) {\n                if (!target.classList.contains('e-spanclicked')) {\n                    target.classList.add('e-spanclicked');\n                    this.enableSelectMultiTouch = true;\n                }\n                else {\n                    target.classList.remove('e-spanclicked');\n                    this.enableSelectMultiTouch = false;\n                    this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n                }\n            }\n        }\n        else {\n            this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n        }\n    };\n    Selection.prototype.showPopup = function (e) {\n        if (!this.selectionSettings.enableSimpleMultiRowSelection) {\n            setCssInGridPopUp(this.parent.element.querySelector('.e-gridpopup'), e, 'e-rowselect e-icons e-icon-rowselect' +\n                (!this.isSingleSel() && (this.selectedRecords.length > 1\n                    || this.selectedRowCellIndexes.length > 1) ? ' e-spanclicked' : ''));\n        }\n    };\n    Selection.prototype.rowCellSelectionHandler = function (rowIndex, cellIndex) {\n        if ((!this.isMultiCtrlRequest && !this.isMultiShiftRequest) || this.isSingleSel()) {\n            if (!this.isDragged) {\n                this.selectRow(rowIndex, this.selectionSettings.enableToggle);\n            }\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, this.selectionSettings.enableToggle);\n            if (this.selectedRowCellIndexes.length) {\n                this.updateAutoFillPosition();\n            }\n            this.drawBorders();\n        }\n        else if (this.isMultiShiftRequest) {\n            var isChkBox = closest(this.target, '.' + literals.rowCell).classList.contains(literals.gridChkBox);\n            if (this.parent.isCheckBoxSelection || (!this.parent.isCheckBoxSelection && !isChkBox)\n                || (this.parent.getColumns().some(function (col) { return col.type === 'checkbox'; })\n                    && this.selectionSettings.checkboxMode === 'ResetOnRowClick' && isChkBox)) {\n                this.selectRowsByRange(isUndefined(this.prevRowIndex) ? rowIndex : this.prevRowIndex, rowIndex);\n            }\n            else {\n                this.addRowsToSelection([rowIndex]);\n            }\n            this.selectCellsByRange(isUndefined(this.prevCIdxs) ? { rowIndex: rowIndex, cellIndex: cellIndex } : this.prevCIdxs, { rowIndex: rowIndex, cellIndex: cellIndex });\n            this.updateAutoFillPosition();\n            this.drawBorders();\n        }\n        else {\n            this.addRowsToSelection([rowIndex]);\n            if (this.selectionSettings.mode === 'Both') {\n                var checkboxColumn = this.parent.getColumns().find(function (col) { return col.type === 'checkbox'; });\n                var checkboxColumnIndexCheck = checkboxColumn && checkboxColumn.index !== cellIndex;\n                if (checkboxColumnIndexCheck && !this.isMultiCtrlRequestCell) {\n                    this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, this.selectionSettings.enableToggle);\n                }\n                else if (!checkboxColumn || checkboxColumnIndexCheck) {\n                    this.addCellsToSelection([{ rowIndex: rowIndex, cellIndex: cellIndex }]);\n                }\n            }\n            else {\n                this.addCellsToSelection([{ rowIndex: rowIndex, cellIndex: cellIndex }]);\n            }\n            this.showHideBorders('none');\n        }\n        this.isDragged = false;\n    };\n    Selection.prototype.onCellFocused = function (e) {\n        if (this.parent.frozenRows && e.container.isHeader && e.byKey) {\n            if (e.keyArgs.action === 'upArrow') {\n                if (this.parent.allowFiltering) {\n                    e.isJump = e.element.tagName === 'INPUT' ? true : false;\n                }\n                else {\n                    e.isJump = e.element.tagName === 'TH' ? true : false;\n                }\n            }\n            else {\n                if (e.keyArgs.action === 'downArrow') {\n                    var rIdx = Number(e.element.parentElement.getAttribute(literals.ariaRowIndex)) - 1;\n                    e.isJump = rIdx === 0 ? true : false;\n                }\n                else {\n                    if (e.keyArgs.action === 'ctrlHome') {\n                        e.isJump = true;\n                    }\n                }\n            }\n        }\n        var clear = ((e.container.isHeader && e.isJump) ||\n            (e.container.isContent && !e.container.isSelectable)) && !(e.byKey && e.keyArgs.action === 'space')\n            && !(e.element.classList.contains('e-detailrowexpand') || e.element.classList.contains('e-detailrowcollapse'));\n        var headerAction = (e.container.isHeader && e.element.tagName !== 'TD' && !closest(e.element, '.' + literals.rowCell))\n            && !(e.byKey && e.keyArgs.action === 'space');\n        if (!e.byKey || clear) {\n            if (clear && !(this.parent.isCheckBoxSelection || (this.selectionSettings.persistSelection && (e.parent.classList.contains('e-recordplusexpand') ||\n                e.parent.classList.contains('e-recordpluscollapse') || e.parent.classList.contains('e-groupcaption'))))) {\n                this.clearSelection();\n            }\n            return;\n        }\n        var _a = e.container.isContent ? e.container.indexes : e.indexes, rowIndex = _a[0], cellIndex = _a[1];\n        var prev = this.focus.getPrevIndexes();\n        if (e.element.parentElement.querySelector('.e-rowcelldrag') || e.element.parentElement.querySelector('.e-dtdiagonalright')\n            || e.element.parentElement.querySelector('.e-dtdiagonaldown')) {\n            prev.cellIndex = prev.cellIndex - 1;\n        }\n        if (this.parent.frozenRows) {\n            if (e.container.isHeader && (e.element.tagName === 'TD' || closest(e.element, '.' + literals.rowCell))) {\n                var hdrLength = this.parent.getHeaderTable().querySelector('thead').childElementCount;\n                if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' &&\n                    e.keyArgs.action === 'upArrow') {\n                    hdrLength++;\n                }\n                rowIndex -= hdrLength;\n                prev.rowIndex = !isNullOrUndefined(prev.rowIndex) ? prev.rowIndex - hdrLength : null;\n            }\n            else {\n                rowIndex += this.parent.frozenRows;\n                prev.rowIndex = prev.rowIndex === 0 || !isNullOrUndefined(prev.rowIndex) ? prev.rowIndex + this.parent.frozenRows : null;\n            }\n        }\n        if (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) {\n            rowIndex = parseInt(e.element.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n        }\n        if ((headerAction || (['ctrlPlusA', 'escape'].indexOf(e.keyArgs.action) === -1 &&\n            e.keyArgs.action !== 'space' && rowIndex === prev.rowIndex && cellIndex === prev.cellIndex)) &&\n            !this.selectionSettings.allowColumnSelection) {\n            return;\n        }\n        if (this.parent.enableVirtualization) {\n            rowIndex = parseInt(e.element.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            if (!this.parent.enableColumnVirtualization && !this.parent.groupSettings.columns.length &&\n                this.parent.totalDataRecordsCount >= 1) {\n                if (e.keyArgs.action === 'ctrlHome') {\n                    rowIndex = 0;\n                    this.parent.isFocusFirstCell = true;\n                }\n                else if (e.keyArgs.action === 'ctrlEnd') {\n                    rowIndex = this.parent.totalDataRecordsCount - 1;\n                    this.isFocusLastCell = true;\n                }\n            }\n        }\n        if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' &&\n            (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling) && e.keyArgs.action === 'downArrow') {\n            rowIndex--;\n        }\n        this.preventFocus = true;\n        var columnIndex = this.getKeyColIndex(e);\n        if (this.needColumnSelection) {\n            cellIndex = columnIndex;\n        }\n        if (this.parent.element.classList.contains('e-gridcell-read') && (e.keyArgs.action === 'tab' || e.keyArgs.action === 'shiftTab'\n            || e.keyArgs.action === 'rightArrow' || e.keyArgs.action === 'leftArrow')) {\n            var targetLabel = this.target.getAttribute('aria-label');\n            targetLabel = this.target.innerHTML + ' column header ' + this.parent.getColumnByIndex(cellIndex).field;\n            this.target.setAttribute('aria-label', targetLabel);\n        }\n        switch (e.keyArgs.action) {\n            case 'downArrow':\n            case 'upArrow':\n            case 'enter':\n            case 'shiftEnter':\n                this.target = e.element;\n                this.isKeyAction = true;\n                this.applyDownUpKey(rowIndex, cellIndex);\n                break;\n            case 'rightArrow':\n            case 'leftArrow':\n                this.applyRightLeftKey(rowIndex, cellIndex);\n                break;\n            case 'shiftDown':\n            case 'shiftUp':\n                this.shiftDownKey(rowIndex, cellIndex);\n                break;\n            case 'shiftLeft':\n            case 'shiftRight':\n                this.applyShiftLeftRightKey(rowIndex, cellIndex);\n                break;\n            case 'home':\n            case 'end':\n                cellIndex = e.keyArgs.action === 'end' ? this.getLastColIndex(rowIndex) : 0;\n                this.applyHomeEndKey(rowIndex, cellIndex);\n                break;\n            case 'ctrlHome':\n            case 'ctrlEnd':\n                this.applyCtrlHomeEndKey(rowIndex, cellIndex);\n                break;\n            case 'escape':\n                this.clearSelection();\n                if (this.parent.clipboardModule) {\n                    window.navigator['clipboard'].writeText('');\n                }\n                break;\n            case 'ctrlPlusA':\n                this.ctrlPlusA();\n                break;\n            case 'space':\n                this.applySpaceSelection(e.element);\n                break;\n            case 'tab':\n                if (this.parent.editSettings.allowNextRowEdit) {\n                    this.selectRow(rowIndex);\n                }\n                break;\n        }\n        this.needColumnSelection = false;\n        this.preventFocus = false;\n        this.positionBorders();\n        if (this.parent.isFrozenGrid()) {\n            this.showHideBorders('none', true);\n            this.refreshFrozenBorders();\n        }\n        this.updateAutoFillPosition();\n    };\n    Selection.prototype.getKeyColIndex = function (e) {\n        var uid;\n        var index = null;\n        var stackedHeader = e.element.querySelector('.e-stackedheadercelldiv');\n        if (this.selectionSettings.allowColumnSelection && parentsUntil(e.element, 'e-columnheader')) {\n            this.needColumnSelection = e.container.isHeader ? true : false;\n            if (stackedHeader) {\n                if (e.keyArgs.action === 'rightArrow' || e.keyArgs.action === 'leftArrow') {\n                    return index;\n                }\n                uid = stackedHeader.getAttribute('e-mappinguid');\n                var innerColumn = this.getstackedColumns(this.parent.getColumnByUid(uid).columns);\n                var lastIndex = this.parent.getColumnIndexByUid(innerColumn[innerColumn.length - 1].uid);\n                var firstIndex = this.parent.getColumnIndexByUid(innerColumn[0].uid);\n                index = this.prevColIndex >= lastIndex ? firstIndex : lastIndex;\n            }\n            else {\n                index = this.parent.getColumnIndexByUid(e.element\n                    .querySelector('.e-headercelldiv').getAttribute('e-mappinguid'));\n            }\n        }\n        return index;\n    };\n    /**\n     * Apply ctrl + A key selection\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.ctrlPlusA = function () {\n        if (this.isRowType() && !this.isSingleSel()) {\n            var rowObj = this.parent.getRowsObject();\n            this.selectRowsByRange(rowObj[0].index, rowObj[rowObj.length - 1].index);\n        }\n        if (this.isCellType() && !this.isSingleSel()) {\n            this.selectCellsByRange({ rowIndex: 0, cellIndex: 0 }, { rowIndex: this.parent.getRows().length - 1, cellIndex: this.parent.getColumns().length - 1 });\n        }\n    };\n    Selection.prototype.applySpaceSelection = function (target) {\n        if (target.classList.contains('e-checkselectall')) {\n            this.checkedTarget = target;\n            this.checkSelectAll(this.checkedTarget);\n        }\n        else {\n            if (target.classList.contains('e-checkselect')) {\n                this.checkedTarget = target;\n                this.checkSelect(this.checkedTarget);\n            }\n        }\n    };\n    Selection.prototype.applyDownUpKey = function (rowIndex, cellIndex) {\n        var gObj = this.parent;\n        if (this.parent.isCheckBoxSelection && this.parent.checkAllRows === 'Check' && !this.selectionSettings.persistSelection &&\n            !this.selectionSettings.checkboxOnly) {\n            this.checkSelectAllAction(false);\n            this.checkedTarget = null;\n        }\n        if (this.isRowType() && !this.selectionSettings.checkboxOnly) {\n            if (this.parent.frozenRows) {\n                this.selectRow(rowIndex, true);\n                this.applyUpDown(gObj.selectedRowIndex);\n            }\n            else {\n                this.selectRow(rowIndex, true);\n                this.applyUpDown(gObj.selectedRowIndex);\n            }\n        }\n        if (this.isCellType()) {\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, true);\n        }\n        if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n            this.selectColumn(cellIndex);\n        }\n    };\n    Selection.prototype.applyUpDown = function (rowIndex) {\n        if (rowIndex < 0) {\n            return;\n        }\n        if (!this.target) {\n            this.target = this.parent.getRows()[0].children[this.parent.groupSettings.columns.length || 0];\n        }\n        var cIndex = parseInt(this.target.getAttribute(literals.ariaColIndex), 10) - 1;\n        var row = this.contentRenderer.getRowByIndex(rowIndex);\n        if (row) {\n            this.target = row.getElementsByClassName(literals.rowCell)[parseInt(cIndex.toString(), 10)];\n        }\n        this.addAttribute(this.target);\n        if (this.parent.element.classList.contains('e-gridcell-read')) {\n            var targetLabel = this.target.getAttribute('aria-label');\n            targetLabel = this.target.innerHTML;\n            this.target.setAttribute('aria-label', targetLabel);\n        }\n    };\n    Selection.prototype.applyRightLeftKey = function (rowIndex, cellIndex) {\n        if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n            this.selectColumn(cellIndex);\n        }\n        else if (this.isCellType()) {\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, true);\n            this.addAttribute(this.target);\n        }\n    };\n    Selection.prototype.applyHomeEndKey = function (rowIndex, cellIndex) {\n        if (this.isCellType()) {\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, true);\n        }\n        else {\n            this.addAttribute(this.parent.getCellFromIndex(rowIndex, cellIndex));\n        }\n    };\n    /**\n     * Apply shift+down key selection\n     *\n     * @param {number} rowIndex - specfies the rowIndex\n     * @param {number} cellIndex - specifies the CellIndex\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.shiftDownKey = function (rowIndex, cellIndex) {\n        this.isMultiShiftRequest = true;\n        if (this.isRowType() && !this.isSingleSel()) {\n            if (!isUndefined(this.prevRowIndex)) {\n                this.selectRowsByRange(this.prevRowIndex, rowIndex);\n                this.applyUpDown(rowIndex);\n            }\n            else if (this.isPartialSelection) {\n                this.selectRow(rowIndex, true);\n            }\n            else {\n                this.selectRow(0, true);\n            }\n        }\n        if (this.isCellType() && !this.isSingleSel()) {\n            this.selectCellsByRange(this.prevCIdxs || { rowIndex: 0, cellIndex: 0 }, { rowIndex: rowIndex, cellIndex: cellIndex });\n        }\n        this.isMultiShiftRequest = false;\n    };\n    Selection.prototype.applyShiftLeftRightKey = function (rowIndex, cellIndex) {\n        this.isMultiShiftRequest = true;\n        if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n            this.selectColumnsByRange(this.prevColIndex, cellIndex);\n        }\n        else {\n            this.selectCellsByRange(this.prevCIdxs, { rowIndex: rowIndex, cellIndex: cellIndex });\n        }\n        this.isMultiShiftRequest = false;\n    };\n    Selection.prototype.getstackedColumns = function (column) {\n        var innerColumnIndexes = [];\n        for (var i = 0, len = column.length; i < len; i++) {\n            if (column[parseInt(i.toString(), 10)].columns) {\n                this.getstackedColumns(column[parseInt(i.toString(), 10)].columns);\n            }\n            else {\n                innerColumnIndexes.push(column[parseInt(i.toString(), 10)]);\n            }\n        }\n        return innerColumnIndexes;\n    };\n    Selection.prototype.applyCtrlHomeEndKey = function (rowIndex, cellIndex) {\n        if (this.isRowType()) {\n            this.selectRow(rowIndex, true);\n            if (!(this.parent.enableVirtualization || this.parent.enableColumnVirtualization)) {\n                this.addAttribute(this.parent.getCellFromIndex(rowIndex, cellIndex));\n            }\n        }\n        if (this.isCellType()) {\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, true);\n        }\n    };\n    Selection.prototype.addRemoveClassesForRow = function (row, isAdd, clearAll) {\n        var args = [];\n        for (var _i = 3; _i < arguments.length; _i++) {\n            args[_i - 3] = arguments[_i];\n        }\n        if (row) {\n            var cells = [].slice.call(row.getElementsByClassName(literals.rowCell));\n            var detailIndentCell = row.querySelector('.e-detailrowcollapse') || row.querySelector('.e-detailrowexpand');\n            var dragdropIndentCell = row.querySelector('.e-rowdragdrop');\n            if (detailIndentCell) {\n                cells.push(detailIndentCell);\n            }\n            if (dragdropIndentCell) {\n                cells.push(dragdropIndentCell);\n            }\n            addRemoveActiveClasses.apply(void 0, [cells, isAdd].concat(args));\n        }\n        this.getRenderer().setSelection(row ? row.getAttribute('data-uid') : null, isAdd, clearAll);\n    };\n    Selection.prototype.isRowType = function () {\n        return this.selectionSettings.mode === 'Row' || this.selectionSettings.mode === 'Both';\n    };\n    Selection.prototype.isCellType = function () {\n        return this.selectionSettings.mode === 'Cell' || this.selectionSettings.mode === 'Both';\n    };\n    Selection.prototype.isSingleSel = function () {\n        return this.selectionSettings.type === 'Single';\n    };\n    Selection.prototype.getRenderer = function () {\n        if (isNullOrUndefined(this.contentRenderer)) {\n            this.contentRenderer = this.factory.getRenderer(RenderType.Content);\n        }\n        return this.contentRenderer;\n    };\n    /**\n     * Gets the collection of selected records.\n     *\n     * @returns {Object[]} returns the Object\n     */\n    Selection.prototype.getSelectedRecords = function () {\n        var selectedData = [];\n        if (!this.selectionSettings.persistSelection && this.selectedRecords.length) {\n            selectedData = this.parent.getRowsObject().filter(function (row) { return row.isSelected; })\n                .map(function (m) { return m.data; });\n        }\n        else {\n            selectedData = this.persistSelectedData;\n        }\n        if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n            selectedData = this.virtualSelectedData;\n        }\n        return selectedData;\n    };\n    /**\n     * Select the column by passing start column index\n     *\n     * @param {number} index - specifies the index\n     * @returns {void}\n     */\n    Selection.prototype.selectColumn = function (index) {\n        var gObj = this.parent;\n        if (isNullOrUndefined(gObj.getColumns()[parseInt(index.toString(), 10)])) {\n            return;\n        }\n        var column = gObj.getColumnByIndex(index);\n        var selectedCol = gObj.getColumnHeaderByUid(column.uid);\n        var isColSelected = selectedCol.classList.contains('e-columnselection');\n        if ((!gObj.selectionSettings.allowColumnSelection)) {\n            return;\n        }\n        var isMultiColumns = this.selectedColumnsIndexes.length > 1 &&\n            this.selectedColumnsIndexes.indexOf(index) > -1;\n        this.clearColDependency();\n        if (!this.selectionSettings.enableToggle || isMultiColumns || !isColSelected) {\n            var args = {\n                columnIndex: index, headerCell: selectedCol,\n                column: column,\n                cancel: false, target: this.actualTarget,\n                isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex,\n                isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest\n            };\n            this.onActionBegin(args, events.columnSelecting);\n            if (args.cancel) {\n                this.disableInteracted();\n                return;\n            }\n            if (isMultiColumns || !(isColSelected && gObj.selectionSettings.enableToggle && index === this.prevColIndex)) {\n                this.updateColSelection(selectedCol, index);\n            }\n            var selectedArgs = {\n                columnIndex: index, headerCell: selectedCol,\n                column: column,\n                target: this.actualTarget,\n                isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex\n            };\n            this.onActionComplete(selectedArgs, events.columnSelected);\n        }\n        this.updateColProps(index);\n    };\n    /**\n     * Select the columns by passing start and end column index\n     *\n     * @param  {number} startIndex - specifies the start index\n     * @param  {number} endIndex - specifies the end index\n     * @returns {void}\n     */\n    Selection.prototype.selectColumnsByRange = function (startIndex, endIndex) {\n        var gObj = this.parent;\n        if (isNullOrUndefined(gObj.getColumns()[parseInt(startIndex.toString(), 10)])) {\n            return;\n        }\n        var indexes = [];\n        if (gObj.selectionSettings.type === 'Single' || isNullOrUndefined(endIndex)) {\n            indexes[0] = startIndex;\n        }\n        else {\n            var min = startIndex < endIndex;\n            for (var i = startIndex; min ? i <= endIndex : i >= endIndex; min ? i++ : i--) {\n                indexes.push(i);\n            }\n        }\n        this.selectColumns(indexes);\n    };\n    /**\n     * Select the columns by passing column indexes\n     *\n     * @param  {number[]} columnIndexes - specifies the columnIndexes\n     * @returns {void}\n     */\n    Selection.prototype.selectColumns = function (columnIndexes) {\n        var gObj = this.parent;\n        var selectedCol = this.getselectedCols();\n        if (gObj.selectionSettings.type === 'Single') {\n            columnIndexes = [columnIndexes[0]];\n        }\n        if (!gObj.selectionSettings.allowColumnSelection) {\n            return;\n        }\n        this.clearColDependency();\n        var selectingArgs = {\n            columnIndex: columnIndexes[0], headerCell: selectedCol,\n            columnIndexes: columnIndexes,\n            column: gObj.getColumnByIndex(columnIndexes[0]),\n            cancel: false, target: this.actualTarget,\n            isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex,\n            isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest\n        };\n        this.onActionBegin(selectingArgs, events.columnSelecting);\n        if (selectingArgs.cancel) {\n            this.disableInteracted();\n            return;\n        }\n        for (var i = 0, len = columnIndexes.length; i < len; i++) {\n            this.updateColSelection(gObj.getColumnHeaderByUid(gObj.getColumnByIndex(columnIndexes[parseInt(i.toString(), 10)]).uid), columnIndexes[parseInt(i.toString(), 10)]);\n        }\n        selectedCol = this.getselectedCols();\n        var selectedArgs = {\n            columnIndex: columnIndexes[0], headerCell: selectedCol,\n            columnIndexes: columnIndexes,\n            column: gObj.getColumnByIndex(columnIndexes[0]),\n            target: this.actualTarget,\n            isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex\n        };\n        this.onActionComplete(selectedArgs, events.columnSelected);\n        this.updateColProps(columnIndexes[0]);\n    };\n    /**\n     * Select the column with existing column by passing column index\n     *\n     * @param  {number} startIndex - specifies the start index\n     * @returns {void}\n     */\n    Selection.prototype.selectColumnWithExisting = function (startIndex) {\n        var gObj = this.parent;\n        if (isNullOrUndefined(gObj.getColumns()[parseInt(startIndex.toString(), 10)])) {\n            return;\n        }\n        var newCol = gObj.getColumnHeaderByUid(gObj.getColumnByIndex(startIndex).uid);\n        var selectedCol = this.getselectedCols();\n        if (gObj.selectionSettings.type === 'Single') {\n            this.clearColDependency();\n        }\n        if (!gObj.selectionSettings.allowColumnSelection) {\n            return;\n        }\n        if (this.selectedColumnsIndexes.indexOf(startIndex) > -1) {\n            this.clearColumnSelection(startIndex);\n        }\n        else {\n            var selectingArgs = {\n                columnIndex: startIndex, headerCell: selectedCol,\n                columnIndexes: this.selectedColumnsIndexes,\n                column: gObj.getColumnByIndex(startIndex),\n                cancel: false, target: this.actualTarget,\n                isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex,\n                isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest\n            };\n            this.onActionBegin(selectingArgs, events.columnSelecting);\n            if (selectingArgs.cancel) {\n                this.disableInteracted();\n                return;\n            }\n            this.updateColSelection(newCol, startIndex);\n            selectedCol = this.getselectedCols();\n            var selectedArgs = {\n                columnIndex: startIndex, headerCell: selectedCol,\n                column: gObj.getColumnByIndex(startIndex),\n                columnIndexes: this.selectedColumnsIndexes,\n                target: this.actualTarget,\n                isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex\n            };\n            this.onActionComplete(selectedArgs, events.columnSelected);\n        }\n        this.updateColProps(startIndex);\n    };\n    /**\n     * Clear the column selection\n     *\n     * @param {number} clearIndex - specifies the clearIndex\n     * @returns {void}\n     */\n    Selection.prototype.clearColumnSelection = function (clearIndex) {\n        if (this.isColumnSelected) {\n            var gObj = this.parent;\n            if (!isNullOrUndefined(clearIndex) && this.selectedColumnsIndexes.indexOf(clearIndex) === -1) {\n                return;\n            }\n            var index = !isNullOrUndefined(clearIndex) ? clearIndex :\n                this.selectedColumnsIndexes[this.selectedColumnsIndexes.length - 1];\n            var column = gObj.getColumnByIndex(index);\n            var selectedCol = gObj.getColumnHeaderByUid(column.uid);\n            var deselectedArgs = {\n                columnIndex: index, headerCell: selectedCol,\n                columnIndexes: this.selectedColumnsIndexes,\n                column: column,\n                cancel: false, target: this.actualTarget,\n                isInteracted: this.isInteracted\n            };\n            var isCanceled = this.columnDeselect(deselectedArgs, events.columnDeselecting);\n            if (isCanceled) {\n                this.disableInteracted();\n                return;\n            }\n            var selectedHeader = !isNullOrUndefined(clearIndex) ? [selectedCol] :\n                [].slice.call(gObj.getHeaderContent().getElementsByClassName('e-columnselection'));\n            var selectedCells = this.getSelectedColumnCells(clearIndex);\n            for (var i = 0, len = selectedHeader.length; i < len; i++) {\n                addRemoveActiveClasses([selectedHeader[parseInt(i.toString(), 10)]], false, 'e-columnselection');\n            }\n            for (var i = 0, len = selectedCells.length; i < len; i++) {\n                addRemoveActiveClasses([selectedCells[parseInt(i.toString(), 10)]], false, 'e-columnselection');\n            }\n            if (!isNullOrUndefined(clearIndex)) {\n                this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(clearIndex), 1);\n                this.parent.getColumns()[parseInt(clearIndex.toString(), 10)].isSelected = false;\n            }\n            else {\n                this.columnDeselect(deselectedArgs, events.columnDeselected);\n                this.selectedColumnsIndexes = [];\n                this.isColumnSelected = false;\n                this.parent.getColumns().filter(function (col) { return col.isSelected = false; });\n            }\n        }\n    };\n    Selection.prototype.getselectedCols = function () {\n        var gObj = this.parent;\n        var selectedCol;\n        if (this.selectedColumnsIndexes.length > 1) {\n            selectedCol = [];\n            for (var i = 0; i < this.selectedColumnsIndexes.length; i++) {\n                (selectedCol).push(gObj.getColumnHeaderByUid(gObj.getColumnByIndex(this.selectedColumnsIndexes[parseInt(i.toString(), 10)]).uid));\n            }\n        }\n        else {\n            selectedCol = gObj.getColumnHeaderByUid(gObj.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);\n        }\n        return selectedCol;\n    };\n    Selection.prototype.getSelectedColumnCells = function (clearIndex) {\n        var gObj = this.parent;\n        var isRowTemplate = !isNullOrUndefined(this.parent.rowTemplate);\n        var rows = isRowTemplate ? gObj.getRows() : gObj.getDataRows();\n        var seletedcells = [];\n        var selectionString = !isNullOrUndefined(clearIndex) ? '[aria-colindex=\"' + (clearIndex + 1) + '\"]' : '.e-columnselection';\n        for (var i = 0, len = rows.length; i < len; i++) {\n            seletedcells = seletedcells.concat([].slice.call(rows[parseInt(i.toString(), 10)].querySelectorAll(selectionString)));\n        }\n        return seletedcells;\n    };\n    Selection.prototype.columnDeselect = function (args, event) {\n        if (event === 'columnDeselected') {\n            delete args.cancel;\n        }\n        this.onActionComplete(args, event);\n        return args.cancel;\n    };\n    Selection.prototype.updateColProps = function (startIndex) {\n        this.prevColIndex = startIndex;\n        this.isColumnSelected = this.selectedColumnsIndexes.length && true;\n    };\n    Selection.prototype.clearColDependency = function () {\n        this.clearColumnSelection();\n        this.selectedColumnsIndexes = [];\n    };\n    Selection.prototype.updateColSelection = function (selectedCol, startIndex) {\n        if (isNullOrUndefined(this.parent.getColumns()[parseInt(startIndex.toString(), 10)])) {\n            return;\n        }\n        var isRowTemplate = !isNullOrUndefined(this.parent.rowTemplate);\n        var rows = isRowTemplate ? this.parent.getRows() : this.parent.getDataRows();\n        this.selectedColumnsIndexes.push(startIndex);\n        this.parent.getColumns()[parseInt(startIndex.toString(), 10)].isSelected = true;\n        startIndex = startIndex + this.parent.getIndentCount();\n        addRemoveActiveClasses([selectedCol], true, 'e-columnselection');\n        for (var j = 0, len = rows.length; j < len; j++) {\n            if (rows[parseInt(j.toString(), 10)].classList.contains(literals.row)) {\n                if ((rows[parseInt(j.toString(), 10)].classList.contains(literals.editedRow)\n                    || rows[parseInt(j.toString(), 10)].classList.contains(literals.addedRow))\n                    && this.parent.editSettings.mode === 'Normal'\n                    && !isNullOrUndefined(rows[parseInt(j.toString(), 10)].querySelector('tr').childNodes[parseInt(startIndex.toString(), 10)])) {\n                    addRemoveActiveClasses([rows[parseInt(j.toString(), 10)].querySelector('tr').childNodes[parseInt(startIndex.toString(), 10)]], true, 'e-columnselection');\n                }\n                else {\n                    if (this.parent.isSpan && this.parent.isFrozenGrid()) {\n                        var cells = rows[parseInt(j.toString(), 10)].querySelectorAll('.e-rowcell');\n                        for (var i = 0; i < cells.length; i++) {\n                            if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === selectedCol.getAttribute('aria-colindex')) {\n                                addRemoveActiveClasses([cells[parseInt(i.toString(), 10)]], true, 'e-columnselection');\n                            }\n                        }\n                    }\n                    else if (!isNullOrUndefined(rows[parseInt(j.toString(), 10)].childNodes[parseInt(startIndex.toString(), 10)])) {\n                        addRemoveActiveClasses([rows[parseInt(j.toString(), 10)].childNodes[parseInt(startIndex.toString(), 10)]], true, 'e-columnselection');\n                    }\n                }\n            }\n        }\n    };\n    Selection.prototype.headerSelectionHandler = function (colIndex) {\n        if ((!this.isMultiCtrlRequest && !this.isMultiShiftRequest) || this.isSingleSel()) {\n            this.selectColumn(colIndex);\n        }\n        else if (this.isMultiShiftRequest) {\n            this.selectColumnsByRange(isUndefined(this.prevColIndex) ? colIndex : this.prevColIndex, colIndex);\n        }\n        else {\n            this.selectColumnWithExisting(colIndex);\n        }\n    };\n    // eslint-disable-next-line camelcase\n    Selection.prototype.addEventListener_checkbox = function () {\n        var _this = this;\n        this.parent.on(events.dataReady, this.dataReady, this);\n        this.onDataBoundFunction = this.onDataBound.bind(this);\n        this.parent.addEventListener(events.dataBound, this.onDataBoundFunction);\n        this.parent.on(events.refreshInfinitePersistSelection, this.onDataBoundFunction);\n        this.parent.on(events.contentReady, this.checkBoxSelectionChanged, this);\n        this.parent.on(events.beforeRefreshOnDataChange, this.initPerisistSelection, this);\n        this.parent.on(events.onEmpty, this.setCheckAllForEmptyGrid, this);\n        this.actionCompleteFunc = this.actionCompleteHandler.bind(this);\n        this.parent.addEventListener(events.actionComplete, this.actionCompleteFunc);\n        this.parent.on(events.click, this.clickHandler, this);\n        this.resizeEndFn = function () {\n            _this.updateAutoFillPosition();\n            _this.drawBorders();\n        };\n        this.resizeEndFn.bind(this);\n        this.parent.addEventListener(events.resizeStop, this.resizeEndFn);\n    };\n    // eslint-disable-next-line camelcase\n    Selection.prototype.removeEventListener_checkbox = function () {\n        this.parent.off(events.dataReady, this.dataReady);\n        this.parent.removeEventListener(events.dataBound, this.onDataBoundFunction);\n        this.parent.removeEventListener(events.actionComplete, this.actionCompleteFunc);\n        this.parent.off(events.refreshInfinitePersistSelection, this.onDataBoundFunction);\n        this.parent.off(events.onEmpty, this.setCheckAllForEmptyGrid);\n        this.parent.off(events.click, this.clickHandler);\n        this.parent.removeEventListener(events.resizeStop, this.resizeEndFn);\n        this.parent.off(events.beforeRefreshOnDataChange, this.initPerisistSelection);\n    };\n    Selection.prototype.setCheckAllForEmptyGrid = function () {\n        var checkAllBox = this.getCheckAllBox();\n        if (checkAllBox) {\n            this.parent.isCheckBoxSelection = true;\n            var spanEle = checkAllBox.nextElementSibling;\n            removeClass([spanEle], ['e-check', 'e-stop', 'e-uncheck']);\n            addClass([spanEle.parentElement], ['e-checkbox-disabled']);\n        }\n    };\n    Selection.prototype.dataReady = function (e) {\n        this.isHeaderCheckboxClicked = false;\n        var isInfinitecroll = this.parent.enableInfiniteScrolling && e.requestType === 'infiniteScroll';\n        if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection && !isInfinitecroll) {\n            this.disableUI = !this.parent.enableImmutableMode && !(e.requestType === 'save' && e['action'] === 'add');\n            this.clearSelection();\n            this.setCheckAllState();\n            this.disableUI = false;\n        }\n    };\n    Selection.prototype.actionCompleteHandler = function (e) {\n        if (e.requestType === 'save' && this.parent.isPersistSelection) {\n            this.refreshPersistSelection();\n        }\n    };\n    Selection.prototype.selectRowIndex = function (index) {\n        this.parent.isSelectedRowIndexUpdating = true;\n        if ((isNullOrUndefined(this.parent.selectedRowIndex) || this.parent.selectedRowIndex === -1) || !this.parent.enablePersistence) {\n            this.parent.selectedRowIndex = index;\n        }\n        else {\n            this.parent.selectedRowIndex = -1;\n        }\n    };\n    Selection.prototype.disableInteracted = function () {\n        this.isInteracted = false;\n    };\n    Selection.prototype.activeTarget = function () {\n        this.actualTarget = this.isInteracted ? this.actualTarget : null;\n    };\n    return Selection;\n}());\nexport { Selection };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}